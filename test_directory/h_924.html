<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Ведение семейных финансов на C# и Xamarin. Личный опыт / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/568174\/"},"headline":"Ведение семейных финансов на C# и Xamarin. Личный опыт","datePublished":"2021-10-06T22:55:39+03:00","dateModified":"2021-10-07T10:42:06+03:00","author":{"@type":"Person","name":"pawellrus"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"ПредисловиеВ данной статье пойдет речь о том, как через тернии костылей и багов я в итоге достиг приличного уровня автоматизации учета семейных финансов.Дисклейм...","url":"https:\/\/habr.com\/ru\/post\/568174\/#post-content-body","about":["h_android_dev","h_csharp","h_read","h_Xamarin","h_finance","f_develop","f_management","f_popsci"],"image":["https:\/\/habr.com\/share\/publication\/568174\/3ddb481c44fc325eb1a157a964bfee74\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/7d4\/4d6\/a26\/7d44d6a26d53e30559aeede30e39c032.JPG","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/fbd\/66e\/e2d\/fbd66ee2d2b8ff0b6948ec577499a680.JPG","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/a7e\/e32\/9b2\/a7ee329b2a031c06544240b4ee9c883e.JPG","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/a29\/035\/54e\/a2903554ea99d97993e1222b213f7b60.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/8b5\/64d\/9ee\/8b564d9ee4d98e0b5317bf061c7c98a4.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/359\/d70\/945\/359d70945dfaebf343dea76926edd996.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/526\/e2e\/8f4\/526e2e8f47156133d3ccbb1e6054522d.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/140\/3fb\/fea\/1403fbfea6f4fd616f46f349cc118d9a.JPG","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/831\/5f9\/faf\/8315f9faf2af87cd2b447fc22aa73065.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/39f\/f48\/d88\/39ff48d88e6ad939211d91921d9f0ff2.JPG","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/85a\/3ac\/143\/85a3ac143037a46d603cb60e4493e6df.PNG","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/1a1\/047\/b49\/1a1047b49b1c166d6e465a464b429a35.JPG","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/939\/997\/794\/939997794aea5f40824cbdb40a22be57.JPG"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Ведение семейных финансов на C# и Xamarin. Личный опыт" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Ведение семейных финансов на C# и Xamarin. Личный опыт" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Ведение семейных финансов на C# и Xamarin. Личный опыт" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="ПредисловиеВ данной статье пойдет речь о том, как через тернии костылей и багов я в итоге достиг приличного уровня автоматизации учета семейных финансов.Дисклеймер: автор статьи имеет посредственные..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="ПредисловиеВ данной статье пойдет речь о том, как через тернии костылей и багов я в итоге достиг приличного уровня автоматизации учета семейных финансов.Дисклеймер: автор статьи имеет посредственные..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="ПредисловиеВ данной статье пойдет речь о том, как через тернии костылей и багов я в итоге достиг приличного уровня автоматизации учета семейных финансов.Дисклеймер: автор статьи имеет посредственные..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="ПредисловиеВ данной статье пойдет речь о том, как через тернии костылей и багов я в итоге достиг приличного уровня автоматизации учета семейных финансов.Дисклеймер: автор статьи имеет посредственные..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="ПредисловиеВ данной статье пойдет речь о том, как через тернии костылей и багов я в итоге достиг приличного уровня автоматизации учета семейных финансов.Дисклеймер: автор статьи имеет посредственные..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/430/be5/99d/430be599dc4626cea3b3c4982ebd8d85.jpg" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/430/be5/99d/430be599dc4626cea3b3c4982ebd8d85.jpg" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/430/be5/99d/430be599dc4626cea3b3c4982ebd8d85.jpg" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/430/be5/99d/430be599dc4626cea3b3c4982ebd8d85.jpg" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/430/be5/99d/430be599dc4626cea3b3c4982ebd8d85.jpg" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="568174" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-06T19:55:39.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/568174/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/568174/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habrastorage.org/getpro/habr/upload_files/430/be5/99d/430be599dc4626cea3b3c4982ebd8d85.jpg" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/568174/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/pawellrus/" title="pawellrus" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/pawellrus/" class="tm-user-info__username">
      pawellrus
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-06T19:55:39.000Z" title="2021-10-06, 22:55">6  октября   в 22:55</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Ведение семейных финансов на C# и Xamarin. Личный опыт</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/android_dev/" class="tm-article-snippet__hubs-item-link"><span>Разработка под Android</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/csharp/" class="tm-article-snippet__hubs-item-link"><span>C#</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/read/" class="tm-article-snippet__hubs-item-link"><span>Читальный зал</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/Xamarin/" class="tm-article-snippet__hubs-item-link"><span>Xamarin</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/finance/" class="tm-article-snippet__hubs-item-link"><span>Финансы в IT</span> <!----></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Recovery mode
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><h2>Предисловие</h2><p>В данной статье пойдет речь о том, как через тернии костылей и багов я в итоге достиг приличного уровня автоматизации учета семейных финансов.</p><p><em>Дисклеймер: автор статьи имеет посредственные скиллы разработки, так что некоторые технические решения могут оскорбить чувства middle и senior developer-ов.</em> </p><p>К пониманию необходимости учета финансов я пришел в 2016 году, когда съехался со своей будущей женой. Цели учета были вполне банальные: понимать кто и сколько расходует на какие товары, выявить возможности для оптимизации расходов, а так же убедиться, что соотношение семейных расходов соразмерно соотношению размеров зарплат членов семьи. (Спойлер: разумеется, сэкономить в итоге ни на чем не получилось)</p><p>Многие советуют заводить отдельную карту для семейных покупок и перечислять на нее средства каждый месяц, но нам этот вариант не понравился. Проще контролировать расходы постфактум, а не пытаться их спрогнозировать. </p><p>Я считаю такой подход более разумным. Разумеется, мы не делим расходы абсолютно в каждом чеке из продуктового. В основном, дележке подвергаются крупные чеки из гипермаркетов на тысячи рублей. Также мы совместо финансируем коммунальные платежи, аренду и другие крупные жилищно-инфраструктурные проекты.</p><h2>Версия 0</h2><p>Как правило, первые попытки ведения семейного бюджета люди начинают в Excel или иных аналогах, типа Google Sheets. И мы не стали исключением. </p><p>Схема была такой. Кто-то из нас двоих в оплачивал в магазине большой чек. Далее содержимое чека вносилось в экселевский файлик, а затем суммировались ячейки с товарами, купленными на семейные нужды. Так мы понимали, кто кому сколько должен перевести денег. </p><p>Такой метод оказался весьма неудобен в эксплуатации, и вскоре я начал поиск более подходящей альтернативы.</p><h2>Версия 1</h2><p>Но поиск быстро зашел в тупик. Бесплатные варианты не умели делить один чек между несколькими пользователями. Да даже многопользовательский режим был далеко не везде. Платные же программы помимо факта своей платности зачастую предлагали поделиться данными о своих расходах с разработчиками. Ни платить ни делиться данными мне не хотелось.</p><p>Поэтому четко вырисовывался вариант - писать программу самому. Еще одним аргументом в пользу разработки было личное желание поизобретать велосипед и попробовать себя в качестве программиста. Я даже вынашивал идею улучшить свои жизненные условия через смену специализации с Windows-эникея на программиста. </p><p>Так как на заочном отделении в моем ВУЗе меня обучили только шлепать формы на C#, выбор стека для собственного приложения был очевиден. В качестве СУБД был выбран MSSQL Express, который хостился на домашнем сервере. Примерно за месяц был написан MVP, после чего с 1 сентября 2016 года процесс учета расходов был перенесен в свеженаписанную программу. </p><p>Параллельно с использованием программы шла ее постоянная доработка. Функционал постоянно дописывался и перекраивался. Неудачные решения выпиливались, и на их месте появлялись новые, которые в будущем могла постичь та же участь. Появлялись новые сущности, корректировался их набор параметров и логика работы, дорабатывался интерфейс. В конечном итоге был выработан наиболее удачный вариант логики приложения:</p><blockquote><p><em>Основная сущность в программе - чек, который содержит позиции. У чека есть дата и место совершения покупки.</em></p><p><em>У каждой позиции в чеке помимо основных параметров (наименование, цена, количество, категория) есть признак «расходы на общие нужды», а также имя пользователя, который эту позицию оплатил. По этим двум важным признакам происходит расчет итоговых сумм чека на каждого члена семьи. </em></p><p><em>Любое приходно-расходное действие также генерирует операцию со знаком плюс или минус. Суммируя все операции, получаем текущее количество денег у отельно взятого пользователя.</em></p><p><em>Помимо этого существуют вспомогательные справочники магазинов, категорий товаров, географических локаций, и.т.д.</em></p></blockquote><p>Вокруг основного функционала и данных я начал реализовывать разные полезные фичи, такие как например:</p><ul><li><p>Отчетность. Были реализованы различные отчеты, как например статистика трат по категориям товаров или статистика трат в разрезе магазинов.</p></li><li><p>Отслеживание текущего баланса. Всегда хотел видеть количество денег, как у игрового персонажа :)</p></li><li><p>Шаблоны чеков. Ввод однотипных расходов, как например такси, кофе, проезд в метро, был значительно упрощен таким путем. При выборе шаблона автоматически подставлялись все данные из соответствующего старого чека. Оставалось только поменять сумму и сохранить новый чек.</p></li></ul><p>В какой-то момент появилось и устоявшееся название, которое сохранилось и по сей день – Домашняя бухгалтерия.</p><p>Немного скриншотов того, как выглядела первая версия Домашней бухгалтерии на излете жизни.</p><figure class="full-width "><img src="https://habrastorage.org/getpro/habr/upload_files/7d4/4d6/a26/7d44d6a26d53e30559aeede30e39c032.JPG" alt="Главное окно программы" title="Главное окно программы" width="1156" height="892"/><figcaption>Главное окно программы</figcaption></figure><figure class="full-width "><img src="https://habrastorage.org/getpro/habr/upload_files/fbd/66e/e2d/fbd66ee2d2b8ff0b6948ec577499a680.JPG" alt="Форма добавления чеков" title="Форма добавления чеков" width="1100" height="870"/><figcaption>Форма добавления чеков</figcaption></figure><figure class="bordered full-width "><img src="https://habrastorage.org/getpro/habr/upload_files/a7e/e32/9b2/a7ee329b2a031c06544240b4ee9c883e.JPG" alt="Отчет по структуре расходов" title="Отчет по структуре расходов" width="1151" height="886"/><figcaption>Отчет по структуре расходов</figcaption></figure><p>После этого дальнейшее развитие программы сильно замедлилось. 2019-2020 годы прошли без каких-либо значимых изменений. Лишь изредка приходилось править баги. Все новые идеи откладывались в долгий ящик, мотивации кодить не было, и скоро поясню почему.</p><h4>Небольшое лирическое отступление</h4><p>За 4 года нам с женой уже порядком поднадоело вносить портянки магазинных чеков вручную. Технологии шагнули далеко вперед, и концепция ручного ввода безнадежно устарела.</p><p>Виделось два очевидных вектора автоматизации учета:</p><ul><li><p>парсинг SMS уведомлений о списаниях с банковской карты</p></li><li><p>получение содержимого чека по QR-коду.</p></li></ul><p>Но такие глобальные доработки упирались в один очень неприятный факт:</p><figure class="bordered full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/a29/035/54e/a2903554ea99d97993e1222b213f7b60.jpg" width="700" height="385" data-src="https://habrastorage.org/getpro/habr/upload_files/a29/035/54e/a2903554ea99d97993e1222b213f7b60.jpg" data-blurred="true"/><figcaption></figcaption></figure><p>Программирование в гуманитарном ВУЗе, да еще и на заочном отделении преподают весьма посредственно. Поэтому весь код представлял из себя мешанину из if/else, непонятных переменных и sql-запросов, объединенных с переменными. ООП? MVC? MVVM? Паттерны проектирования? Да хотя бы банально писать комментарии? Не, не слышали. После многократных переделок код стал похож на эдакого Франкенштейна. Надо ли говорить, что ориентироваться в нем было крайне сложно?</p><p>И вот под конец бесполезно потраченных новогодних выходных 2021 года я снова взялся за Visual Studio.</p><figure class=""><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/8b5/64d/9ee/8b564d9ee4d98e0b5317bf061c7c98a4.jpg" width="512" height="512" data-src="https://habrastorage.org/getpro/habr/upload_files/8b5/64d/9ee/8b564d9ee4d98e0b5317bf061c7c98a4.jpg" data-blurred="true"/><figcaption></figcaption></figure><h2>Версия 2 - текущая</h2><p>Реализовывать новый функционал, как это сейчас принято, я решил через отдельный микросервис с собственной базой данных. Он должен был быть опубликован в интернет и получать данные от приложения-компаньона на смартфоне.</p><p>Опыта в мобильной разработке у меня было ровно ноль. Тратить месяцы на изучение Java или Kotlin не хотелось. И поэтому, я опять же пошел по легкому пути – Xamarin. В интернете нашел учебный шаблон приложения с вкладками и принялся его погонять под свои нужды, в процессе активно используя Google и Stackoverflow. Как только стало понятно, что мои планы на мобильное приложение реализуемы, параллельно начал разработку серверной части. Тут опять же был выбран C# и .Net Core. Мы же в 2021 живем как-никак, нужно уметь в кроссплатформенность.</p><p>Где-то около месяца у меня ушло на то, чтобы создать прототипы приложения и серверной части, которые могли общаться друг с другом. А далее снова начался процесс тестирования на проде и череда новых версий.</p><h4>Мобильное приложение - CostsExporter</h4><p>Мобильное приложение-компаньон умеет делать три вещи:</p><ul><li><p>сканировать и отправлять на сервер QR-код с чека. </p></li><li><p>проверять inbox на предмет новых SMS от банка и так же отправлять их на сервер. </p></li><li><p>отправлять на сервер введенный расход в виде сумма:описание.</p></li></ul><p>Для сканирования QR-кодов с чека я использую библиотеку <a href="https://github.com/Redth/ZXing.Net.Mobile" rel="noopener noreferrer nofollow">ZXing.Net.Mobile</a>. Примерно в 90% случаев QR-код удается отсканировать. Но если QR-код нечеткий или чек непропечатался/истерся, то тут все печально. Встроенное приложение камеры, как и официально приложение ФНС России, вполне справляются даже в таких случаях. Специально для этого пришлось добавить вариант с ручным ввводом содержимого QR-кода. Если кто может посоветовать вариант лучше, я был бы очень благодарен.</p><p>Для чтения SMS в памяти телефона постоянно висит Foreground Service, который дергает метод проверки входящих SMS каждые 3 минуты. После продолжительного штудирования интернетов я сделал вывод, что только таким путем можно обеспечить приемлемую работоспособность этого процесса, ибо своевольный Android может выгружать любые активности, когда ему вздумается.</p><p>Все SMS/QR-коды/ручные записи перед отправкой складываются в локальную базу SQLite, где так же хранится дата создания и статус отправки на сервер. При повторном сканировании SMS/QR-кода дубли будут отброшены.</p><p>Все сообщения отправляются в json-формате. JSON выглядит примерно так:</p><pre><code>{
  "TypeId": "2",
  "Payload": "02.03.2021 9:54:33;Raiffeisen;Karta *****. Pokupka 137.00 RUB. CITYMOBIL.. Balans 4842.16 RUB. 02.03.2021"0Э
  "User": "Pavel",
  "Secret": "SomeSecret"
}</code></pre><p>Далее немного скринов приложения:</p><figure class="bordered full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/359/d70/945/359d70945dfaebf343dea76926edd996.jpg" alt="" title="" width="2880" height="3168" data-src="https://habrastorage.org/getpro/habr/upload_files/359/d70/945/359d70945dfaebf343dea76926edd996.jpg" data-blurred="true"/><figcaption></figcaption></figure><figure class="bordered full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/526/e2e/8f4/526e2e8f47156133d3ccbb1e6054522d.jpg" alt="" title="" width="2880" height="3168" data-src="https://habrastorage.org/getpro/habr/upload_files/526/e2e/8f4/526e2e8f47156133d3ccbb1e6054522d.jpg" data-blurred="true"/><figcaption></figcaption></figure><h4>Серверная часть - CostsReceiver</h4><p>CostsReceiver представляет из себя Web-сервер на Asp.Net Core запущеный в Docker-контейнере на домашнем сервере. Наружу он опубликован через KeenDNS (сервис для владельцев роутеров Keenetic), который позаботился и о доменном имени и SSL сертификате. </p><p>CostsReceiver парсит прилетающие к нему json-ы и складывает результат в таблицу пакетов для обработки.</p><p>Каждые 3 минуты в отдельном потоке запускается воркер, который пытается обработать все необработанные входящие пакеты. Параметр TypeID подсказывает серверу, как обрабатывать полученный пакет. Если TypeID равен единице, то это QR-код, если 2 – это SMS, если 3 – то это расход, введенный вручную.</p><p>С SMS все просто – текст прогоняется через регулярное выражение. Из него вычленяются название торговой точки, время и сумма покупки. Непрошедшие регулярку сообщения удаляются.</p><p>С QR-кодом все интереснее. После непродолжительного поиска я нашел <a href="https://leftjoin.ru/all/nalog-ru-client/" rel="noopener noreferrer nofollow">статью Николая Валиотти</a> о реализации парсера чеков на Python. Переписать код на C# было несложно.</p><p>Сперва происходит аутентификация и запрос токена. Затем с этим токеном и содержимым QR кода воркер постоянно стучится на сервер ФНС, пока сервер не выдаст ему в ответ содержимое чека в json формате. Как быстро чек появляется на сервере ФНС, судя по всему, зависит от типа кассы. Это может занять от пары минут до пары дней. Из полученного json-а также выдергивается название торговой точки, время покупки и все позиции чека.</p><details class="spoiler"><summary>Возможно, кому-то этот код будет полезен</summary><div class="spoiler__content"><pre><code class="cs">public class CheckRequesterByQR
    {

        private Envelope _envelope = new Envelope();
        public CheckRequesterByQR(Envelope envelope)
        {
            _envelope = envelope;

        }


        public async Task&lt;string> GetCheckByQR()
        {
            string sessionId;
            if (Variables.sessionID == null)
            {
                JObject responseSessId = JObject.Parse(await GetSessionID());
                sessionId = (string)responseSessId["sessionId"];
                Variables.sessionID = sessionId;
            }
            else sessionId = Variables.sessionID;

            try
            {
                JObject responseTicketId = JObject.Parse(await GetTicketID(sessionId, _envelope.Payload));
                var ticketId = (string)responseTicketId["id"];
                if (ticketId != null)
                {
                    JObject responseCheck = JObject.Parse(await GetCheck(sessionId, ticketId));
                    var check = responseCheck.ToString();
                    return check;
                }
                else return null;
            }
            catch (Exception ex)
            {
                if (ex.Message == "HTTP ERROR: Unauthorized" &amp;&amp; Variables.sessionID != null)
                {
                    Variables.sessionID = null;
                    throw new Exception("HTTP ERROR: Unauthorized. Will try to renew session token next time.");
                }
                else
                {
                    throw ex;
                }
                
            }        
           
        }

        private HttpClient GetClient()
        {
            HttpClient client = new HttpClient();
            client.DefaultRequestHeaders.Add("Accept", "application/json");
            client.DefaultRequestHeaders.Add("Host", "irkkt-mobile.nalog.ru:8888");
            client.DefaultRequestHeaders.Add("Accept", "*/*");
            client.DefaultRequestHeaders.Add("Device-OS", "iOS");
            client.DefaultRequestHeaders.Add("Device-Id", "7C82010F-16CC-446B-8F66-FC4080C66521");
            client.DefaultRequestHeaders.Add("clientVersion", "2.9.0");
            client.DefaultRequestHeaders.Add("Accept-Language", "ru-RU;q=1, en-US;q=0.9");
            client.DefaultRequestHeaders.Add("User-Agent", "billchecker/2.9.0 (iPhone; iOS 13.6; Scale/2.00)");
            client.Timeout = TimeSpan.FromSeconds(7);
            return client;
        }

        private async Task&lt;string> GetSessionID()
        {
            HttpClient client = GetClient();

            var env_inn = Environment.GetEnvironmentVariable("INN");
            var env_pass = Environment.GetEnvironmentVariable("PASSWD");

            var payload = new
            {
                inn = env_inn,
                client_secret = "IyvrAbKt9h/8p6a7QPh8gpkXYQ4=",
                password = env_pass
            };

            try
            {
                var response = await client.PostAsync("https://irkkt-mobile.nalog.ru:8888/v2/mobile/users/lkfl/auth",
                new StringContent(
                    JsonConvert.SerializeObject(payload),
                    Encoding.UTF8, "application/json"));

                if (response.IsSuccessStatusCode)
                {
                    return await response.Content.ReadAsStringAsync();
                }
                else
                {
                    throw new Exception("HTTP ERROR: " + response.StatusCode);
                }

            }
            catch (Exception ex) when (ex is TaskCanceledException || ex is OperationCanceledException)
            {
                return null;
            }
        }

        private async Task&lt;string> GetTicketID(string sessionId, string qrcode)
        {
            HttpClient client = GetClient();
            client.DefaultRequestHeaders.Add("sessionId", sessionId);

            var payload = new
            {
                qr = qrcode
            };

            try
            {
                var response = await client.PostAsync("https://irkkt-mobile.nalog.ru:8888/v2/ticket",
                new StringContent(
                    JsonConvert.SerializeObject(payload),
                    Encoding.UTF8, "application/json"));

                if (response.IsSuccessStatusCode)
                {
                    return await response.Content.ReadAsStringAsync();
                }
                else
                {
                    throw new Exception("HTTP ERROR: " + response.StatusCode);
                }

            }
            catch (Exception ex) when (ex is TaskCanceledException || ex is OperationCanceledException)
            {
                return null;
            }

        }

        private async Task&lt;string> GetCheck(string sessionId, string ticket)
        {
            HttpClient client = GetClient();
            client.DefaultRequestHeaders.Add("sessionId", sessionId);

            try
            {
                var response = await client.GetAsync("https://irkkt-mobile.nalog.ru:8888/v2/tickets/" + ticket);

                if (response.IsSuccessStatusCode)
                {
                    return await response.Content.ReadAsStringAsync();
                }
                else
                {
                    throw new Exception("HTTP ERROR: " + response.StatusCode);
                }

            }
            catch (Exception ex) when (ex is TaskCanceledException || ex is OperationCanceledException)
            {
                return null;
            }
        }

    }</code></pre></div></details><p>Результатом работы CostsReceiver являются черновики чеков. Они уже содержат в себе дату чека, место покупки, сумму и, если это был QR-код, то и позиции в чеке. К ним можно получить доступ из основного приложения. Черновик чека - это еще не полноценный чек. Для каждой позиции в черновике нужно указать категорию. Если не удалось определить магазин, его также нужно указать вручную. Но это все равно гораздо быстрее, чем вводить данные с нуля.</p><h4>Нормализация данных</h4><p>Попутно пришлось решить пару проблем по данной части.</p><p>Во-первых - это преобразование названий многочисленных ООО-шек в уже предопределенные названия магазинов. При обработке пакета воркер производит замену названия типа <em>ОБЩЕСТВО С ОГРАНИЧЕННОЙ ОТВЕТСТВЕННОСТЬЮ "АЛЬФА ПЕНЗА"</em> на хорошо известное название <em>"Красное и Белое"</em>.</p><figure class="full-width "><img src="https://habrastorage.org/getpro/habr/upload_files/140/3fb/fea/1403fbfea6f4fd616f46f349cc118d9a.JPG" width="890" height="766"/><figcaption></figcaption></figure><p>Аналогичным путем решается вопрос нормализации названий позиций в чеке. Думаю, каждый не раз задавался вопросом, что такое, например, <em>*KON.Печ-сэн.СУП.КОН.mars.сл288г</em> или <em>*Р.ФР.Бат.КР.тв/как/вз.кар.180г. </em>Когда я расшифровываю эту позицию в чеке, она записывается в базу, и в следующий раз CostsReceiver автоматом заменит белиберду на понятное название и подставит категорию товара.</p><p>Так же CostsReceiver автоматически пытается подобрать соответствующий шаблон для черновика чека на основании заранее предопределенных правил. Если таковой находится, то добавить чек можно нажатием одной кнопки. Правила для шаблона нужно задать самому. </p><figure class="full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/831/5f9/faf/8315f9faf2af87cd2b447fc22aa73065.jpg" alt="Три из пяти расходов можно одобрить нажанием одной кнопки" title="Три из пяти расходов можно одобрить нажанием одной кнопки" width="1269" height="554" data-src="https://habrastorage.org/getpro/habr/upload_files/831/5f9/faf/8315f9faf2af87cd2b447fc22aa73065.jpg" data-blurred="true"/><figcaption>Три из пяти расходов можно одобрить нажанием одной кнопки</figcaption></figure><h4>Домашняя бухгалтерия v2</h4><p>Но все это было бы невозможно без переписывания десктопной версии "Домашней бухгалтерии". К марту руки дошли и до нее.</p><p>В этот раз было решено отказаться от безнадежно устаревшего WinForms и выбрать что-то посовременнее. Выбор пал на WPF. Было очень непривычно формошлепить в xaml, но после пары форм дело пошло быстрее. Еще через месяц активного кодинга большая часть старого кода была переписан с нуля с сохранением логики. </p><p>К написанию второй версии я подошел уже с некоторым багажом знаний и опыта в программировании. Теперь в нем стало немного больше ООП. Появились классы, отражающие сущности из БД, методы доступа к данным были отделены от логики форм. Попутно была реализована интеграция с CostsReceiver и разнообразные мелкие улучшения.</p><p>Снова скриншотики:</p><figure class="full-width "><img src="https://habrastorage.org/getpro/habr/upload_files/39f/f48/d88/39ff48d88e6ad939211d91921d9f0ff2.JPG" alt="Новое главное окно программы" title="Новое главное окно программы" width="1432" height="1103"/><figcaption>Новое главное окно программы</figcaption></figure><figure class="full-width "><img src="https://habrastorage.org/getpro/habr/upload_files/85a/3ac/143/85a3ac143037a46d603cb60e4493e6df.PNG" alt="Ввод нового чека" title="Ввод нового чека" width="1249" height="1000"/><figcaption>Ввод нового чека</figcaption></figure><figure class="full-width "><img src="https://habrastorage.org/getpro/habr/upload_files/1a1/047/b49/1a1047b49b1c166d6e465a464b429a35.JPG" alt="Красивый график текущего баланса" title="Красивый график текущего баланса" width="1432" height="1101"/><figcaption>Красивый график текущего баланса</figcaption></figure><figure class="full-width "><img src="https://habrastorage.org/getpro/habr/upload_files/939/997/794/939997794aea5f40824cbdb40a22be57.JPG" alt="И визуализация распределения расходов по категориям
" title="И визуализация распределения расходов по категориям
" width="1434" height="1100"/><figcaption>И визуализация распределения расходов по категориям
</figcaption></figure><p>В конечном итоге удалось существенно сократить время на занесение расходов. Так же теперь нет и необходимости заносить расходы каждый день из боязни что-то забыть или пропустить. Переписывание кода с нуля открыло дорогу к реализации многих идей по учету доходов и расходов, о которых я раньше только мечтал.</p><p>Из глобальных доработок в планах осталось:</p><ul><li><p><s>добавление мультивалютности</s></p></li><li><p><s>упрощение заполнение чеков в туристических поездках, чтобы не пересчитывать вручную цену каждой позиции на курс</s></p></li><li><p>возможно, прикрутить хранение сканов гарантиек и чеков на разную технику</p></li><li><p><s>допилить учет кредитов/ипотек. Тут пока нет четкого понимания ввиду сложности рассчетов ежемесячных платежей и остатка долга</s></p></li><li><p>в перспективе добавить учет ИИС и активов в валюте (когда они появятся)</p></li></ul><p><em>UPD: так как черновик статьи появился несколько месяцев назад, большая часть планов уже реализованы. В настоящий момент я планирую на какое-то время отойти от активного напиливания новых <s>багов</s> фичей и заняться полировкой существующего функционала.</em></p><h2>Выводы</h2><p>Сложно однозначно ответить на вопрос, как именно нам помогло как-то детальное знание структуры семейных и личных расходов. В экономическом плане скорее всего никак. Больше экономить на основании полученных данных мы конечно же не стали.</p><p>В историческом плане бесспорно будет интересно лет через 10-20 сравнить цены и запилить аналитический пост на тему очередного пробитого дна. Наибольший профит для себя я вижу в новом хобби и каком-никаком опыте программирования, который может пригодится мне в будущем.</p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%84%D0%B8%D0%BD%D0%B0%D0%BD%D1%81%D1%8B%5D" class="tm-tags-list__link">финансы</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%80%D0%B0%D1%81%D1%85%D0%BE%D0%B4%D1%8B%5D" class="tm-tags-list__link">расходы</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D0%B5%D0%BC%D0%B5%D0%B9%D0%BD%D1%8B%D0%B9%20%D0%B1%D1%8E%D0%B4%D0%B6%D0%B5%D1%82%5D" class="tm-tags-list__link">семейный бюджет</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B.net%5D" class="tm-tags-list__link">.net</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bxamarin.android%5D" class="tm-tags-list__link">xamarin.android</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BB%D0%B8%D1%87%D0%BD%D1%8B%D0%B9%20%D0%BE%D0%BF%D1%8B%D1%82%5D" class="tm-tags-list__link">личный опыт</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/android_dev/" class="tm-hubs-list__link">
    Разработка под Android
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/csharp/" class="tm-hubs-list__link">
    C#
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/read/" class="tm-hubs-list__link">
    Читальный зал
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/Xamarin/" class="tm-hubs-list__link">
    Xamarin
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/finance/" class="tm-hubs-list__link">
    Финансы в IT
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 24: ↑23 и ↓1</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 24: ↑23 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+22</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">9K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    53
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/pawellrus/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 22 голоса " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    4
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">22</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/pawellrus/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @pawellrus
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/568174/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 37 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/568174/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/568174/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"568174":{"id":"568174","timePublished":"2021-10-06T19:55:39+00:00","isCorporative":false,"lang":"ru","titleHtml":"Ведение семейных финансов на C# и Xamarin. Личный опыт","leadData":{"textHtml":"\u003Cp\u003EВ данной статье пойдет речь о том, как через тернии костылей и багов я в итоге достиг приличного уровня автоматизации учета семейных финансов. \u003C\u002Fp\u003E\u003Cp\u003E\u003Cem\u003EАвтор сей статьи имеет крайне посредственные скиллы разработки, так что некоторые технические решения могут оскорбить чувства профессиональных программистов на C# и разработчиков приложений для Android.\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003EЗа всеми подробностями прошу под кат.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F430\u002Fbe5\u002F99d\u002F430be599dc4626cea3b3c4982ebd8d85.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F430\u002Fbe5\u002F99d\u002F430be599dc4626cea3b3c4982ebd8d85.jpg","fit":"cover","positionY":11.818181818182,"positionX":32.179487179487}},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"recovery","data":null}],"author":{"scoreStats":{"score":4,"votesCount":22},"rating":22,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"68657","alias":"pawellrus","fullname":null,"avatarUrl":null,"speciality":"Пользователь"},"statistics":{"commentsCount":37,"favoritesCount":53,"readingCount":9025,"score":22,"votesCount":24},"hubs":[{"relatedData":null,"id":"17107","alias":"android_dev","type":"collective","title":"Разработка под Android","titleHtml":"Разработка под Android","isProfiled":true},{"relatedData":null,"id":"17718","alias":"csharp","type":"collective","title":"C#","titleHtml":"C#","isProfiled":true},{"relatedData":null,"id":"20742","alias":"read","type":"collective","title":"Читальный зал","titleHtml":"Читальный зал","isProfiled":false},{"relatedData":null,"id":"21374","alias":"Xamarin","type":"collective","title":"Xamarin","titleHtml":"Xamarin","isProfiled":true},{"relatedData":null,"id":"21928","alias":"finance","type":"collective","title":"Финансы в IT","titleHtml":"Финансы в IT","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Ch2\u003EПредисловие\u003C\u002Fh2\u003E\u003Cp\u003EВ данной статье пойдет речь о том, как через тернии костылей и багов я в итоге достиг приличного уровня автоматизации учета семейных финансов.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cem\u003EДисклеймер: автор статьи имеет посредственные скиллы разработки, так что некоторые технические решения могут оскорбить чувства middle и senior developer-ов.\u003C\u002Fem\u003E \u003C\u002Fp\u003E\u003Cp\u003EК пониманию необходимости учета финансов я пришел в 2016 году, когда съехался со своей будущей женой. Цели учета были вполне банальные: понимать кто и сколько расходует на какие товары, выявить возможности для оптимизации расходов, а так же убедиться, что соотношение семейных расходов соразмерно соотношению размеров зарплат членов семьи. (Спойлер: разумеется, сэкономить в итоге ни на чем не получилось)\u003C\u002Fp\u003E\u003Cp\u003EМногие советуют заводить отдельную карту для семейных покупок и перечислять на нее средства каждый месяц, но нам этот вариант не понравился. Проще контролировать расходы постфактум, а не пытаться их спрогнозировать. \u003C\u002Fp\u003E\u003Cp\u003EЯ считаю такой подход более разумным. Разумеется, мы не делим расходы абсолютно в каждом чеке из продуктового. В основном, дележке подвергаются крупные чеки из гипермаркетов на тысячи рублей. Также мы совместо финансируем коммунальные платежи, аренду и другие крупные жилищно-инфраструктурные проекты.\u003C\u002Fp\u003E\u003Ch2\u003EВерсия 0\u003C\u002Fh2\u003E\u003Cp\u003EКак правило, первые попытки ведения семейного бюджета люди начинают в Excel или иных аналогах, типа Google Sheets. И мы не стали исключением. \u003C\u002Fp\u003E\u003Cp\u003EСхема была такой. Кто-то из нас двоих в оплачивал в магазине большой чек. Далее содержимое чека вносилось в экселевский файлик, а затем суммировались ячейки с товарами, купленными на семейные нужды. Так мы понимали, кто кому сколько должен перевести денег. \u003C\u002Fp\u003E\u003Cp\u003EТакой метод оказался весьма неудобен в эксплуатации, и вскоре я начал поиск более подходящей альтернативы.\u003C\u002Fp\u003E\u003Ch2\u003EВерсия 1\u003C\u002Fh2\u003E\u003Cp\u003EНо поиск быстро зашел в тупик. Бесплатные варианты не умели делить один чек между несколькими пользователями. Да даже многопользовательский режим был далеко не везде. Платные же программы помимо факта своей платности зачастую предлагали поделиться данными о своих расходах с разработчиками. Ни платить ни делиться данными мне не хотелось.\u003C\u002Fp\u003E\u003Cp\u003EПоэтому четко вырисовывался вариант - писать программу самому. Еще одним аргументом в пользу разработки было личное желание поизобретать велосипед и попробовать себя в качестве программиста. Я даже вынашивал идею улучшить свои жизненные условия через смену специализации с Windows-эникея на программиста. \u003C\u002Fp\u003E\u003Cp\u003EТак как на заочном отделении в моем ВУЗе меня обучили только шлепать формы на C#, выбор стека для собственного приложения был очевиден. В качестве СУБД был выбран MSSQL Express, который хостился на домашнем сервере. Примерно за месяц был написан MVP, после чего с 1 сентября 2016 года процесс учета расходов был перенесен в свеженаписанную программу. \u003C\u002Fp\u003E\u003Cp\u003EПараллельно с использованием программы шла ее постоянная доработка. Функционал постоянно дописывался и перекраивался. Неудачные решения выпиливались, и на их месте появлялись новые, которые в будущем могла постичь та же участь. Появлялись новые сущности, корректировался их набор параметров и логика работы, дорабатывался интерфейс. В конечном итоге был выработан наиболее удачный вариант логики приложения:\u003C\u002Fp\u003E\u003Cblockquote\u003E\u003Cp\u003E\u003Cem\u003EОсновная сущность в программе - чек, который содержит позиции. У чека есть дата и место совершения покупки.\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cem\u003EУ каждой позиции в чеке помимо основных параметров (наименование, цена, количество, категория) есть признак «расходы на общие нужды», а также имя пользователя, который эту позицию оплатил. По этим двум важным признакам происходит расчет итоговых сумм чека на каждого члена семьи. \u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cem\u003EЛюбое приходно-расходное действие также генерирует операцию со знаком плюс или минус. Суммируя все операции, получаем текущее количество денег у отельно взятого пользователя.\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cem\u003EПомимо этого существуют вспомогательные справочники магазинов, категорий товаров, географических локаций, и.т.д.\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003C\u002Fblockquote\u003E\u003Cp\u003EВокруг основного функционала и данных я начал реализовывать разные полезные фичи, такие как например:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EОтчетность. Были реализованы различные отчеты, как например статистика трат по категориям товаров или статистика трат в разрезе магазинов.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EОтслеживание текущего баланса. Всегда хотел видеть количество денег, как у игрового персонажа :)\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EШаблоны чеков. Ввод однотипных расходов, как например такси, кофе, проезд в метро, был значительно упрощен таким путем. При выборе шаблона автоматически подставлялись все данные из соответствующего старого чека. Оставалось только поменять сумму и сохранить новый чек.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EВ какой-то момент появилось и устоявшееся название, которое сохранилось и по сей день – Домашняя бухгалтерия.\u003C\u002Fp\u003E\u003Cp\u003EНемного скриншотов того, как выглядела первая версия Домашней бухгалтерии на излете жизни.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7d4\u002F4d6\u002Fa26\u002F7d44d6a26d53e30559aeede30e39c032.JPG\" alt=\"Главное окно программы\" title=\"Главное окно программы\" width=\"1156\" height=\"892\"\u002F\u003E\u003Cfigcaption\u003EГлавное окно программы\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffbd\u002F66e\u002Fe2d\u002Ffbd66ee2d2b8ff0b6948ec577499a680.JPG\" alt=\"Форма добавления чеков\" title=\"Форма добавления чеков\" width=\"1100\" height=\"870\"\u002F\u003E\u003Cfigcaption\u003EФорма добавления чеков\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"bordered full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa7e\u002Fe32\u002F9b2\u002Fa7ee329b2a031c06544240b4ee9c883e.JPG\" alt=\"Отчет по структуре расходов\" title=\"Отчет по структуре расходов\" width=\"1151\" height=\"886\"\u002F\u003E\u003Cfigcaption\u003EОтчет по структуре расходов\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПосле этого дальнейшее развитие программы сильно замедлилось. 2019-2020 годы прошли без каких-либо значимых изменений. Лишь изредка приходилось править баги. Все новые идеи откладывались в долгий ящик, мотивации кодить не было, и скоро поясню почему.\u003C\u002Fp\u003E\u003Ch4\u003EНебольшое лирическое отступление\u003C\u002Fh4\u003E\u003Cp\u003EЗа 4 года нам с женой уже порядком поднадоело вносить портянки магазинных чеков вручную. Технологии шагнули далеко вперед, и концепция ручного ввода безнадежно устарела.\u003C\u002Fp\u003E\u003Cp\u003EВиделось два очевидных вектора автоматизации учета:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eпарсинг SMS уведомлений о списаниях с банковской карты\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eполучение содержимого чека по QR-коду.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EНо такие глобальные доработки упирались в один очень неприятный факт:\u003C\u002Fp\u003E\u003Cfigure class=\"bordered full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa29\u002F035\u002F54e\u002Fa2903554ea99d97993e1222b213f7b60.jpg\" width=\"700\" height=\"385\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa29\u002F035\u002F54e\u002Fa2903554ea99d97993e1222b213f7b60.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПрограммирование в гуманитарном ВУЗе, да еще и на заочном отделении преподают весьма посредственно. Поэтому весь код представлял из себя мешанину из if\u002Felse, непонятных переменных и sql-запросов, объединенных с переменными. ООП? MVC? MVVM? Паттерны проектирования? Да хотя бы банально писать комментарии? Не, не слышали. После многократных переделок код стал похож на эдакого Франкенштейна. Надо ли говорить, что ориентироваться в нем было крайне сложно?\u003C\u002Fp\u003E\u003Cp\u003EИ вот под конец бесполезно потраченных новогодних выходных 2021 года я снова взялся за Visual Studio.\u003C\u002Fp\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8b5\u002F64d\u002F9ee\u002F8b564d9ee4d98e0b5317bf061c7c98a4.jpg\" width=\"512\" height=\"512\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8b5\u002F64d\u002F9ee\u002F8b564d9ee4d98e0b5317bf061c7c98a4.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch2\u003EВерсия 2 - текущая\u003C\u002Fh2\u003E\u003Cp\u003EРеализовывать новый функционал, как это сейчас принято, я решил через отдельный микросервис с собственной базой данных. Он должен был быть опубликован в интернет и получать данные от приложения-компаньона на смартфоне.\u003C\u002Fp\u003E\u003Cp\u003EОпыта в мобильной разработке у меня было ровно ноль. Тратить месяцы на изучение Java или Kotlin не хотелось. И поэтому, я опять же пошел по легкому пути – Xamarin. В интернете нашел учебный шаблон приложения с вкладками и принялся его погонять под свои нужды, в процессе активно используя Google и Stackoverflow. Как только стало понятно, что мои планы на мобильное приложение реализуемы, параллельно начал разработку серверной части. Тут опять же был выбран C# и .Net Core. Мы же в 2021 живем как-никак, нужно уметь в кроссплатформенность.\u003C\u002Fp\u003E\u003Cp\u003EГде-то около месяца у меня ушло на то, чтобы создать прототипы приложения и серверной части, которые могли общаться друг с другом. А далее снова начался процесс тестирования на проде и череда новых версий.\u003C\u002Fp\u003E\u003Ch4\u003EМобильное приложение - CostsExporter\u003C\u002Fh4\u003E\u003Cp\u003EМобильное приложение-компаньон умеет делать три вещи:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eсканировать и отправлять на сервер QR-код с чека. \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eпроверять inbox на предмет новых SMS от банка и так же отправлять их на сервер. \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eотправлять на сервер введенный расход в виде сумма:описание.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EДля сканирования QR-кодов с чека я использую библиотеку \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FRedth\u002FZXing.Net.Mobile\" rel=\"noopener noreferrer nofollow\"\u003EZXing.Net.Mobile\u003C\u002Fa\u003E. Примерно в 90% случаев QR-код удается отсканировать. Но если QR-код нечеткий или чек непропечатался\u002Fистерся, то тут все печально. Встроенное приложение камеры, как и официально приложение ФНС России, вполне справляются даже в таких случаях. Специально для этого пришлось добавить вариант с ручным ввводом содержимого QR-кода. Если кто может посоветовать вариант лучше, я был бы очень благодарен.\u003C\u002Fp\u003E\u003Cp\u003EДля чтения SMS в памяти телефона постоянно висит Foreground Service, который дергает метод проверки входящих SMS каждые 3 минуты. После продолжительного штудирования интернетов я сделал вывод, что только таким путем можно обеспечить приемлемую работоспособность этого процесса, ибо своевольный Android может выгружать любые активности, когда ему вздумается.\u003C\u002Fp\u003E\u003Cp\u003EВсе SMS\u002FQR-коды\u002Fручные записи перед отправкой складываются в локальную базу SQLite, где так же хранится дата создания и статус отправки на сервер. При повторном сканировании SMS\u002FQR-кода дубли будут отброшены.\u003C\u002Fp\u003E\u003Cp\u003EВсе сообщения отправляются в json-формате. JSON выглядит примерно так:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E{\n  \"TypeId\": \"2\",\n  \"Payload\": \"02.03.2021 9:54:33;Raiffeisen;Karta *****. Pokupka 137.00 RUB. CITYMOBIL.. Balans 4842.16 RUB. 02.03.2021\"0Э\n  \"User\": \"Pavel\",\n  \"Secret\": \"SomeSecret\"\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДалее немного скринов приложения:\u003C\u002Fp\u003E\u003Cfigure class=\"bordered full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F359\u002Fd70\u002F945\u002F359d70945dfaebf343dea76926edd996.jpg\" alt=\"\" title=\"\" width=\"2880\" height=\"3168\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F359\u002Fd70\u002F945\u002F359d70945dfaebf343dea76926edd996.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"bordered full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F526\u002Fe2e\u002F8f4\u002F526e2e8f47156133d3ccbb1e6054522d.jpg\" alt=\"\" title=\"\" width=\"2880\" height=\"3168\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F526\u002Fe2e\u002F8f4\u002F526e2e8f47156133d3ccbb1e6054522d.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch4\u003EСерверная часть - CostsReceiver\u003C\u002Fh4\u003E\u003Cp\u003ECostsReceiver представляет из себя Web-сервер на Asp.Net Core запущеный в Docker-контейнере на домашнем сервере. Наружу он опубликован через KeenDNS (сервис для владельцев роутеров Keenetic), который позаботился и о доменном имени и SSL сертификате. \u003C\u002Fp\u003E\u003Cp\u003ECostsReceiver парсит прилетающие к нему json-ы и складывает результат в таблицу пакетов для обработки.\u003C\u002Fp\u003E\u003Cp\u003EКаждые 3 минуты в отдельном потоке запускается воркер, который пытается обработать все необработанные входящие пакеты. Параметр TypeID подсказывает серверу, как обрабатывать полученный пакет. Если TypeID равен единице, то это QR-код, если 2 – это SMS, если 3 – то это расход, введенный вручную.\u003C\u002Fp\u003E\u003Cp\u003EС SMS все просто – текст прогоняется через регулярное выражение. Из него вычленяются название торговой точки, время и сумма покупки. Непрошедшие регулярку сообщения удаляются.\u003C\u002Fp\u003E\u003Cp\u003EС QR-кодом все интереснее. После непродолжительного поиска я нашел \u003Ca href=\"https:\u002F\u002Fleftjoin.ru\u002Fall\u002Fnalog-ru-client\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eстатью Николая Валиотти\u003C\u002Fa\u003E о реализации парсера чеков на Python. Переписать код на C# было несложно.\u003C\u002Fp\u003E\u003Cp\u003EСперва происходит аутентификация и запрос токена. Затем с этим токеном и содержимым QR кода воркер постоянно стучится на сервер ФНС, пока сервер не выдаст ему в ответ содержимое чека в json формате. Как быстро чек появляется на сервере ФНС, судя по всему, зависит от типа кассы. Это может занять от пары минут до пары дней. Из полученного json-а также выдергивается название торговой точки, время покупки и все позиции чека.\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EВозможно, кому-то этот код будет полезен\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Epublic class CheckRequesterByQR\n    {\n\n        private Envelope _envelope = new Envelope();\n        public CheckRequesterByQR(Envelope envelope)\n        {\n            _envelope = envelope;\n\n        }\n\n\n        public async Task&lt;string\u003E GetCheckByQR()\n        {\n            string sessionId;\n            if (Variables.sessionID == null)\n            {\n                JObject responseSessId = JObject.Parse(await GetSessionID());\n                sessionId = (string)responseSessId[\"sessionId\"];\n                Variables.sessionID = sessionId;\n            }\n            else sessionId = Variables.sessionID;\n\n            try\n            {\n                JObject responseTicketId = JObject.Parse(await GetTicketID(sessionId, _envelope.Payload));\n                var ticketId = (string)responseTicketId[\"id\"];\n                if (ticketId != null)\n                {\n                    JObject responseCheck = JObject.Parse(await GetCheck(sessionId, ticketId));\n                    var check = responseCheck.ToString();\n                    return check;\n                }\n                else return null;\n            }\n            catch (Exception ex)\n            {\n                if (ex.Message == \"HTTP ERROR: Unauthorized\" &amp;&amp; Variables.sessionID != null)\n                {\n                    Variables.sessionID = null;\n                    throw new Exception(\"HTTP ERROR: Unauthorized. Will try to renew session token next time.\");\n                }\n                else\n                {\n                    throw ex;\n                }\n                \n            }        \n           \n        }\n\n        private HttpClient GetClient()\n        {\n            HttpClient client = new HttpClient();\n            client.DefaultRequestHeaders.Add(\"Accept\", \"application\u002Fjson\");\n            client.DefaultRequestHeaders.Add(\"Host\", \"irkkt-mobile.nalog.ru:8888\");\n            client.DefaultRequestHeaders.Add(\"Accept\", \"*\u002F*\");\n            client.DefaultRequestHeaders.Add(\"Device-OS\", \"iOS\");\n            client.DefaultRequestHeaders.Add(\"Device-Id\", \"7C82010F-16CC-446B-8F66-FC4080C66521\");\n            client.DefaultRequestHeaders.Add(\"clientVersion\", \"2.9.0\");\n            client.DefaultRequestHeaders.Add(\"Accept-Language\", \"ru-RU;q=1, en-US;q=0.9\");\n            client.DefaultRequestHeaders.Add(\"User-Agent\", \"billchecker\u002F2.9.0 (iPhone; iOS 13.6; Scale\u002F2.00)\");\n            client.Timeout = TimeSpan.FromSeconds(7);\n            return client;\n        }\n\n        private async Task&lt;string\u003E GetSessionID()\n        {\n            HttpClient client = GetClient();\n\n            var env_inn = Environment.GetEnvironmentVariable(\"INN\");\n            var env_pass = Environment.GetEnvironmentVariable(\"PASSWD\");\n\n            var payload = new\n            {\n                inn = env_inn,\n                client_secret = \"IyvrAbKt9h\u002F8p6a7QPh8gpkXYQ4=\",\n                password = env_pass\n            };\n\n            try\n            {\n                var response = await client.PostAsync(\"https:\u002F\u002Firkkt-mobile.nalog.ru:8888\u002Fv2\u002Fmobile\u002Fusers\u002Flkfl\u002Fauth\",\n                new StringContent(\n                    JsonConvert.SerializeObject(payload),\n                    Encoding.UTF8, \"application\u002Fjson\"));\n\n                if (response.IsSuccessStatusCode)\n                {\n                    return await response.Content.ReadAsStringAsync();\n                }\n                else\n                {\n                    throw new Exception(\"HTTP ERROR: \" + response.StatusCode);\n                }\n\n            }\n            catch (Exception ex) when (ex is TaskCanceledException || ex is OperationCanceledException)\n            {\n                return null;\n            }\n        }\n\n        private async Task&lt;string\u003E GetTicketID(string sessionId, string qrcode)\n        {\n            HttpClient client = GetClient();\n            client.DefaultRequestHeaders.Add(\"sessionId\", sessionId);\n\n            var payload = new\n            {\n                qr = qrcode\n            };\n\n            try\n            {\n                var response = await client.PostAsync(\"https:\u002F\u002Firkkt-mobile.nalog.ru:8888\u002Fv2\u002Fticket\",\n                new StringContent(\n                    JsonConvert.SerializeObject(payload),\n                    Encoding.UTF8, \"application\u002Fjson\"));\n\n                if (response.IsSuccessStatusCode)\n                {\n                    return await response.Content.ReadAsStringAsync();\n                }\n                else\n                {\n                    throw new Exception(\"HTTP ERROR: \" + response.StatusCode);\n                }\n\n            }\n            catch (Exception ex) when (ex is TaskCanceledException || ex is OperationCanceledException)\n            {\n                return null;\n            }\n\n        }\n\n        private async Task&lt;string\u003E GetCheck(string sessionId, string ticket)\n        {\n            HttpClient client = GetClient();\n            client.DefaultRequestHeaders.Add(\"sessionId\", sessionId);\n\n            try\n            {\n                var response = await client.GetAsync(\"https:\u002F\u002Firkkt-mobile.nalog.ru:8888\u002Fv2\u002Ftickets\u002F\" + ticket);\n\n                if (response.IsSuccessStatusCode)\n                {\n                    return await response.Content.ReadAsStringAsync();\n                }\n                else\n                {\n                    throw new Exception(\"HTTP ERROR: \" + response.StatusCode);\n                }\n\n            }\n            catch (Exception ex) when (ex is TaskCanceledException || ex is OperationCanceledException)\n            {\n                return null;\n            }\n        }\n\n    }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Cp\u003EРезультатом работы CostsReceiver являются черновики чеков. Они уже содержат в себе дату чека, место покупки, сумму и, если это был QR-код, то и позиции в чеке. К ним можно получить доступ из основного приложения. Черновик чека - это еще не полноценный чек. Для каждой позиции в черновике нужно указать категорию. Если не удалось определить магазин, его также нужно указать вручную. Но это все равно гораздо быстрее, чем вводить данные с нуля.\u003C\u002Fp\u003E\u003Ch4\u003EНормализация данных\u003C\u002Fh4\u003E\u003Cp\u003EПопутно пришлось решить пару проблем по данной части.\u003C\u002Fp\u003E\u003Cp\u003EВо-первых - это преобразование названий многочисленных ООО-шек в уже предопределенные названия магазинов. При обработке пакета воркер производит замену названия типа \u003Cem\u003EОБЩЕСТВО С ОГРАНИЧЕННОЙ ОТВЕТСТВЕННОСТЬЮ \"АЛЬФА ПЕНЗА\"\u003C\u002Fem\u003E на хорошо известное название \u003Cem\u003E\"Красное и Белое\"\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F140\u002F3fb\u002Ffea\u002F1403fbfea6f4fd616f46f349cc118d9a.JPG\" width=\"890\" height=\"766\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EАналогичным путем решается вопрос нормализации названий позиций в чеке. Думаю, каждый не раз задавался вопросом, что такое, например, \u003Cem\u003E*KON.Печ-сэн.СУП.КОН.mars.сл288г\u003C\u002Fem\u003E или \u003Cem\u003E*Р.ФР.Бат.КР.тв\u002Fкак\u002Fвз.кар.180г. \u003C\u002Fem\u003EКогда я расшифровываю эту позицию в чеке, она записывается в базу, и в следующий раз CostsReceiver автоматом заменит белиберду на понятное название и подставит категорию товара.\u003C\u002Fp\u003E\u003Cp\u003EТак же CostsReceiver автоматически пытается подобрать соответствующий шаблон для черновика чека на основании заранее предопределенных правил. Если таковой находится, то добавить чек можно нажатием одной кнопки. Правила для шаблона нужно задать самому. \u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F831\u002F5f9\u002Ffaf\u002F8315f9faf2af87cd2b447fc22aa73065.jpg\" alt=\"Три из пяти расходов можно одобрить нажанием одной кнопки\" title=\"Три из пяти расходов можно одобрить нажанием одной кнопки\" width=\"1269\" height=\"554\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F831\u002F5f9\u002Ffaf\u002F8315f9faf2af87cd2b447fc22aa73065.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003EТри из пяти расходов можно одобрить нажанием одной кнопки\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch4\u003EДомашняя бухгалтерия v2\u003C\u002Fh4\u003E\u003Cp\u003EНо все это было бы невозможно без переписывания десктопной версии \"Домашней бухгалтерии\". К марту руки дошли и до нее.\u003C\u002Fp\u003E\u003Cp\u003EВ этот раз было решено отказаться от безнадежно устаревшего WinForms и выбрать что-то посовременнее. Выбор пал на WPF. Было очень непривычно формошлепить в xaml, но после пары форм дело пошло быстрее. Еще через месяц активного кодинга большая часть старого кода была переписан с нуля с сохранением логики. \u003C\u002Fp\u003E\u003Cp\u003EК написанию второй версии я подошел уже с некоторым багажом знаний и опыта в программировании. Теперь в нем стало немного больше ООП. Появились классы, отражающие сущности из БД, методы доступа к данным были отделены от логики форм. Попутно была реализована интеграция с CostsReceiver и разнообразные мелкие улучшения.\u003C\u002Fp\u003E\u003Cp\u003EСнова скриншотики:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F39f\u002Ff48\u002Fd88\u002F39ff48d88e6ad939211d91921d9f0ff2.JPG\" alt=\"Новое главное окно программы\" title=\"Новое главное окно программы\" width=\"1432\" height=\"1103\"\u002F\u003E\u003Cfigcaption\u003EНовое главное окно программы\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F85a\u002F3ac\u002F143\u002F85a3ac143037a46d603cb60e4493e6df.PNG\" alt=\"Ввод нового чека\" title=\"Ввод нового чека\" width=\"1249\" height=\"1000\"\u002F\u003E\u003Cfigcaption\u003EВвод нового чека\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1a1\u002F047\u002Fb49\u002F1a1047b49b1c166d6e465a464b429a35.JPG\" alt=\"Красивый график текущего баланса\" title=\"Красивый график текущего баланса\" width=\"1432\" height=\"1101\"\u002F\u003E\u003Cfigcaption\u003EКрасивый график текущего баланса\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F939\u002F997\u002F794\u002F939997794aea5f40824cbdb40a22be57.JPG\" alt=\"И визуализация распределения расходов по категориям\n\" title=\"И визуализация распределения расходов по категориям\n\" width=\"1434\" height=\"1100\"\u002F\u003E\u003Cfigcaption\u003EИ визуализация распределения расходов по категориям\n\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВ конечном итоге удалось существенно сократить время на занесение расходов. Так же теперь нет и необходимости заносить расходы каждый день из боязни что-то забыть или пропустить. Переписывание кода с нуля открыло дорогу к реализации многих идей по учету доходов и расходов, о которых я раньше только мечтал.\u003C\u002Fp\u003E\u003Cp\u003EИз глобальных доработок в планах осталось:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Cs\u003Eдобавление мультивалютности\u003C\u002Fs\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cs\u003Eупрощение заполнение чеков в туристических поездках, чтобы не пересчитывать вручную цену каждой позиции на курс\u003C\u002Fs\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eвозможно, прикрутить хранение сканов гарантиек и чеков на разную технику\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cs\u003Eдопилить учет кредитов\u002Fипотек. Тут пока нет четкого понимания ввиду сложности рассчетов ежемесячных платежей и остатка долга\u003C\u002Fs\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eв перспективе добавить учет ИИС и активов в валюте (когда они появятся)\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Cem\u003EUPD: так как черновик статьи появился несколько месяцев назад, большая часть планов уже реализованы. В настоящий момент я планирую на какое-то время отойти от активного напиливания новых \u003Cs\u003Eбагов\u003C\u002Fs\u003E фичей и заняться полировкой существующего функционала.\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Ch2\u003EВыводы\u003C\u002Fh2\u003E\u003Cp\u003EСложно однозначно ответить на вопрос, как именно нам помогло как-то детальное знание структуры семейных и личных расходов. В экономическом плане скорее всего никак. Больше экономить на основании полученных данных мы конечно же не стали.\u003C\u002Fp\u003E\u003Cp\u003EВ историческом плане бесспорно будет интересно лет через 10-20 сравнить цены и запилить аналитический пост на тему очередного пробитого дна. Наибольший профит для себя я вижу в новом хобби и каком-никаком опыте программирования, который может пригодится мне в будущем.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"финансы"},{"titleHtml":"расходы"},{"titleHtml":"семейный бюджет"},{"titleHtml":".net"},{"titleHtml":"xamarin.android"},{"titleHtml":"личный опыт"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F430\u002Fbe5\u002F99d\u002F430be599dc4626cea3b3c4982ebd8d85.jpg","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F430\u002Fbe5\u002F99d\u002F430be599dc4626cea3b3c4982ebd8d85.jpg","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F568174\\\u002F\"},\"headline\":\"Ведение семейных финансов на C# и Xamarin. Личный опыт\",\"datePublished\":\"2021-10-06T22:55:39+03:00\",\"dateModified\":\"2021-10-07T10:42:06+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"pawellrus\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"ПредисловиеВ данной статье пойдет речь о том, как через тернии костылей и багов я в итоге достиг приличного уровня автоматизации учета семейных финансов.Дисклейм...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F568174\\\u002F#post-content-body\",\"about\":[\"h_android_dev\",\"h_csharp\",\"h_read\",\"h_Xamarin\",\"h_finance\",\"f_develop\",\"f_management\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F568174\\\u002F3ddb481c44fc325eb1a157a964bfee74\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F7d4\\\u002F4d6\\\u002Fa26\\\u002F7d44d6a26d53e30559aeede30e39c032.JPG\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Ffbd\\\u002F66e\\\u002Fe2d\\\u002Ffbd66ee2d2b8ff0b6948ec577499a680.JPG\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fa7e\\\u002Fe32\\\u002F9b2\\\u002Fa7ee329b2a031c06544240b4ee9c883e.JPG\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fa29\\\u002F035\\\u002F54e\\\u002Fa2903554ea99d97993e1222b213f7b60.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F8b5\\\u002F64d\\\u002F9ee\\\u002F8b564d9ee4d98e0b5317bf061c7c98a4.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F359\\\u002Fd70\\\u002F945\\\u002F359d70945dfaebf343dea76926edd996.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F526\\\u002Fe2e\\\u002F8f4\\\u002F526e2e8f47156133d3ccbb1e6054522d.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F140\\\u002F3fb\\\u002Ffea\\\u002F1403fbfea6f4fd616f46f349cc118d9a.JPG\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F831\\\u002F5f9\\\u002Ffaf\\\u002F8315f9faf2af87cd2b447fc22aa73065.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F39f\\\u002Ff48\\\u002Fd88\\\u002F39ff48d88e6ad939211d91921d9f0ff2.JPG\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F85a\\\u002F3ac\\\u002F143\\\u002F85a3ac143037a46d603cb60e4493e6df.PNG\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F1a1\\\u002F047\\\u002Fb49\\\u002F1a1047b49b1c166d6e465a464b429a35.JPG\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F939\\\u002F997\\\u002F794\\\u002F939997794aea5f40824cbdb40a22be57.JPG\"]}","metaDescription":"ПредисловиеВ данной статье пойдет речь о том, как через тернии костылей и багов я в итоге достиг приличного уровня автоматизации учета семейных финансов.Дисклеймер: автор статьи имеет посредственные...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"android_dev,csharp,read,Xamarin,finance"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
