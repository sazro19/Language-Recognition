<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Миграция со Spring Boot на Quarkus. Магия или безумие? / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/583572\/"},"headline":"Миграция со Spring Boot на Quarkus. Магия или безумие?","datePublished":"2021-10-15T00:03:56+03:00","dateModified":"2021-10-15T23:11:18+03:00","author":{"@type":"Person","name":"Sivchenko_translate"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Quarkus&nbsp;&ndash; это стек&nbsp;Java, приспособленный для работы с OpenJDK HotSpot (или OpenJ9 на zSeries) и GraalVM, собранный из оптимизированных библиотек и стандартов Jav...","url":"https:\/\/habr.com\/ru\/post\/583572\/#post-content-body","about":["h_programming","h_java","h_refactoring","h_api","f_develop"],"image":["https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/38e\/a61\/f0d\/38ea61f0d1616cf20676aaf9a0fb0f78.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/00e\/7ab\/73b\/00e7ab73b892e0381c578dd00a6787c7.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/8c1\/c3f\/c8e\/8c1c3fc8e0fdd41985929d1bedb2634e.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/919\/572\/a0e\/919572a0e5b478fdcf917d0a13dc9882.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Миграция со Spring Boot на Quarkus. Магия или безумие?" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Миграция со Spring Boot на Quarkus. Магия или безумие?" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Миграция со Spring Boot на Quarkus. Магия или безумие?" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Quarkus&amp;nbsp;– это стек&amp;nbsp;Java, приспособленный для работы с OpenJDK HotSpot (или OpenJ9 на zSeries) и GraalVM, собранный из оптимизированных библиотек и стандартов Java. Он хорошо подходит для..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Quarkus&amp;nbsp;– это стек&amp;nbsp;Java, приспособленный для работы с OpenJDK HotSpot (или OpenJ9 на zSeries) и GraalVM, собранный из оптимизированных библиотек и стандартов Java. Он хорошо подходит для..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Quarkus&amp;nbsp;– это стек&amp;nbsp;Java, приспособленный для работы с OpenJDK HotSpot (или OpenJ9 на zSeries) и GraalVM, собранный из оптимизированных библиотек и стандартов Java. Он хорошо подходит для..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Quarkus&amp;nbsp;– это стек&amp;nbsp;Java, приспособленный для работы с OpenJDK HotSpot (или OpenJ9 на zSeries) и GraalVM, собранный из оптимизированных библиотек и стандартов Java. Он хорошо подходит для..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Quarkus&amp;nbsp;– это стек&amp;nbsp;Java, приспособленный для работы с OpenJDK HotSpot (или OpenJ9 на zSeries) и GraalVM, собранный из оптимизированных библиотек и стандартов Java. Он хорошо подходит для..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/583572/64611b23b7cdc8e3d74570d440241271/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/583572/64611b23b7cdc8e3d74570d440241271/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/583572/64611b23b7cdc8e3d74570d440241271/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/583572/64611b23b7cdc8e3d74570d440241271/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/583572/64611b23b7cdc8e3d74570d440241271/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="583572" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-14T21:03:56.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/583572/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/583572/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/583572/64611b23b7cdc8e3d74570d440241271/" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/583572/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/Sivchenko_translate/" title="Sivchenko_translate" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/Sivchenko_translate/" class="tm-user-info__username">
      Sivchenko_translate
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-14T21:03:56.000Z" title="2021-10-15, 00:03">15  октября   в 00:03</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Миграция со Spring Boot на Quarkus. Магия или безумие?</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/programming/" class="tm-article-snippet__hubs-item-link"><span>Программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/java/" class="tm-article-snippet__hubs-item-link"><span>Java</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/refactoring/" class="tm-article-snippet__hubs-item-link"><span>Проектирование и рефакторинг</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/api/" class="tm-article-snippet__hubs-item-link"><span>API</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Перевод
      </span></div><div class="tm-article-snippet__label"><span>
        Tutorial
      </span></div></div> <!----> <!----></div></div> <div class="tm-article-presenter__origin"><a href="https://developers.redhat.com/blog/2021/02/09/spring-boot-on-quarkus-magic-or-madness" target="_blank" class="tm-article-presenter__origin-link">
                Автор оригинала:
                <span>
                  Eric Deandrea
                </span></a></div> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><p><a href="https://quarkus.io/" rel="noopener noreferrer nofollow">Quarkus</a> – это стек <a href="https://developers.redhat.com/topics/enterprise-java" rel="noopener noreferrer nofollow">Java</a>, приспособленный для работы с OpenJDK HotSpot (или OpenJ9 на zSeries) и GraalVM, собранный из оптимизированных библиотек и стандартов Java. Он хорошо подходит для создания сильно масштабируемых приложений, при этом значительно скромнее использует ресурсы CPU и памяти, нежели другие фреймворки Java. Quarkus может работать с традиционными веб-приложениями, бессерверными приложениями и даже с <a href="https://quarkus.io/guides/funqy" rel="noopener noreferrer nofollow">функциями, предоставляемыми как услуга</a>.</p><p>Существует <a href="https://quarkus.io/blog/tag/user-story/" rel="noopener noreferrer nofollow">много документированных случаев</a>, в которых организации переносили свои приложения на Quarkus. В этой статье рассмотрим один из таких миграционных путей: со <a href="https://spring.io/projects/spring-boot" rel="noopener noreferrer nofollow">Spring Boot</a> на Quarkus. Есть в этом своя магия и свое безумие. Магия – это когда миграция осуществляется как по мановению руки, и ни одной строки кода при этом менять не приходится. Безумие – в том, чтобы попытаться осознать, как все это делается.</p><h2>Приложение</h2><p>Приложение – это простая система для управления задачами из разряда “to-do”. Пользователь может вносить в список дела, а затем вычеркивать те, с которыми справится. Эти позиции хранятся в базе данных <a href="https://www.postgresql.org/" rel="noopener noreferrer nofollow">PostgreSQL</a>. Весь исходный код приложения находится <a href="https://github.com/edeandrea/todo-spring-quarkus" rel="noopener noreferrer nofollow">здесь</a>. Есть и версия, где в качестве сборочного инструмента используется не <a href="https://maven.apache.org/" rel="noopener noreferrer nofollow">Maven</a>, а <a href="https://gradle.org/" rel="noopener noreferrer nofollow">Gradle</a>, она находится в ветке <code>gradle</code>.</p><h2>Запуск базы данных</h2><p>Для приложения требуется база данных PostgreSQL, поэтому первым делом воспользуемся Docker или <a href="https://podman.io/" rel="noopener noreferrer nofollow">Podman</a>, чтобы локально запустить инстанс:</p><pre><code>docker run --ulimit memlock=-1:-1 -it --rm=true --memory-swappiness=0 --name tododb -e POSTGRES_USER=todo -e POSTGRES_PASSWORD=todo -e POSTGRES_DB=tododb -p 5432:5432 postgres:13</code></pre><p>Теперь у вас должен работать инстанс PostgreSQL 11.5 на порте 5432. Нужно создать схему <code>tododb</code>, доступную по пользовательскому <code>todo</code>, с паролем <code>todo</code>.</p><h2>Запуск приложения</h2><p>Запустите приложение, введя в командной строке команду<code>./mvnw clean spring-boot:run</code>. Если вы хотите воспользоваться Gradle вместо Maven, то сначала переключитесь на ветку <code>gradle</code> (<code>git checkout gradle</code>) и запустите команду <code>./gradlew clean bootRun</code>.</p><p>Увидите стандартный символ Spring Boot:</p><figure class="full-width "><img src="/img/image-loader.svg" height="240" data-src="https://habrastorage.org/getpro/habr/upload_files/38e/a61/f0d/38ea61f0d1616cf20676aaf9a0fb0f78.png" data-width="759"/><figcaption></figcaption></figure><pre><code>INFO 70823 --- [  restartedMain] i.q.todospringquarkus.TodoApplication    : Started TodoApplication in 4.392 seconds (JVM running for 5.116)</code></pre><p>Обратите внимание, с какой скоростью оно запускается. Мы об этом еще поговорим.</p><p>Убедившись, что приложение работает, перейдите к <a href="http://localhost:8080/" rel="noopener noreferrer nofollow">http://localhost:8080</a> в вашем любимом браузере. Откроется главный экран приложения, как далее на рисунке 1.</p><figure class="full-width "><img src="/img/image-loader.svg" alt="Рисунок 1. Начальный экран приложения" title="Рисунок 1. Начальный экран приложения" height="408" data-src="https://habrastorage.org/getpro/habr/upload_files/00e/7ab/73b/00e7ab73b892e0381c578dd00a6787c7.png" data-width="600"/><figcaption>Рисунок 1. Начальный экран приложения</figcaption></figure><p> Немного поэкспериментируйте с приложением. Введите в текстовое поле новую задачу (todo) и нажмите Enter. Эта задача отобразится в списке, как показано далее, на рисунке 2: </p><figure class="full-width "><img src="/img/image-loader.svg" alt="Добавление новой задачи" title="Добавление новой задачи" height="407" data-src="https://habrastorage.org/getpro/habr/upload_files/8c1/c3f/c8e/8c1c3fc8e0fdd41985929d1bedb2634e.png" data-width="600"/><figcaption>Добавление новой задачи</figcaption></figure><ol><li><p>Щелкните по пустому кругу рядом с задачей,      чтобы завершить ее, либо уберите отметку из круга, чтобы отметить задачу как      незавершенную.</p></li><li><p>Щелкните <strong>X</strong>, чтобы удалить задачу.</p></li><li><p>По ссылке <strong>OpenAPI</strong> внизу страницы открывается спецификация OpenAPI 3.0 для этого приложения.</p></li><li><p>Ссылка <strong>Swagger UI</strong> открывает  встроенный <a href="https://swagger.io/tools/swagger-ui/" rel="noopener noreferrer nofollow">Swagger UI</a>, при помощи которого можно непосредственно выполнять некоторые конечные точки <a href="https://en.wikipedia.org/wiki/Representational_state_transfer" rel="noopener noreferrer nofollow">RESTful</a>.</p></li><li><p>Ссылка <strong>Prometheus Metrics</strong> ведет к конечной точке с метриками <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#production-ready-metrics-export-prometheus" rel="noopener noreferrer nofollow">Prometheus</a>, которую <a href="https://prometheus.io/" rel="noopener noreferrer nofollow">Prometheus</a> будет время от времени подвергать скрапингу.</p></li><li><p>Ссылка   <strong>Health Check</strong> открывает <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html#production-ready-health" rel="noopener noreferrer nofollow">встроенную проверку работоспособности</a>, предоставляемую Spring Boot.</p></li></ol><p>Экспериментируйте далее и посмотрите, как все это работает. Не забудьте вернуться, когда закончите! Когда будете готовы, остановите приложение, нажав на клавиатуре сочетание клавиш <code>CTRL-C</code> .</p><h2>Разберитесь во внутреннем устройстве</h2><p>Перед нами полноценное приложение Spring Boot, использующее следующие возможности:</p><ul><li><p><a href="https://docs.spring.io/spring-framework/docs/current/reference/html/web.html" rel="noopener noreferrer nofollow">Spring MVC</a> для      создания уровня REST:</p><ul><li><p>Откройте <code>src/main/java/io/quarkus/todospringquarkus/TodoController.java</code> – там вы найдете RESTful-контроллер Spring MVC,       предоставляющий различные конечные точки, доступные через       пользовательский интерфейс.</p></li></ul></li><li><p><a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html" rel="noopener noreferrer nofollow">Spring Data JPA</a> для определения, а также для хранения и извлечения реляционных сущностей:</p><ul><li><p>Откройте <code>src/main/java/io/quarkus/todospringquarkus/TodoEntity.java</code> – и найдете там сущность <a href="https://www.oracle.com/java/technologies/persistence-jsp.html" rel="noopener noreferrer nofollow">Java Persistence API (JPA)</a>, представляющую       собой реляционную таблицу для хранения задач.</p></li><li><p>Откройте <code>src/main/java/io/quarkus/todospringquarkus/TodoRepository.java </code>– и найдете       репозиторий <a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories" rel="noopener noreferrer nofollow">Spring Data JPA Repository</a>, предоставляющий для TodoEntity все операции создания, чтения, обновления и удаления.</p></li></ul></li><li><p><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-features.html" rel="noopener noreferrer nofollow">Spring Boot Actuators</a> для предоставления эксплуатационных возможностей, в том числе, проверок работоспособности и сбора метрик.</p></li><li><p><a href="https://springdoc.org/" rel="noopener noreferrer nofollow">SpringDoc OpenAPI 3</a> для генерирования и предоставления информации RESTful      API, а также встроенной конечной точки Swagger UI.</p></li><li><p><a href="https://micrometer.io/docs/registry/prometheus" rel="noopener noreferrer nofollow">Prometheus Micrometer Registry</a> для предоставления метрик Prometheus.</p></li><li><p>Откройте <code>src/main/resources/META-INF/resources</code>, чтобы находить, какие компоненты пользовательского интерфейса были применены  .</p></li></ul><h2>Конфигурация</h2><p>Откройте <code>src/main/resources/application.properties</code> – там находится конфигурация приложения:</p><p><code>spring.jpa.hibernate.ddl-auto=create-drop spring.datasource.url=jdbc:postgresql://localhost:5432/tododb spring.datasource.username=todo spring.datasource.password=todo</code></p><p><code>springdoc.api-docs.path=/openapi springdoc.swagger-ui.path=/swagger-ui</code></p><p><code>management.endpoints.web.exposure.include=prometheus,health</code></p><p>Откройте <code>src/main/resources/import.sql</code>, там содержится SQL для предзаполнения таблицы базы данных первичным набором данных:</p><p><code>INSERT INTO todo(id, title, completed) VALUES (0, 'My first todo', 'true');</code></p><p>Согласитесь, не так много кода для полнофункционального приложения, которое может гораздо больше, чем “Hello World!”</p><h2>Магия</h2><p>Для этой миграции было выбрано одно сложное требование: исходный код приложения нельзя никоим образом модифицировать.</p><p>Волшебство начинается, готовы? Вернитесь в командную строку и выполните команду<code>./.mvnw clean spring-boot:run</code>. Если хотите использовать Gradle вместо Maven, сначала переключитесь на ветку <code>gradle</code>  (<code>git checkout gradle</code>) и запустите команду <code>./.gradlew clean bootRun</code>.</p><p>После этого вы сразу увидите баннер Quarkus и соответствующее стартовое сообщение, а не то, что демонстрировалось в случае со Spring Boot:</p><figure class="full-width "><img src="/img/image-loader.svg" height="137" data-src="https://habrastorage.org/getpro/habr/upload_files/919/572/a0e/919572a0e5b478fdcf917d0a13dc9882.png" data-width="743"/><figcaption></figcaption></figure><p><code>INFO  [io.quarkus] (Quarkus Main Thread) todo-spring-quarkus 0.0.1-SNAPSHOT on JVM (powered by Quarkus 2.0.0.Final) started in 2.748s. Listening on: http://localhost:8080</code></p><p><code>INFO  [io.quarkus] (Quarkus Main Thread) Profile dev activated. Live Coding activated.</code></p><p><code>INFO  [io.quarkus] (Quarkus Main Thread) Installed features: [agroal, cdi, hibernate-orm, hibernate-orm-panache, jdbc-postgresql, kubernetes, micrometer, narayana-jta, resteasy, resteasy-jackson, smallrye-context-propagation, smallrye-health, smallrye-openapi, spring-data-jpa, spring-di, spring-web, swagger-ui]</code></p><p>Подождите, что же случилось? Теперь это уже приложение Quarkus, а никак не Spring Boot? Это же безумие! </p><p>Хотите убедиться? Вернитесь в окно браузера (<a href="http://localhost:8080/" rel="noopener noreferrer nofollow">http://localhost:8080</a> если вы его уже закрыли) и перезагрузите страницу. Увидите тот же самый пользовательский интерфейс, и он будет полностью функционален. Пощелкайте по разным ссылкам внизу страницы. Все они открываются, как и ранее.</p><p>Также обратите внимание, сколько времени потребовалось для запуска. Версия Quarkus запускается практически вполовину быстрее, чем Spring, притом, что база кода одна и та же (4,392 сек. для Spring против 2,748 сек. для Quarkus в приведенных примерах). Вот она – сверхзвуковая субатомная Java!</p><p>Ничто не изменилось, так как же это все произошло? Умелый маг не раскрывает своих секретов!</p><h2>Безумие </h2><p>Все хорошие маги призывают <a href="https://en.wikipedia.org/wiki/Sleight_of_hand" rel="noopener noreferrer nofollow">следить за руками</a>, чтобы отвлечь внимание зрителей в момент совершения фокуса. Некоторые детали в этом посте рассмотрены не были, а невооруженным глазом они не заметны. Вам ничего не показалось подозрительным? Давайте подробнее рассмотрим, как делается этот фокус.</p><h2>Выполнение </h2><p>Присмотритесь ко всем тем командам, которые выполняете в приложении:</p><p>С Maven:</p><p>Spring Boot: <code>./mvnw clean spring-boot:run</code></p><p>Quarkus: <code>./.mvnw clean spring-boot:run</code></p><p>С Gradle:</p><p>Spring Boot: <code>./gradlew clean bootRun</code></p><p>Quarkus: <code>./.gradlew clean bootRun</code></p><p>Заметили разницу? В версии с Quarkus используется свой исполняемый файл (<code>.mvnw</code>/<code>.gradlew</code>). Если открыть эти файлы и как следует их рассмотреть, то понятно, что происходит кое-что любопытное: </p><p><a href="https://github.com/edeandrea/todo-spring-quarkus/blob/main/.mvnw" rel="noopener noreferrer nofollow">.mvnw</a></p><pre><code>#!/bin/sh</code></pre><pre><code>./mvnw clean quarkus:dev -Pquarkus</code></pre><p><a href="https://github.com/edeandrea/todo-spring-quarkus/blob/gradle/.gradlew" rel="noopener noreferrer nofollow">.gradlew</a></p><pre><code>#!/bin/sh</code></pre><pre><code>./gradlew -Pprofile=quarkus $@</code></pre><p>Мы немного пошаманили, чтобы замаскировать те команды, которые фактически используются для запуска приложения.</p><h2>Конфигурация</h2><p>Вы думаете, что Quarkus умеет читать и понимать конфигурацию Spring Boot внутри <code>src/main/resources/application.properties</code>? Ну, нет. Не забывайте, это же магия. Маг никогда не открывает всей правды. В вышеприведенном примере не была показана Quarkus-специфичная конфигурация. Она спрятана ниже в том же файле.</p><p>Если снова открыть <code>src/main/resources/application.properties</code> и прокрутить до самого низа (примерно до строки 58), увидите кое-какую дополнительную конфигурацию: </p><p><code>quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/tododb quarkus.datasource.username=todo quarkus.datasource.password=todo quarkus.datasource.metrics.enabled=true quarkus.hibernate-orm.database.generation=drop-and-create quarkus.hibernate-orm.sql-load-script=import.sql</code></p><p><code>quarkus.swagger-ui.always-include=true quarkus.swagger-ui.path=/swagger-ui quarkus.micrometer.export.prometheus.path=/actuator/prometheus quarkus.smallrye-health.root-path=/actuator/health quarkus.smallrye-openapi.path=/openapi</code></p><p>Эта конфигурация похожа на конфигурацию Spring Boot, расположенную вверху файла. Но она, в частности, переопределяет пути для Prometheus и конечные точки, отвечающие за проверку работоспособности, так что эти пути совпадают с путями к конечным точкам актуатора Spring Boot. Именно поэтому ссылки на <strong>Prometheus Metrics</strong> и <strong>Health Check</strong> в самом низу экрана продолжают работать, и для этого не требуется вносить никаких изменений в пользовательский интерфейс. </p><p>Весьма хитро, верно?</p><h2>Зависимости</h2><p>Как вы уже представляете, здесь множество зависимостей, которые требуется изменять, добавлять или обновлять. К счастью, Quarkus предоставляет множество расширений для совместимости со Spring:</p><ul><li><p><a href="https://quarkus.io/guides/spring-di" rel="noopener noreferrer nofollow">Расширение Quarkus для внедрения зависимостей в Spring</a> </p></li><li><p><a href="https://quarkus.io/guides/spring-web" rel="noopener noreferrer nofollow">Расширение Quarkus для Spring Web</a></p></li><li><p><a href="https://quarkus.io/guides/spring-data-jpa" rel="noopener noreferrer nofollow">Расширение Quarkus для Spring Data JPA</a></p></li><li><p><a href="https://quarkus.io/guides/spring-boot-properties" rel="noopener noreferrer nofollow">Расширение Quarkus для Spring Boot Properties</a></p></li></ul><p>Если просто заменить некоторые зависимости Spring Boot на соответствующие зависимости Quarkus, это уже многое даст. Есть и некоторые другие составляющие, в частности, метрики Prometheus, документация OpenAPI, интеграция с Swagger UI и проверки работоспособности, для реализации которых потребуется добавлять и другие зависимости. Опять же, к счастью для нас, в Quarkus предусмотрены и такие возможности:</p><ul><li><p><a href="https://quarkus.io/guides/openapi-swaggerui" rel="noopener noreferrer nofollow">Расширение Quarkus для OpenAPI и Swagger UI</a></p></li><li><p><a href="https://quarkus.io/guides/smallrye-health" rel="noopener noreferrer nofollow">Расширение Quarkus для проверки работоспособности MicroProfile</a></p></li><li><p><a href="https://quarkus.io/guides/micrometer" rel="noopener noreferrer nofollow">Расширение Quarkus для метрик Micrometer</a></p></li></ul><p>Теперь вы, вероятно, думаете: «Но я же вообще никаких изменений не вносил. Я просто выполнил команду Maven или Gradle, и все приложение запустилось именно под Quarkus, а не под Spring Boot. Как такое возможно?»</p><h2>Настройка сборки</h2><p>Вся магия происходит в файле сборки. От того, какой сборочный инструмент вы используете, зависит, какая именно магия произойдет при разрешении зависимостей.</p><h2>Maven</h2><p>В ветке <code>main</code>откройте файл <code>pom.xml</code>. Сразу же увидите, что файл сборки разбит на множество профилей <a href="https://maven.apache.org/guides/introduction/introduction-to-profiles.html" rel="noopener noreferrer nofollow">Maven profiles</a> для <a href="https://github.com/edeandrea/todo-spring-quarkus/blob/main/pom.xml#L26-L99" rel="noopener noreferrer nofollow">spring</a> и<code>quarkus</code>, причем, профиль <code>spring</code> задан по умолчанию. От этих профилей зависит, какие зависимости и плагины сборки будут включаться при запуске либо<code>./mvnw clean spring-boot:run</code> либо <code>./mvnw -Pquarkus clean quarkus:dev</code> (это маскируется при помощи некоторого перенаправления в вышеупомянутом скрипте <code>.mvnw</code>).</p><h2>Gradle </h2><p>С другой стороны, в Gradle нет такой концепции как профиль. Вы заметите в  <code>gradle</code> –ветке проекта несколько файлов <code>.gradle</code>:</p><ul><li><p><a href="https://github.com/edeandrea/todo-spring-quarkus/blob/gradle/build-common.gradle" rel="noopener noreferrer nofollow">build-common.gradle</a></p><ul><li><p>Содержит всю обычную логику сборки для обеих версий приложения,       в том числе, настройки для groupId/version произведенного артефакта, а также       определения репозитория артефакта.</p></li></ul></li><li><p><a href="https://github.com/edeandrea/todo-spring-quarkus/blob/gradle/build-spring.gradle" rel="noopener noreferrer nofollow">build-spring.gradle</a></p><ul><li><p>Содержит всю логику сборки, все плагины и зависимости, специфичные       для Spring-версии приложения.</p></li></ul></li><li><p><a href="https://github.com/edeandrea/todo-spring-quarkus/blob/gradle/build-quarkus.gradle" rel="noopener noreferrer nofollow">build-quarkus.gradle</a></p><ul><li><p>Содержит всю логику сборки, все плагины и зависимости, специфичные       для Quarkus-версии приложения. <code>build-quarkus.gradle</code> даже вводит задачу <code>bootRun </code>из <a href="https://docs.spring.io/spring-boot/docs/current/gradle-plugin/reference/htmlsingle/#running-your-application" rel="noopener noreferrer nofollow">Spring Boot </a>, повторно отображая ее на задачу <code>quarkusDev</code> из плагина <a href="https://quarkus.io/guides/gradle-tooling" rel="noopener noreferrer nofollow">Quarkus Gradle.</a></p></li></ul></li><li><p><a href="https://github.com/edeandrea/todo-spring-quarkus/blob/gradle/settings.gradle" rel="noopener noreferrer nofollow">settings.gradle</a></p><ul><li><p>Вот тут-то и творится магия! Файл <code>settings.gradle</code> ищет свойство проекта <a href="https://docs.gradle.org/current/userguide/build_environment.html#sec:project_properties" rel="noopener noreferrer nofollow">Gradle, </a> которое называется <code>profile</code>:</p><ul><li><p>Если это свойство не найдено,        то по умолчанию принимается значение <code>spring</code>.</p></li><li><p>Затем задается, какой файл сборки проекта будет использоваться в качестве основного, <code>build-spring.gradle</code>, или <code>build-quarkus.gradle</code>.</p></li></ul></li></ul></li></ul><p>В принципе, это очень дельный подход, если вам нужно сымитировать в Gradle возможности профилей Maven.</p><h2>Главный класс приложения</h2><p>В начале этой статьи упоминалось, что мы хотели осуществить миграцию, не изменив ни единой строки кода. В каждом приложении Spring Boot необходим класс “application”, который содержит метод <code>main</code> и аннотирован <code>@SpringBootApplication</code>. В нашем проекте такой класс – это <a href="https://github.com/edeandrea/todo-spring-quarkus/blob/main/src/main/java/io/quarkus/todospringquarkus/TodoApplication.java" rel="noopener noreferrer nofollow">src/main/java/io/quarkus/todospringquarkus/TodoApplication.java</a>.</p><p>Quarkus не требует такого класса, а также нет таких расширений для совместимости Quarkus и Spring, которые позволяли бы разрешать аннотацию <code>@SpringBootApplication</code>, нет и ссылки на класс <code>SpringApplication</code> внутри такого главного класса.</p><p>Итак, что же получается? Мы не внесли в код вообще никаких изменений, но рассмотренные классы будто бы совершенно нормально разрешаются в Quarkus.</p><p>Вы заметите один странный комментарий как в файле <a href="https://github.com/edeandrea/todo-spring-quarkus/blob/main/pom.xml#L16" rel="noopener noreferrer nofollow">pom.xml</a> (для Maven), так и в<a href="https://github.com/edeandrea/todo-spring-quarkus/blob/gradle/build-quarkus.gradle#L23" rel="noopener noreferrer nofollow">build-quarkus.gradle</a> (для Gradle), прямо над объявлением зависимости для <code>org.springframework.boot:spring-boot-autoconfigure</code>:</p><p><em>This dependency is a hack for TodoApplication.java, which isn't required for Quarkus.  Point of demo is to NOT have any code changes.</em></p><p>(Эта зависимость – хак для TodoApplication.java и не требуется для Quarkus. Суть демо в том, чтобы НЕ вносить никаких изменений в код).</p><p>Вот ключевой элемент фокуса. Эта зависимость позволяет как Spring Boot, так и Quarkus разрешать эти классы во время сборки. Эта зависимость объявляется как <a href="https://maven.apache.org/guides/introduction/introduction-to-optional-and-excludes-dependencies.html#optional-dependencies" rel="noopener noreferrer nofollow">optional</a> в Maven и <code>compileOnly</code> в Gradle, то есть, никогда не будет включаться в тот двоичный файл, который получается в результате сборки Quarkus. Она будет включаться в результат сборки Spring Boot, так как от нее также зависят другие зависимости <code>spring-boot-starter-*</code>, поэтому она включается транзитивно.</p><h2>Заключение</h2><p>В этой статье было показано, как взять имеющееся приложение Spring Boot и запустить его под Quarkus, не внося в код ровно никаких изменений. Это была магия или безумие? Или и того, и другого понемножку? Решайте сами.</p><p>Здесь было показано, как можно осуществить миграцию приложения со Spring Boot на Quarkus (причем, это приложение умеет больше, чем вывести “Hello World”) при жестком требовании не менять ни строки исходного кода. Это далеко не единственный возможный путь миграции. Кроме того, возможны случаи, когда приложение использует некую библиотеку или API, для которых нет эквивалента в Quarkus. В таких случаях все-таки может оказаться необходимо изменить код или произвести некоторый рефакторинг. </p><p>Автор горячо благодарит <a href="https://developers.redhat.com/authors/eric-murphy" rel="noopener noreferrer nofollow">Эрика Мерфи</a>. Именно он – автор описанного приложения, и это он придумал такой волшебный фокус.</p><h2>Ссылки </h2><p>Весь исходный код к этой статье находится <a href="http://github.com/edeandrea/todo-spring-quarkus" rel="noopener noreferrer nofollow">здесь</a>. В ветке <code>main</code> содержится версия Maven, а в ветке <code>gradle</code> версия Gradle. Исходный код приложения в обеих ветках одинаков.</p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BJava%5D" class="tm-tags-list__link">Java</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BSpring%20Boot%5D" class="tm-tags-list__link">Spring Boot</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BQuarkus%5D" class="tm-tags-list__link">Quarkus</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BMaven%5D" class="tm-tags-list__link">Maven</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%80%D0%B5%D1%84%D0%B0%D0%BA%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3%5D" class="tm-tags-list__link">рефакторинг</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bgradle%5D" class="tm-tags-list__link">gradle</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/programming/" class="tm-hubs-list__link">
    Программирование
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/java/" class="tm-hubs-list__link">
    Java
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/refactoring/" class="tm-hubs-list__link">
    Проектирование и рефакторинг
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/api/" class="tm-hubs-list__link">
    API
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 10: ↑6 и ↓4</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 10: ↑6 и ↓4" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+2</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">4.2K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    36
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/Sivchenko_translate/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 18 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    16
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">24</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/Sivchenko_translate/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @Sivchenko_translate
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/583572/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 2 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/583572/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/583572/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"583572":{"id":"583572","timePublished":"2021-10-14T21:03:56+00:00","isCorporative":false,"lang":"ru","titleHtml":"Миграция со Spring Boot на Quarkus. Магия или безумие?","leadData":{"textHtml":"\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fquarkus.io\u002F\" rel=\"noopener noreferrer nofollow\"\u003EQuarkus\u003C\u002Fa\u003E&nbsp;– это стек&nbsp;\u003Ca href=\"https:\u002F\u002Fdevelopers.redhat.com\u002Ftopics\u002Fenterprise-java\" rel=\"noopener noreferrer nofollow\"\u003EJava\u003C\u002Fa\u003E, приспособленный для работы с OpenJDK HotSpot (или OpenJ9 на zSeries) и GraalVM, собранный из оптимизированных библиотек и стандартов Java. Он хорошо подходит для создания сильно масштабируемых приложений, при этом значительно скромнее использует ресурсы CPU и памяти, нежели другие фреймворки Java. Quarkus может работать с традиционными веб-приложениями, бессерверными приложениями и даже с&nbsp;\u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fguides\u002Ffunqy\" rel=\"noopener noreferrer nofollow\"\u003Eфункциями, предоставляемыми как услуга\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EСуществует&nbsp;\u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fblog\u002Ftag\u002Fuser-story\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eмного документированных случаев\u003C\u002Fa\u003E, в которых организации переносили свои приложения на Quarkus. В этой статье рассмотрим один из таких миграционных путей: со \u003Ca href=\"https:\u002F\u002Fspring.io\u002Fprojects\u002Fspring-boot\" rel=\"noopener noreferrer nofollow\"\u003ESpring Boot\u003C\u002Fa\u003E&nbsp;на Quarkus. Есть в этом своя магия и свое безумие. Магия – это когда миграция осуществляется как по мановению руки, и ни одной строки кода при этом менять не приходится. Безумие – в том, чтобы попытаться осознать, как все это делается.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Eric Deandrea","originalUrl":"https:\u002F\u002Fdevelopers.redhat.com\u002Fblog\u002F2021\u002F02\u002F09\u002Fspring-boot-on-quarkus-magic-or-madness"}},{"type":"tutorial","data":null}],"author":{"scoreStats":{"score":16,"votesCount":18},"rating":24,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"2793727","alias":"Sivchenko_translate","fullname":null,"avatarUrl":null,"speciality":null},"statistics":{"commentsCount":2,"favoritesCount":36,"readingCount":4168,"score":2,"votesCount":10},"hubs":[{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"375","alias":"java","type":"collective","title":"Java","titleHtml":"Java","isProfiled":true},{"relatedData":null,"id":"7504","alias":"refactoring","type":"collective","title":"Проектирование и рефакторинг","titleHtml":"Проектирование и рефакторинг","isProfiled":true},{"relatedData":null,"id":"17690","alias":"api","type":"collective","title":"API","titleHtml":"API","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fquarkus.io\u002F\" rel=\"noopener noreferrer nofollow\"\u003EQuarkus\u003C\u002Fa\u003E – это стек \u003Ca href=\"https:\u002F\u002Fdevelopers.redhat.com\u002Ftopics\u002Fenterprise-java\" rel=\"noopener noreferrer nofollow\"\u003EJava\u003C\u002Fa\u003E, приспособленный для работы с OpenJDK HotSpot (или OpenJ9 на zSeries) и GraalVM, собранный из оптимизированных библиотек и стандартов Java. Он хорошо подходит для создания сильно масштабируемых приложений, при этом значительно скромнее использует ресурсы CPU и памяти, нежели другие фреймворки Java. Quarkus может работать с традиционными веб-приложениями, бессерверными приложениями и даже с \u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fguides\u002Ffunqy\" rel=\"noopener noreferrer nofollow\"\u003Eфункциями, предоставляемыми как услуга\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EСуществует \u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fblog\u002Ftag\u002Fuser-story\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eмного документированных случаев\u003C\u002Fa\u003E, в которых организации переносили свои приложения на Quarkus. В этой статье рассмотрим один из таких миграционных путей: со \u003Ca href=\"https:\u002F\u002Fspring.io\u002Fprojects\u002Fspring-boot\" rel=\"noopener noreferrer nofollow\"\u003ESpring Boot\u003C\u002Fa\u003E на Quarkus. Есть в этом своя магия и свое безумие. Магия – это когда миграция осуществляется как по мановению руки, и ни одной строки кода при этом менять не приходится. Безумие – в том, чтобы попытаться осознать, как все это делается.\u003C\u002Fp\u003E\u003Ch2\u003EПриложение\u003C\u002Fh2\u003E\u003Cp\u003EПриложение – это простая система для управления задачами из разряда “to-do”. Пользователь может вносить в список дела, а затем вычеркивать те, с которыми справится. Эти позиции хранятся в базе данных \u003Ca href=\"https:\u002F\u002Fwww.postgresql.org\u002F\" rel=\"noopener noreferrer nofollow\"\u003EPostgreSQL\u003C\u002Fa\u003E. Весь исходный код приложения находится \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\" rel=\"noopener noreferrer nofollow\"\u003Eздесь\u003C\u002Fa\u003E. Есть и версия, где в качестве сборочного инструмента используется не \u003Ca href=\"https:\u002F\u002Fmaven.apache.org\u002F\" rel=\"noopener noreferrer nofollow\"\u003EMaven\u003C\u002Fa\u003E, а \u003Ca href=\"https:\u002F\u002Fgradle.org\u002F\" rel=\"noopener noreferrer nofollow\"\u003EGradle\u003C\u002Fa\u003E, она находится в ветке \u003Ccode\u003Egradle\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Ch2\u003EЗапуск базы данных\u003C\u002Fh2\u003E\u003Cp\u003EДля приложения требуется база данных PostgreSQL, поэтому первым делом воспользуемся Docker или \u003Ca href=\"https:\u002F\u002Fpodman.io\u002F\" rel=\"noopener noreferrer nofollow\"\u003EPodman\u003C\u002Fa\u003E, чтобы локально запустить инстанс:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Edocker run --ulimit memlock=-1:-1 -it --rm=true --memory-swappiness=0 --name tododb -e POSTGRES_USER=todo -e POSTGRES_PASSWORD=todo -e POSTGRES_DB=tododb -p 5432:5432 postgres:13\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТеперь у вас должен работать инстанс PostgreSQL 11.5 на порте 5432. Нужно создать схему \u003Ccode\u003Etododb\u003C\u002Fcode\u003E, доступную по пользовательскому \u003Ccode\u003Etodo\u003C\u002Fcode\u003E, с паролем \u003Ccode\u003Etodo\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Ch2\u003EЗапуск приложения\u003C\u002Fh2\u003E\u003Cp\u003EЗапустите приложение, введя в командной строке команду\u003Ccode\u003E.\u002Fmvnw clean spring-boot:run\u003C\u002Fcode\u003E. Если вы хотите воспользоваться Gradle вместо Maven, то сначала переключитесь на ветку \u003Ccode\u003Egradle\u003C\u002Fcode\u003E (\u003Ccode\u003Egit checkout gradle\u003C\u002Fcode\u003E) и запустите команду \u003Ccode\u003E.\u002Fgradlew clean bootRun\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cp\u003EУвидите стандартный символ Spring Boot:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"240\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F38e\u002Fa61\u002Ff0d\u002F38ea61f0d1616cf20676aaf9a0fb0f78.png\" data-width=\"759\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cpre\u003E\u003Ccode\u003EINFO 70823 --- [  restartedMain] i.q.todospringquarkus.TodoApplication    : Started TodoApplication in 4.392 seconds (JVM running for 5.116)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EОбратите внимание, с какой скоростью оно запускается. Мы об этом еще поговорим.\u003C\u002Fp\u003E\u003Cp\u003EУбедившись, что приложение работает, перейдите к \u003Ca href=\"http:\u002F\u002Flocalhost:8080\u002F\" rel=\"noopener noreferrer nofollow\"\u003Ehttp:\u002F\u002Flocalhost:8080\u003C\u002Fa\u003E в вашем любимом браузере. Откроется главный экран приложения, как далее на рисунке 1.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Рисунок 1. Начальный экран приложения\" title=\"Рисунок 1. Начальный экран приложения\" height=\"408\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F00e\u002F7ab\u002F73b\u002F00e7ab73b892e0381c578dd00a6787c7.png\" data-width=\"600\"\u002F\u003E\u003Cfigcaption\u003EРисунок 1. Начальный экран приложения\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E Немного поэкспериментируйте с приложением. Введите в текстовое поле новую задачу (todo) и нажмите Enter. Эта задача отобразится в списке, как показано далее, на рисунке 2: \u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Добавление новой задачи\" title=\"Добавление новой задачи\" height=\"407\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8c1\u002Fc3f\u002Fc8e\u002F8c1c3fc8e0fdd41985929d1bedb2634e.png\" data-width=\"600\"\u002F\u003E\u003Cfigcaption\u003EДобавление новой задачи\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003EЩелкните по пустому кругу рядом с задачей,      чтобы завершить ее, либо уберите отметку из круга, чтобы отметить задачу как      незавершенную.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EЩелкните \u003Cstrong\u003EX\u003C\u002Fstrong\u003E, чтобы удалить задачу.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EПо ссылке \u003Cstrong\u003EOpenAPI\u003C\u002Fstrong\u003E внизу страницы открывается спецификация OpenAPI 3.0 для этого приложения.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСсылка \u003Cstrong\u003ESwagger UI\u003C\u002Fstrong\u003E открывает  встроенный \u003Ca href=\"https:\u002F\u002Fswagger.io\u002Ftools\u002Fswagger-ui\u002F\" rel=\"noopener noreferrer nofollow\"\u003ESwagger UI\u003C\u002Fa\u003E, при помощи которого можно непосредственно выполнять некоторые конечные точки \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FRepresentational_state_transfer\" rel=\"noopener noreferrer nofollow\"\u003ERESTful\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСсылка \u003Cstrong\u003EPrometheus Metrics\u003C\u002Fstrong\u003E ведет к конечной точке с метриками \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-boot\u002Fdocs\u002Fcurrent\u002Freference\u002Fhtml\u002Fproduction-ready-features.html#production-ready-metrics-export-prometheus\" rel=\"noopener noreferrer nofollow\"\u003EPrometheus\u003C\u002Fa\u003E, которую \u003Ca href=\"https:\u002F\u002Fprometheus.io\u002F\" rel=\"noopener noreferrer nofollow\"\u003EPrometheus\u003C\u002Fa\u003E будет время от времени подвергать скрапингу.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСсылка   \u003Cstrong\u003EHealth Check\u003C\u002Fstrong\u003E открывает \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-boot\u002Fdocs\u002Fcurrent\u002Freference\u002Fhtml\u002Fproduction-ready-features.html#production-ready-health\" rel=\"noopener noreferrer nofollow\"\u003Eвстроенную проверку работоспособности\u003C\u002Fa\u003E, предоставляемую Spring Boot.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp\u003EЭкспериментируйте далее и посмотрите, как все это работает. Не забудьте вернуться, когда закончите! Когда будете готовы, остановите приложение, нажав на клавиатуре сочетание клавиш \u003Ccode\u003ECTRL-C\u003C\u002Fcode\u003E .\u003C\u002Fp\u003E\u003Ch2\u003EРазберитесь во внутреннем устройстве\u003C\u002Fh2\u003E\u003Cp\u003EПеред нами полноценное приложение Spring Boot, использующее следующие возможности:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-framework\u002Fdocs\u002Fcurrent\u002Freference\u002Fhtml\u002Fweb.html\" rel=\"noopener noreferrer nofollow\"\u003ESpring MVC\u003C\u002Fa\u003E для      создания уровня REST:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EОткройте \u003Ccode\u003Esrc\u002Fmain\u002Fjava\u002Fio\u002Fquarkus\u002Ftodospringquarkus\u002FTodoController.java\u003C\u002Fcode\u003E – там вы найдете RESTful-контроллер Spring MVC,       предоставляющий различные конечные точки, доступные через       пользовательский интерфейс.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-data\u002Fjpa\u002Fdocs\u002Fcurrent\u002Freference\u002Fhtml\" rel=\"noopener noreferrer nofollow\"\u003ESpring Data JPA\u003C\u002Fa\u003E для определения, а также для хранения и извлечения реляционных сущностей:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EОткройте \u003Ccode\u003Esrc\u002Fmain\u002Fjava\u002Fio\u002Fquarkus\u002Ftodospringquarkus\u002FTodoEntity.java\u003C\u002Fcode\u003E – и найдете там сущность \u003Ca href=\"https:\u002F\u002Fwww.oracle.com\u002Fjava\u002Ftechnologies\u002Fpersistence-jsp.html\" rel=\"noopener noreferrer nofollow\"\u003EJava Persistence API (JPA)\u003C\u002Fa\u003E, представляющую       собой реляционную таблицу для хранения задач.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EОткройте \u003Ccode\u003Esrc\u002Fmain\u002Fjava\u002Fio\u002Fquarkus\u002Ftodospringquarkus\u002FTodoRepository.java \u003C\u002Fcode\u003E– и найдете       репозиторий \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-data\u002Fjpa\u002Fdocs\u002Fcurrent\u002Freference\u002Fhtml\u002F#repositories\" rel=\"noopener noreferrer nofollow\"\u003ESpring Data JPA Repository\u003C\u002Fa\u003E, предоставляющий для TodoEntity все операции создания, чтения, обновления и удаления.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-boot\u002Fdocs\u002Fcurrent\u002Freference\u002Fhtml\u002Fproduction-ready-features.html\" rel=\"noopener noreferrer nofollow\"\u003ESpring Boot Actuators\u003C\u002Fa\u003E для предоставления эксплуатационных возможностей, в том числе, проверок работоспособности и сбора метрик.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fspringdoc.org\u002F\" rel=\"noopener noreferrer nofollow\"\u003ESpringDoc OpenAPI 3\u003C\u002Fa\u003E для генерирования и предоставления информации RESTful      API, а также встроенной конечной точки Swagger UI.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fmicrometer.io\u002Fdocs\u002Fregistry\u002Fprometheus\" rel=\"noopener noreferrer nofollow\"\u003EPrometheus Micrometer Registry\u003C\u002Fa\u003E для предоставления метрик Prometheus.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EОткройте \u003Ccode\u003Esrc\u002Fmain\u002Fresources\u002FMETA-INF\u002Fresources\u003C\u002Fcode\u003E, чтобы находить, какие компоненты пользовательского интерфейса были применены  .\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch2\u003EКонфигурация\u003C\u002Fh2\u003E\u003Cp\u003EОткройте \u003Ccode\u003Esrc\u002Fmain\u002Fresources\u002Fapplication.properties\u003C\u002Fcode\u003E – там находится конфигурация приложения:\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003Espring.jpa.hibernate.ddl-auto=create-drop spring.datasource.url=jdbc:postgresql:\u002F\u002Flocalhost:5432\u002Ftododb spring.datasource.username=todo spring.datasource.password=todo\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003Espringdoc.api-docs.path=\u002Fopenapi springdoc.swagger-ui.path=\u002Fswagger-ui\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003Emanagement.endpoints.web.exposure.include=prometheus,health\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EОткройте \u003Ccode\u003Esrc\u002Fmain\u002Fresources\u002Fimport.sql\u003C\u002Fcode\u003E, там содержится SQL для предзаполнения таблицы базы данных первичным набором данных:\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003EINSERT INTO todo(id, title, completed) VALUES (0, 'My first todo', 'true');\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EСогласитесь, не так много кода для полнофункционального приложения, которое может гораздо больше, чем “Hello World!”\u003C\u002Fp\u003E\u003Ch2\u003EМагия\u003C\u002Fh2\u003E\u003Cp\u003EДля этой миграции было выбрано одно сложное требование: исходный код приложения нельзя никоим образом модифицировать.\u003C\u002Fp\u003E\u003Cp\u003EВолшебство начинается, готовы? Вернитесь в командную строку и выполните команду\u003Ccode\u003E.\u002F.mvnw clean spring-boot:run\u003C\u002Fcode\u003E. Если хотите использовать Gradle вместо Maven, сначала переключитесь на ветку \u003Ccode\u003Egradle\u003C\u002Fcode\u003E  (\u003Ccode\u003Egit checkout gradle\u003C\u002Fcode\u003E) и запустите команду \u003Ccode\u003E.\u002F.gradlew clean bootRun\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cp\u003EПосле этого вы сразу увидите баннер Quarkus и соответствующее стартовое сообщение, а не то, что демонстрировалось в случае со Spring Boot:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"137\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F919\u002F572\u002Fa0e\u002F919572a0e5b478fdcf917d0a13dc9882.png\" data-width=\"743\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Ccode\u003EINFO  [io.quarkus] (Quarkus Main Thread) todo-spring-quarkus 0.0.1-SNAPSHOT on JVM (powered by Quarkus 2.0.0.Final) started in 2.748s. Listening on: http:\u002F\u002Flocalhost:8080\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003EINFO  [io.quarkus] (Quarkus Main Thread) Profile dev activated. Live Coding activated.\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003EINFO  [io.quarkus] (Quarkus Main Thread) Installed features: [agroal, cdi, hibernate-orm, hibernate-orm-panache, jdbc-postgresql, kubernetes, micrometer, narayana-jta, resteasy, resteasy-jackson, smallrye-context-propagation, smallrye-health, smallrye-openapi, spring-data-jpa, spring-di, spring-web, swagger-ui]\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EПодождите, что же случилось? Теперь это уже приложение Quarkus, а никак не Spring Boot? Это же безумие! \u003C\u002Fp\u003E\u003Cp\u003EХотите убедиться? Вернитесь в окно браузера (\u003Ca href=\"http:\u002F\u002Flocalhost:8080\u002F\" rel=\"noopener noreferrer nofollow\"\u003Ehttp:\u002F\u002Flocalhost:8080\u003C\u002Fa\u003E если вы его уже закрыли) и перезагрузите страницу. Увидите тот же самый пользовательский интерфейс, и он будет полностью функционален. Пощелкайте по разным ссылкам внизу страницы. Все они открываются, как и ранее.\u003C\u002Fp\u003E\u003Cp\u003EТакже обратите внимание, сколько времени потребовалось для запуска. Версия Quarkus запускается практически вполовину быстрее, чем Spring, притом, что база кода одна и та же (4,392 сек. для Spring против 2,748 сек. для Quarkus в приведенных примерах). Вот она – сверхзвуковая субатомная Java!\u003C\u002Fp\u003E\u003Cp\u003EНичто не изменилось, так как же это все произошло? Умелый маг не раскрывает своих секретов!\u003C\u002Fp\u003E\u003Ch2\u003EБезумие \u003C\u002Fh2\u003E\u003Cp\u003EВсе хорошие маги призывают \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FSleight_of_hand\" rel=\"noopener noreferrer nofollow\"\u003Eследить за руками\u003C\u002Fa\u003E, чтобы отвлечь внимание зрителей в момент совершения фокуса. Некоторые детали в этом посте рассмотрены не были, а невооруженным глазом они не заметны. Вам ничего не показалось подозрительным? Давайте подробнее рассмотрим, как делается этот фокус.\u003C\u002Fp\u003E\u003Ch2\u003EВыполнение \u003C\u002Fh2\u003E\u003Cp\u003EПрисмотритесь ко всем тем командам, которые выполняете в приложении:\u003C\u002Fp\u003E\u003Cp\u003EС Maven:\u003C\u002Fp\u003E\u003Cp\u003ESpring Boot: \u003Ccode\u003E.\u002Fmvnw clean spring-boot:run\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EQuarkus: \u003Ccode\u003E.\u002F.mvnw clean spring-boot:run\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EС Gradle:\u003C\u002Fp\u003E\u003Cp\u003ESpring Boot: \u003Ccode\u003E.\u002Fgradlew clean bootRun\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EQuarkus: \u003Ccode\u003E.\u002F.gradlew clean bootRun\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EЗаметили разницу? В версии с Quarkus используется свой исполняемый файл (\u003Ccode\u003E.mvnw\u003C\u002Fcode\u003E\u002F\u003Ccode\u003E.gradlew\u003C\u002Fcode\u003E). Если открыть эти файлы и как следует их рассмотреть, то понятно, что происходит кое-что любопытное: \u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\u002Fblob\u002Fmain\u002F.mvnw\" rel=\"noopener noreferrer nofollow\"\u003E.mvnw\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E#!\u002Fbin\u002Fsh\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre\u003E\u003Ccode\u003E.\u002Fmvnw clean quarkus:dev -Pquarkus\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\u002Fblob\u002Fgradle\u002F.gradlew\" rel=\"noopener noreferrer nofollow\"\u003E.gradlew\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E#!\u002Fbin\u002Fsh\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre\u003E\u003Ccode\u003E.\u002Fgradlew -Pprofile=quarkus $@\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EМы немного пошаманили, чтобы замаскировать те команды, которые фактически используются для запуска приложения.\u003C\u002Fp\u003E\u003Ch2\u003EКонфигурация\u003C\u002Fh2\u003E\u003Cp\u003EВы думаете, что Quarkus умеет читать и понимать конфигурацию Spring Boot внутри \u003Ccode\u003Esrc\u002Fmain\u002Fresources\u002Fapplication.properties\u003C\u002Fcode\u003E? Ну, нет. Не забывайте, это же магия. Маг никогда не открывает всей правды. В вышеприведенном примере не была показана Quarkus-специфичная конфигурация. Она спрятана ниже в том же файле.\u003C\u002Fp\u003E\u003Cp\u003EЕсли снова открыть \u003Ccode\u003Esrc\u002Fmain\u002Fresources\u002Fapplication.properties\u003C\u002Fcode\u003E и прокрутить до самого низа (примерно до строки 58), увидите кое-какую дополнительную конфигурацию: \u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003Equarkus.datasource.jdbc.url=jdbc:postgresql:\u002F\u002Flocalhost:5432\u002Ftododb quarkus.datasource.username=todo quarkus.datasource.password=todo quarkus.datasource.metrics.enabled=true quarkus.hibernate-orm.database.generation=drop-and-create quarkus.hibernate-orm.sql-load-script=import.sql\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003Equarkus.swagger-ui.always-include=true quarkus.swagger-ui.path=\u002Fswagger-ui quarkus.micrometer.export.prometheus.path=\u002Factuator\u002Fprometheus quarkus.smallrye-health.root-path=\u002Factuator\u002Fhealth quarkus.smallrye-openapi.path=\u002Fopenapi\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EЭта конфигурация похожа на конфигурацию Spring Boot, расположенную вверху файла. Но она, в частности, переопределяет пути для Prometheus и конечные точки, отвечающие за проверку работоспособности, так что эти пути совпадают с путями к конечным точкам актуатора Spring Boot. Именно поэтому ссылки на \u003Cstrong\u003EPrometheus Metrics\u003C\u002Fstrong\u003E и \u003Cstrong\u003EHealth Check\u003C\u002Fstrong\u003E в самом низу экрана продолжают работать, и для этого не требуется вносить никаких изменений в пользовательский интерфейс. \u003C\u002Fp\u003E\u003Cp\u003EВесьма хитро, верно?\u003C\u002Fp\u003E\u003Ch2\u003EЗависимости\u003C\u002Fh2\u003E\u003Cp\u003EКак вы уже представляете, здесь множество зависимостей, которые требуется изменять, добавлять или обновлять. К счастью, Quarkus предоставляет множество расширений для совместимости со Spring:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fguides\u002Fspring-di\" rel=\"noopener noreferrer nofollow\"\u003EРасширение Quarkus для внедрения зависимостей в Spring\u003C\u002Fa\u003E \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fguides\u002Fspring-web\" rel=\"noopener noreferrer nofollow\"\u003EРасширение Quarkus для Spring Web\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fguides\u002Fspring-data-jpa\" rel=\"noopener noreferrer nofollow\"\u003EРасширение Quarkus для Spring Data JPA\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fguides\u002Fspring-boot-properties\" rel=\"noopener noreferrer nofollow\"\u003EРасширение Quarkus для Spring Boot Properties\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EЕсли просто заменить некоторые зависимости Spring Boot на соответствующие зависимости Quarkus, это уже многое даст. Есть и некоторые другие составляющие, в частности, метрики Prometheus, документация OpenAPI, интеграция с Swagger UI и проверки работоспособности, для реализации которых потребуется добавлять и другие зависимости. Опять же, к счастью для нас, в Quarkus предусмотрены и такие возможности:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fguides\u002Fopenapi-swaggerui\" rel=\"noopener noreferrer nofollow\"\u003EРасширение Quarkus для OpenAPI и Swagger UI\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fguides\u002Fsmallrye-health\" rel=\"noopener noreferrer nofollow\"\u003EРасширение Quarkus для проверки работоспособности MicroProfile\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fguides\u002Fmicrometer\" rel=\"noopener noreferrer nofollow\"\u003EРасширение Quarkus для метрик Micrometer\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EТеперь вы, вероятно, думаете: «Но я же вообще никаких изменений не вносил. Я просто выполнил команду Maven или Gradle, и все приложение запустилось именно под Quarkus, а не под Spring Boot. Как такое возможно?»\u003C\u002Fp\u003E\u003Ch2\u003EНастройка сборки\u003C\u002Fh2\u003E\u003Cp\u003EВся магия происходит в файле сборки. От того, какой сборочный инструмент вы используете, зависит, какая именно магия произойдет при разрешении зависимостей.\u003C\u002Fp\u003E\u003Ch2\u003EMaven\u003C\u002Fh2\u003E\u003Cp\u003EВ ветке \u003Ccode\u003Emain\u003C\u002Fcode\u003Eоткройте файл \u003Ccode\u003Epom.xml\u003C\u002Fcode\u003E. Сразу же увидите, что файл сборки разбит на множество профилей \u003Ca href=\"https:\u002F\u002Fmaven.apache.org\u002Fguides\u002Fintroduction\u002Fintroduction-to-profiles.html\" rel=\"noopener noreferrer nofollow\"\u003EMaven profiles\u003C\u002Fa\u003E для \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\u002Fblob\u002Fmain\u002Fpom.xml#L26-L99\" rel=\"noopener noreferrer nofollow\"\u003Espring\u003C\u002Fa\u003E и\u003Ccode\u003Equarkus\u003C\u002Fcode\u003E, причем, профиль \u003Ccode\u003Espring\u003C\u002Fcode\u003E задан по умолчанию. От этих профилей зависит, какие зависимости и плагины сборки будут включаться при запуске либо\u003Ccode\u003E.\u002Fmvnw clean spring-boot:run\u003C\u002Fcode\u003E либо \u003Ccode\u003E.\u002Fmvnw -Pquarkus clean quarkus:dev\u003C\u002Fcode\u003E (это маскируется при помощи некоторого перенаправления в вышеупомянутом скрипте \u003Ccode\u003E.mvnw\u003C\u002Fcode\u003E).\u003C\u002Fp\u003E\u003Ch2\u003EGradle \u003C\u002Fh2\u003E\u003Cp\u003EС другой стороны, в Gradle нет такой концепции как профиль. Вы заметите в  \u003Ccode\u003Egradle\u003C\u002Fcode\u003E –ветке проекта несколько файлов \u003Ccode\u003E.gradle\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\u002Fblob\u002Fgradle\u002Fbuild-common.gradle\" rel=\"noopener noreferrer nofollow\"\u003Ebuild-common.gradle\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EСодержит всю обычную логику сборки для обеих версий приложения,       в том числе, настройки для groupId\u002Fversion произведенного артефакта, а также       определения репозитория артефакта.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\u002Fblob\u002Fgradle\u002Fbuild-spring.gradle\" rel=\"noopener noreferrer nofollow\"\u003Ebuild-spring.gradle\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EСодержит всю логику сборки, все плагины и зависимости, специфичные       для Spring-версии приложения.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\u002Fblob\u002Fgradle\u002Fbuild-quarkus.gradle\" rel=\"noopener noreferrer nofollow\"\u003Ebuild-quarkus.gradle\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EСодержит всю логику сборки, все плагины и зависимости, специфичные       для Quarkus-версии приложения. \u003Ccode\u003Ebuild-quarkus.gradle\u003C\u002Fcode\u003E даже вводит задачу \u003Ccode\u003EbootRun \u003C\u002Fcode\u003Eиз \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-boot\u002Fdocs\u002Fcurrent\u002Fgradle-plugin\u002Freference\u002Fhtmlsingle\u002F#running-your-application\" rel=\"noopener noreferrer nofollow\"\u003ESpring Boot \u003C\u002Fa\u003E, повторно отображая ее на задачу \u003Ccode\u003EquarkusDev\u003C\u002Fcode\u003E из плагина \u003Ca href=\"https:\u002F\u002Fquarkus.io\u002Fguides\u002Fgradle-tooling\" rel=\"noopener noreferrer nofollow\"\u003EQuarkus Gradle.\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\u002Fblob\u002Fgradle\u002Fsettings.gradle\" rel=\"noopener noreferrer nofollow\"\u003Esettings.gradle\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EВот тут-то и творится магия! Файл \u003Ccode\u003Esettings.gradle\u003C\u002Fcode\u003E ищет свойство проекта \u003Ca href=\"https:\u002F\u002Fdocs.gradle.org\u002Fcurrent\u002Fuserguide\u002Fbuild_environment.html#sec:project_properties\" rel=\"noopener noreferrer nofollow\"\u003EGradle, \u003C\u002Fa\u003E которое называется \u003Ccode\u003Eprofile\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EЕсли это свойство не найдено,        то по умолчанию принимается значение \u003Ccode\u003Espring\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EЗатем задается, какой файл сборки проекта будет использоваться в качестве основного, \u003Ccode\u003Ebuild-spring.gradle\u003C\u002Fcode\u003E, или \u003Ccode\u003Ebuild-quarkus.gradle\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EВ принципе, это очень дельный подход, если вам нужно сымитировать в Gradle возможности профилей Maven.\u003C\u002Fp\u003E\u003Ch2\u003EГлавный класс приложения\u003C\u002Fh2\u003E\u003Cp\u003EВ начале этой статьи упоминалось, что мы хотели осуществить миграцию, не изменив ни единой строки кода. В каждом приложении Spring Boot необходим класс “application”, который содержит метод \u003Ccode\u003Emain\u003C\u002Fcode\u003E и аннотирован \u003Ccode\u003E@SpringBootApplication\u003C\u002Fcode\u003E. В нашем проекте такой класс – это \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\u002Fblob\u002Fmain\u002Fsrc\u002Fmain\u002Fjava\u002Fio\u002Fquarkus\u002Ftodospringquarkus\u002FTodoApplication.java\" rel=\"noopener noreferrer nofollow\"\u003Esrc\u002Fmain\u002Fjava\u002Fio\u002Fquarkus\u002Ftodospringquarkus\u002FTodoApplication.java\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EQuarkus не требует такого класса, а также нет таких расширений для совместимости Quarkus и Spring, которые позволяли бы разрешать аннотацию \u003Ccode\u003E@SpringBootApplication\u003C\u002Fcode\u003E, нет и ссылки на класс \u003Ccode\u003ESpringApplication\u003C\u002Fcode\u003E внутри такого главного класса.\u003C\u002Fp\u003E\u003Cp\u003EИтак, что же получается? Мы не внесли в код вообще никаких изменений, но рассмотренные классы будто бы совершенно нормально разрешаются в Quarkus.\u003C\u002Fp\u003E\u003Cp\u003EВы заметите один странный комментарий как в файле \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\u002Fblob\u002Fmain\u002Fpom.xml#L16\" rel=\"noopener noreferrer nofollow\"\u003Epom.xml\u003C\u002Fa\u003E (для Maven), так и в\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\u002Fblob\u002Fgradle\u002Fbuild-quarkus.gradle#L23\" rel=\"noopener noreferrer nofollow\"\u003Ebuild-quarkus.gradle\u003C\u002Fa\u003E (для Gradle), прямо над объявлением зависимости для \u003Ccode\u003Eorg.springframework.boot:spring-boot-autoconfigure\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cp\u003E\u003Cem\u003EThis dependency is a hack for TodoApplication.java, which isn't required for Quarkus.  Point of demo is to NOT have any code changes.\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cp\u003E(Эта зависимость – хак для TodoApplication.java и не требуется для Quarkus. Суть демо в том, чтобы НЕ вносить никаких изменений в код).\u003C\u002Fp\u003E\u003Cp\u003EВот ключевой элемент фокуса. Эта зависимость позволяет как Spring Boot, так и Quarkus разрешать эти классы во время сборки. Эта зависимость объявляется как \u003Ca href=\"https:\u002F\u002Fmaven.apache.org\u002Fguides\u002Fintroduction\u002Fintroduction-to-optional-and-excludes-dependencies.html#optional-dependencies\" rel=\"noopener noreferrer nofollow\"\u003Eoptional\u003C\u002Fa\u003E в Maven и \u003Ccode\u003EcompileOnly\u003C\u002Fcode\u003E в Gradle, то есть, никогда не будет включаться в тот двоичный файл, который получается в результате сборки Quarkus. Она будет включаться в результат сборки Spring Boot, так как от нее также зависят другие зависимости \u003Ccode\u003Espring-boot-starter-*\u003C\u002Fcode\u003E, поэтому она включается транзитивно.\u003C\u002Fp\u003E\u003Ch2\u003EЗаключение\u003C\u002Fh2\u003E\u003Cp\u003EВ этой статье было показано, как взять имеющееся приложение Spring Boot и запустить его под Quarkus, не внося в код ровно никаких изменений. Это была магия или безумие? Или и того, и другого понемножку? Решайте сами.\u003C\u002Fp\u003E\u003Cp\u003EЗдесь было показано, как можно осуществить миграцию приложения со Spring Boot на Quarkus (причем, это приложение умеет больше, чем вывести “Hello World”) при жестком требовании не менять ни строки исходного кода. Это далеко не единственный возможный путь миграции. Кроме того, возможны случаи, когда приложение использует некую библиотеку или API, для которых нет эквивалента в Quarkus. В таких случаях все-таки может оказаться необходимо изменить код или произвести некоторый рефакторинг. \u003C\u002Fp\u003E\u003Cp\u003EАвтор горячо благодарит \u003Ca href=\"https:\u002F\u002Fdevelopers.redhat.com\u002Fauthors\u002Feric-murphy\" rel=\"noopener noreferrer nofollow\"\u003EЭрика Мерфи\u003C\u002Fa\u003E. Именно он – автор описанного приложения, и это он придумал такой волшебный фокус.\u003C\u002Fp\u003E\u003Ch2\u003EСсылки \u003C\u002Fh2\u003E\u003Cp\u003EВесь исходный код к этой статье находится \u003Ca href=\"http:\u002F\u002Fgithub.com\u002Fedeandrea\u002Ftodo-spring-quarkus\" rel=\"noopener noreferrer nofollow\"\u003Eздесь\u003C\u002Fa\u003E. В ветке \u003Ccode\u003Emain\u003C\u002Fcode\u003E содержится версия Maven, а в ветке \u003Ccode\u003Egradle\u003C\u002Fcode\u003E версия Gradle. Исходный код приложения в обеих ветках одинаков.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"Java"},{"titleHtml":"Spring Boot"},{"titleHtml":"Quarkus"},{"titleHtml":"Maven"},{"titleHtml":"рефакторинг"},{"titleHtml":"gradle"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F583572\u002F64611b23b7cdc8e3d74570d440241271\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F583572\u002F64611b23b7cdc8e3d74570d440241271\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F583572\\\u002F\"},\"headline\":\"Миграция со Spring Boot на Quarkus. Магия или безумие?\",\"datePublished\":\"2021-10-15T00:03:56+03:00\",\"dateModified\":\"2021-10-15T23:11:18+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Sivchenko_translate\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Quarkus&nbsp;&ndash; это стек&nbsp;Java, приспособленный для работы с OpenJDK HotSpot (или OpenJ9 на zSeries) и GraalVM, собранный из оптимизированных библиотек и стандартов Jav...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F583572\\\u002F#post-content-body\",\"about\":[\"h_programming\",\"h_java\",\"h_refactoring\",\"h_api\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F38e\\\u002Fa61\\\u002Ff0d\\\u002F38ea61f0d1616cf20676aaf9a0fb0f78.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F00e\\\u002F7ab\\\u002F73b\\\u002F00e7ab73b892e0381c578dd00a6787c7.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F8c1\\\u002Fc3f\\\u002Fc8e\\\u002F8c1c3fc8e0fdd41985929d1bedb2634e.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F919\\\u002F572\\\u002Fa0e\\\u002F919572a0e5b478fdcf917d0a13dc9882.png\"]}","metaDescription":"Quarkus&nbsp;– это стек&nbsp;Java, приспособленный для работы с OpenJDK HotSpot (или OpenJ9 на zSeries) и GraalVM, собранный из оптимизированных библиотек и стандартов Java. Он хорошо подходит для...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":true}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"programming,java,refactoring,api"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
