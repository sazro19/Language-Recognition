<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Пишем систему рекомендаций музыки на основе ML / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/company\/skillfactory\/blog\/585182\/"},"headline":"Пишем систему рекомендаций музыки на основе ML","datePublished":"2021-10-24T21:09:32+03:00","dateModified":"2021-10-24T21:09:32+03:00","author":{"@type":"Person","name":"honyaki"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"К старту курса по ML и DL рассказываем, как воспользоваться API Spotify, чтобы создать систему рекомендаций музыки под настроение на основе алгоритмов ML. Благод...","url":"https:\/\/habr.com\/ru\/company\/skillfactory\/blog\/585182\/#post-content-body","about":["c_skillfactory","h_python","h_programming","h_api","h_sound","f_develop","f_popsci"],"image":["https:\/\/habr.com\/share\/publication\/585182\/9fd89c7f09b145ab70d941246c2bc401\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/d8b\/c53\/cc5\/d8bc53cc5c6f27a9917110d847ee9bf5.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/f4c\/79e\/e31\/f4c79ee31689718d9ac07a14eb2c0897.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/50f\/a4d\/059\/50fa4d0591002d34540acc6313677c95.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/370\/d57\/497\/370d574971b946d05c4c3a4ab82ed36a.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/6be\/04e\/c35\/6be04ec3565f4405e75ca54afabcdb6a.jpeg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/518\/bbf\/90f\/518bbf90ffa1593341efb098fee01f78.jpeg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/b5c\/dc5\/fd6\/b5cdc5fd6dda4f6f0f3c562950a16f36.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/4cb\/f38\/0fb\/4cbf380fb5af6a7ce549977901b8ca96.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Пишем систему рекомендаций музыки на основе ML" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Пишем систему рекомендаций музыки на основе ML" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Пишем систему рекомендаций музыки на основе ML" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="К старту курса по ML и DL рассказываем, как воспользоваться API Spotify, чтобы создать систему рекомендаций музыки под настроение на основе алгоритмов ML. Благодаря простоте систему легко настроить..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="К старту курса по ML и DL рассказываем, как воспользоваться API Spotify, чтобы создать систему рекомендаций музыки под настроение на основе алгоритмов ML. Благодаря простоте систему легко настроить..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="К старту курса по ML и DL рассказываем, как воспользоваться API Spotify, чтобы создать систему рекомендаций музыки под настроение на основе алгоритмов ML. Благодаря простоте систему легко настроить..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="К старту курса по ML и DL рассказываем, как воспользоваться API Spotify, чтобы создать систему рекомендаций музыки под настроение на основе алгоритмов ML. Благодаря простоте систему легко настроить..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="К старту курса по ML и DL рассказываем, как воспользоваться API Spotify, чтобы создать систему рекомендаций музыки под настроение на основе алгоритмов ML. Благодаря простоте систему легко настроить..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/535/c72/c29/535c72c29c551511b13169b6618f410c.jpg" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/535/c72/c29/535c72c29c551511b13169b6618f410c.jpg" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/535/c72/c29/535c72c29c551511b13169b6618f410c.jpg" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/535/c72/c29/535c72c29c551511b13169b6618f410c.jpg" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/535/c72/c29/535c72c29c551511b13169b6618f410c.jpg" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="585182" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-24T18:09:32.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/585182/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/company/skillfactory/blog/585182/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habrastorage.org/getpro/habr/upload_files/535/c72/c29/535c72c29c551511b13169b6618f410c.jpg" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/585182/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" companyName="skillfactory" data-async-called="true" class="tm-page"><div class="tm-page-width"><div class="tm-page__header"><!----></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"><div class="tm-company-card tm-company-article__company-card"><div class="tm-company-card__info"><div class="tm-company-card__header"><a href="/ru/company/skillfactory/profile/" class="tm-company-card__avatar"><div class="tm-entity-image"><img alt="" height="48" src="//habrastorage.org/getpro/habr/company/9bb/5f7/d50/9bb5f7d50871bf0981f64b1970f22fe1.png" width="48" class="tm-entity-image__pic"></div></a> <!----> <div class="tm-rating tm-company-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">145.99</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div> <div class="tm-company-card__info"><a href="/ru/company/skillfactory/profile/" class="tm-company-card__name">
        SkillFactory
      </a> <div class="tm-company-card__description">Школа Computer Science. Скидка 45% по коду HABR</div></div></div> <div class="tm-company-card__buttons"><!----> <!----></div></div> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/honyaki/" title="honyaki" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/96e/81d/bc0/96e81dbc01247c6c855b1806b355efa3.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/honyaki/" class="tm-user-info__username">
      honyaki
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-24T18:09:32.000Z" title="2021-10-24, 21:09">вчера в 21:09</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Пишем систему рекомендаций музыки на основе ML</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/company/skillfactory/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании SkillFactory</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/python/" class="tm-article-snippet__hubs-item-link"><span>Python</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/programming/" class="tm-article-snippet__hubs-item-link"><span>Программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/api/" class="tm-article-snippet__hubs-item-link"><span>API</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/sound/" class="tm-article-snippet__hubs-item-link"><span>Звук</span> <!----></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Перевод
      </span></div><div class="tm-article-snippet__label"><span>
        Tutorial
      </span></div></div> <!----> <!----></div></div> <div class="tm-article-presenter__origin"><a href="https://towardsdatascience.com/build-your-first-mood-based-music-recommendation-system-in-python-26a427308d96" target="_blank" class="tm-article-presenter__origin-link">
                Автор оригинала:
                <span>
                  Max Hilsdorf
                </span></a></div> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><figure class="full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/d8b/c53/cc5/d8bc53cc5c6f27a9917110d847ee9bf5.jpg" width="780" height="440" data-src="https://habrastorage.org/getpro/habr/upload_files/d8b/c53/cc5/d8bc53cc5c6f27a9917110d847ee9bf5.jpg" data-blurred="true"/><figcaption></figcaption></figure><p>К старту <a href="https://skillfactory.ru/machine-learning-i-deep-learning?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_mldl_241021&amp;utm_term=lead">курса по ML и DL</a> рассказываем, как воспользоваться API Spotify, чтобы создать систему рекомендаций музыки под настроение на основе алгоритмов ML. Благодаря простоте систему легко настроить под ваши нужды: API Spotify возвращает понятные человеку признаки музыкального файла, например тембр. За подробностями приглашаем под кат.</p><hr/><p>Чтобы создать систему музыкальных рекомендаций, нужно абстрагироваться от жанров и — что сложнее — найти количественные методы превращения идей в полезный инструмент рекомендаций. Посмотрим, как это сделать. Методы рекомендаций делятся на две основные ветви.</p><h3>Коллаборативная фильтрация</h3><p>В ней поведение пользователя моделируется, а затем статистически прогнозируется, что понравится конкретному пользователю в конкретной ситуации. В ход идёт сакраментальное «другие пользователи также приобрели...». Учитывается и общая популярность. Так, случайному пользователю Дрейк по статистике понравится больше Slipknot. Особенно, если ему нравятся и другие рэп-исполнители.</p><h3>Фильтрация по содержанию</h3><p>Другой подход — извлечь данные из музыкального файла. Например, метаданные — это дата релиза, жанр или лейбл, под которым вышел трек. Или признаки самого аудио — от очевидных тональности и темпа до весьма абстрактных, математических признаков, например MFCC или измерение тембра. Напишем простую и эффективную систему рекомендаций без какого-либо машинного обучения… по крайней мере с вашей стороны.</p><h3>Плюсы подхода</h3><p>Этот подход принципиально отличается от методов коллаборативной фильтрации («другие пользователи также приобрели...»). Особенно он полезен тем, кто не работает с большой музыкальной платформой и не имеет миллиардов релевантных пользовательских точек данных. Ещё один плюс — быстрая и бесплатная реализация, от сбора данных до алгоритма.</p><h2>Извлекаем данные</h2><p>Извлечь аудиоданные с помощью алгоритмов или моделей машинного обучения поиска музыкальной информации — для новичка это сложно. К счастью, умные люди сделали API, где делятся секретами инновационной технологии.</p><figure class="full-width "><img src="/img/image-loader.svg" alt="Фрагмент документации API Spotify о доступных характеристиках аудио" title="Фрагмент документации API Spotify о доступных характеристиках аудио" height="388" data-src="https://habrastorage.org/getpro/habr/upload_files/f4c/79e/e31/f4c79ee31689718d9ac07a14eb2c0897.png" data-width="630"/><figcaption>Фрагмент документации API Spotify о доступных характеристиках аудио</figcaption></figure><p>API от Spotify бесплатный и имеет несколько характеристик настроения, извлекаемых прямо из внутренних моделей машинного обучения. Но как смоделировать настроение всего четырьмя характеристиками: «Танцевальностью», «Валентностью», «Возбуждением» и «Темпом»? Темп при этом [по мнению автора] едва ли отнесёшь к настроению. На самом деле нужны только две характеристики.</p><h2>Психология: плоскость «валентность — возбуждение»</h2><figure class="full-width "><img src="/img/image-loader.svg" alt="Плоскость «валентность — возбуждение» с расположением эмоций (Russel, 1980)" title="Плоскость «валентность — возбуждение» с расположением эмоций (Russel, 1980)" height="711" data-src="https://habrastorage.org/getpro/habr/upload_files/50f/a4d/059/50fa4d0591002d34540acc6313677c95.png" data-width="864"/><figcaption>Плоскость «валентность — возбуждение» с расположением эмоций (Russel, 1980)</figcaption></figure><p>Плоскость «валентность — возбуждение» — одна из главных психологических моделей факторной структуры эмоций. Модель описывает, сколько существует независимых измерений эмоций. Эмоции сводятся к двум компонентам — возбуждению (активности или вялости) и валентности (позитиву или негативу). </p><p>У этой модели есть проблемы: к примеру, страх и гнев расположены близко, но у неё прекрасный баланс между сложностью и прогностической значимостью, поэтому модель Рассела находит широкое применение. А главное — она сочетается с «валентностью» и «возбуждением» в данных от Spotify. Посмотрим, как получить данные по API и реализуем простую, но эффективную систему рекомендаций.</p><h2>Собираем данные</h2><h3>Авторизация</h3><p>Для доступа к Spotify API регистрируем приложение согласно <a href="https://developer.spotify.com/documentation/general/guides/authorization-guide/">этому </a>руководству или смотрим эту <a href="https://medium.com/@maxtingle/getting-started-with-spotifys-api-spotipy-197c3dc6353b">наглядную</a> статью на Medium. Без авторизации мы не получим данные.</p><h3>Подготовка кода</h3><p>Нам нужна база данных о треках, пакет <a href="https://github.com/felix-hilden/tekore">tekore</a>, Client ID и Secret ID от Spotify для доступа к API. В каталоге проекта пишем скрипт <code>authorization.py</code>:</p><pre><code class="python">import tekore as tk
def authorize():
 CLIENT_ID = "ENTER YOUR CLIENT ID HERE"
 CLIENT_SECRET = "ENTER YOUR CLIENT SECRET HERE"
 app_token = tk.request_client_token(CLIENT_ID, CLIENT_SECRET)
 return tk.Spotify(app_token)</code></pre><p>В коде вводим Client ID и Client Secret ID. Скрипт разрешает доступ к Spotify API и возвращает объект для обращения к API, а ещё служит вспомогательным скриптом. Главное — он гарантирует, что Client ID и Client Secret ID скрыты.</p><h3>Получение набора данных Spotify</h3><p>Командой pip install pandas tqdm устанавливаем нужные пакеты. Копируем и запускаем код ниже и/или следуем краткому обзору кода.</p><pre><code class="python">#################
## PREPARATION ##
#################

# Import modules
import sys
# If your authentification script is not in the project directory
# append its folder to sys.path
sys.path.append("../spotify_api_web_app")
import authorization
import pandas as pd
from tqdm import tqdm
import time

# Authorize and call access object "sp"
sp = authorization.authorize()

# Get all genres
genres = sp.recommendation_genre_seeds()

# Set number of recommendations per genre
n_recs = 100

# Initiate a dictionary with all the information you want to crawl
data_dict = {"id":[], "genre":[], "track_name":[], "artist_name":[],
             "valence":[], "energy":[]}

################
## CRAWL DATA ##
################

# Get recs for every genre
for g in tqdm(genres):
    
    # Get n recommendations
    recs = sp.recommendations(genres = [g], limit = n_recs)
    # json-like string to dict
    recs = eval(recs.json().replace("null", "-999").replace("false", "False").replace("true", "True"))["tracks"]
    
    # Crawl data from each track
    for track in recs:
        # ID and Genre
        data_dict["id"].append(track["id"])
        data_dict["genre"].append(g)
        # Metadata
        track_meta = sp.track(track["id"])
        data_dict["track_name"].append(track_meta.name)
        data_dict["artist_name"].append(track_meta.album.artists[0].name)
        # Valence and energy
        track_features = sp.track_audio_features(track["id"])
        data_dict["valence"].append(track_features.valence)
        data_dict["energy"].append(track_features.energy)
        
        # Wait 0.2 seconds per track so that the api doesnt overheat
        time.sleep(0.2)
        
##################
## PROCESS DATA ##
##################

# Store data in dataframe
df = pd.DataFrame(data_dict)

# Drop duplicates
df.drop_duplicates(subset = "id", keep = "first", inplace = True)
df.to_csv("valence_arousal_dataset.csv", index = False)</code></pre><h3>Как работает код</h3><ol><li><p>Вспомогательный скрипт выполняет авторизацию. </p></li><li><p>С помощью <code>sp.recommendation_genre_seeds()</code> получаем все 120 жанров Spotify. </p></li><li><p>Устанавливаем на максимум число рекомендаций на жанр (100). </p></li><li><p>Задаём словарь для всех данных из API. </p></li><li><p>Проходимся по каждому жанру и треку. </p></li><li><p>Получаем метаданные и аудио информацию и сохраняем в <code>data_dict</code>.</p></li><li><p>Преобразуем словарь во фрейм pandas.</p></li><li><p>После удаления дублей идентификаторов экспортируем её в рабочий каталог.</p></li></ol><p>У нас получился набор данных <code>valence_arousal_dataset.csv</code> для системы рекомендаций.</p><h2>Как использовать валентность и возбуждение для рекомендаций</h2><p>Посмотрите на график ниже: </p><figure class="full-width "><img src="/img/image-loader.svg" alt="Векторы на плоскости «валентность — возбуждение». Расположение приблизительное" title="Векторы на плоскости «валентность — возбуждение». Расположение приблизительное" height="687" data-src="https://habrastorage.org/getpro/habr/upload_files/370/d57/497/370d574971b946d05c4c3a4ab82ed36a.png" data-width="827"/><figcaption>Векторы на плоскости «валентность — возбуждение». Расположение приблизительное</figcaption></figure><p>Каждый вектор с координатами «валентности» и «возбуждения» соединён с другими треками линиями. Мы видим, что эмоциональный профиль Thriller исполнителя Майкла Джексона больше похож на Rosanna.</p><p>Измерим длину векторов, или их «норму». Вот формула: <em>sqrt(a²+b²)</em>. Пример:</p><ol><li><p>Допустим «валентность» трека — 0,5, а его «возбуждение» — 1, то есть он имеет координаты (0,5, 1). </p></li><li><p>Тогда расстояние от начала координат до трека равно <em>sqrt((0,5)² + 1²</em>) = 1,12.</p></li></ol><p>Тогда расстояние от начала координат до трека равно <em>sqrt((0,5)² + 1²</em>) = 1,12.</p><p>Точно так же нужно найти векторы, соединяющие трек со всеми остальными треками: применить формулу и взять вектор с наименьшей длиной.</p><p>Жёлтый вектор из точки <em>p1</em> в точку <em>p2</em> определяется как разность двух векторов: p2 - p1<em>.</em> Поэтому «расстояние настроения» между треками t1 и t2 равно норме (t2 - t1). Иначе говоря, из t2 вычитается t1 и по формуле вычисляется норма результирующего вектора. В коде на Python это реализуется просто:</p><pre><code class="python">def distance(p1, p2):
    distance_x = p2[0] - p1[0]
    distance_y = p2[1] - p1[1]
    distance_vec = [distance_x, distance_y]
    norm = (distance_vec[0]**2 + distance_vec[1]**2)**(1/2)
    return norm</code></pre><p>В своём коде я воспользовался <code>numpy.linalg.norm(p2-p1)</code>, которая делает то же самое.</p><h3>Проблемы</h3><p>Ещё до реализации системы обозначим две статистические проблемы. Если они не важны для вас, пропускайте эту часть или вернитесь к ней позже.</p><figure class="full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/6be/04e/c35/6be04ec3565f4405e75ca54afabcdb6a.jpeg" alt="Распределение признаков «валентность» и «возбуждение»" title="Распределение признаков «валентность» и «возбуждение»" width="2400" height="1200" data-src="https://habrastorage.org/getpro/habr/upload_files/6be/04e/c35/6be04ec3565f4405e75ca54afabcdb6a.jpeg" data-blurred="true"/><figcaption>Распределение признаков «валентность» и «возбуждение»</figcaption></figure><p>У двух наших признаков совершенно разные распределения: у «валентности» оно близко к очень плоскому нормальному распределению, а у «возбуждения» сильно скошено.</p><p>Скачок на 0,2 «валентности» не всегда совпадает со скачком на 0,2 «возбуждения». Для модели это — недостаток. Она предполагает, что вектор (0,5, 0,5) так же близок к (0,7, 0,5), как и к (0,5, 0,7). Чтобы разрешить этот конфликт, применяется <a href="https://medium.com/analytics-vidhya/z-score-in-detail-9dd0f0afa142">z-преобразование</a>, но здесь мы его не рассматриваем.</p><figure class=""><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/518/bbf/90f/518bbf90ffa1593341efb098fee01f78.jpeg" alt="Корреляция «валентности» и «возбуждения», линейная регрессия" title="Корреляция «валентности» и «возбуждения», линейная регрессия" width="450" height="450" data-src="https://habrastorage.org/getpro/habr/upload_files/518/bbf/90f/518bbf90ffa1593341efb098fee01f78.jpeg" data-blurred="true"/><figcaption>Корреляция «валентности» и «возбуждения», линейная регрессия</figcaption></figure><p>Другая проблема показана на рисунке выше. В теории психологии валентность и возбуждение — два статистически независимых измерения эмоций. Но, если нанести все 12 000 треков из набора данных на плоскость «валентность — возбуждение», мы увидим, что при увеличении «валентности» увеличивается и «возбуждение».</p><p>Наклон линии регрессии 0,250 указывает на существенную корреляцию валентности и возбуждения. К сожалению, здесь нет решения: эта ошибка (по крайней мере в нашем случае) заложена в Spotify API.</p><h2>Алгоритм рекомендаций</h2><p>Окончательный вариант алгоритма рекомендаций прост. Пройдём его последние этапы. Весь алгоритм вы найдёте в <a href="https://github.com/MaxHilsdorf/mood-based-music-recommendation-system/blob/main/recommendation_system.ipynb">этом </a>блокноте. </p><p>Импортируем модули:</p><pre><code class="python">import pandas as pd
import random
import authorization # this is the script we created earlier
import numpy as np
from numpy.linalg import norm</code></pre><p>Считываем данные 12 000 треков из фрейма:</p><pre><code class="python">df = pd.read_csv("valence_arousal_dataset.csv")</code></pre><p>Комбинируем столбцы «валентности» и «возбуждения» и создаём для каждого трека единый вектор mood_vec:</p><pre><code class="python">df["mood_vec"] = df[["valence", "energy"]].values.tolist()</code></pre><p>Последний этап перед реализацией алгоритма рекомендаций — авторизация для доступа к API Spotify:</p><pre><code class="python">sp = authorization.authorize()</code></pre><p>Реализуем алгоритм рекомендаций на основе длины вектора:</p><pre><code class="python">def recommend(track_id, ref_df, sp, n_recs = 5):
    
    # Crawl valence and arousal of given track from spotify api
    track_features = sp.track_audio_features(track_id)
    track_moodvec = np.array([track_features.valence, track_features.energy])
    
    # Compute distances to all reference tracks
    ref_df["distances"] = ref_df["mood_vec"].apply(lambda x: norm(track_moodvec-np.array(x)))
    # Sort distances from lowest to highest
    ref_df_sorted = ref_df.sort_values(by = "distances", ascending = True)
    # If the input track is in the reference set, it will have a distance of 0, but should not be recommendet
    ref_df_sorted = ref_df_sorted[ref_df_sorted["id"] != track_id]
    
    # Return n recommendations
    return ref_df_sorted.iloc[:n_recs]</code></pre><h2>Проверим алгоритм</h2><p>Остаётся проверить, даёт ли алгоритм значимые результаты. У каждого трека на Spotify есть идентификатор, который содержится в ссылке на песню:</p><figure class="full-width "><img src="/img/image-loader.svg" height="359" data-src="https://habrastorage.org/getpro/habr/upload_files/b5c/dc5/fd6/b5cdc5fd6dda4f6f0f3c562950a16f36.png" data-width="630"/><figcaption></figcaption></figure><p>Получим ссылку: <a href="https://open.spotify.com/track/3JOVTQ5h8HGFnDdp4VT3MP?si=96f7844315434b0a">https://open.spotify.com/track/<strong>3JOVTQ5h8HGFnDdp4VT3MP</strong>?si=96f7844315434b0a</a>. Идентификатор трека — это выделенная строка <a href="https://open.spotify.com/track/3JOVTQ5h8HGFnDdp4VT3MP?si=96f7844315434b0a">3JOVTQ5h8HGFnDdp4VT3MP</a>.</p><h3>Gary Jules — Mad World</h3><p>Добавим трек Mad World с «валентностью» 0,30 и «возбуждением» 0,06.</p><div class="tm-iframe_temp" data-src="https://embedd.srv.habr.com/iframe/617569ba4615593b75e246c2" data-style="" id="617569ba4615593b75e246c2" width=""></div><pre><code class="python">mad_world = "3JOVTQ5h8HGFnDdp4VT3MP"
recommend(track_id = mad_world, ref_df = df, sp = sp, n_recs = 5)</code></pre><p>Лучшая рекомендация с «валентностью» 0,31 и «возбуждением» 0,05 — это Glory Manger от Harry Belafonte.</p><div class="tm-iframe_temp" data-src="https://embedd.srv.habr.com/iframe/61756c9b4615593b75e246c3" data-style="" id="61756c9b4615593b75e246c3" width=""></div><p>Неплохо! Хотя Glory Manger из совершенно другого жанра, алгоритм подобрал этот трек как имеющий схожие уровни «валентности» и «возбуждения».</p><h3>Rosanna, Toto</h3><p>Попробуем ещё! Rosanna имеет «валентность» 0,739 и «возбуждение» 0,513.</p><div class="tm-iframe_temp" data-src="https://embedd.srv.habr.com/iframe/61756cc5abb378f6450d1a42" data-style="" id="61756cc5abb378f6450d1a42" width=""></div><p>Лучшая рекомендация с «валентностью» 0,740 и «возбуждением» 0,504 — Sentimientos De Chartón от Duelo.</p><div class="tm-iframe_temp" data-src="https://embedd.srv.habr.com/iframe/61756d136ea11f3bbbaf1fe0" data-style="" id="61756d136ea11f3bbbaf1fe0" width=""></div><p>Снова жанр сильно отличается: это скорее латино, чем поп-рок. Но Sentimientos De Cartón передаёт чувство романтической тоски и одновременно ощущение движения, ритма, которые ощущаются и в Rosanna.</p><h2>Заключение</h2><p>Поздравляю! Вы добрались до этого места, а значит — либо создали свою первую систему рекомендаций под настроение, либо хотя бы немного узнали о том, как создать такую систему. Но есть ещё кое-что.</p><h3>Как улучшить систему?</h3><ul><li><p>Чтобы расстояния стали точнее, можно применять z-преобразование для признаков «валентности» и «возбуждения».</p></li><li><p>В Spotify API есть и другие характеристики: «танцевальность», «акустичность», «темп». Подумайте, как развить плоскость «валентность — возбуждение» или разработать собственный набор переменных.</p></li><li><p>Интересно сочетание рекомендаций под настроение и методов коллаборативной фильтрации. После вычисления 10 лучших рекомендаций с «валентностью» и «возбуждением» стоит попробовать изменить порядок рекомендаций по «популярности» — такой признак также есть в API Spotify.</p></li><li><p>Можно дать пользователю возможность указать списки жанров — белый и чёрный.</p></li><li><p>Стоит расширить эталонный набор данных, изучив возможности Spotify API и проанализировав ещё больше треков. Большая база данных повышает вероятность найти почти идеальное соответствие треков.</p></li></ul><p>Если вы хотите не только использовать машинное обучение, но и понять, как оно работает, то вы можете обратить внимание на наши курсы:</p><ul><li><p><a href="https://skillfactory.ru/machine-learning-i-deep-learning?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_mldl_241021&amp;utm_term=conc">Курс «Machine Learning и Deep Learning» (6 месяцев)</a></p></li><li><p><a href="https://skillfactory.ru/data-scientist-pro?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_dspr_241021&amp;utm_term=conc">Профессия Data Scientist (24 месяца)</a></p></li></ul><p>Также вы можете перейти на страницы <a href="https://skillfactory.ru/catalogue?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=sf_allcourses_241021&amp;utm_term=conc">из каталога</a>, чтобы увидеть, как мы готовим специалистов в других направлениях.</p><figure class="full-width "><img src="/img/image-loader.svg" height="200" data-src="https://habrastorage.org/getpro/habr/upload_files/4cb/f38/0fb/4cbf380fb5af6a7ce549977901b8ca96.png" data-width="1000"/><figcaption></figcaption></figure><details class="spoiler"><summary>Профессии и курсы</summary><div class="spoiler__content"><p><strong>Data Science и Machine Learning</strong></p><ul><li><p><a href="https://skillfactory.ru/data-scientist-pro?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_dspr_241021&amp;utm_term=cat">Профессия Data Scientist</a></p></li><li><p><a href="https://skillfactory.ru/data-analyst-pro?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=analytics_dapr_241021&amp;utm_term=cat">Профессия Data Analyst</a></p></li><li><p><a href="https://skillfactory.ru/matematika-dlya-data-science#syllabus?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_mat_241021&amp;utm_term=cat">Курс «Математика для Data Science»</a></p></li><li><p><a href="https://skillfactory.ru/matematika-i-machine-learning-dlya-data-science?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_matml_241021&amp;utm_term=cat">Курс «Математика и Machine Learning для Data Science»</a></p></li><li><p><a href="https://skillfactory.ru/data-engineer?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_dea_241021&amp;utm_term=cat">Курс по Data Engineering</a></p></li><li><p><a href="https://skillfactory.ru/machine-learning-i-deep-learning?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_mldl_241021&amp;utm_term=cat">Курс «Machine Learning и Deep Learning»</a></p></li><li><p><a href="https://skillfactory.ru/machine-learning?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_ml_241021&amp;utm_term=cat">Курс по Machine Learning</a></p></li></ul><p><strong>Python, веб-разработка</strong></p><ul><li><p><a href="https://skillfactory.ru/python-fullstack-web-developer?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_fpw_241021&amp;utm_term=cat">Профессия Fullstack-разработчик на Python</a></p></li><li><p><a href="https://skillfactory.ru/python-for-web-developers?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_pws_241021&amp;utm_term=cat">Курс «Python для веб-разработки»</a></p></li><li><p><a href="https://skillfactory.ru/frontend-razrabotchik?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_fr_241021&amp;utm_term=cat">Профессия Frontend-разработчик</a></p></li><li><p><a href="https://skillfactory.ru/webdev?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_webdev_241021&amp;utm_term=cat">Профессия Веб-разработчик</a></p></li></ul><p><strong>Мобильная разработка</strong></p><ul><li><p><a href="https://skillfactory.ru/ios-razrabotchik-s-nulya?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_ios_241021&amp;utm_term=cat">Профессия iOS-разработчик</a></p></li><li><p><a href="https://skillfactory.ru/android-razrabotchik?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_andr_241021&amp;utm_term=cat">Профессия Android-разработчик</a></p></li></ul><p><strong>Java и C#</strong></p><ul><li><p><a href="https://skillfactory.ru/java-razrabotchik?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_java_241021&amp;utm_term=cat">Профессия Java-разработчик</a></p></li><li><p><a href="https://skillfactory.ru/java-qa-engineer-testirovshik-po?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_qaja_241021&amp;utm_term=cat">Профессия QA-инженер на JAVA</a></p></li><li><p><a href="https://skillfactory.ru/c-sharp-razrabotchik?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_cdev_241021&amp;utm_term=cat">Профессия C#-разработчик</a></p></li><li><p><a href="https://skillfactory.ru/game-razrabotchik-na-unity-i-c-sharp?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_gamedev_241021&amp;utm_term=cat">Профессия Разработчик игр на Unity</a></p></li></ul><p><strong>От основ — в глубину</strong></p><ul><li><p><a href="https://skillfactory.ru/algoritmy-i-struktury-dannyh?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_algo_241021&amp;utm_term=cat">Курс «Алгоритмы и структуры данных»</a></p></li><li><p><a href="https://skillfactory.ru/c-plus-plus-razrabotchik?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_cplus_241021&amp;utm_term=cat">Профессия C++ разработчик</a></p></li><li><p><a href="https://skillfactory.ru/cyber-security-etichnij-haker?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_hacker_241021&amp;utm_term=cat">Профессия Этичный хакер</a></p></li></ul><p><strong>А также:</strong></p><ul><li><p><a href="https://skillfactory.ru/devops-ingineer?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_devops_241021&amp;utm_term=cat">Курс по DevOps</a></p></li><li><p><a href="https://skillfactory.ru/catalogue?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=sf_allcourses_241021&amp;utm_term=cat">Все курсы</a></p></li></ul></div></details></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bskillfactory%5D" class="tm-tags-list__link">skillfactory</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bpython%5D" class="tm-tags-list__link">python</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B7%D0%B2%D1%83%D0%BA%5D" class="tm-tags-list__link">звук</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%80%D0%B5%D0%BA%D0%BE%D0%BC%D0%B5%D0%BD%D0%B4%D0%B0%D1%86%D0%B8%D0%B8%5D" class="tm-tags-list__link">рекомендации</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D1%8B%5D" class="tm-tags-list__link">векторы</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bspotify%5D" class="tm-tags-list__link">spotify</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bspotify%20api%5D" class="tm-tags-list__link">spotify api</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bapi%5D" class="tm-tags-list__link">api</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B8%D0%B8%5D" class="tm-tags-list__link">ии</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bmachine%20learning%5D" class="tm-tags-list__link">machine learning</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/company/skillfactory/blog/" class="tm-hubs-list__link router-link-active">
    Блог компании SkillFactory
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/python/" class="tm-hubs-list__link">
    Python
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/programming/" class="tm-hubs-list__link">
    Программирование
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/api/" class="tm-hubs-list__link">
    API
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/sound/" class="tm-hubs-list__link">
    Звук
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 5: ↑4 и ↓1</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 5: ↑4 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+3</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">2K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    29
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="/ru/company/skillfactory/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" height="40" src="//habrastorage.org/getpro/habr/company/9bb/5f7/d50/9bb5f7d50871bf0981f64b1970f22fe1.png" width="40" class="tm-entity-image__pic"></div></a> <div class="tm-company-snippet__info"><a href="/ru/company/skillfactory/profile/" class="tm-company-snippet__title">SkillFactory</a> <div class="tm-company-snippet__description">Школа Computer Science. Скидка 45% по коду HABR</div></div></div> <div class="tm-article-author__buttons"><!----> <!----></div></div> <div class="tm-article-author__company-contacts"><a href="http://www.skillfactory.ru/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a></div> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/honyaki/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/96e/81d/bc0/96e81dbc01247c6c855b1806b355efa3.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 106 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    20
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">22.4</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/honyaki/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @honyaki
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/company/skillfactory/blog/585182/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 3 
    </span></a> <!----></div></div></div>  <!---->  <!----> <!----></div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section class="tm-block tm-block_spacing-bottom"><header class="tm-block__header"><h2 class="tm-block__title">Информация</h2> <!----></header> <div class="tm-block__body"><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата основания</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2012-10-31T20:00:00.000Z" title="2012-11-01, 00:00">1  ноября  2012</time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Местоположение</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    Россия
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Сайт</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="http://www.skillfactory.ru/" target="_blank" class="tm-company-basic-info__link">
      www.skillfactory.ru
    </a></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Численность</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    201–500 человек
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата регистрации</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2012-12-14T13:25:37.000Z" title="2012-12-14, 17:25">14  декабря  2012</time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Представитель</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="/ru/users/skillfactory_school/" class="tm-company-basic-info__link">
      Skillfactory School
    </a></dd></dl></div></div> <!----></section> <div class="tm-company-widgets"></div> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/company/skillfactory/blog/585182/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/company/skillfactory/blog/585182/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"585182":{"id":"585182","timePublished":"2021-10-24T18:09:32+00:00","isCorporative":true,"lang":"ru","titleHtml":"Пишем систему рекомендаций музыки на основе ML","leadData":{"textHtml":"\u003Cp\u003EК старту \u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fmachine-learning-i-deep-learning?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_mldl_241021&amp;utm_term=lead\"\u003Eкурса по ML и DL\u003C\u002Fa\u003E рассказываем, как воспользоваться API Spotify, чтобы создать систему рекомендаций музыки под настроение на основе алгоритмов ML. Благодаря простоте систему легко настроить под ваши нужды: API Spotify возвращает понятные человеку признаки музыкального файла, например тембр. За подробностями приглашаем под кат.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F535\u002Fc72\u002Fc29\u002F535c72c29c551511b13169b6618f410c.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F535\u002Fc72\u002Fc29\u002F535c72c29c551511b13169b6618f410c.jpg","fit":"cover","positionY":0,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Max Hilsdorf","originalUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fbuild-your-first-mood-based-music-recommendation-system-in-python-26a427308d96"}},{"type":"tutorial","data":null}],"author":{"scoreStats":{"score":20,"votesCount":106},"rating":22.4,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"2534597","alias":"honyaki","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F96e\u002F81d\u002Fbc0\u002F96e81dbc01247c6c855b1806b355efa3.jpg","speciality":null},"statistics":{"commentsCount":3,"favoritesCount":29,"readingCount":1960,"score":3,"votesCount":5},"hubs":[{"relatedData":null,"id":"17931","alias":"skillfactory","type":"corporative","title":"Блог компании SkillFactory","titleHtml":"Блог компании SkillFactory","isProfiled":false},{"relatedData":null,"id":"340","alias":"python","type":"collective","title":"Python","titleHtml":"Python","isProfiled":true},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"17690","alias":"api","type":"collective","title":"API","titleHtml":"API","isProfiled":true},{"relatedData":null,"id":"21988","alias":"sound","type":"collective","title":"Звук","titleHtml":"Звук","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd8b\u002Fc53\u002Fcc5\u002Fd8bc53cc5c6f27a9917110d847ee9bf5.jpg\" width=\"780\" height=\"440\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd8b\u002Fc53\u002Fcc5\u002Fd8bc53cc5c6f27a9917110d847ee9bf5.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EК старту \u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fmachine-learning-i-deep-learning?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_mldl_241021&amp;utm_term=lead\"\u003Eкурса по ML и DL\u003C\u002Fa\u003E рассказываем, как воспользоваться API Spotify, чтобы создать систему рекомендаций музыки под настроение на основе алгоритмов ML. Благодаря простоте систему легко настроить под ваши нужды: API Spotify возвращает понятные человеку признаки музыкального файла, например тембр. За подробностями приглашаем под кат.\u003C\u002Fp\u003E\u003Chr\u002F\u003E\u003Cp\u003EЧтобы создать систему музыкальных рекомендаций, нужно абстрагироваться от жанров и — что сложнее — найти количественные методы превращения идей в полезный инструмент рекомендаций. Посмотрим, как это сделать. Методы рекомендаций делятся на две основные ветви.\u003C\u002Fp\u003E\u003Ch3\u003EКоллаборативная фильтрация\u003C\u002Fh3\u003E\u003Cp\u003EВ ней поведение пользователя моделируется, а затем статистически прогнозируется, что понравится конкретному пользователю в конкретной ситуации. В ход идёт сакраментальное «другие пользователи также приобрели...». Учитывается и общая популярность. Так, случайному пользователю Дрейк по статистике понравится больше Slipknot. Особенно, если ему нравятся и другие рэп-исполнители.\u003C\u002Fp\u003E\u003Ch3\u003EФильтрация по содержанию\u003C\u002Fh3\u003E\u003Cp\u003EДругой подход — извлечь данные из музыкального файла. Например, метаданные — это дата релиза, жанр или лейбл, под которым вышел трек. Или признаки самого аудио — от очевидных тональности и темпа до весьма абстрактных, математических признаков, например MFCC или измерение тембра. Напишем простую и эффективную систему рекомендаций без какого-либо машинного обучения… по крайней мере с вашей стороны.\u003C\u002Fp\u003E\u003Ch3\u003EПлюсы подхода\u003C\u002Fh3\u003E\u003Cp\u003EЭтот подход принципиально отличается от методов коллаборативной фильтрации («другие пользователи также приобрели...»). Особенно он полезен тем, кто не работает с большой музыкальной платформой и не имеет миллиардов релевантных пользовательских точек данных. Ещё один плюс — быстрая и бесплатная реализация, от сбора данных до алгоритма.\u003C\u002Fp\u003E\u003Ch2\u003EИзвлекаем данные\u003C\u002Fh2\u003E\u003Cp\u003EИзвлечь аудиоданные с помощью алгоритмов или моделей машинного обучения поиска музыкальной информации — для новичка это сложно. К счастью, умные люди сделали API, где делятся секретами инновационной технологии.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Фрагмент документации API Spotify о доступных характеристиках аудио\" title=\"Фрагмент документации API Spotify о доступных характеристиках аудио\" height=\"388\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff4c\u002F79e\u002Fe31\u002Ff4c79ee31689718d9ac07a14eb2c0897.png\" data-width=\"630\"\u002F\u003E\u003Cfigcaption\u003EФрагмент документации API Spotify о доступных характеристиках аудио\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EAPI от Spotify бесплатный и имеет несколько характеристик настроения, извлекаемых прямо из внутренних моделей машинного обучения. Но как смоделировать настроение всего четырьмя характеристиками: «Танцевальностью», «Валентностью», «Возбуждением» и «Темпом»? Темп при этом [по мнению автора] едва ли отнесёшь к настроению. На самом деле нужны только две характеристики.\u003C\u002Fp\u003E\u003Ch2\u003EПсихология: плоскость «валентность — возбуждение»\u003C\u002Fh2\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Плоскость «валентность — возбуждение» с расположением эмоций (Russel, 1980)\" title=\"Плоскость «валентность — возбуждение» с расположением эмоций (Russel, 1980)\" height=\"711\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F50f\u002Fa4d\u002F059\u002F50fa4d0591002d34540acc6313677c95.png\" data-width=\"864\"\u002F\u003E\u003Cfigcaption\u003EПлоскость «валентность — возбуждение» с расположением эмоций (Russel, 1980)\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПлоскость «валентность — возбуждение» — одна из главных психологических моделей факторной структуры эмоций. Модель описывает, сколько существует независимых измерений эмоций. Эмоции сводятся к двум компонентам — возбуждению (активности или вялости) и валентности (позитиву или негативу). \u003C\u002Fp\u003E\u003Cp\u003EУ этой модели есть проблемы: к примеру, страх и гнев расположены близко, но у неё прекрасный баланс между сложностью и прогностической значимостью, поэтому модель Рассела находит широкое применение. А главное — она сочетается с «валентностью» и «возбуждением» в данных от Spotify. Посмотрим, как получить данные по API и реализуем простую, но эффективную систему рекомендаций.\u003C\u002Fp\u003E\u003Ch2\u003EСобираем данные\u003C\u002Fh2\u003E\u003Ch3\u003EАвторизация\u003C\u002Fh3\u003E\u003Cp\u003EДля доступа к Spotify API регистрируем приложение согласно \u003Ca href=\"https:\u002F\u002Fdeveloper.spotify.com\u002Fdocumentation\u002Fgeneral\u002Fguides\u002Fauthorization-guide\u002F\"\u003Eэтому \u003C\u002Fa\u003Eруководству или смотрим эту \u003Ca href=\"https:\u002F\u002Fmedium.com\u002F@maxtingle\u002Fgetting-started-with-spotifys-api-spotipy-197c3dc6353b\"\u003Eнаглядную\u003C\u002Fa\u003E статью на Medium. Без авторизации мы не получим данные.\u003C\u002Fp\u003E\u003Ch3\u003EПодготовка кода\u003C\u002Fh3\u003E\u003Cp\u003EНам нужна база данных о треках, пакет \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ffelix-hilden\u002Ftekore\"\u003Etekore\u003C\u002Fa\u003E, Client ID и Secret ID от Spotify для доступа к API. В каталоге проекта пишем скрипт \u003Ccode\u003Eauthorization.py\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Eimport tekore as tk\ndef authorize():\n CLIENT_ID = \"ENTER YOUR CLIENT ID HERE\"\n CLIENT_SECRET = \"ENTER YOUR CLIENT SECRET HERE\"\n app_token = tk.request_client_token(CLIENT_ID, CLIENT_SECRET)\n return tk.Spotify(app_token)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ коде вводим Client ID и Client Secret ID. Скрипт разрешает доступ к Spotify API и возвращает объект для обращения к API, а ещё служит вспомогательным скриптом. Главное — он гарантирует, что Client ID и Client Secret ID скрыты.\u003C\u002Fp\u003E\u003Ch3\u003EПолучение набора данных Spotify\u003C\u002Fh3\u003E\u003Cp\u003EКомандой pip install pandas tqdm устанавливаем нужные пакеты. Копируем и запускаем код ниже и\u002Fили следуем краткому обзору кода.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003E#################\n## PREPARATION ##\n#################\n\n# Import modules\nimport sys\n# If your authentification script is not in the project directory\n# append its folder to sys.path\nsys.path.append(\"..\u002Fspotify_api_web_app\")\nimport authorization\nimport pandas as pd\nfrom tqdm import tqdm\nimport time\n\n# Authorize and call access object \"sp\"\nsp = authorization.authorize()\n\n# Get all genres\ngenres = sp.recommendation_genre_seeds()\n\n# Set number of recommendations per genre\nn_recs = 100\n\n# Initiate a dictionary with all the information you want to crawl\ndata_dict = {\"id\":[], \"genre\":[], \"track_name\":[], \"artist_name\":[],\n             \"valence\":[], \"energy\":[]}\n\n################\n## CRAWL DATA ##\n################\n\n# Get recs for every genre\nfor g in tqdm(genres):\n    \n    # Get n recommendations\n    recs = sp.recommendations(genres = [g], limit = n_recs)\n    # json-like string to dict\n    recs = eval(recs.json().replace(\"null\", \"-999\").replace(\"false\", \"False\").replace(\"true\", \"True\"))[\"tracks\"]\n    \n    # Crawl data from each track\n    for track in recs:\n        # ID and Genre\n        data_dict[\"id\"].append(track[\"id\"])\n        data_dict[\"genre\"].append(g)\n        # Metadata\n        track_meta = sp.track(track[\"id\"])\n        data_dict[\"track_name\"].append(track_meta.name)\n        data_dict[\"artist_name\"].append(track_meta.album.artists[0].name)\n        # Valence and energy\n        track_features = sp.track_audio_features(track[\"id\"])\n        data_dict[\"valence\"].append(track_features.valence)\n        data_dict[\"energy\"].append(track_features.energy)\n        \n        # Wait 0.2 seconds per track so that the api doesnt overheat\n        time.sleep(0.2)\n        \n##################\n## PROCESS DATA ##\n##################\n\n# Store data in dataframe\ndf = pd.DataFrame(data_dict)\n\n# Drop duplicates\ndf.drop_duplicates(subset = \"id\", keep = \"first\", inplace = True)\ndf.to_csv(\"valence_arousal_dataset.csv\", index = False)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3\u003EКак работает код\u003C\u002Fh3\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003EВспомогательный скрипт выполняет авторизацию. \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EС помощью \u003Ccode\u003Esp.recommendation_genre_seeds()\u003C\u002Fcode\u003E получаем все 120 жанров Spotify. \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EУстанавливаем на максимум число рекомендаций на жанр (100). \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EЗадаём словарь для всех данных из API. \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EПроходимся по каждому жанру и треку. \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EПолучаем метаданные и аудио информацию и сохраняем в \u003Ccode\u003Edata_dict\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EПреобразуем словарь во фрейм pandas.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EПосле удаления дублей идентификаторов экспортируем её в рабочий каталог.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp\u003EУ нас получился набор данных \u003Ccode\u003Evalence_arousal_dataset.csv\u003C\u002Fcode\u003E для системы рекомендаций.\u003C\u002Fp\u003E\u003Ch2\u003EКак использовать валентность и возбуждение для рекомендаций\u003C\u002Fh2\u003E\u003Cp\u003EПосмотрите на график ниже: \u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Векторы на плоскости «валентность — возбуждение». Расположение приблизительное\" title=\"Векторы на плоскости «валентность — возбуждение». Расположение приблизительное\" height=\"687\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F370\u002Fd57\u002F497\u002F370d574971b946d05c4c3a4ab82ed36a.png\" data-width=\"827\"\u002F\u003E\u003Cfigcaption\u003EВекторы на плоскости «валентность — возбуждение». Расположение приблизительное\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EКаждый вектор с координатами «валентности» и «возбуждения» соединён с другими треками линиями. Мы видим, что эмоциональный профиль Thriller исполнителя Майкла Джексона больше похож на Rosanna.\u003C\u002Fp\u003E\u003Cp\u003EИзмерим длину векторов, или их «норму». Вот формула: \u003Cem\u003Esqrt(a²+b²)\u003C\u002Fem\u003E. Пример:\u003C\u002Fp\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003EДопустим «валентность» трека — 0,5, а его «возбуждение» — 1, то есть он имеет координаты (0,5, 1). \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EТогда расстояние от начала координат до трека равно \u003Cem\u003Esqrt((0,5)² + 1²\u003C\u002Fem\u003E) = 1,12.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp\u003EТогда расстояние от начала координат до трека равно \u003Cem\u003Esqrt((0,5)² + 1²\u003C\u002Fem\u003E) = 1,12.\u003C\u002Fp\u003E\u003Cp\u003EТочно так же нужно найти векторы, соединяющие трек со всеми остальными треками: применить формулу и взять вектор с наименьшей длиной.\u003C\u002Fp\u003E\u003Cp\u003EЖёлтый вектор из точки \u003Cem\u003Ep1\u003C\u002Fem\u003E в точку \u003Cem\u003Ep2\u003C\u002Fem\u003E определяется как разность двух векторов: p2 - p1\u003Cem\u003E.\u003C\u002Fem\u003E Поэтому «расстояние настроения» между треками t1 и t2 равно норме (t2 - t1). Иначе говоря, из t2 вычитается t1 и по формуле вычисляется норма результирующего вектора. В коде на Python это реализуется просто:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edef distance(p1, p2):\n    distance_x = p2[0] - p1[0]\n    distance_y = p2[1] - p1[1]\n    distance_vec = [distance_x, distance_y]\n    norm = (distance_vec[0]**2 + distance_vec[1]**2)**(1\u002F2)\n    return norm\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ своём коде я воспользовался \u003Ccode\u003Enumpy.linalg.norm(p2-p1)\u003C\u002Fcode\u003E, которая делает то же самое.\u003C\u002Fp\u003E\u003Ch3\u003EПроблемы\u003C\u002Fh3\u003E\u003Cp\u003EЕщё до реализации системы обозначим две статистические проблемы. Если они не важны для вас, пропускайте эту часть или вернитесь к ней позже.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6be\u002F04e\u002Fc35\u002F6be04ec3565f4405e75ca54afabcdb6a.jpeg\" alt=\"Распределение признаков «валентность» и «возбуждение»\" title=\"Распределение признаков «валентность» и «возбуждение»\" width=\"2400\" height=\"1200\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6be\u002F04e\u002Fc35\u002F6be04ec3565f4405e75ca54afabcdb6a.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003EРаспределение признаков «валентность» и «возбуждение»\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EУ двух наших признаков совершенно разные распределения: у «валентности» оно близко к очень плоскому нормальному распределению, а у «возбуждения» сильно скошено.\u003C\u002Fp\u003E\u003Cp\u003EСкачок на 0,2 «валентности» не всегда совпадает со скачком на 0,2 «возбуждения». Для модели это — недостаток. Она предполагает, что вектор (0,5, 0,5) так же близок к (0,7, 0,5), как и к (0,5, 0,7). Чтобы разрешить этот конфликт, применяется \u003Ca href=\"https:\u002F\u002Fmedium.com\u002Fanalytics-vidhya\u002Fz-score-in-detail-9dd0f0afa142\"\u003Ez-преобразование\u003C\u002Fa\u003E, но здесь мы его не рассматриваем.\u003C\u002Fp\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F518\u002Fbbf\u002F90f\u002F518bbf90ffa1593341efb098fee01f78.jpeg\" alt=\"Корреляция «валентности» и «возбуждения», линейная регрессия\" title=\"Корреляция «валентности» и «возбуждения», линейная регрессия\" width=\"450\" height=\"450\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F518\u002Fbbf\u002F90f\u002F518bbf90ffa1593341efb098fee01f78.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003EКорреляция «валентности» и «возбуждения», линейная регрессия\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EДругая проблема показана на рисунке выше. В теории психологии валентность и возбуждение — два статистически независимых измерения эмоций. Но, если нанести все 12 000 треков из набора данных на плоскость «валентность — возбуждение», мы увидим, что при увеличении «валентности» увеличивается и «возбуждение».\u003C\u002Fp\u003E\u003Cp\u003EНаклон линии регрессии 0,250 указывает на существенную корреляцию валентности и возбуждения. К сожалению, здесь нет решения: эта ошибка (по крайней мере в нашем случае) заложена в Spotify API.\u003C\u002Fp\u003E\u003Ch2\u003EАлгоритм рекомендаций\u003C\u002Fh2\u003E\u003Cp\u003EОкончательный вариант алгоритма рекомендаций прост. Пройдём его последние этапы. Весь алгоритм вы найдёте в \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FMaxHilsdorf\u002Fmood-based-music-recommendation-system\u002Fblob\u002Fmain\u002Frecommendation_system.ipynb\"\u003Eэтом \u003C\u002Fa\u003Eблокноте. \u003C\u002Fp\u003E\u003Cp\u003EИмпортируем модули:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Eimport pandas as pd\nimport random\nimport authorization # this is the script we created earlier\nimport numpy as np\nfrom numpy.linalg import norm\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EСчитываем данные 12 000 треков из фрейма:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edf = pd.read_csv(\"valence_arousal_dataset.csv\")\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКомбинируем столбцы «валентности» и «возбуждения» и создаём для каждого трека единый вектор mood_vec:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edf[\"mood_vec\"] = df[[\"valence\", \"energy\"]].values.tolist()\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПоследний этап перед реализацией алгоритма рекомендаций — авторизация для доступа к API Spotify:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Esp = authorization.authorize()\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EРеализуем алгоритм рекомендаций на основе длины вектора:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edef recommend(track_id, ref_df, sp, n_recs = 5):\n    \n    # Crawl valence and arousal of given track from spotify api\n    track_features = sp.track_audio_features(track_id)\n    track_moodvec = np.array([track_features.valence, track_features.energy])\n    \n    # Compute distances to all reference tracks\n    ref_df[\"distances\"] = ref_df[\"mood_vec\"].apply(lambda x: norm(track_moodvec-np.array(x)))\n    # Sort distances from lowest to highest\n    ref_df_sorted = ref_df.sort_values(by = \"distances\", ascending = True)\n    # If the input track is in the reference set, it will have a distance of 0, but should not be recommendet\n    ref_df_sorted = ref_df_sorted[ref_df_sorted[\"id\"] != track_id]\n    \n    # Return n recommendations\n    return ref_df_sorted.iloc[:n_recs]\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2\u003EПроверим алгоритм\u003C\u002Fh2\u003E\u003Cp\u003EОстаётся проверить, даёт ли алгоритм значимые результаты. У каждого трека на Spotify есть идентификатор, который содержится в ссылке на песню:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"359\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb5c\u002Fdc5\u002Ffd6\u002Fb5cdc5fd6dda4f6f0f3c562950a16f36.png\" data-width=\"630\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПолучим ссылку: \u003Ca href=\"https:\u002F\u002Fopen.spotify.com\u002Ftrack\u002F3JOVTQ5h8HGFnDdp4VT3MP?si=96f7844315434b0a\"\u003Ehttps:\u002F\u002Fopen.spotify.com\u002Ftrack\u002F\u003Cstrong\u003E3JOVTQ5h8HGFnDdp4VT3MP\u003C\u002Fstrong\u003E?si=96f7844315434b0a\u003C\u002Fa\u003E. Идентификатор трека — это выделенная строка \u003Ca href=\"https:\u002F\u002Fopen.spotify.com\u002Ftrack\u002F3JOVTQ5h8HGFnDdp4VT3MP?si=96f7844315434b0a\"\u003E3JOVTQ5h8HGFnDdp4VT3MP\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Ch3\u003EGary Jules — Mad World\u003C\u002Fh3\u003E\u003Cp\u003EДобавим трек Mad World с «валентностью» 0,30 и «возбуждением» 0,06.\u003C\u002Fp\u003E\u003Cdiv class=\"tm-iframe_temp\" data-src=\"https:\u002F\u002Fembedd.srv.habr.com\u002Fiframe\u002F617569ba4615593b75e246c2\" data-style=\"\" id=\"617569ba4615593b75e246c2\" width=\"\"\u003E\u003C\u002Fdiv\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Emad_world = \"3JOVTQ5h8HGFnDdp4VT3MP\"\nrecommend(track_id = mad_world, ref_df = df, sp = sp, n_recs = 5)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЛучшая рекомендация с «валентностью» 0,31 и «возбуждением» 0,05 — это Glory Manger от Harry Belafonte.\u003C\u002Fp\u003E\u003Cdiv class=\"tm-iframe_temp\" data-src=\"https:\u002F\u002Fembedd.srv.habr.com\u002Fiframe\u002F61756c9b4615593b75e246c3\" data-style=\"\" id=\"61756c9b4615593b75e246c3\" width=\"\"\u003E\u003C\u002Fdiv\u003E\u003Cp\u003EНеплохо! Хотя Glory Manger из совершенно другого жанра, алгоритм подобрал этот трек как имеющий схожие уровни «валентности» и «возбуждения».\u003C\u002Fp\u003E\u003Ch3\u003ERosanna, Toto\u003C\u002Fh3\u003E\u003Cp\u003EПопробуем ещё! Rosanna имеет «валентность» 0,739 и «возбуждение» 0,513.\u003C\u002Fp\u003E\u003Cdiv class=\"tm-iframe_temp\" data-src=\"https:\u002F\u002Fembedd.srv.habr.com\u002Fiframe\u002F61756cc5abb378f6450d1a42\" data-style=\"\" id=\"61756cc5abb378f6450d1a42\" width=\"\"\u003E\u003C\u002Fdiv\u003E\u003Cp\u003EЛучшая рекомендация с «валентностью» 0,740 и «возбуждением» 0,504 — Sentimientos De Chartón от Duelo.\u003C\u002Fp\u003E\u003Cdiv class=\"tm-iframe_temp\" data-src=\"https:\u002F\u002Fembedd.srv.habr.com\u002Fiframe\u002F61756d136ea11f3bbbaf1fe0\" data-style=\"\" id=\"61756d136ea11f3bbbaf1fe0\" width=\"\"\u003E\u003C\u002Fdiv\u003E\u003Cp\u003EСнова жанр сильно отличается: это скорее латино, чем поп-рок. Но Sentimientos De Cartón передаёт чувство романтической тоски и одновременно ощущение движения, ритма, которые ощущаются и в Rosanna.\u003C\u002Fp\u003E\u003Ch2\u003EЗаключение\u003C\u002Fh2\u003E\u003Cp\u003EПоздравляю! Вы добрались до этого места, а значит — либо создали свою первую систему рекомендаций под настроение, либо хотя бы немного узнали о том, как создать такую систему. Но есть ещё кое-что.\u003C\u002Fp\u003E\u003Ch3\u003EКак улучшить систему?\u003C\u002Fh3\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EЧтобы расстояния стали точнее, можно применять z-преобразование для признаков «валентности» и «возбуждения».\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EВ Spotify API есть и другие характеристики: «танцевальность», «акустичность», «темп». Подумайте, как развить плоскость «валентность — возбуждение» или разработать собственный набор переменных.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EИнтересно сочетание рекомендаций под настроение и методов коллаборативной фильтрации. После вычисления 10 лучших рекомендаций с «валентностью» и «возбуждением» стоит попробовать изменить порядок рекомендаций по «популярности» — такой признак также есть в API Spotify.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EМожно дать пользователю возможность указать списки жанров — белый и чёрный.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСтоит расширить эталонный набор данных, изучив возможности Spotify API и проанализировав ещё больше треков. Большая база данных повышает вероятность найти почти идеальное соответствие треков.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EЕсли вы хотите не только использовать машинное обучение, но и понять, как оно работает, то вы можете обратить внимание на наши курсы:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fmachine-learning-i-deep-learning?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_mldl_241021&amp;utm_term=conc\"\u003EКурс «Machine Learning и Deep Learning» (6 месяцев)\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fdata-scientist-pro?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_dspr_241021&amp;utm_term=conc\"\u003EПрофессия Data Scientist (24 месяца)\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EТакже вы можете перейти на страницы \u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fcatalogue?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=sf_allcourses_241021&amp;utm_term=conc\"\u003Eиз каталога\u003C\u002Fa\u003E, чтобы увидеть, как мы готовим специалистов в других направлениях.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"200\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4cb\u002Ff38\u002F0fb\u002F4cbf380fb5af6a7ce549977901b8ca96.png\" data-width=\"1000\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EПрофессии и курсы\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cp\u003E\u003Cstrong\u003EData Science и Machine Learning\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fdata-scientist-pro?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_dspr_241021&amp;utm_term=cat\"\u003EПрофессия Data Scientist\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fdata-analyst-pro?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=analytics_dapr_241021&amp;utm_term=cat\"\u003EПрофессия Data Analyst\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fmatematika-dlya-data-science#syllabus?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_mat_241021&amp;utm_term=cat\"\u003EКурс «Математика для Data Science»\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fmatematika-i-machine-learning-dlya-data-science?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_matml_241021&amp;utm_term=cat\"\u003EКурс «Математика и Machine Learning для Data Science»\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fdata-engineer?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_dea_241021&amp;utm_term=cat\"\u003EКурс по Data Engineering\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fmachine-learning-i-deep-learning?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_mldl_241021&amp;utm_term=cat\"\u003EКурс «Machine Learning и Deep Learning»\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fmachine-learning?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=data-science_ml_241021&amp;utm_term=cat\"\u003EКурс по Machine Learning\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Cstrong\u003EPython, веб-разработка\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fpython-fullstack-web-developer?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_fpw_241021&amp;utm_term=cat\"\u003EПрофессия Fullstack-разработчик на Python\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fpython-for-web-developers?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_pws_241021&amp;utm_term=cat\"\u003EКурс «Python для веб-разработки»\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Ffrontend-razrabotchik?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_fr_241021&amp;utm_term=cat\"\u003EПрофессия Frontend-разработчик\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fwebdev?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_webdev_241021&amp;utm_term=cat\"\u003EПрофессия Веб-разработчик\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Cstrong\u003EМобильная разработка\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fios-razrabotchik-s-nulya?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_ios_241021&amp;utm_term=cat\"\u003EПрофессия iOS-разработчик\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fandroid-razrabotchik?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_andr_241021&amp;utm_term=cat\"\u003EПрофессия Android-разработчик\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Cstrong\u003EJava и C#\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fjava-razrabotchik?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_java_241021&amp;utm_term=cat\"\u003EПрофессия Java-разработчик\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fjava-qa-engineer-testirovshik-po?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_qaja_241021&amp;utm_term=cat\"\u003EПрофессия QA-инженер на JAVA\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fc-sharp-razrabotchik?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_cdev_241021&amp;utm_term=cat\"\u003EПрофессия C#-разработчик\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fgame-razrabotchik-na-unity-i-c-sharp?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_gamedev_241021&amp;utm_term=cat\"\u003EПрофессия Разработчик игр на Unity\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Cstrong\u003EОт основ — в глубину\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Falgoritmy-i-struktury-dannyh?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_algo_241021&amp;utm_term=cat\"\u003EКурс «Алгоритмы и структуры данных»\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fc-plus-plus-razrabotchik?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_cplus_241021&amp;utm_term=cat\"\u003EПрофессия C++ разработчик\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fcyber-security-etichnij-haker?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_hacker_241021&amp;utm_term=cat\"\u003EПрофессия Этичный хакер\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Cstrong\u003EА также:\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fdevops-ingineer?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=coding_devops_241021&amp;utm_term=cat\"\u003EКурс по DevOps\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fskillfactory.ru\u002Fcatalogue?utm_source=habr&amp;utm_medium=habr&amp;utm_campaign=article&amp;utm_content=sf_allcourses_241021&amp;utm_term=cat\"\u003EВсе курсы\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"skillfactory"},{"titleHtml":"python"},{"titleHtml":"звук"},{"titleHtml":"рекомендации"},{"titleHtml":"векторы"},{"titleHtml":"spotify"},{"titleHtml":"spotify api"},{"titleHtml":"api"},{"titleHtml":"ии"},{"titleHtml":"machine learning"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F535\u002Fc72\u002Fc29\u002F535c72c29c551511b13169b6618f410c.jpg","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F535\u002Fc72\u002Fc29\u002F535c72c29c551511b13169b6618f410c.jpg","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fskillfactory\\\u002Fblog\\\u002F585182\\\u002F\"},\"headline\":\"Пишем систему рекомендаций музыки на основе ML\",\"datePublished\":\"2021-10-24T21:09:32+03:00\",\"dateModified\":\"2021-10-24T21:09:32+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"honyaki\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"К старту курса по ML и DL рассказываем, как воспользоваться API Spotify, чтобы создать систему рекомендаций музыки под настроение на основе алгоритмов ML. Благод...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fskillfactory\\\u002Fblog\\\u002F585182\\\u002F#post-content-body\",\"about\":[\"c_skillfactory\",\"h_python\",\"h_programming\",\"h_api\",\"h_sound\",\"f_develop\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F585182\\\u002F9fd89c7f09b145ab70d941246c2bc401\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fd8b\\\u002Fc53\\\u002Fcc5\\\u002Fd8bc53cc5c6f27a9917110d847ee9bf5.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Ff4c\\\u002F79e\\\u002Fe31\\\u002Ff4c79ee31689718d9ac07a14eb2c0897.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F50f\\\u002Fa4d\\\u002F059\\\u002F50fa4d0591002d34540acc6313677c95.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F370\\\u002Fd57\\\u002F497\\\u002F370d574971b946d05c4c3a4ab82ed36a.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F6be\\\u002F04e\\\u002Fc35\\\u002F6be04ec3565f4405e75ca54afabcdb6a.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F518\\\u002Fbbf\\\u002F90f\\\u002F518bbf90ffa1593341efb098fee01f78.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fb5c\\\u002Fdc5\\\u002Ffd6\\\u002Fb5cdc5fd6dda4f6f0f3c562950a16f36.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F4cb\\\u002Ff38\\\u002F0fb\\\u002F4cbf380fb5af6a7ce549977901b8ca96.png\"]}","metaDescription":"К старту курса по ML и DL рассказываем, как воспользоваться API Spotify, чтобы создать систему рекомендаций музыки под настроение на основе алгоритмов ML. Благодаря простоте систему легко настроить...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{"skillfactory":{"alias":"skillfactory","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F9bb\u002F5f7\u002Fd50\u002F9bb5f7d50871bf0981f64b1970f22fe1.png","titleHtml":"SkillFactory","descriptionHtml":"Школа Computer Science. Скидка 45% по коду HABR","relatedData":null,"statistics":{"postsCount":538,"newsCount":3,"vacanciesCount":4,"employeesCount":27,"careerRating":null,"subscribersCount":2670,"rating":145.99,"invest":null},"foundationDate":{"year":"2012","month":"11","day":"01"},"location":{"city":{"id":"447159","title":"Москва"},"region":{"id":"1885","title":"Москва и Московская обл."},"country":{"id":"168","title":"Россия"}},"siteUrl":"http:\u002F\u002Fwww.skillfactory.ru\u002F","staffNumber":"201–500 человек","registrationDate":"2012-12-14T13:25:37+00:00","representativeUser":{"alias":"skillfactory_school","fullname":"Skillfactory School"},"contacts":[{"title":"Сайт","url":"http:\u002F\u002Fwww.skillfactory.ru\u002F"}],"settings":{"analyticsSettings":[{"type":"ym","trackingId":"38813825"}],"branding":null,"status":"active"},"metadata":{"titleHtml":"SkillFactory, Москва - Школа Computer Science. Скидка 45% по коду HABR с 1 ноября 2012 г.","title":"SkillFactory, Москва - Школа Computer Science. Скидка 45% по коду HABR с 1 ноября 2012 г.","keywords":["Программирование","Python","Машинное обучение","Читальный зал","Научно-популярное"],"descriptionHtml":"538 статей от авторов компании SkillFactory","description":"538 статей от авторов компании SkillFactory"},"aDeskSettings":null,"careerAlias":"skillfactory","maxCustomTrackerLinks":0}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
