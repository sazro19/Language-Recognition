<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Как дополнить данные в Amplitude информацией из CRM и других систем с помощью S2S событий / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/company\/ligastavok\/blog\/581894\/"},"headline":"Как дополнить данные в Amplitude информацией из CRM и других систем с помощью S2S событий","datePublished":"2021-10-06T14:16:19+03:00","dateModified":"2021-10-06T16:05:35+03:00","author":{"@type":"Person","name":"helloageeva"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"В рамках спецпроекта&nbsp;Product Analytics Champions рассказываем, как и зачем используют S2S обогащение Amplitude через стандартные API.  Что такое S2S события и за...","url":"https:\/\/habr.com\/ru\/company\/ligastavok\/blog\/581894\/#post-content-body","about":["c_ligastavok","h_bigdata","h_mobileanalytics","h_productpm","h_data_engineering","f_develop","f_management","f_marketing","f_admin"],"image":["https:\/\/habr.com\/share\/publication\/581894\/79b2d70736dacb9313206cc10338ae76\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/774\/45d\/e86\/77445de86a6ed512d5daaf11a0d51e72.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/16f\/ef1\/08b\/16fef108b19518b57da1426008a73c23.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Как дополнить данные в Amplitude информацией из CRM и других систем с помощью S2S событий" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Как дополнить данные в Amplitude информацией из CRM и других систем с помощью S2S событий" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Как дополнить данные в Amplitude информацией из CRM и других систем с помощью S2S событий" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="В рамках спецпроекта&amp;nbsp;Product Analytics Champions рассказываем, как и зачем используют S2S обогащение Amplitude через стандартные API.  Что такое S2S события и зачем они нужны  Межсерверные..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="В рамках спецпроекта&amp;nbsp;Product Analytics Champions рассказываем, как и зачем используют S2S обогащение Amplitude через стандартные API.  Что такое S2S события и зачем они нужны  Межсерверные..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="В рамках спецпроекта&amp;nbsp;Product Analytics Champions рассказываем, как и зачем используют S2S обогащение Amplitude через стандартные API.  Что такое S2S события и зачем они нужны  Межсерверные..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="В рамках спецпроекта&amp;nbsp;Product Analytics Champions рассказываем, как и зачем используют S2S обогащение Amplitude через стандартные API.  Что такое S2S события и зачем они нужны  Межсерверные..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="В рамках спецпроекта&amp;nbsp;Product Analytics Champions рассказываем, как и зачем используют S2S обогащение Amplitude через стандартные API.  Что такое S2S события и зачем они нужны  Межсерверные..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/774/45d/e86/77445de86a6ed512d5daaf11a0d51e72.png" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/774/45d/e86/77445de86a6ed512d5daaf11a0d51e72.png" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/774/45d/e86/77445de86a6ed512d5daaf11a0d51e72.png" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/774/45d/e86/77445de86a6ed512d5daaf11a0d51e72.png" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/774/45d/e86/77445de86a6ed512d5daaf11a0d51e72.png" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="581894" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-06T11:16:19.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/581894/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/company/ligastavok/blog/581894/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habrastorage.org/getpro/habr/upload_files/774/45d/e86/77445de86a6ed512d5daaf11a0d51e72.png" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/581894/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" companyName="ligastavok" data-async-called="true" class="tm-page"><div class="tm-page-width"><div class="tm-page__header"><!----></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"><div class="tm-company-card tm-company-article__company-card"><div class="tm-company-card__info"><div class="tm-company-card__header"><a href="/ru/company/ligastavok/profile/" class="tm-company-card__avatar"><div class="tm-entity-image"><img alt="" height="48" src="//habrastorage.org/getpro/habr/company/dec/f8d/87c/decf8d87cf0971a9d5ed43157e76c1b0.jpg" width="48" class="tm-entity-image__pic"></div></a> <!----> <div class="tm-rating tm-company-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">40.48</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div> <div class="tm-company-card__info"><a href="/ru/company/ligastavok/profile/" class="tm-company-card__name">
        Лига Ставок
      </a> <div class="tm-company-card__description"></div></div></div> <div class="tm-company-card__buttons"><!----> <!----></div></div> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/helloageeva/" title="helloageeva" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/35a/dd2/302/35add23025db047565eb30b40b770254.png" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/helloageeva/" class="tm-user-info__username">
      helloageeva
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-06T11:16:19.000Z" title="2021-10-06, 14:16">6  октября   в 14:16</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Как дополнить данные в Amplitude информацией из CRM и других систем с помощью S2S событий</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/company/ligastavok/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании Лига Ставок</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/bigdata/" class="tm-article-snippet__hubs-item-link"><span>Big Data</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/mobileanalytics/" class="tm-article-snippet__hubs-item-link"><span>Аналитика мобильных приложений</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/productpm/" class="tm-article-snippet__hubs-item-link"><span>Управление продуктом</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/data_engineering/" class="tm-article-snippet__hubs-item-link"><span>Data Engineering</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Recovery mode
      </span></div><div class="tm-article-snippet__label"><span>
        Tutorial
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><p>В рамках спецпроекта <a href="https://amplitude.adventum.ru/champion-liga-stavok">Product Analytics Champions</a> рассказываем, как и зачем используют S2S обогащение Amplitude через стандартные API.  </p><h2>Что такое S2S события и зачем они нужны  </h2><p>Межсерверные (server-to-server или S2S) события позволяют отслеживать кастомные события и параметры через HTTP запросы. Они часто используются в мобильной атрибуции, например, в Appsflyer или в Adjust.</p><p>При этом S2S события можно использовать и в Amplitude. Для прометки большинства событий, их свойств и параметров пользователей достаточно стандартного SDK Amplitude. К S2S событиям стоит прибегать при импорте данных из других систем, которые сложно передавать напрямую в Amplitude.  </p><p><strong>Примеры использования такой интеграции:</strong></p><p>1. Можно отправлять свойства пользователей из CRM (например, количество покупок или дату регистрации на сайте/приложении) даже для тех тех, кого еще нет в Amplitude. После того, как они появятся в Amplitude, данные по ним смэчатся по user ID. Это полезно на начальных этапах, когда еще не все пользователи появились в Amplitude.</p><p>2. Можно передавать события "выкупа заказа", например, для приложений с самовывозом, чтобы события самого заказа в приложении дополнялись еще событиями финальной оффлайновой точки воронки.</p><p>Хотим рассказать, как это способ используется в Лиге Ставок. Мы широко применяем сервис продуктовой аналитики Amplitude для анализа поведения пользователей. Например, это помогает нам <a href="https://amplitude.adventum.ru/champion-liga-stavok/bug-analytics-in-amplitude">сокращать количество ошибок</a> и <a href="https://amplitude.adventum.ru/specials/liga-stavok/conversion-rate-optimization-case">увеличивать конверсию в регистрацию</a>. При этом мы собираем дополнительные данные по пользователям в CRM и других системах. Их нет в Amplitude, но с ними можно анализировать большее количество срезов, чем есть в разметке.</p><p>Так в Лиге Ставок создали систему межсерверного (S2S) обогащения Amplitude через стандартные API, чтобы глубже анализировать поведение и свойства своих клиентов.  </p><h2>Что нужно для такого обмена данными  </h2><p>1. Определите параметры, которые вы хотите дополнительно передавать в Amplitude для работы с функциями сервиса и уже существующими событиями/свойствами пользователей. Например:</p><ul><li><p>Категории по доходу и другая финансовая информация</p></li></ul><ul><li><p>Конверсии, которые не покрываются разметкой (например, переходы на сторонние web-view из приложения)</p></li></ul><p>2. Определите источники данных:</p><ul><li><p>CRM</p></li></ul><ul><li><p>Системы веб-аналитики</p></li></ul><ul><li><p>Внутреннее хранилище данных (DWH)</p></li></ul><ul><li><p>И другие</p></li></ul><p>3. Python 3.7 (и выше) для настройки передачи данных.  </p><h2>Инструкция по настройке s2s передачи данных  </h2><p>У Amplitude есть свой API выдачи сырых данных по проекту. Подробную документацию по нему можно найти <a href="https://developers.amplitude.com/docs/export-api?source=adventum">по ссылке</a>. Для пуша событий мы используем <a href="https://api.amplitude.com/httpapi">https://api2.amplitude.com/httpapi</a> или будущие обновления из документации, обычно они идут с приставками 2, 3 и т.д. Для обогащения профиля пользователя берем точку <a href="https://api2.amplitude.com/identify">https://api2.amplitude.com/identify</a>. Ключ авторизации берется из настроек проекта в Amplitude:  </p><figure class="full-width "><img src="/img/image-loader.svg" height="431" data-src="https://habrastorage.org/getpro/habr/upload_files/774/45d/e86/77445de86a6ed512d5daaf11a0d51e72.png" data-width="916"/><figcaption></figcaption></figure><p><strong>Код</strong>. Стоит отметить, что в Лиге Ставок намеренно пишут простые агенты, понятные даже начинающим аналитикам.  </p><p><strong>Шаг 1. Агент доставки s2s событий</strong></p><p>Для создания агента понадобится всего две библиотеки:</p><ul><li><p>import amplitude</p></li><li><p>import pymssql</p></li></ul><p>В нашем случае источником выступает MSSQL хранилище данных. По умолчанию библиотека Amplitude позволяет вам отправлять события, аналогичные SDK разметке. Формируется JSON с вашим набором данных и отправляется в API Amplitude, все просто.</p><p>Несмотря на то, что в мы в Лиге не стали писать код с нуля и используем готовую библиотеку, нам пришлось ее немного изменить. А именно — добавить точку отправки профиля клиента. Далее будет описан пример корректировки библиотеки, но, конечно, лучше написать своей параметризованный код.</p><p>Переходим к корректировкам в библиотеке. Изменения коснулись блока AmplitudeLogger, где заменили ссылку <a href="https://api.amplitude.com/httpapi">https://api2.amplitude.com/httpapi</a> на <a href="https://api2.amplitude.com/identify">https://api2.amplitude.com/identify</a>:  </p><pre><code>class AmplitudeLogger:
    def __init__(self, api_key, api_uri="https://api2.amplitude.com/identify"):
        self.api_key = api_key
        self.api_uri = api_uri
        self.is_logging = True</code></pre><p>Теперь все сообщения пойдут в API обогащения профиля пользователей. Также нам пришлось исключить (закомментировать) блок названий типа событий. Он уже не требуется при доставке профиля пользователей. Исходный вариант блока:  </p><pre><code>event_type = kwargs.get('event_type', None)
        if self._is_None_or_not_str(event_type):
            return None

        event["event_type"] = event_type</code></pre><p>После исключения/закомментирования:  </p><pre><code>		#event_type = kwargs.get('event_type', None)
        #if self._is_None_or_not_str(event_type):
            #return None

        #event["event_type"] = event_type</code></pre><p>Блок свойств события заменяем на свойства клиента. Исходный блок:</p><pre><code>event_properties = kwargs.get('event_properties', None)
		if event_properties is not None and type(event_properties) == dict:
			event["event_properties"] = event_properties</code></pre><p>Заменяем на:  </p><pre><code>user_properties = kwargs.get('user_properties', None)
        event["user_properties"] = user_properties</code></pre><p><strong>Шаг 2. Настройка передачи событий в Amplitude</strong></p><p>Cкриптом передаем наши s2s обогащения профилей, где USERID это ваш ключ клиента между системами. Например:  </p><pre><code>amplitude_logger = amplitude.AmplitudeLogger(api_key = "Ключик")
    
	# собираем событие на примере обогащения CRM категорий
    event_args = {"user_id": str(USERID),
                  "user_properties":{"CRM_Segment":str(SEGMENT), "CRM_Group": str(GROUP), "CRM_Level": str(LEVEL)}}
    event = amplitude_logger.create_event(**event_args)
    
    # отправляем в Amplitude
    amplitude_logger.log_event(event)</code></pre><p>Готово! Данные должны отображаться в Amplitude:  </p><figure class=""><img src="/img/image-loader.svg" height="154" data-src="https://habrastorage.org/getpro/habr/upload_files/16f/ef1/08b/16fef108b19518b57da1426008a73c23.png" data-width="369"/><figcaption></figcaption></figure><p><strong>Шаг 3. Очередь доставки</strong></p><p>У нас такой подход: запросил запись на отправку -> отправил -> зафиксировал в очереди, что отправлено.</p><p>Пример получения записи для отправки профиля. Используется singlе обработка результата из 4 столбцов. Далее полученные данные раскладываются и передаются уже в s2s запросе, на примере выше.  </p><pre><code>conn = pymssql.connect(server, user, password, database)
    cursor = conn.cursor()
    query = "СЕЛЕКТ таблицы или ВЫЗОВ процедуры"
    cursor.execute(query)

    for row in cursor:
     
        USERID = row[0]
        SEGMENT = row[1]
        LEVEL = row[2]
        GROUP = row[3]
    conn.commit() 
    conn.close()  </code></pre><p>Именно так проходит обогащение данных в Amplitude в Лиге Ставок.</p><p>В будущих обновлениях <a href="https://amplitude.adventum.ru/champion-liga-stavok">спецпроекта</a> мы расскажем, как команда маркетинга использует сервис продуктовой аналитики в своей работе. </p><p><a href="https://hh.ru/employer/223129">А здесь можно посмотреть, кто нам нужен в команду, в том числе по продукту и аналитике</a>, например, <a href="https://hh.ru/vacancy/46736251?from=employer">Руководитель направления DWH </a>или <a href="https://hh.ru/vacancy/46351199?from=employer">Head of Product Department</a></p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BB%D0%B8%D0%B3%D0%B0%20%D1%81%D1%82%D0%B0%D0%B2%D0%BE%D0%BA%5D" class="tm-tags-list__link">лига ставок</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B1%D0%B8%D0%B3%20%D0%B4%D0%B0%D1%82%D0%B0%5D" class="tm-tags-list__link">биг дата</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%5D" class="tm-tags-list__link">анализ данных</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D1%80%D0%BE%D0%B4%D1%83%D0%BA%D1%82%D0%BE%D0%B2%D0%B0%D1%8F%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D1%82%D0%B8%D0%BA%D0%B0%5D" class="tm-tags-list__link">продуктовая аналитика</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D1%80%D0%BE%D0%B4%D1%83%D0%BA%D1%82%D0%BE%D0%B2%D0%B0%D1%8F%20%D0%BA%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4%D0%B0%5D" class="tm-tags-list__link">продуктовая команда</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bdwn%5D" class="tm-tags-list__link">dwn</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BF%D1%80%D0%BE%D0%B4%D1%83%D0%BA%D1%82%D0%BE%D0%BC%5D" class="tm-tags-list__link">управление продуктом</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D1%82%D0%B8%D0%BA%D0%B0%5D" class="tm-tags-list__link">аналитика</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D1%82%D0%B8%D0%BA%D0%B0%20%D0%BC%D0%BE%D0%B1%D0%B8%D0%BB%D1%8C%D0%BD%D1%8B%D1%85%20%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9%5D" class="tm-tags-list__link">аналитика мобильных приложений</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bproduct%5D" class="tm-tags-list__link">product</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/company/ligastavok/blog/" class="tm-hubs-list__link router-link-active">
    Блог компании Лига Ставок
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/bigdata/" class="tm-hubs-list__link">
    Big Data
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/mobileanalytics/" class="tm-hubs-list__link">
    Аналитика мобильных приложений
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/productpm/" class="tm-hubs-list__link">
    Управление продуктом
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/data_engineering/" class="tm-hubs-list__link">
    Data Engineering
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 2: ↑1 и ↓1</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 2: ↑1 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_medium">0</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">270</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    6
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="/ru/company/ligastavok/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" height="40" src="//habrastorage.org/getpro/habr/company/dec/f8d/87c/decf8d87cf0971a9d5ed43157e76c1b0.jpg" width="40" class="tm-entity-image__pic"></div></a> <div class="tm-company-snippet__info"><a href="/ru/company/ligastavok/profile/" class="tm-company-snippet__title">Лига Ставок</a> <div class="tm-company-snippet__description">Компания</div></div></div> <div class="tm-article-author__buttons"><!----> <!----></div></div> <div class="tm-article-author__company-contacts"><a href="https://www.ligastavok.ru/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a></div> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/helloageeva/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/35a/dd2/302/35add23025db047565eb30b40b770254.png" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 20 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_negative">
    -2
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/helloageeva/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @helloageeva
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/company/ligastavok/blog/581894/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментировать 
    </span></a> <!----></div></div></div>  <!---->  <!----> <!----></div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section class="tm-block tm-block_spacing-bottom"><header class="tm-block__header"><h2 class="tm-block__title">Информация</h2> <!----></header> <div class="tm-block__body"><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата основания</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><span>
      2008
    </span></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Местоположение</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    Россия
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Сайт</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="https://www.ligastavok.ru/promo/people" target="_blank" class="tm-company-basic-info__link">
      www.ligastavok.ru
    </a></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Численность</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    1 001–5 000 человек
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата регистрации</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2020-10-28T08:00:21.000Z" title="2020-10-28, 11:00">28  октября  2020</time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Представитель</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="/ru/users/helloageeva/" class="tm-company-basic-info__link">
      helloageeva
    </a></dd></dl></div></div> <!----></section> <div class="tm-company-widgets"></div> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/company/ligastavok/blog/581894/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/company/ligastavok/blog/581894/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"581894":{"id":"581894","timePublished":"2021-10-06T11:16:19+00:00","isCorporative":true,"lang":"ru","titleHtml":"Как дополнить данные в Amplitude информацией из CRM и других систем с помощью S2S событий","leadData":{"textHtml":"\u003Cp\u003EМежсерверные (server-to-server или S2S) события позволяют отслеживать кастомные события и параметры через HTTP запросы. Они часто используются в мобильной атрибуции, например, в Appsflyer или в Adjust. При этом S2S события можно использовать и в Amplitude. Рассказываем как это настроить.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F774\u002F45d\u002Fe86\u002F77445de86a6ed512d5daaf11a0d51e72.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F774\u002F45d\u002Fe86\u002F77445de86a6ed512d5daaf11a0d51e72.png","fit":"cover","positionY":0,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"recovery","data":null},{"type":"tutorial","data":null}],"author":{"scoreStats":{"score":-2,"votesCount":20},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"2460033","alias":"helloageeva","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F35a\u002Fdd2\u002F302\u002F35add23025db047565eb30b40b770254.png","speciality":"Пользователь"},"statistics":{"commentsCount":0,"favoritesCount":6,"readingCount":270,"score":0,"votesCount":2},"hubs":[{"relatedData":null,"id":"22582","alias":"ligastavok","type":"corporative","title":"Блог компании Лига Ставок","titleHtml":"Блог компании Лига Ставок","isProfiled":false},{"relatedData":null,"id":"17795","alias":"bigdata","type":"collective","title":"Big Data","titleHtml":"Big Data","isProfiled":true},{"relatedData":null,"id":"20724","alias":"mobileanalytics","type":"collective","title":"Аналитика мобильных приложений","titleHtml":"Аналитика мобильных приложений","isProfiled":true},{"relatedData":null,"id":"20726","alias":"productpm","type":"collective","title":"Управление продуктом","titleHtml":"Управление продуктом","isProfiled":true},{"relatedData":null,"id":"22374","alias":"data_engineering","type":"collective","title":"Data Engineering","titleHtml":"Data Engineering","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"},{"id":"4","alias":"marketing","title":"Маркетинг"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EВ рамках спецпроекта \u003Ca href=\"https:\u002F\u002Famplitude.adventum.ru\u002Fchampion-liga-stavok\"\u003EProduct Analytics Champions\u003C\u002Fa\u003E рассказываем, как и зачем используют S2S обогащение Amplitude через стандартные API.  \u003C\u002Fp\u003E\u003Ch2\u003EЧто такое S2S события и зачем они нужны  \u003C\u002Fh2\u003E\u003Cp\u003EМежсерверные (server-to-server или S2S) события позволяют отслеживать кастомные события и параметры через HTTP запросы. Они часто используются в мобильной атрибуции, например, в Appsflyer или в Adjust.\u003C\u002Fp\u003E\u003Cp\u003EПри этом S2S события можно использовать и в Amplitude. Для прометки большинства событий, их свойств и параметров пользователей достаточно стандартного SDK Amplitude. К S2S событиям стоит прибегать при импорте данных из других систем, которые сложно передавать напрямую в Amplitude.  \u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EПримеры использования такой интеграции:\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003E1. Можно отправлять свойства пользователей из CRM (например, количество покупок или дату регистрации на сайте\u002Fприложении) даже для тех тех, кого еще нет в Amplitude. После того, как они появятся в Amplitude, данные по ним смэчатся по user ID. Это полезно на начальных этапах, когда еще не все пользователи появились в Amplitude.\u003C\u002Fp\u003E\u003Cp\u003E2. Можно передавать события \"выкупа заказа\", например, для приложений с самовывозом, чтобы события самого заказа в приложении дополнялись еще событиями финальной оффлайновой точки воронки.\u003C\u002Fp\u003E\u003Cp\u003EХотим рассказать, как это способ используется в Лиге Ставок. Мы широко применяем сервис продуктовой аналитики Amplitude для анализа поведения пользователей. Например, это помогает нам \u003Ca href=\"https:\u002F\u002Famplitude.adventum.ru\u002Fchampion-liga-stavok\u002Fbug-analytics-in-amplitude\"\u003Eсокращать количество ошибок\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Famplitude.adventum.ru\u002Fspecials\u002Fliga-stavok\u002Fconversion-rate-optimization-case\"\u003Eувеличивать конверсию в регистрацию\u003C\u002Fa\u003E. При этом мы собираем дополнительные данные по пользователям в CRM и других системах. Их нет в Amplitude, но с ними можно анализировать большее количество срезов, чем есть в разметке.\u003C\u002Fp\u003E\u003Cp\u003EТак в Лиге Ставок создали систему межсерверного (S2S) обогащения Amplitude через стандартные API, чтобы глубже анализировать поведение и свойства своих клиентов.  \u003C\u002Fp\u003E\u003Ch2\u003EЧто нужно для такого обмена данными  \u003C\u002Fh2\u003E\u003Cp\u003E1. Определите параметры, которые вы хотите дополнительно передавать в Amplitude для работы с функциями сервиса и уже существующими событиями\u002Fсвойствами пользователей. Например:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EКатегории по доходу и другая финансовая информация\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EКонверсии, которые не покрываются разметкой (например, переходы на сторонние web-view из приложения)\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E2. Определите источники данных:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003ECRM\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EСистемы веб-аналитики\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EВнутреннее хранилище данных (DWH)\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EИ другие\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E3. Python 3.7 (и выше) для настройки передачи данных.  \u003C\u002Fp\u003E\u003Ch2\u003EИнструкция по настройке s2s передачи данных  \u003C\u002Fh2\u003E\u003Cp\u003EУ Amplitude есть свой API выдачи сырых данных по проекту. Подробную документацию по нему можно найти \u003Ca href=\"https:\u002F\u002Fdevelopers.amplitude.com\u002Fdocs\u002Fexport-api?source=adventum\"\u003Eпо ссылке\u003C\u002Fa\u003E. Для пуша событий мы используем \u003Ca href=\"https:\u002F\u002Fapi.amplitude.com\u002Fhttpapi\"\u003Ehttps:\u002F\u002Fapi2.amplitude.com\u002Fhttpapi\u003C\u002Fa\u003E или будущие обновления из документации, обычно они идут с приставками 2, 3 и т.д. Для обогащения профиля пользователя берем точку \u003Ca href=\"https:\u002F\u002Fapi2.amplitude.com\u002Fidentify\"\u003Ehttps:\u002F\u002Fapi2.amplitude.com\u002Fidentify\u003C\u002Fa\u003E. Ключ авторизации берется из настроек проекта в Amplitude:  \u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"431\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F774\u002F45d\u002Fe86\u002F77445de86a6ed512d5daaf11a0d51e72.png\" data-width=\"916\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Cstrong\u003EКод\u003C\u002Fstrong\u003E. Стоит отметить, что в Лиге Ставок намеренно пишут простые агенты, понятные даже начинающим аналитикам.  \u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EШаг 1. Агент доставки s2s событий\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EДля создания агента понадобится всего две библиотеки:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eimport amplitude\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eimport pymssql\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EВ нашем случае источником выступает MSSQL хранилище данных. По умолчанию библиотека Amplitude позволяет вам отправлять события, аналогичные SDK разметке. Формируется JSON с вашим набором данных и отправляется в API Amplitude, все просто.\u003C\u002Fp\u003E\u003Cp\u003EНесмотря на то, что в мы в Лиге не стали писать код с нуля и используем готовую библиотеку, нам пришлось ее немного изменить. А именно — добавить точку отправки профиля клиента. Далее будет описан пример корректировки библиотеки, но, конечно, лучше написать своей параметризованный код.\u003C\u002Fp\u003E\u003Cp\u003EПереходим к корректировкам в библиотеке. Изменения коснулись блока AmplitudeLogger, где заменили ссылку \u003Ca href=\"https:\u002F\u002Fapi.amplitude.com\u002Fhttpapi\"\u003Ehttps:\u002F\u002Fapi2.amplitude.com\u002Fhttpapi\u003C\u002Fa\u003E на \u003Ca href=\"https:\u002F\u002Fapi2.amplitude.com\u002Fidentify\"\u003Ehttps:\u002F\u002Fapi2.amplitude.com\u002Fidentify\u003C\u002Fa\u003E:  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Eclass AmplitudeLogger:\n    def __init__(self, api_key, api_uri=\"https:\u002F\u002Fapi2.amplitude.com\u002Fidentify\"):\n        self.api_key = api_key\n        self.api_uri = api_uri\n        self.is_logging = True\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТеперь все сообщения пойдут в API обогащения профиля пользователей. Также нам пришлось исключить (закомментировать) блок названий типа событий. Он уже не требуется при доставке профиля пользователей. Исходный вариант блока:  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Eevent_type = kwargs.get('event_type', None)\n        if self._is_None_or_not_str(event_type):\n            return None\n\n        event[\"event_type\"] = event_type\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПосле исключения\u002Fзакомментирования:  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E\t\t#event_type = kwargs.get('event_type', None)\n        #if self._is_None_or_not_str(event_type):\n            #return None\n\n        #event[\"event_type\"] = event_type\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EБлок свойств события заменяем на свойства клиента. Исходный блок:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Eevent_properties = kwargs.get('event_properties', None)\n\t\tif event_properties is not None and type(event_properties) == dict:\n\t\t\tevent[\"event_properties\"] = event_properties\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЗаменяем на:  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Euser_properties = kwargs.get('user_properties', None)\n        event[\"user_properties\"] = user_properties\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cstrong\u003EШаг 2. Настройка передачи событий в Amplitude\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003ECкриптом передаем наши s2s обогащения профилей, где USERID это ваш ключ клиента между системами. Например:  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Eamplitude_logger = amplitude.AmplitudeLogger(api_key = \"Ключик\")\n    \n\t# собираем событие на примере обогащения CRM категорий\n    event_args = {\"user_id\": str(USERID),\n                  \"user_properties\":{\"CRM_Segment\":str(SEGMENT), \"CRM_Group\": str(GROUP), \"CRM_Level\": str(LEVEL)}}\n    event = amplitude_logger.create_event(**event_args)\n    \n    # отправляем в Amplitude\n    amplitude_logger.log_event(event)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EГотово! Данные должны отображаться в Amplitude:  \u003C\u002Fp\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"154\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F16f\u002Fef1\u002F08b\u002F16fef108b19518b57da1426008a73c23.png\" data-width=\"369\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Cstrong\u003EШаг 3. Очередь доставки\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EУ нас такой подход: запросил запись на отправку -\u003E отправил -\u003E зафиксировал в очереди, что отправлено.\u003C\u002Fp\u003E\u003Cp\u003EПример получения записи для отправки профиля. Используется singlе обработка результата из 4 столбцов. Далее полученные данные раскладываются и передаются уже в s2s запросе, на примере выше.  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Econn = pymssql.connect(server, user, password, database)\n    cursor = conn.cursor()\n    query = \"СЕЛЕКТ таблицы или ВЫЗОВ процедуры\"\n    cursor.execute(query)\n\n    for row in cursor:\n     \n        USERID = row[0]\n        SEGMENT = row[1]\n        LEVEL = row[2]\n        GROUP = row[3]\n    conn.commit() \n    conn.close()  \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EИменно так проходит обогащение данных в Amplitude в Лиге Ставок.\u003C\u002Fp\u003E\u003Cp\u003EВ будущих обновлениях \u003Ca href=\"https:\u002F\u002Famplitude.adventum.ru\u002Fchampion-liga-stavok\"\u003Eспецпроекта\u003C\u002Fa\u003E мы расскажем, как команда маркетинга использует сервис продуктовой аналитики в своей работе. \u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fhh.ru\u002Femployer\u002F223129\"\u003EА здесь можно посмотреть, кто нам нужен в команду, в том числе по продукту и аналитике\u003C\u002Fa\u003E, например, \u003Ca href=\"https:\u002F\u002Fhh.ru\u002Fvacancy\u002F46736251?from=employer\"\u003EРуководитель направления DWH \u003C\u002Fa\u003Eили \u003Ca href=\"https:\u002F\u002Fhh.ru\u002Fvacancy\u002F46351199?from=employer\"\u003EHead of Product Department\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"лига ставок"},{"titleHtml":"биг дата"},{"titleHtml":"анализ данных"},{"titleHtml":"продуктовая аналитика"},{"titleHtml":"продуктовая команда"},{"titleHtml":"dwn"},{"titleHtml":"управление продуктом"},{"titleHtml":"аналитика"},{"titleHtml":"аналитика мобильных приложений"},{"titleHtml":"product"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F774\u002F45d\u002Fe86\u002F77445de86a6ed512d5daaf11a0d51e72.png","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F774\u002F45d\u002Fe86\u002F77445de86a6ed512d5daaf11a0d51e72.png","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fligastavok\\\u002Fblog\\\u002F581894\\\u002F\"},\"headline\":\"Как дополнить данные в Amplitude информацией из CRM и других систем с помощью S2S событий\",\"datePublished\":\"2021-10-06T14:16:19+03:00\",\"dateModified\":\"2021-10-06T16:05:35+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"helloageeva\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"В рамках спецпроекта&nbsp;Product Analytics Champions рассказываем, как и зачем используют S2S обогащение Amplitude через стандартные API.  Что такое S2S события и за...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fligastavok\\\u002Fblog\\\u002F581894\\\u002F#post-content-body\",\"about\":[\"c_ligastavok\",\"h_bigdata\",\"h_mobileanalytics\",\"h_productpm\",\"h_data_engineering\",\"f_develop\",\"f_management\",\"f_marketing\",\"f_admin\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F581894\\\u002F79b2d70736dacb9313206cc10338ae76\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F774\\\u002F45d\\\u002Fe86\\\u002F77445de86a6ed512d5daaf11a0d51e72.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F16f\\\u002Fef1\\\u002F08b\\\u002F16fef108b19518b57da1426008a73c23.png\"]}","metaDescription":"В рамках спецпроекта&nbsp;Product Analytics Champions рассказываем, как и зачем используют S2S обогащение Amplitude через стандартные API.  Что такое S2S события и зачем они нужны  Межсерверные...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{"ligastavok":{"alias":"ligastavok","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002Fdec\u002Ff8d\u002F87c\u002Fdecf8d87cf0971a9d5ed43157e76c1b0.jpg","titleHtml":"Лига Ставок","descriptionHtml":"","relatedData":null,"statistics":{"postsCount":10,"newsCount":4,"vacanciesCount":0,"employeesCount":8,"careerRating":null,"subscribersCount":35,"rating":40.48,"invest":null},"foundationDate":{"year":"2008","month":null,"day":null},"location":{"city":{"id":"447159","title":"Москва"},"region":{"id":"1885","title":"Москва и Московская обл."},"country":{"id":"168","title":"Россия"}},"siteUrl":"https:\u002F\u002Fwww.ligastavok.ru\u002Fpromo\u002Fpeople","staffNumber":"1 001–5 000 человек","registrationDate":"2020-10-28T08:00:21+00:00","representativeUser":{"alias":"helloageeva","fullname":null},"contacts":[{"title":"Сайт","url":"https:\u002F\u002Fwww.ligastavok.ru\u002F"}],"settings":{"analyticsSettings":[],"branding":null,"status":"active"},"metadata":{"titleHtml":"Лига Ставок, Москва -  с 2008 год","title":"Лига Ставок, Москва -  с 2008 год","keywords":["Dart","Flutter","Управление продуктом","Игры и игровые приставки","Киберспорт"],"descriptionHtml":"10 статей от авторов компании Лига Ставок","description":"10 статей от авторов компании Лига Ставок"},"aDeskSettings":null,"careerAlias":"ligastavok","maxCustomTrackerLinks":0}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
