<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Как с применением Power BI создавалась система анализа финансово-хозяйственной деятельности предприятий России и зачем / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/581030\/"},"headline":"Как с применением Power BI создавалась система анализа финансово-хозяйственной деятельности предприятий России и зачем","datePublished":"2021-10-18T01:18:51+03:00","dateModified":"2021-10-19T13:17:16+03:00","author":{"@type":"Person","name":"Гуреев Кирилл"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Вместо вступления выражаю надеждуИдея для данной работы вынашивалась какое-то время. Ранее не хватало навыков и знаний, но задавшись целью в течении года (52 нед...","url":"https:\/\/habr.com\/ru\/post\/581030\/#post-content-body","about":["h_bigdata","f_develop"],"image":["https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/80c\/44c\/e0e\/80c44ce0e4c93d4adf2f67fcb335ffff.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/8bf\/556\/e43\/8bf556e43d58e5cbca82daa0c2b13952.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/b8c\/866\/f2e\/b8c866f2e1aa65db6207634e10a8d1aa.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/431\/a58\/1fc\/431a581fc6d3bc3eac89bf075db83c5d.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/b75\/350\/52d\/b7535052de02e594b6d7e514d20d1058.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/f4d\/8e1\/1bb\/f4d8e11bb2b4b1432297bd904c710a1b.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/d88\/b2e\/d9c\/d88b2ed9cb354e9e6ad6d3e77d16b703.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/c09\/86e\/a7d\/c0986ea7d2317319d6925e91edda76a1.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/4f7\/bd6\/bc2\/4f7bd6bc278d062a507ca64261bb39de.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/d36\/a34\/55a\/d36a3455aff7872afd1ff886b748bd28.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/f44\/77d\/2c8\/f4477d2c8517cbfbe6f3a008021ef5e3.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/141\/456\/2fb\/1414562fb3be2a16b30a22b179a35a24.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/e86\/df0\/677\/e86df0677b5c5a980f73d41e20f6ad83.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/92a\/4fc\/393\/92a4fc3936cad54029f3de0263e711a9.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/737\/d17\/cde\/737d17cdeb27aab9e553b2ceaf545644.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Как с применением Power BI создавалась система анализа финансово-хозяйственной деятельности предприятий России и зачем" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Как с применением Power BI создавалась система анализа финансово-хозяйственной деятельности предприятий России и зачем" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Как с применением Power BI создавалась система анализа финансово-хозяйственной деятельности предприятий России и зачем" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Вместо вступления выражаю надеждуИдея для данной работы вынашивалась какое-то время. Ранее не хватало навыков и знаний, но задавшись целью в течении года (52 недели по 16 часов работы = 832 часа..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Вместо вступления выражаю надеждуИдея для данной работы вынашивалась какое-то время. Ранее не хватало навыков и знаний, но задавшись целью в течении года (52 недели по 16 часов работы = 832 часа..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Вместо вступления выражаю надеждуИдея для данной работы вынашивалась какое-то время. Ранее не хватало навыков и знаний, но задавшись целью в течении года (52 недели по 16 часов работы = 832 часа..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Вместо вступления выражаю надеждуИдея для данной работы вынашивалась какое-то время. Ранее не хватало навыков и знаний, но задавшись целью в течении года (52 недели по 16 часов работы = 832 часа..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Вместо вступления выражаю надеждуИдея для данной работы вынашивалась какое-то время. Ранее не хватало навыков и знаний, но задавшись целью в течении года (52 недели по 16 часов работы = 832 часа..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/581030/e00c693e9772343328b1370a871b6822/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/581030/e00c693e9772343328b1370a871b6822/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/581030/e00c693e9772343328b1370a871b6822/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/581030/e00c693e9772343328b1370a871b6822/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/581030/e00c693e9772343328b1370a871b6822/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="581030" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-17T22:18:51.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/581030/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/581030/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/581030/e00c693e9772343328b1370a871b6822/" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/581030/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/rick1177/" title="rick1177" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/92d/4f1/4c7/92d4f14c741d9ead7e1afda47d56d2ec.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/rick1177/" class="tm-user-info__username">
      rick1177
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-17T22:18:51.000Z" title="2021-10-18, 01:18">18  октября   в 01:18</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Как с применением Power BI создавалась система анализа финансово-хозяйственной деятельности предприятий России и зачем</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/bigdata/" class="tm-article-snippet__hubs-item-link"><span>Big Data</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><p><strong>Вместо вступления выражаю надежду<br/><br/></strong>Идея для данной работы вынашивалась какое-то время. Ранее не хватало навыков и знаний, но задавшись целью в течении года (52 недели по 16 часов работы = 832 часа (примерно, конечно же)) были изучены 2 инструмента работы с большими данными и методами построения отчётов.  Увиденный вами результат - следствие кропотливой работы, которая, в силу обстоятельств, описываемых ниже, скорее всего на этом и остановится. Однако! Вдруг кем-то будет замечена, получено продолжение и вырастет в нечто замечательное (надеюсь, что и я вместе с ней).<br/><br/>Все представленные данные отныне являются полностью открытыми и каждый сможет повторить сделанное или взять уже готовое. Проделать данную работу мне не удалось бы без стимулирующего фактора - студентов, жаждущих новых знаний и вынуждающих двигаться вперёд, чтобы не выглядеть некрасиво. Также следует отметить, что и без технических возможностей Пермского национального исследовательского политехнического университета я бы также не обошёлся, поскольку домашних вычислительных мощностей просто не хватило бы. <br/><br/>Итоговое решение я выкладываю на своём канале в Telegram, включая ссылки для скачивания баз-данных (вдруг пропадут). Искренне надеюсь, что для читающих не составит труда подписаться ну и поддержать меня и мой труд.</p><p><strong>Кому будет интересна данная статья?</strong><br/><br/>В сети, лично для меня, было достаточно трудно искать решение какой-либо сквозной задачи с применением Power BI. Т.е. есть отдельные частные примеры, есть учебники и видеоуроки и в целом много материала. Однако, достаточно мало полноценных мастер-классов, где даётся разъяснение всех этапов выполнения задания. По этой причине первая группа заинтересованных -  те, кто ищет подобный кейс с достаточно обывательским рассказом о причинах свершения тех или иных шагов.<br/><br/>Вторым заинтересованным лицом можно обозначить человека, имеющего отношение к миру финансов, анализу деятельности предприятий, кредитующих организаций. Продукт нацелен на представление информации о деятельности "совокупности" предприятий, что может помочь аналитику оценить состояние этой самой совокупности, детализировать отдельные её части и, наконец-то, осознать, что общепринятые коэффициенты оценки финансового состояния, методы оценки, зачастую, неприменимы к части субъектов рынка. Но об этом позже.<br/><br/>В качестве третьего заинтересованного можно выделить учёного-экономиста, аналитика, разрабатывающего  какие-либо актуальные подходы к оценке финансового состояния предприятия, отрасли, региона. <br/><br/>Отдельно хочется обратить внимание на данную работу участников экономики, принимающих решения в части поддержки, финансирования, развития и т.д. Возможно для вас данный материал послужит основой для анализа и принятия решений.</p><p> <strong>Почему на этом этапе данная работа может увянуть?</strong>  <strong><br/><br/></strong>Всё просто. Приложение выстраивается на открытых данных, предоставляемых сайтом <a href="https://rosstat.gov.ru/" rel="noopener noreferrer nofollow">Федеральной службы государственной статистики</a>. На момент написания статьи данные находились по данной <a href="https://rosstat.gov.ru/opendata?division=&amp;tag=13&amp;updated_from=&amp;updated_to=&amp;search=&amp;search_by_name=on&amp;sort=&amp;per_page=40" rel="noopener noreferrer nofollow">ссылке</a>. Если посмотреть, то 2018 - последний год, когда данные присутствуют. В дальнейшем было принято решение распространять массив данных по подписке, о чём свидетельствует <a href="https://bo.nalog.ru/subscriptions-service" rel="noopener noreferrer nofollow">данный ресурс</a> и данная запись на сайте <a href="https://www.nalog.gov.ru/rn77/news/activities_fts/9809967/" rel="noopener noreferrer nofollow">Федеральной налоговой службы</a>. Чтобы получить свежий массив данных нужно уплатить 200 т.р. Очень хитрая манипуляция) Т.е. данные, вроде как, распространяются бесплатно, т.е. можно посмотреть информацию про любого агента, но вот получить массив - это уже по подписке. <br/><br/>Надо сказать , что модель бизнеса очень прикольная. Получается, что ФНС обязала всех проверять своих контрагентов, в рамках проведения мероприятий по налоговому контролю в отношении соблюдения принципа должной осмотрительности и осторожности при выборе контрагента, используя открытые источники. Наплодились сайты, где формируется сводка по предприятиям, а потом ФНС взяла и принудила их уплачивать абонентскую плату, а данные собирает в обязательном порядке и бесплатно. Отличная модель.<br/><br/>Поскольку вся работа выстраивается на голом энтузиазме и собственными силами, то, конечно же, выплачивать такие средства у меня возможности нет. Объяснить руководству ВУЗа необходимость такой покупки я тоже не смогу, поскольку мы на самоокупаемости и без продаж результатов не будет финансирования. Так что, если не найдётся помощь, то и работа останавливается на достигнутом. <br/><br/>Но уже и этого результата достаточно, чтобы интересно и плодотворно поработать.</p><p><strong>Дисклеймер (отказ от ответственности за переработку данных)</strong>  <br/><br/>Будучи преисполненным уверенности, что работа ФНС - крайне кропотливый труд, а работники и система педантичны и точны, вначале я решал возникающие перед моим взором задачи, как задачи, по управлению, с корректными данными. Однако, в какой-то момент наступило понимание, что база вся в "дырах" и ошибках. Когда эти ошибки накапливаются, то анализ становится невозможным. <br/><br/>Обнаруживается это элементарным суммированием всех балансов предприятий по статьям в группы и попыткой сопоставить дебет с кредитом. Когда сопоставление не пошло, то стало понятно, что ошибка именно в данных.<br/><br/>Чтобы не быть голословным, давайте посмотрим некоторые совершенно случайные примеры, обнаруживаемые на момент написания статьи.<br/><br/>Рассмотрим предприятие Общество с ограниченной ответственностью сельскохозяйственный производственный комплекс «Аргамак». Отчётность данного предприятия Вы можете запросить (смотрим 2018 год) на <a href="https://www.gks.ru/accounting_report" rel="noopener noreferrer nofollow">официальном сайте статистики </a>по ИНН (0228005239) или на любом другом сайте, где представлена информация о предприятиях, например, <a href="https://www.list-org.com/company/4347724/report" rel="noopener noreferrer nofollow">здесь</a>. Что же мы обнаруживаем при просмотре  (сократив общий вид, чтобы уменьшить изображение)?</p><figure class="full-width "><img src="/img/image-loader.svg" height="1224" data-src="https://habrastorage.org/getpro/habr/upload_files/80c/44c/e0e/80c44ce0e4c93d4adf2f67fcb335ffff.png" data-width="1349"/><figcaption></figcaption></figure><p>А обнаруживаем мы, что сумма по трём разделам баланса, предприятия (выделяются красным цветом) не соответствует проставленной сумме в итоговом Балансе (фиолетовая отметка). <br/><br/>В качестве второго примера можно представить ООО "ТАТТРАНСКОНТУР" (1650109381), где всё по тому же 2018 году обнаруживается подобная ситуация:</p><figure class="full-width "><img src="/img/image-loader.svg" height="1378" data-src="https://habrastorage.org/getpro/habr/upload_files/8bf/556/e43/8bf556e43d58e5cbca82daa0c2b13952.png" data-width="1460"/><figcaption></figcaption></figure><p>Здесь специально взяты различные сайты, где, в том числе, производится оценка финансово-хозяйственной деятельности предприятий (видимо на основе этих ошибочных данных) . <br/><br/>Мы не будем искать виноватого и пытаться судить о том, на каком этапе возникла данная проблема, однако, проводить задуманный анализ на этих данных было бы некорректно.</p><p>Я взял на себя смелость скорректировать балансы предприятий по определённой модели, за что прошу прощения. Мне пришлось пережить дискуссию с весьма уважаемыми датасаянтистами на эту тему, но вот на такой позиции я остался.</p><p><strong>Особенности процесса импорта или "Мощный запрос"</strong>  (Power query)</p><p>Для дальнейшего изложения требуется ознакомиться с логикой создания приложения с применением Power BI:</p><figure class="float full-width "><img src="/img/image-loader.svg" height="5726" data-src="https://habrastorage.org/getpro/habr/upload_files/b8c/866/f2e/b8c866f2e1aa65db6207634e10a8d1aa.png" data-width="9131"/><figcaption></figcaption></figure><p>Условно вся работа разделяется между Power Query и Power BI. PQ отвечает за создание соединений с данными, переработку до нужно вида и интеграцию результата в общую модель данных.<br/>В Power BI производится структурирование данных, если они из разных источников, группировка, при необходимости производятся дополнительные вычисления, создание новых мер и таблиц данных, необходимых для нужного отображения данных и подготовка конечного вида отчёта, максимально презентабельного для данной задачи. </p><p>Исходи из сказанного, ранее произнесённая фраза "Я взял на себя смелость скорректировать балансы предприятий " правильно звучит так: "В процессе подготовки данных они были частично модифицированы без нарушения  целостности".</p><p>После открытия Power BI самым целесообразным, по моему убеждению, является переход в редактор Power Query. Не смотря на то, что есть предподготовленные диалоги импорта данных, склоняю вас к написанию кода в "чистом" виде. Тем не менее должен сказать, что Power Query предлагает графический интерфейс для многих действий. Переход в PQ выглядит так:</p><figure class="full-width "><img src="/img/image-loader.svg" height="285" data-src="https://habrastorage.org/getpro/habr/upload_files/431/a58/1fc/431a581fc6d3bc3eac89bf075db83c5d.png" data-width="1035"/><figcaption></figcaption></figure><figure class="float "><img src="/img/image-loader.svg" height="522" data-src="https://habrastorage.org/getpro/habr/upload_files/b75/350/52d/b7535052de02e594b6d7e514d20d1058.png" data-width="285"/><figcaption></figcaption></figure><p>После попадания в PQ можно сформировать необходимый запрос, воспользовавшись имеющимися диалогами, однако, моим предпочтением является создание пустого запроса. Поскольку любые действия в PQ - выполнение функции, то всё, что нам необходимо выполнить прописывается "ручками".<br/><br/>Вначале, поскольку все файлы будут лежать в одном месте, целесообразно прописать путь к файлам, который будет использоваться во всех запросах. <br/><br/>При выполнении работы соблюдалась логика, что при вводе запроса для каждого нового файла потребуется лишь изменить год.</p><pre><code>let
    #"Директория хранения файлов" = "\\ns\Public\Power BI\Data\"
in
    #"Директория хранения файлов"</code></pre><p>Соответственно, прописав однажды путь, значительно упрощается жизнь. Сам запрос был назван <strong>FilesDirectory</strong>.</p><p>Далее формируются тексты запросов для каждого года. Надо отметить, что запрос для 2011 года выстраивается на данных 2012, поэтому ниже приведён отдельно:</p><details class="spoiler"><summary>2011</summary><div class="spoiler__content"><pre><code>let
    #"Год" = 2012,
	#"Путь расположения файлов" = #"FilesDirectory",
	#"Наименование файла данных" = Lines.ToText(
					{
						"data-20200331-structure-",
						Number.ToText(#"Год"),
						"1231"
					},
					"") as text,
	#"Наименование файла структуры" = Lines.ToText(
					{
						"structure-",
						Number.ToText(#"Год"),
						"1231"
					},
					"") as text,
	#"Расширение файла" = "csv",
	#"Длина таблица данных" = 124,
	
	#"Импорт_1" = Lines.ToText(
		{
			#"Путь расположения файлов",
			#"Наименование файла данных",
			".",
			#"Расширение файла"			
		},
		"") as text,
	#"Данные_1" = Csv.Document(File.Contents(#"Импорт_1"),
												[Delimiter=";", 
												Columns=#"Длина таблица данных", 
												Encoding=1251, 
												QuoteStyle=QuoteStyle.None]),
	#"Импорт_2" = Lines.ToText(
		{
			#"Путь расположения файлов",
			"Help",
			".",
			#"Расширение файла"			
		},
		"") as text,
	#"Расшифровка_1" = Csv.Document(File.Contents(#"Импорт_2"),
												[Delimiter=";", 
												Columns=3, 
												Encoding=1251, 
												QuoteStyle=QuoteStyle.None]),	
	#"Расшифровка_2" = Table.RenameColumns(#"Расшифровка_1",{{"Column1", "Numer"}, {"Column2", "Name_RUS"}, {"Column3", "Name_ENG"}}),
	
	#"Импорт_3" = Lines.ToText(
		{
			#"Путь расположения файлов",
			#"Наименование файла структуры",
			".",
			#"Расширение файла"			
		},
		"") as text,
	#"Структура_1" = Csv.Document(File.Contents(#"Импорт_3"),
												[Delimiter=",", 
												Columns=4, 
												Encoding=1251, 
												QuoteStyle=QuoteStyle.Csv]),
	#"Структура_2" =  Table.PromoteHeaders (#"Структура_1"),

	#"Список_полей_1" = #"Структура_2"[#"field name"],
	#"Список_полей_2"=List.FirstN(#"Список_полей_1", #"Длина таблица данных"),
	#"Список_полей_3" = Table.ColumnNames(#"Данные_1"),
	#"Список_полей_4" =  List.Zip({#"Список_полей_3",#"Список_полей_2"}),
	
	#"Данные_2" = Table.RenameColumns(#"Данные_1", #"Список_полей_4"),
		
	#"Перечень стобцов" = Table.FromList(Table.ColumnNames(#"Данные_2")),	
	#"Перечень стобцов с фильтром" = Table.SelectRows(#"Перечень стобцов", each 
		(Text.Length([Column1]) =5) and (Text.At([Column1], 4)="3")),
	#"Перечень стобцов с фильтром в виде списка" = #"Перечень стобцов с фильтром"[Column1],

    #"Удаленные столбцы" = Table.RemoveColumns(#"Данные_2",#"Перечень стобцов с фильтром в виде списка", MissingField.Ignore),

	#"Перечень стобцов новый" = Table.FromList(Table.ColumnNames(#"Удаленные столбцы")),
	#"Перечень стобцов новый с фильтром" = Table.SelectRows(#"Перечень стобцов новый", each 
		(Text.Length([Column1]) =5) and (Text.At([Column1], 4)="4")),
	#"Перечень стобцов новый с заменой" = Table.AddColumn(#"Перечень стобцов новый с фильтром", "Result", each Text.Combine({Text.RemoveRange([Column1],Text.Length([Column1])-1),"3"})),
	#"Список_полей_6"=#"Перечень стобцов новый с заменой"[Result],
	#"Список_полей_5" =  List.Zip({Table.ToList(#"Перечень стобцов новый с фильтром"), #"Список_полей_6"}),

	#"Удаленные столбцы новый" = Table.RenameColumns(#"Удаленные столбцы", #"Список_полей_5"),
	#"Вид таблицы с добавленным годом" = Table.AddColumn(#"Удаленные столбцы новый" , "Year", each 2011), 

	#"Финальный вид таблицы" = Table.TransformColumns(
		#"Вид таблицы с добавленным годом",
		{
			{
			"okved", 
			each 
				Text.Insert(
						(_),0,
						(if #"Год" &lt;= 2016 
						then "ОКВЭД: "
						else "ОКВЭД2: ")
				),
			type text
			}
		}
	),

	//Блок конвертации по кода 383, 384 ...
	lst1 = List.Skip(Table.ColumnNames(#"Финальный вид таблицы" ), 8), 
	lst=List.Range(lst1,0,58),
	f=(x,y)=>List.Accumulate(lst,x,(s,c)=>Record.TransformFields(s,{c,(x)=>Number.From(x)*y})),
	g=(x)=> f(x,Number.Power(10, (Number.FromText(x[#"measure"])-383)*3)),
	
	tbl = Table.ToRecords(#"Финальный вид таблицы"),
	trnsf= List.Transform(tbl,g),
	#"Окончательный вид таблицы перед дополнительными вычислениями" = Table.FromRecords(trnsf),
	//...
	
		

	#"Измененный тип 1" = 
	Table.TransformColumnTypes(#"Окончательный вид таблицы перед дополнительными вычислениями",{
		{"11103", Int64.Type},
		{"11203", Int64.Type},
		{"11303", Int64.Type},
		{"11403", Int64.Type},
		{"11503", Int64.Type},
		{"11603", Int64.Type},
		{"11703", Int64.Type},
		{"11803", Int64.Type},
		{"11903", Int64.Type},
		{"11003", Int64.Type},
		{"12103", Int64.Type},
		{"12203", Int64.Type},
		{"12303", Int64.Type},
		{"12403", Int64.Type},
		{"12503", Int64.Type},
		{"12603", Int64.Type},
		{"12003", Int64.Type},
		{"16003", Int64.Type},
		{"13103", Int64.Type},
		{"13203", Int64.Type},
		{"13403", Int64.Type},
		{"13503", Int64.Type},
		{"13603", Int64.Type},
		{"13703", Int64.Type},
		{"13003", Int64.Type},
		{"14103", Int64.Type},
		{"14203", Int64.Type},
		{"14303", Int64.Type},
		{"14503", Int64.Type},
		{"14003", Int64.Type},
		{"15103", Int64.Type},
		{"15203", Int64.Type},
		{"15303", Int64.Type},
		{"15403", Int64.Type},
		{"15503", Int64.Type},
		{"15003", Int64.Type},
		{"17003", Int64.Type},
		{"21103", Int64.Type},
		{"21203", Int64.Type},
		{"21003", Int64.Type},
		{"22103", Int64.Type},
		{"22203", Int64.Type},
		{"22003", Int64.Type},
		{"23103", Int64.Type},
		{"23203", Int64.Type},
		{"23303", Int64.Type},
		{"23403", Int64.Type},
		{"23503", Int64.Type},
		{"23003", Int64.Type},
		{"24103", Int64.Type},
		{"24213", Int64.Type},
		{"24303", Int64.Type},
		{"24503", Int64.Type},
		{"24603", Int64.Type},
		{"24003", Int64.Type},
		{"25103", Int64.Type},
		{"25203", Int64.Type},
		{"25003", Int64.Type}
	}),


	#"Дополнительные вычисления 1" = #"Измененный тип 1",
	
    #"Переименованные столбцы 1" = Table.RenameColumns(#"Дополнительные вычисления 1",{{"11003", "11003.1"}}),
	#"Переименованные столбцы 2" = Table.RenameColumns(#"Переименованные столбцы 1",{{"12003", "12003.1"}}),
	#"Переименованные столбцы 3" = Table.RenameColumns(#"Переименованные столбцы 2",{{"13003", "13003.1"}}),
	#"Переименованные столбцы 4" = Table.RenameColumns(#"Переименованные столбцы 3",{{"14003", "14003.1"}}),
	#"Переименованные столбцы 5" = Table.RenameColumns(#"Переименованные столбцы 4",{{"15003", "15003.1"}}),
	#"Переименованные столбцы 6" = Table.RenameColumns(#"Переименованные столбцы 5",{{"16003", "16003.1"}}),
	#"Переименованные столбцы 7" = Table.RenameColumns(#"Переименованные столбцы 6",{{"17003", "17003.1"}}),
		
    #"Добавлен пользовательский объект 1" = Table.AddColumn(#"Переименованные столбцы 7", "11003.2", each [11103]+[11203]+[11303]+[11403]+[11503]+[11603]+[11703]+[11803]+[11903], Int64.Type),
	#"Добавлен пользовательский объект 2" = Table.AddColumn(#"Добавлен пользовательский объект 1", "12003.2", each [12103]+[12203]+[12303]+[12403]+[12503]+[12603], Int64.Type),
	#"Добавлен пользовательский объект 3" = Table.AddColumn(#"Добавлен пользовательский объект 2", "13003.2", each [13103]+[13203]+[13403]+[13503]+[13603]+[13703], Int64.Type),
	#"Добавлен пользовательский объект 4" = Table.AddColumn(#"Добавлен пользовательский объект 3", "14003.2", each [14103]+[14203]+[14303]+[14503], Int64.Type),
	#"Добавлен пользовательский объект 5" = Table.AddColumn(#"Добавлен пользовательский объект 4", "15003.2", each [15103]+[15203]+[15303]+[15403]+[15503], Int64.Type),
	#"Добавлен пользовательский объект 6" = Table.AddColumn(#"Добавлен пользовательский объект 5", "16003.2", each [11003.2]+[12003.2], Int64.Type),
	#"Добавлен пользовательский объект 7" = Table.AddColumn(#"Добавлен пользовательский объект 6", "17003.2", each [13003.2]+[14003.2]+[15003.2], Int64.Type),
	
	#"Промежуточная проверка 1" = Table.AddColumn(#"Добавлен пользовательский объект 7", "Проверка 1", each [13003.2]+[14003.2]+[15003.2]-[11003.2]-[12003.2], Int64.Type),

    //#"Удаленные столбцы после преобразования" = Table.RemoveColumns(#"Добавлен пользовательский объект 7",{"11003.1", "12003.1","13003.1","14003.1","15003.1","16003.1","17003.1"}),
	//#"Переупорядоченные столбцы" = Table.ReorderColumns(#"Удаленные столбцы после преобразования",{"name", "okpo", "okopf", "okfs", "okved", "inn", "measure", "type", "11103", "11203", "11303", "11403", "11503", "11603", "11703", "11803", "11903", "11003", "12103", "12203", "12303", "12403", "12503", "12603", "12003", "16003", "13103", "13203", "13403", "13503", "13603", "13703", "13003", "14103", "14203", "14303", "14503", "14003", "15103", "15203", "15303", "15403", "15503", "15003", "17003", "21103", "21203", "21003", "22103", "22203", "22003", "23103", "23203", "23303", "23403", "23503", "23003", "24103", "24213", "24303", "24503", "24603", "24003", "25103", "25203", "25003", "Year"}),
	
	#"Финальные вычисления 1" = Table.AddColumn(
		#"Промежуточная проверка 1",
		"11003",
		each  (
			if ([11003.2]&lt;>0) then  [11003.2] else ([11003.1])
		),
		Int64.Type),

	#"Переименованные столбцы 1.1" = Table.RenameColumns(#"Финальные вычисления 1",{{"11503", "11503.1"}}),

	#"Финальные вычисления 1.1" = Table.AddColumn(
		#"Переименованные столбцы 1.1",
			"11503",
			each  (
				if ([11003.2]=0 and [11003.1]&lt;>0)
				then [11503.1]+([11003.1]-[11003.2])
				else [11503.1]
		),
		Int64.Type),


	#"Финальные вычисления 2" = Table.AddColumn(
		#"Финальные вычисления 1.1",
		"12003",
		each  (
			if ([12003.2]&lt;>0) then  [12003.2] else ([12003.1])
		),
		Int64.Type),

	#"Переименованные столбцы 2.1" = Table.RenameColumns(#"Финальные вычисления 2",{{"12303", "12303.1"}}),

	#"Финальные вычисления 2.1" = Table.AddColumn(
		#"Переименованные столбцы 2.1",
			"12303",
			each  (
				if ([12003.2]=0 and [12003.1]&lt;>0)
				then [12303.1]+([12003.1]-[12003.2])
				else [12303.1]
		),
		Int64.Type),

	#"Финальные вычисления 3" = Table.AddColumn(
		#"Финальные вычисления 2.1",
		"13003",
		each  (
			if ([13003.2]&lt;>0) then  [13003.2] else ([13003.1])
		),
		Int64.Type),

	#"Переименованные столбцы 3.1" = Table.RenameColumns(#"Финальные вычисления 3",{{"13703", "13703.1"}}),

	#"Финальные вычисления 3.1" = Table.AddColumn(
		#"Переименованные столбцы 3.1",
			"13703",
			each  (
				if ([13003.2]=0 and [13003.1]&lt;>0)
				then [13703.1]+([13003.1]-[13003.2])
				else [13703.1]
		),
		Int64.Type),

	#"Финальные вычисления 4" = Table.AddColumn(
		#"Финальные вычисления 3.1",
		"14003",
		each  (
			if ([14003.2]&lt;>0) then  [14003.2] else ([14003.1])
		),
		Int64.Type),

	#"Переименованные столбцы 4.1" = Table.RenameColumns(#"Финальные вычисления 4",{{"14103", "14103.1"}}),

	#"Финальные вычисления 4.1" = Table.AddColumn(
		#"Переименованные столбцы 4.1",
			"14103",
			each  (
				if ([14003.2]=0 and [14003.1]&lt;>0)
				then [14103.1]+([14003.1]-[14003.2])
				else [14103.1]
		),
		Int64.Type),

	#"Финальные вычисления 5" = Table.AddColumn(
		#"Финальные вычисления 4.1",
		"15003",
		each  (
			if ([15003.2]&lt;>0) then  [15003.2] else ([15003.1])
		),
		Int64.Type), 

	#"Переименованные столбцы 5.1" = Table.RenameColumns(#"Финальные вычисления 5",{{"15203", "15203.1"}}),

	#"Финальные вычисления 5.1" = Table.AddColumn(
		#"Переименованные столбцы 5.1",
			"15203",
			each  (
				if ([15003.2]=0 and [15003.1]&lt;>0)
				then [15203.1]+([15003.1]-[15003.2])
				else [15203.1]
		),
		Int64.Type),

	#"Промежуточная проверка 2" = Table.AddColumn(#"Финальные вычисления 5.1" , "Проверка 2", each [13003]+[14003]+[15003]-[11003]-[12003], Int64.Type),


	#"Вторая итерация корректировки 1" = Table.RemoveColumns(#"Промежуточная проверка 2",
		{"13703.1","14103.1","15203.1"}
		),
	#"Вторая итерация корректировки 2" = Table.RenameColumns(#"Вторая итерация корректировки 1" ,
		{
			{"13703", "13703.1"},
			{"14103", "14103.1"},
			{"15203", "15203.1"}
		}),	
		
	#"Вторая итерация корректировки 3" = Table.AddColumn(
		#"Вторая итерация корректировки 2",
			"15203",
			each  (
				if (([11003]+[12003])&lt;>([13003]+[14003]+[15003]))
				then [15203.1]+Number.RoundDown((([11003]+[12003])-([13003]+[14003]+[15003]))/3)
				else [15203.1]
		),
		Int64.Type),

	#"Вторая итерация корректировки 4" = Table.AddColumn(
		#"Вторая итерация корректировки 3",
			"14103",
			each  (
				if (([11003]+[12003])&lt;>([13003]+[14003]+[15003]))
				then [14103.1]+Number.RoundDown((([11003]+[12003])-([13003]+[14003]+[15003]))/3)
				else [14103.1]
		),
		Int64.Type),

	#"Вторая итерация корректировки 5" = Table.RemoveColumns(#"Вторая итерация корректировки 4" ,
		{"13003.1","14003.1","15003.1"}),

	#"Вторая итерация корректировки 6" = Table.RenameColumns(#"Вторая итерация корректировки 5" ,
		{
			{"13003", "13003.1"},
			{"14003", "14003.1"},
			{"15003", "15003.1"}
		}),	
	
	#"Вторая итерация корректировки 7" = Table.AddColumn(#"Вторая итерация корректировки 6",
		"14003", each [14103]+[14203]+[14303]+[14503], Int64.Type),


	#"Вторая итерация корректировки 8"  = Table.AddColumn(#"Вторая итерация корректировки 7" ,
		"15003", each [15103]+[15203]+[15303]+[15403]+[15503], Int64.Type),
	
	#"Вторая итерация корректировки 9" = Table.AddColumn(
		#"Вторая итерация корректировки 8",
			"13703",
			each  (
				if (([11003]+[12003])&lt;>([13003.1]+[14003]+[15003]))
				then [13703.1]+([11003]+[12003])-([13003.1]+[14003]+[15003])
				else [13703.1]
		),
		Int64.Type),

	#"Вторая итерация корректировки 10" = Table.AddColumn(#"Вторая итерация корректировки 9",
		"13003", each [13103]+[13203]+[13403]+[13503]+[13603]+[13703], Int64.Type),	


	#"Финальные вычисления 6.1" = Table.AddColumn(
		#"Вторая итерация корректировки 10",
			"16003",
			each  (
				[11003]+[12003]
		),
		Int64.Type),

	#"Финальные вычисления 7.1" = Table.AddColumn(
		#"Финальные вычисления 6.1" ,
			"17003",
			each  (
				[13003]+[14003]+[15003]
		),
		Int64.Type),


	#"Промежуточная проверка 3" = Table.AddColumn(#"Финальные вычисления 7.1" , "Проверка 3", each [13003]+[14003]+[15003]-[11003]-[12003], Int64.Type),


	#"Финальные вычисления" = Table.RemoveColumns(#"Промежуточная проверка 3",
	{	"11003.1", "11003.2", "11503.1",
		"12003.1", "12003.2", "12303.1",
		"13003.1", "13003.2", "13703.1",
		"14003.1", "14003.2", "14103.1",
		"15003.1", "15003.2", "15203.1",
		"16003.1", "16003.2",
		"17003.1", "17003.2",
		"Проверка 1", "Проверка 2", "Проверка 3" 
	}
	),

	#"Измененный тип 3" = 
	Table.TransformColumnTypes(#"Финальные вычисления",{		
		{"11503", Int64.Type},
		{"12303", Int64.Type},
		{"13703", Int64.Type},
		{"14103", Int64.Type},
		{"15203", Int64.Type},
		
		{"11003", Int64.Type},
		{"12003", Int64.Type},
		{"16003", Int64.Type},
		{"13003", Int64.Type},
		{"14003", Int64.Type},
		{"15003", Int64.Type},
		{"17003", Int64.Type}
	}),

    #"Переупорядоченные столбцы"= Table.ReorderColumns(#"Финальные вычисления",{"name", "okpo", "okopf", "okfs", "okved", "inn", "measure", "type", "11103", "11203", "11303", "11403", "11503", "11603", "11703", "11803", "11903", "11003", "12103", "12203", "12303", "12403", "12503", "12603", "12003", "16003", "13103", "13203", "13403", "13503", "13603", "13703", "13003", "14103", "14203", "14303", "14503", "14003", "15103", "15203", "15303", "15403", "15503", "15003", "17003" , "21103", "21203", "21003", "22103", "22203", "22003", "23103", "23203", "23303", "23403", "23503", "23003", "24103", "24213", "24303", "24503", "24603", "24003", "25103", "25203", "25003", "Year"}),
	

	#"Результат" = #"Переупорядоченные столбцы"
in
    Результат</code></pre></div></details><details class="spoiler"><summary>2012</summary><div class="spoiler__content"><pre><code>let
    #"Год" = 2012,
	#"Путь расположения файлов" = #"FilesDirectory",
	#"Наименование файла данных" = Lines.ToText(
					{
						"data-20200331-structure-",
						Number.ToText(#"Год"),
						"1231"
					},
					"") as text,
	#"Наименование файла структуры" = Lines.ToText(
					{
						"structure-",
						Number.ToText(#"Год"),
						"1231"
					},
					"") as text,
	#"Расширение файла" = "csv",
	#"Длина таблица данных" = 124,
	
	#"Импорт_1" = Lines.ToText(
		{
			#"Путь расположения файлов",
			#"Наименование файла данных",
			".",
			#"Расширение файла"			
		},
		"") as text,
	#"Данные_1" = Csv.Document(File.Contents(#"Импорт_1"),
												[Delimiter=";", 
												Columns=#"Длина таблица данных", 
												Encoding=1251, 
												QuoteStyle=QuoteStyle.None]),
	#"Импорт_2" = Lines.ToText(
		{
			#"Путь расположения файлов",
			"Help",
			".",
			#"Расширение файла"			
		},
		"") as text,
	#"Расшифровка_1" = Csv.Document(File.Contents(#"Импорт_2"),
												[Delimiter=";", 
												Columns=3, 
												Encoding=1251, 
												QuoteStyle=QuoteStyle.None]),	
	#"Расшифровка_2" = Table.RenameColumns(#"Расшифровка_1",{{"Column1", "Numer"}, {"Column2", "Name_RUS"}, {"Column3", "Name_ENG"}}),
	
	#"Импорт_3" = Lines.ToText(
		{
			#"Путь расположения файлов",
			#"Наименование файла структуры",
			".",
			#"Расширение файла"			
		},
		"") as text,
	#"Структура_1" = Csv.Document(File.Contents(#"Импорт_3"),
												[Delimiter=",", 
												Columns=4, 
												Encoding=1251, 
												QuoteStyle=QuoteStyle.Csv]),
	#"Структура_2" =  Table.PromoteHeaders (#"Структура_1"),

	#"Список_полей_1" = #"Структура_2"[#"field name"],
	#"Список_полей_2"=List.FirstN(#"Список_полей_1", #"Длина таблица данных"),
	#"Список_полей_3" = Table.ColumnNames(#"Данные_1"),
	#"Список_полей_4" =  List.Zip({#"Список_полей_3",#"Список_полей_2"}),
	
	#"Данные_2" = Table.RenameColumns(#"Данные_1", #"Список_полей_4"),
		
	#"Перечень стобцов" = Table.FromList(Table.ColumnNames(#"Данные_2")),	
	#"Перечень стобцов с фильтром" = Table.SelectRows(#"Перечень стобцов", each 
		(Text.Length([Column1]) =5) and (Text.At([Column1], 4)="4")),
	#"Перечень стобцов с фильтром в виде списка" = #"Перечень стобцов с фильтром"[Column1],

    #"Удаленные столбцы новый" = Table.RemoveColumns(#"Данные_2",#"Перечень стобцов с фильтром в виде списка", MissingField.Ignore),
	
	#"Вид таблицы с добавленным годом" = Table.AddColumn(#"Удаленные столбцы новый" , "Year", each #"Год"), 

	#"Финальный вид таблицы" = Table.TransformColumns(
		#"Вид таблицы с добавленным годом",
		{
			{
			"okved", 
			each 
				Text.Insert(
						(_),0,
						(if #"Год" &lt;= 2016 
						then "ОКВЭД: "
						else "ОКВЭД2: ")
				),
			type text
			}
		}
	),

	//Блок конвертации по кода 383, 384 ...
	lst1 = List.Skip(Table.ColumnNames(#"Финальный вид таблицы" ), 8), 
	lst=List.Range(lst1,0,58),
	f=(x,y)=>List.Accumulate(lst,x,(s,c)=>Record.TransformFields(s,{c,(x)=>Number.From(x)*y})),
	g=(x)=> f(x,Number.Power(10, (Number.FromText(x[#"measure"])-383)*3)),
	
	tbl = Table.ToRecords(#"Финальный вид таблицы"),
	trnsf= List.Transform(tbl,g),
	#"Окончательный вид таблицы перед дополнительными вычислениями" = Table.FromRecords(trnsf),
	//...
	
		

	#"Измененный тип 1" = 
	Table.TransformColumnTypes(#"Окончательный вид таблицы перед дополнительными вычислениями",{
		{"11103", Int64.Type},
		{"11203", Int64.Type},
		{"11303", Int64.Type},
		{"11403", Int64.Type},
		{"11503", Int64.Type},
		{"11603", Int64.Type},
		{"11703", Int64.Type},
		{"11803", Int64.Type},
		{"11903", Int64.Type},
		{"11003", Int64.Type},
		{"12103", Int64.Type},
		{"12203", Int64.Type},
		{"12303", Int64.Type},
		{"12403", Int64.Type},
		{"12503", Int64.Type},
		{"12603", Int64.Type},
		{"12003", Int64.Type},
		{"16003", Int64.Type},
		{"13103", Int64.Type},
		{"13203", Int64.Type},
		{"13403", Int64.Type},
		{"13503", Int64.Type},
		{"13603", Int64.Type},
		{"13703", Int64.Type},
		{"13003", Int64.Type},
		{"14103", Int64.Type},
		{"14203", Int64.Type},
		{"14303", Int64.Type},
		{"14503", Int64.Type},
		{"14003", Int64.Type},
		{"15103", Int64.Type},
		{"15203", Int64.Type},
		{"15303", Int64.Type},
		{"15403", Int64.Type},
		{"15503", Int64.Type},
		{"15003", Int64.Type},
		{"17003", Int64.Type},
		{"21103", Int64.Type},
		{"21203", Int64.Type},
		{"21003", Int64.Type},
		{"22103", Int64.Type},
		{"22203", Int64.Type},
		{"22003", Int64.Type},
		{"23103", Int64.Type},
		{"23203", Int64.Type},
		{"23303", Int64.Type},
		{"23403", Int64.Type},
		{"23503", Int64.Type},
		{"23003", Int64.Type},
		{"24103", Int64.Type},
		{"24213", Int64.Type},
		{"24303", Int64.Type},
		{"24503", Int64.Type},
		{"24603", Int64.Type},
		{"24003", Int64.Type},
		{"25103", Int64.Type},
		{"25203", Int64.Type},
		{"25003", Int64.Type}
	}),


	#"Дополнительные вычисления 1" = #"Измененный тип 1",
	
    #"Переименованные столбцы 1" = Table.RenameColumns(#"Дополнительные вычисления 1",{{"11003", "11003.1"}}),
	#"Переименованные столбцы 2" = Table.RenameColumns(#"Переименованные столбцы 1",{{"12003", "12003.1"}}),
	#"Переименованные столбцы 3" = Table.RenameColumns(#"Переименованные столбцы 2",{{"13003", "13003.1"}}),
	#"Переименованные столбцы 4" = Table.RenameColumns(#"Переименованные столбцы 3",{{"14003", "14003.1"}}),
	#"Переименованные столбцы 5" = Table.RenameColumns(#"Переименованные столбцы 4",{{"15003", "15003.1"}}),
	#"Переименованные столбцы 6" = Table.RenameColumns(#"Переименованные столбцы 5",{{"16003", "16003.1"}}),
	#"Переименованные столбцы 7" = Table.RenameColumns(#"Переименованные столбцы 6",{{"17003", "17003.1"}}),
		
    #"Добавлен пользовательский объект 1" = Table.AddColumn(#"Переименованные столбцы 7", "11003.2", each [11103]+[11203]+[11303]+[11403]+[11503]+[11603]+[11703]+[11803]+[11903], Int64.Type),
	#"Добавлен пользовательский объект 2" = Table.AddColumn(#"Добавлен пользовательский объект 1", "12003.2", each [12103]+[12203]+[12303]+[12403]+[12503]+[12603], Int64.Type),
	#"Добавлен пользовательский объект 3" = Table.AddColumn(#"Добавлен пользовательский объект 2", "13003.2", each [13103]+[13203]+[13403]+[13503]+[13603]+[13703], Int64.Type),
	#"Добавлен пользовательский объект 4" = Table.AddColumn(#"Добавлен пользовательский объект 3", "14003.2", each [14103]+[14203]+[14303]+[14503], Int64.Type),
	#"Добавлен пользовательский объект 5" = Table.AddColumn(#"Добавлен пользовательский объект 4", "15003.2", each [15103]+[15203]+[15303]+[15403]+[15503], Int64.Type),
	#"Добавлен пользовательский объект 6" = Table.AddColumn(#"Добавлен пользовательский объект 5", "16003.2", each [11003.2]+[12003.2], Int64.Type),
	#"Добавлен пользовательский объект 7" = Table.AddColumn(#"Добавлен пользовательский объект 6", "17003.2", each [13003.2]+[14003.2]+[15003.2], Int64.Type),
	
	#"Промежуточная проверка 1" = Table.AddColumn(#"Добавлен пользовательский объект 7", "Проверка 1", each [13003.2]+[14003.2]+[15003.2]-[11003.2]-[12003.2], Int64.Type),

    //#"Удаленные столбцы после преобразования" = Table.RemoveColumns(#"Добавлен пользовательский объект 7",{"11003.1", "12003.1","13003.1","14003.1","15003.1","16003.1","17003.1"}),
	//#"Переупорядоченные столбцы" = Table.ReorderColumns(#"Удаленные столбцы после преобразования",{"name", "okpo", "okopf", "okfs", "okved", "inn", "measure", "type", "11103", "11203", "11303", "11403", "11503", "11603", "11703", "11803", "11903", "11003", "12103", "12203", "12303", "12403", "12503", "12603", "12003", "16003", "13103", "13203", "13403", "13503", "13603", "13703", "13003", "14103", "14203", "14303", "14503", "14003", "15103", "15203", "15303", "15403", "15503", "15003", "17003", "21103", "21203", "21003", "22103", "22203", "22003", "23103", "23203", "23303", "23403", "23503", "23003", "24103", "24213", "24303", "24503", "24603", "24003", "25103", "25203", "25003", "Year"}),
	
	#"Финальные вычисления 1" = Table.AddColumn(
		#"Промежуточная проверка 1",
		"11003",
		each  (
			if ([11003.2]&lt;>0) then  [11003.2] else ([11003.1])
		),
		Int64.Type),

	#"Переименованные столбцы 1.1" = Table.RenameColumns(#"Финальные вычисления 1",{{"11503", "11503.1"}}),

	#"Финальные вычисления 1.1" = Table.AddColumn(
		#"Переименованные столбцы 1.1",
			"11503",
			each  (
				if ([11003.2]=0 and [11003.1]&lt;>0)
				then [11503.1]+([11003.1]-[11003.2])
				else [11503.1]
		),
		Int64.Type),


	#"Финальные вычисления 2" = Table.AddColumn(
		#"Финальные вычисления 1.1",
		"12003",
		each  (
			if ([12003.2]&lt;>0) then  [12003.2] else ([12003.1])
		),
		Int64.Type),

	#"Переименованные столбцы 2.1" = Table.RenameColumns(#"Финальные вычисления 2",{{"12303", "12303.1"}}),

	#"Финальные вычисления 2.1" = Table.AddColumn(
		#"Переименованные столбцы 2.1",
			"12303",
			each  (
				if ([12003.2]=0 and [12003.1]&lt;>0)
				then [12303.1]+([12003.1]-[12003.2])
				else [12303.1]
		),
		Int64.Type),

	#"Финальные вычисления 3" = Table.AddColumn(
		#"Финальные вычисления 2.1",
		"13003",
		each  (
			if ([13003.2]&lt;>0) then  [13003.2] else ([13003.1])
		),
		Int64.Type),

	#"Переименованные столбцы 3.1" = Table.RenameColumns(#"Финальные вычисления 3",{{"13703", "13703.1"}}),

	#"Финальные вычисления 3.1" = Table.AddColumn(
		#"Переименованные столбцы 3.1",
			"13703",
			each  (
				if ([13003.2]=0 and [13003.1]&lt;>0)
				then [13703.1]+([13003.1]-[13003.2])
				else [13703.1]
		),
		Int64.Type),

	#"Финальные вычисления 4" = Table.AddColumn(
		#"Финальные вычисления 3.1",
		"14003",
		each  (
			if ([14003.2]&lt;>0) then  [14003.2] else ([14003.1])
		),
		Int64.Type),

	#"Переименованные столбцы 4.1" = Table.RenameColumns(#"Финальные вычисления 4",{{"14103", "14103.1"}}),

	#"Финальные вычисления 4.1" = Table.AddColumn(
		#"Переименованные столбцы 4.1",
			"14103",
			each  (
				if ([14003.2]=0 and [14003.1]&lt;>0)
				then [14103.1]+([14003.1]-[14003.2])
				else [14103.1]
		),
		Int64.Type),

	#"Финальные вычисления 5" = Table.AddColumn(
		#"Финальные вычисления 4.1",
		"15003",
		each  (
			if ([15003.2]&lt;>0) then  [15003.2] else ([15003.1])
		),
		Int64.Type), 

	#"Переименованные столбцы 5.1" = Table.RenameColumns(#"Финальные вычисления 5",{{"15203", "15203.1"}}),

	#"Финальные вычисления 5.1" = Table.AddColumn(
		#"Переименованные столбцы 5.1",
			"15203",
			each  (
				if ([15003.2]=0 and [15003.1]&lt;>0)
				then [15203.1]+([15003.1]-[15003.2])
				else [15203.1]
		),
		Int64.Type),

	#"Промежуточная проверка 2" = Table.AddColumn(#"Финальные вычисления 5.1" , "Проверка 2", each [13003]+[14003]+[15003]-[11003]-[12003], Int64.Type),


	#"Вторая итерация корректировки 1" = Table.RemoveColumns(#"Промежуточная проверка 2",
		{"13703.1","14103.1","15203.1"}
		),
	#"Вторая итерация корректировки 2" = Table.RenameColumns(#"Вторая итерация корректировки 1" ,
		{
			{"13703", "13703.1"},
			{"14103", "14103.1"},
			{"15203", "15203.1"}
		}),	
		
	#"Вторая итерация корректировки 3" = Table.AddColumn(
		#"Вторая итерация корректировки 2",
			"15203",
			each  (
				if (([11003]+[12003])&lt;>([13003]+[14003]+[15003]))
				then [15203.1]+Number.RoundDown((([11003]+[12003])-([13003]+[14003]+[15003]))/3)
				else [15203.1]
		),
		Int64.Type),

	#"Вторая итерация корректировки 4" = Table.AddColumn(
		#"Вторая итерация корректировки 3",
			"14103",
			each  (
				if (([11003]+[12003])&lt;>([13003]+[14003]+[15003]))
				then [14103.1]+Number.RoundDown((([11003]+[12003])-([13003]+[14003]+[15003]))/3)
				else [14103.1]
		),
		Int64.Type),

	#"Вторая итерация корректировки 5" = Table.RemoveColumns(#"Вторая итерация корректировки 4" ,
		{"13003.1","14003.1","15003.1"}),

	#"Вторая итерация корректировки 6" = Table.RenameColumns(#"Вторая итерация корректировки 5" ,
		{
			{"13003", "13003.1"},
			{"14003", "14003.1"},
			{"15003", "15003.1"}
		}),	
	
	#"Вторая итерация корректировки 7" = Table.AddColumn(#"Вторая итерация корректировки 6",
		"14003", each [14103]+[14203]+[14303]+[14503], Int64.Type),


	#"Вторая итерация корректировки 8"  = Table.AddColumn(#"Вторая итерация корректировки 7" ,
		"15003", each [15103]+[15203]+[15303]+[15403]+[15503], Int64.Type),
	
	#"Вторая итерация корректировки 9" = Table.AddColumn(
		#"Вторая итерация корректировки 8",
			"13703",
			each  (
				if (([11003]+[12003])&lt;>([13003.1]+[14003]+[15003]))
				then [13703.1]+([11003]+[12003])-([13003.1]+[14003]+[15003])
				else [13703.1]
		),
		Int64.Type),

	#"Вторая итерация корректировки 10" = Table.AddColumn(#"Вторая итерация корректировки 9",
		"13003", each [13103]+[13203]+[13403]+[13503]+[13603]+[13703], Int64.Type),	


	#"Финальные вычисления 6.1" = Table.AddColumn(
		#"Вторая итерация корректировки 10",
			"16003",
			each  (
				[11003]+[12003]
		),
		Int64.Type),

	#"Финальные вычисления 7.1" = Table.AddColumn(
		#"Финальные вычисления 6.1" ,
			"17003",
			each  (
				[13003]+[14003]+[15003]
		),
		Int64.Type),


	#"Промежуточная проверка 3" = Table.AddColumn(#"Финальные вычисления 7.1" , "Проверка 3", each [13003]+[14003]+[15003]-[11003]-[12003], Int64.Type),


	#"Финальные вычисления" = Table.RemoveColumns(#"Промежуточная проверка 3",
	{	"11003.1", "11003.2", "11503.1",
		"12003.1", "12003.2", "12303.1",
		"13003.1", "13003.2", "13703.1",
		"14003.1", "14003.2", "14103.1",
		"15003.1", "15003.2", "15203.1",
		"16003.1", "16003.2",
		"17003.1", "17003.2",
		"Проверка 1", "Проверка 2", "Проверка 3" 
	}
	),

	#"Измененный тип 3" = 
	Table.TransformColumnTypes(#"Финальные вычисления",{		
		{"11503", Int64.Type},
		{"12303", Int64.Type},
		{"13703", Int64.Type},
		{"14103", Int64.Type},
		{"15203", Int64.Type},
		
		{"11003", Int64.Type},
		{"12003", Int64.Type},
		{"16003", Int64.Type},
		{"13003", Int64.Type},
		{"14003", Int64.Type},
		{"15003", Int64.Type},
		{"17003", Int64.Type}
	}),

    #"Переупорядоченные столбцы"= Table.ReorderColumns(#"Финальные вычисления",{"name", "okpo", "okopf", "okfs", "okved", "inn", "measure", "type", "11103", "11203", "11303", "11403", "11503", "11603", "11703", "11803", "11903", "11003", "12103", "12203", "12303", "12403", "12503", "12603", "12003", "16003", "13103", "13203", "13403", "13503", "13603", "13703", "13003", "14103", "14203", "14303", "14503", "14003", "15103", "15203", "15303", "15403", "15503", "15003", "17003" , "21103", "21203", "21003", "22103", "22203", "22003", "23103", "23203", "23303", "23403", "23503", "23003", "24103", "24213", "24303", "24503", "24603", "24003", "25103", "25203", "25003", "Year"}),
	

	#"Результат" = #"Переупорядоченные столбцы"
in
    #"Результат"</code></pre><p>Если скачанные файлы вами не переименовывались и лежат в одном месте, а также вы указали папку в <strong>FilesDirectory</strong>, то повторив запрос 2012  для каждого из файлов, мы их все интегрируем и предварительно обработаем, чего, собственно, и добивались.</p><p>Однако работать с такими данными не представляется возможным, потому их потребуется переработать. Для этих целей создаётся запрос Fact:</p><details class="spoiler"><summary>Fact</summary><div class="spoiler__content"><pre><code>let
    #"Исходные данные" = Table.Combine({#"2018", #"2017", #"2016", #"2015", #"2014", #"2013", #"2012", #"2011"}),
    //#"Исходные данные" = Table.Combine({#"2012"}),
    #"Развёрнутая таблица" = Table.UnpivotOtherColumns(#"Исходные данные", 
        List.Combine({List.FirstN(Table.ColumnNames( #"Исходные данные"),8),{"Year"}}), "Attribute", "Value"),
    #"Список колонок на удаление" = List.RemoveItems(Table.ColumnNames(#"Развёрнутая таблица"),{"inn", "Year", "okved", "Attribute", "Value"}),
        
    #"Таблица с удалёнными колонками" = Table.RemoveColumns(#"Развёрнутая таблица",#"Список колонок на удаление" ),
    #"Таблица с корректным типами" = Table.TransformColumnTypes(#"Таблица с удалёнными колонками",{{"inn", Text.Type}, {"okved", Text.Type}, {"Year", Int64.Type}, {"Value", Int64.Type}}),
    #"Переупорядоченные столбцы" = Table.ReorderColumns(#"Таблица с корректным типами",{"inn", "okved", "Year", "Attribute", "Value"}),
    //#"Строки с примененным фильтром" = Table.SelectRows(Результат, each true)
    #"Результат" = #"Переупорядоченные столбцы"
in
    Результат</code></pre></div></details><p>Собственно, данный запрос формирует то, что нам нужно - таблица приемлемого формата, по которой теперь можно "фильтроваться", считать суммы и т.д. Эта таблица соответствует и принципам нормальности из СУБД.</p><p><strong>Если вы, кстати, внимательно посмотрите на все запросы, то увидите, что помимо файлов с данными потребуется некоторое количество дополнительных файлов: файлы структуры для каждой из баз, файл help (там расшифровки и названия для колонок таблиц с данными).</strong></p><p>Для файла Help также формируется отдельный запрос:</p><details class="spoiler"><summary>Help</summary><div class="spoiler__content"><pre><code>let
	#"Путь расположения файлов" = #"FilesDirectory",
	#"Расширение файла" = "csv",
	#"Импорт_2" = Lines.ToText(
		{
			#"Путь расположения файлов",
			"Help",
			".",
			#"Расширение файла"			
		},
		"") as text,
	#"Расшифровка_1" = Csv.Document(File.Contents(#"Импорт_2"),
												[Delimiter=";", 
												Columns=3, 
												Encoding=1251, 
												QuoteStyle=QuoteStyle.None]),	
	#"Расшифровка_2" = Table.RenameColumns(#"Расшифровка_1",{{"Column1", "Numer"}, {"Column2", "Name_RUS"}, {"Column3", "Name_ENG"}}),
    #"Результат"= #"Расшифровка_2",
    #"Измененный тип" = Table.TransformColumnTypes(Результат,{{"Numer", type text}})
in
    #"Измененный тип"</code></pre></div></details><p>Далее потребуется выгрузить элементы фильтрации, т.е. ОКВЭД, год, Регион. Выглядит это так:</p><ol start="2"><li><p>Чтобы можно было выделить отдельное предприятие и сразу просмотреть его анализ, выделяем весь имеющийся перечень:</p><details class="spoiler"><summary>Enterprises</summary><div class="spoiler__content"><pre><code>let
    #"Source" = Table.Combine({#"2018", #"2017", #"2016", #"2015", #"2014", #"2013", #"2012", #"2011"}),
    #"Переупорядоченные столбцы" = Table.ReorderColumns(#"Source",{"name", "okpo", "okopf", "okfs", "okved", "inn", "measure", "type", "11103", "11203", "11303", "11403", "11503", "11603", "11703", "11803", "11903", "11003", "12103", "12203", "12303", "12403", "12503", "12603", "12003", "16003", "13103", "13203", "13403", "13503", "13603", "13703", "13003", "14103", "14203", "14303", "14503", "14003", "15103", "15203", "15303", "15403", "15503", "15003", "17003", "21103", "21203", "21003", "22103", "22203", "22003", "23103", "23203", "23303", "23403", "23503", "23003", "24103", "24213", "24303", "24503", "24603", "24003", "25103", "25203", "25003", "Year"}),
    #"Removed Other Columns" = Table.SelectColumns(Source,List.FirstN(Table.ColumnNames(#"Переупорядоченные столбцы"),8)),
    #"Removed Duplicates" = Table.Distinct(#"Removed Other Columns", "inn")
in
    #"Removed Duplicates"</code></pre></div></details></li><li><p>Могут понадобиться коды всех используемых строк финансовой отчётности:</p><details class="spoiler"><summary>Codes</summary><div class="spoiler__content"><pre><code>let
    Source = Fact,
    #"Removed Other Columns" = Table.SelectColumns(Source,{"Attribute"}),
    #"Removed Duplicates" = Table.Distinct(#"Removed Other Columns")
in
    #"Removed Duplicates"</code></pre></div></details></li><li><p>Вытащим отдельно годы:</p><details class="spoiler"><summary>Years</summary><div class="spoiler__content"><pre><code>let
    Source = Fact,
    #"Removed Other Columns" = Table.SelectColumns(Source,{"Year"}),
    #"Removed Duplicates" = Table.Distinct(#"Removed Other Columns")
in
    #"Removed Duplicates"</code></pre></div></details></li><li><p>Сформируем перечень регионов:</p><details class="spoiler"><summary>Reg</summary><div class="spoiler__content"><pre><code>let
    Источник = #table(
        type table [ID = text, GegName = text],
        {
            {"01","Адыгея республика"},
            {"02","Башкортостан республика"},
            {"03","Бурятия республика"},
            {"04","Алтай республика"},
            {"05","Дагестан республика"},
            {"06","Ингушетия республика"},
            {"07","Кабардино-Балкарская республика"},
            {"08","Калмыкия республика"},
            {"09","Карачаево-Черкесская республика"},
            {"10","Карелия республика"},
            {"11","Коми республика"},
            {"12","Марий Эл республика"},
            {"13","Мордовия республика"},
            {"14","Саха /Якутия/ республика"},
            {"15","Северная Осетия - Алания республика"},
            {"16","Татарстан республика"},
            {"17","Тыва республика"},
            {"18","Удмуртская республика"},
            {"19","Хакасия республика"},
            {"20","Чеченская республика"},
            {"21","Чувашская Республика - Чувашия"},
            {"22","Алтайский край"},
            {"23","Краснодарский край"},
            {"24","Красноярский край"},
            {"25","Приморский край"},
            {"26","Ставропольский край"},
            {"27","Хабаровский край"},
            {"28","Амурская область"},
            {"29","Архангельская область"},
            {"30","Астраханская область"},
            {"31","Белгородская область"},
            {"32","Брянская область"},
            {"33","Владимирская область"},
            {"34","Волгоградская область"},
            {"35","Вологодская область"},
            {"36","Воронежская область"},
            {"37","Ивановская область"},
            {"38","Иркутская область"},
            {"39","Калининградская область"},
            {"40","Калужская область"},
            {"41","Камчатский край"},
            {"42","Кемеровская область"},
            {"43","Кировская область"},
            {"44","Костромская область"},
            {"45","Курганская область"},
            {"46","Курская область"},
            {"47","Ленинградская область"},
            {"48","Липецкая область"},
            {"49","Магаданская область"},
            {"50","Московская область"},
            {"51","Мурманская область"},
            {"52","Нижегородская область"},
            {"53","Новгородская область"},
            {"54","Новосибирская область"},
            {"55","Омская область"},
            {"56","Оренбургская область"},
            {"57","Орловская область"},
            {"58","Пензенская область"},
            {"59","Пермский край"},
            {"60","Псковская область"},
            {"61","Ростовская область"},
            {"62","Рязанская область"},
            {"63","Самарская область"},
            {"64","Саратовская область"},
            {"65","Сахалинская область"},
            {"66","Свердловская область"},
            {"67","Смоленская область"},
            {"68","Тамбовская область"},
            {"69","Тверская область"},
            {"70","Томская область"},
            {"71","Тульская область"},
            {"72","Тюменская область"},
            {"73","Ульяновская область"},
            {"74","Челябинская область"},
            {"75","Забайкальский край"},
            {"76","Ярославская область"},
            {"77","Москва город"},
            {"78","Санкт-Петербург город"},
            {"79","Еврейская автономная область"},
            {"83","Ненецкий автономный округ"},
            {"86","Ханты-Мансийский Автономный округ - Югра автономный округ"},
            {"87","Чукотский автономный округ"},
            {"89","Ямало-Ненецкий автономный округ"},
            {"91","Крым республика"},
            {"92","Севастополь город"},
            {"99","Байконур город"}

        }

    ),
    #"Переименованные столбцы" = Table.RenameColumns(Источник,{{"GegName", "Регион"}})
in
    #"Переименованные столбцы"</code></pre></div></details></li><li><p>Выделим перечень ОКВЭД-ов:</p><details class="spoiler"><summary>okved</summary><div class="spoiler__content"><pre><code>let
    Source = Fact,
    #"Removed Other Columns" = Table.SelectColumns(Source,{"okved"}),
    #"Removed Duplicates" = Table.Distinct(#"Removed Other Columns")
in
    #"Removed Duplicates"</code></pre></div></details></li></ol><figure class="float "><img src="/img/image-loader.svg" height="578" data-src="https://habrastorage.org/getpro/habr/upload_files/f4d/8e1/1bb/f4d8e11bb2b4b1432297bd904c710a1b.png" data-width="184"/><figcaption></figcaption></figure><p>Собственно, на этом временно с запросами можно закончить и выгрузить все, нажав на кнопку  "Закрыть и применить". Перечень запросов к этой стадии реализации выглядит указанным образом.<br/><br/>Не обольщайтесь, проделана лишь часть работы, но она одна из ключевых.<br/><br/>После начала загрузки у меня перерасчёт и дозагрузка происходит примерно ~ 24 часа. Не могу сказать норма ли это. При этом устройство, на котором выполнялась работа - достаточно мощное. <br/><br/>"Заблюренные" таблицы у Вас появятся чуть позже, а сейчас следует, согласно нашего плана, структурировать данные и выстроить взаимосвязи.<br/><br/></p></div></details><p>После "импорта" данных потребуется их структурировать, указав взаимосвязи между таблицами. Это ключевой и необходимый момент, чтобы появилась возможность фильтрации и выбора данных по признакам. Общий вид таков:</p><figure class="full-width "><img src="/img/image-loader.svg" height="1040" data-src="https://habrastorage.org/getpro/habr/upload_files/d88/b2e/d9c/d88b2ed9cb354e9e6ad6d3e77d16b703.png" data-width="1574"/><figcaption></figcaption></figure><p>Практически все связи выстраивались в логике 1 ко многим. Power BI предоставляет посмотреть структуру связей в формате таблицы:</p><figure class="full-width "><img src="/img/image-loader.svg" height="536" data-src="https://habrastorage.org/getpro/habr/upload_files/c09/86e/a7d/c0986ea7d2317319d6925e91edda76a1.png" data-width="757"/><figcaption></figcaption></figure><p>По итогу этих действий мы полностью готовы к формированию отчёта и разработке представлений. </p><p><strong>Разработка интерфейса (</strong>плюшки, особенности<strong>)</strong></p><p>Итоговый внешний вид пользовательского интерфейса получился таковым:</p><figure class="full-width "><img src="/img/image-loader.svg" height="868" data-src="https://habrastorage.org/getpro/habr/upload_files/4f7/bd6/bc2/4f7bd6bc278d062a507ca64261bb39de.png" data-width="1545"/><figcaption></figcaption></figure><p>Слева пользователю доступны "разделы" (на самом деле, страницы) отчёта, перемещение по которым производится нажатием левой кнопки мыши (ЛКМ)  при зажатой клавише ctrl. </p><p>Интересным аспектом данной страницы является ограничение "бегунком" (модифицированным срезом) числа, демонстрируемых объектов в диаграмме и таблице. </p><p><strong><em>Как реализовано? А вот так...</em></strong></p><p>Сначала создаётся простая одностолбцовая таблица:</p><pre><code>Кол-во в рейтинге = GENERATESERIES(5, 88, 1)</code></pre><p>Кидаем срез на лист, указываем его тип :"одиночное значение", в качестве поля (аргумента), указываем "<code>Кол-во в рейтинге</code>". Теперь срез будет принимать только указанные в данной таблице значения. Следующая функция будет указывать, какое именно значение выбрано фильтром:</p><pre><code>Значение Кол-ва в рейтинге = SELECTEDVALUE('Кол-во в рейтинге'[Кол-во в рейтинге])</code></pre><p>Теперь необходимо по каждому региону выставить рейтинг в зависимости от числа предприятий в нём:</p><pre><code>РангРегионаПоКоличествуПредприятий = 
VAR REGToRank = [Значение Кол-ва в рейтинге]
VAR Ranking = 
    RANKX(
        ALLSELECTED(NewReg[Регион]), COUNTROWS ( RELATEDTABLE (Enterprises))
    )
VAR IsOtherSelected = SELECTEDVALUE(NewReg[Регион]) = "Другие"
VAR Result = IF (IsOtherSelected, REGToRank+1, 
        IF (Ranking&lt;=REGToRank,Ranking,Ranking+1))
RETURN Result</code></pre><p>Что осталось сделать... указать для регионов, чей рейтинг в пределе интересующего их соответствие, а остальным - нет:</p><pre><code>Кол-воВРейтинге = 
VAR Ranking = [РангРегионаПоКоличествуПредприятий]
VAR TopNValue = [Значение Кол-ва в рейтинге]
VAR Result = Int(Ranking&lt;=TopNValue+1)
RETURN
    Result</code></pre><p>В итоге, настроив для графического элемента фильтр, можно показывать только те регионы, что попали в интересующий рейтинг:</p><figure class="full-width "><img src="/img/image-loader.svg" height="680" data-src="https://habrastorage.org/getpro/habr/upload_files/d36/a34/55a/d36a3455aff7872afd1ff886b748bd28.png" data-width="1920"/><figcaption></figcaption></figure><p>Поскольку суммарные значения по денежным позициям весьма велики, то для управления отображением значений пришлось реализовать переключатель единиц измерения. Например, на втором отчёте он уже появляется:</p><figure class="full-width "><img src="/img/image-loader.svg" height="868" data-src="https://habrastorage.org/getpro/habr/upload_files/f44/77d/2c8/f4477d2c8517cbfbe6f3a008021ef5e3.png" data-width="1544"/><figcaption></figcaption></figure><p><strong>Реализация переключения единиц измерения</strong></p><p>В первую очередь нужно прямо в Power BI создать таблицу с применением синтаксиса DAX (для разнообразия, так сказать, а то всё PQ, да PQ):</p><pre><code>Display = DATATABLE("Type",STRING,
{
    {"1. Рубли"},
    {"2. Тысячи рублей"},
    {"3. Миллионы рублей"},
    {"4. Миллиарды рублей"},
    {"5. Триллионы рублей"},
    {"6. Квадриллионы рублей"}
}
)</code></pre><p>Теперь можно создать срез и сразу на него и разместить Type.</p><p>Ну а дальше всё достаточно просто. В любой элемент размещаются не сами значения, а их "форматированные копии". А для этих самых копий пишется такой синтаксис:</p><pre><code>Formatted Value = 
SWITCH(
    TRUE(),
        SELECTEDVALUE(Display[Type]) = "1. Рубли", FORMAT(SUM(Fact[Value]), "### ### ### ### ##0"),
        SELECTEDVALUE(Display[Type]) = "2. Тысячи рублей", FORMAT(SUM(Fact[Value])/1000, "### ### ### ### ##0"),
        SELECTEDVALUE(Display[Type]) = "3. Миллионы рублей", FORMAT(SUM(Fact[Value])/1000000, "### ### ### ### ##0"),
        SELECTEDVALUE(Display[Type]) = "4. Миллиарды рублей", FORMAT(SUM(Fact[Value])/1000000000, "### ### ### ### ##0"),
        SELECTEDVALUE(Display[Type]) = "5. Триллионы рублей", FORMAT(SUM(Fact[Value])/1000000000000, "### ### ### ### ##0"),
        SELECTEDVALUE(Display[Type]) = "6. Квадриллионы рублей", FORMAT(SUM(Fact[Value])/1000000000000000, "### ### ### ### ##0")
)</code></pre><p>Ну вот, более-менее и прояснилось всё.</p><p>В отчёте содержится анализ по форме 2:</p><figure class="full-width "><img src="/img/image-loader.svg" height="862" data-src="https://habrastorage.org/getpro/habr/upload_files/141/456/2fb/1414562fb3be2a16b30a22b179a35a24.png" data-width="1920"/><figcaption></figcaption></figure><p>Включил в отчёт анализ по основным финансовым коэффициентам:</p><figure class="full-width "><img src="/img/image-loader.svg" height="929" data-src="https://habrastorage.org/getpro/habr/upload_files/e86/df0/677/e86df0677b5c5a980f73d41e20f6ad83.png" data-width="1591"/><figcaption></figcaption></figure><p>Отдельное внимание стоило уделить анализу ликвидности, поэтому в отчёте ему посвящается отдельная страница:</p><figure class="full-width "><img src="/img/image-loader.svg" height="905" data-src="https://habrastorage.org/getpro/habr/upload_files/92a/4fc/393/92a4fc3936cad54029f3de0263e711a9.png" data-width="1545"/><figcaption></figcaption></figure><p>Исключительного "описательного" внимания заслуживает реализация модели Дюпон.</p><figure class="full-width "><img src="/img/image-loader.svg" height="915" data-src="https://habrastorage.org/getpro/habr/upload_files/737/d17/cde/737d17cdeb27aab9e553b2ceaf545644.png" data-width="1545"/><figcaption></figcaption></figure><p>Иной способ отобразить всю модель и по всем периодам не пришёл на ум. Здесь требуется перемещаться по чёрным стрелкам. Внизу для модели указаны терминальные критерии, т.е. те, на основе которых выстраиваются все дальнейшие вычисления. Данные критерии принимаются или вычисляются по формам отчётности. Каждому такому критерию указан графический символ (кругляшом определённого цвета). Поднимаясь на уровень выше с критериями проводятся математические действия и результат также получает свой графический символ.</p><p>Что можно ещё добавить именно по разработке модели? Не приходит на ум.</p><p><strong>Как исследовать и работать с моделью</strong></p><p>Модель призвана для решения следующих задач (это не исчерпывающий список, а то, что пришло в голову):</p><ul><li><p>Сравнить тенденции регионов с общей тенденцией в России и между собой;</p></li><li><p>Сравнить тенденции отдельных отраслей (через выбор ОКВЭД);</p></li><li><p>Сравнить тенденцию отдельного предприятия с общими по региону, ОКВЭД-ам и России в целом;</p></li><li><p>Определить применимость рекомендованных значений коэффициентов, моделей и т.д. для отдельных видов предприятий, отдельных субъектов;</p></li><li><p>Выявить "аномалии" (странности) в динамики и попытаться определить основные причины этих событий.</p></li></ul><p>Наверно и всё.</p><p><strong>Заключение</strong></p><p>Ещё раз позвольте выразить убеждённость, что данный труд, модель и статья не "лягут на полку", а окажутся действительно полезными для вас!  Если у Вас найдётся возможность помочь моему труду, предоставив актуальные базы за 2019,2020 годы, то буду крайне благодарен. Если сообщество решит меня поддержать материально, то уверяю, что если средств хватит - потрачу их на приобретение баз. </p><p>Отдельно обращаюсь к службам статистики. Товарищи! Проверьте, пожалуйста, базы данных и корректность их ведения! В них есть и достаточно много ошибок. На основе этих данных проводится экономический анализ и принимаются решения в части финансирования и управления.</p><p>Отдельное обращение к представителям финансовых организаций. Пожалуйста, не пользуйтесь слепо аналитическими моделями. Ситуация меняется, модели подходят не всем видам бизнеса, сами модели устаревают. </p><p>Рад был представить Вам эту работу.</p><p>P.S. Данные и результаты работы можно совершенно бесплатно получить на моём канале в <a href="https://t.me/ework_pro" rel="noopener noreferrer nofollow">Telegramm</a>. </p><p>P.S.2. <a class="mention" href="/users/microsoft">@Microsoft</a>! Являюсь не просто Вашим поклонником, но и адептом! Позвольте порекомендовать Вам расширить возможность бесплатной публикации отчётов для некоммерческих и учебных проектов. С одной стороны, Вы повысите популярность собственного инструмента, с другой стороны, сделаете мир немного лучше. Я хотел опубликовать этот отчёт онлайн, но возможности Power BI для бесплатной публикации ограничиваются 1 Гб размещаемой информации.</p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bpower%20bi%20desktop%5D" class="tm-tags-list__link">power bi desktop</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bpower%20query%5D" class="tm-tags-list__link">power query</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%8F%D0%B7%D1%8B%D0%BA%20m%5D" class="tm-tags-list__link">язык m</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bdax%5D" class="tm-tags-list__link">dax</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%5D" class="tm-tags-list__link">анализ данных</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%84%D0%B8%D0%BD%D0%B0%D0%BD%D1%81%D1%8B%5D" class="tm-tags-list__link">финансы</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B1%D1%83%D1%85%D0%B3%D0%B0%D0%BB%D1%82%D0%B5%D1%80%D1%81%D0%BA%D0%B0%D1%8F%20%D0%BE%D1%82%D1%87%D1%91%D1%82%D0%BD%D0%BE%D1%81%D1%82%D1%8C%5D" class="tm-tags-list__link">бухгалтерская отчётность</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/bigdata/" class="tm-hubs-list__link">
    Big Data
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 4: ↑4 и ↓0</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 4: ↑4 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+4</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.7K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    27
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/rick1177/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/92d/4f1/4c7/92d4f14c741d9ead7e1afda47d56d2ec.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 7 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    5
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">4</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Гуреев Кирилл</span> <a href="/ru/users/rick1177/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @rick1177
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Excel, R, DAX, Power Query, C#</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <button type="submit" class="tm-user-card__button btn btn_transparent btn_small">
      Задонатить
    </button> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/581030/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 2 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/581030/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/581030/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"581030":{"id":"581030","timePublished":"2021-10-17T22:18:51+00:00","isCorporative":false,"lang":"ru","titleHtml":"Как с применением Power BI создавалась система анализа финансово-хозяйственной деятельности предприятий России и зачем","leadData":{"textHtml":"\u003Cp\u003EДанный материал является, своего рода, рефератом, описывающим созданный продукт с применением инструмента Power BI, основанный на открытых статистических данных бухгалтерской отчётности предприятий России. В работе сделана попытка представить совокупность, как единым субъект, реагирующий  на изменения, который, тем не менее, можно разложить на региональные составляющие и описывающие деятельность.\u003C\u002Fp\u003E\u003Cp\u003EВ статье показан полный цикл создания (сквозная задача), а также представлена возможность скачать и ознакомиться с продуктом.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Ознакомиться &rarr;","image":null},"editorVersion":"2.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":5,"votesCount":7},"rating":4,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":"410014334241623","paymentPayPalMe":null,"paymentWebmoney":null},"id":"1355180","alias":"rick1177","fullname":"Гуреев Кирилл","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F92d\u002F4f1\u002F4c7\u002F92d4f14c741d9ead7e1afda47d56d2ec.jpg","speciality":"Excel, R, DAX, Power Query, C#"},"statistics":{"commentsCount":2,"favoritesCount":27,"readingCount":3657,"score":4,"votesCount":4},"hubs":[{"relatedData":null,"id":"17795","alias":"bigdata","type":"collective","title":"Big Data","titleHtml":"Big Data","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003E\u003Cstrong\u003EВместо вступления выражаю надежду\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fstrong\u003EИдея для данной работы вынашивалась какое-то время. Ранее не хватало навыков и знаний, но задавшись целью в течении года (52 недели по 16 часов работы = 832 часа (примерно, конечно же)) были изучены 2 инструмента работы с большими данными и методами построения отчётов.  Увиденный вами результат - следствие кропотливой работы, которая, в силу обстоятельств, описываемых ниже, скорее всего на этом и остановится. Однако! Вдруг кем-то будет замечена, получено продолжение и вырастет в нечто замечательное (надеюсь, что и я вместе с ней).\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EВсе представленные данные отныне являются полностью открытыми и каждый сможет повторить сделанное или взять уже готовое. Проделать данную работу мне не удалось бы без стимулирующего фактора - студентов, жаждущих новых знаний и вынуждающих двигаться вперёд, чтобы не выглядеть некрасиво. Также следует отметить, что и без технических возможностей Пермского национального исследовательского политехнического университета я бы также не обошёлся, поскольку домашних вычислительных мощностей просто не хватило бы. \u003Cbr\u002F\u003E\u003Cbr\u002F\u003EИтоговое решение я выкладываю на своём канале в Telegram, включая ссылки для скачивания баз-данных (вдруг пропадут). Искренне надеюсь, что для читающих не составит труда подписаться ну и поддержать меня и мой труд.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКому будет интересна данная статья?\u003C\u002Fstrong\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EВ сети, лично для меня, было достаточно трудно искать решение какой-либо сквозной задачи с применением Power BI. Т.е. есть отдельные частные примеры, есть учебники и видеоуроки и в целом много материала. Однако, достаточно мало полноценных мастер-классов, где даётся разъяснение всех этапов выполнения задания. По этой причине первая группа заинтересованных -  те, кто ищет подобный кейс с достаточно обывательским рассказом о причинах свершения тех или иных шагов.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EВторым заинтересованным лицом можно обозначить человека, имеющего отношение к миру финансов, анализу деятельности предприятий, кредитующих организаций. Продукт нацелен на представление информации о деятельности \"совокупности\" предприятий, что может помочь аналитику оценить состояние этой самой совокупности, детализировать отдельные её части и, наконец-то, осознать, что общепринятые коэффициенты оценки финансового состояния, методы оценки, зачастую, неприменимы к части субъектов рынка. Но об этом позже.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EВ качестве третьего заинтересованного можно выделить учёного-экономиста, аналитика, разрабатывающего  какие-либо актуальные подходы к оценке финансового состояния предприятия, отрасли, региона. \u003Cbr\u002F\u003E\u003Cbr\u002F\u003EОтдельно хочется обратить внимание на данную работу участников экономики, принимающих решения в части поддержки, финансирования, развития и т.д. Возможно для вас данный материал послужит основой для анализа и принятия решений.\u003C\u002Fp\u003E\u003Cp\u003E \u003Cstrong\u003EПочему на этом этапе данная работа может увянуть?\u003C\u002Fstrong\u003E  \u003Cstrong\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fstrong\u003EВсё просто. Приложение выстраивается на открытых данных, предоставляемых сайтом \u003Ca href=\"https:\u002F\u002Frosstat.gov.ru\u002F\" rel=\"noopener noreferrer nofollow\"\u003EФедеральной службы государственной статистики\u003C\u002Fa\u003E. На момент написания статьи данные находились по данной \u003Ca href=\"https:\u002F\u002Frosstat.gov.ru\u002Fopendata?division=&amp;tag=13&amp;updated_from=&amp;updated_to=&amp;search=&amp;search_by_name=on&amp;sort=&amp;per_page=40\" rel=\"noopener noreferrer nofollow\"\u003Eссылке\u003C\u002Fa\u003E. Если посмотреть, то 2018 - последний год, когда данные присутствуют. В дальнейшем было принято решение распространять массив данных по подписке, о чём свидетельствует \u003Ca href=\"https:\u002F\u002Fbo.nalog.ru\u002Fsubscriptions-service\" rel=\"noopener noreferrer nofollow\"\u003Eданный ресурс\u003C\u002Fa\u003E и данная запись на сайте \u003Ca href=\"https:\u002F\u002Fwww.nalog.gov.ru\u002Frn77\u002Fnews\u002Factivities_fts\u002F9809967\u002F\" rel=\"noopener noreferrer nofollow\"\u003EФедеральной налоговой службы\u003C\u002Fa\u003E. Чтобы получить свежий массив данных нужно уплатить 200 т.р. Очень хитрая манипуляция) Т.е. данные, вроде как, распространяются бесплатно, т.е. можно посмотреть информацию про любого агента, но вот получить массив - это уже по подписке. \u003Cbr\u002F\u003E\u003Cbr\u002F\u003EНадо сказать , что модель бизнеса очень прикольная. Получается, что ФНС обязала всех проверять своих контрагентов, в рамках проведения мероприятий по налоговому контролю в отношении соблюдения принципа должной осмотрительности и осторожности при выборе контрагента, используя открытые источники. Наплодились сайты, где формируется сводка по предприятиям, а потом ФНС взяла и принудила их уплачивать абонентскую плату, а данные собирает в обязательном порядке и бесплатно. Отличная модель.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EПоскольку вся работа выстраивается на голом энтузиазме и собственными силами, то, конечно же, выплачивать такие средства у меня возможности нет. Объяснить руководству ВУЗа необходимость такой покупки я тоже не смогу, поскольку мы на самоокупаемости и без продаж результатов не будет финансирования. Так что, если не найдётся помощь, то и работа останавливается на достигнутом. \u003Cbr\u002F\u003E\u003Cbr\u002F\u003EНо уже и этого результата достаточно, чтобы интересно и плодотворно поработать.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EДисклеймер (отказ от ответственности за переработку данных)\u003C\u002Fstrong\u003E  \u003Cbr\u002F\u003E\u003Cbr\u002F\u003EБудучи преисполненным уверенности, что работа ФНС - крайне кропотливый труд, а работники и система педантичны и точны, вначале я решал возникающие перед моим взором задачи, как задачи, по управлению, с корректными данными. Однако, в какой-то момент наступило понимание, что база вся в \"дырах\" и ошибках. Когда эти ошибки накапливаются, то анализ становится невозможным. \u003Cbr\u002F\u003E\u003Cbr\u002F\u003EОбнаруживается это элементарным суммированием всех балансов предприятий по статьям в группы и попыткой сопоставить дебет с кредитом. Когда сопоставление не пошло, то стало понятно, что ошибка именно в данных.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EЧтобы не быть голословным, давайте посмотрим некоторые совершенно случайные примеры, обнаруживаемые на момент написания статьи.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EРассмотрим предприятие Общество с ограниченной ответственностью сельскохозяйственный производственный комплекс «Аргамак». Отчётность данного предприятия Вы можете запросить (смотрим 2018 год) на \u003Ca href=\"https:\u002F\u002Fwww.gks.ru\u002Faccounting_report\" rel=\"noopener noreferrer nofollow\"\u003Eофициальном сайте статистики \u003C\u002Fa\u003Eпо ИНН (0228005239) или на любом другом сайте, где представлена информация о предприятиях, например, \u003Ca href=\"https:\u002F\u002Fwww.list-org.com\u002Fcompany\u002F4347724\u002Freport\" rel=\"noopener noreferrer nofollow\"\u003Eздесь\u003C\u002Fa\u003E. Что же мы обнаруживаем при просмотре  (сократив общий вид, чтобы уменьшить изображение)?\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"1224\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F80c\u002F44c\u002Fe0e\u002F80c44ce0e4c93d4adf2f67fcb335ffff.png\" data-width=\"1349\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EА обнаруживаем мы, что сумма по трём разделам баланса, предприятия (выделяются красным цветом) не соответствует проставленной сумме в итоговом Балансе (фиолетовая отметка). \u003Cbr\u002F\u003E\u003Cbr\u002F\u003EВ качестве второго примера можно представить ООО \"ТАТТРАНСКОНТУР\" (1650109381), где всё по тому же 2018 году обнаруживается подобная ситуация:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"1378\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8bf\u002F556\u002Fe43\u002F8bf556e43d58e5cbca82daa0c2b13952.png\" data-width=\"1460\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EЗдесь специально взяты различные сайты, где, в том числе, производится оценка финансово-хозяйственной деятельности предприятий (видимо на основе этих ошибочных данных) . \u003Cbr\u002F\u003E\u003Cbr\u002F\u003EМы не будем искать виноватого и пытаться судить о том, на каком этапе возникла данная проблема, однако, проводить задуманный анализ на этих данных было бы некорректно.\u003C\u002Fp\u003E\u003Cp\u003EЯ взял на себя смелость скорректировать балансы предприятий по определённой модели, за что прошу прощения. Мне пришлось пережить дискуссию с весьма уважаемыми датасаянтистами на эту тему, но вот на такой позиции я остался.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EОсобенности процесса импорта или \"Мощный запрос\"\u003C\u002Fstrong\u003E  (Power query)\u003C\u002Fp\u003E\u003Cp\u003EДля дальнейшего изложения требуется ознакомиться с логикой создания приложения с применением Power BI:\u003C\u002Fp\u003E\u003Cfigure class=\"float full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"5726\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb8c\u002F866\u002Ff2e\u002Fb8c866f2e1aa65db6207634e10a8d1aa.png\" data-width=\"9131\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EУсловно вся работа разделяется между Power Query и Power BI. PQ отвечает за создание соединений с данными, переработку до нужно вида и интеграцию результата в общую модель данных.\u003Cbr\u002F\u003EВ Power BI производится структурирование данных, если они из разных источников, группировка, при необходимости производятся дополнительные вычисления, создание новых мер и таблиц данных, необходимых для нужного отображения данных и подготовка конечного вида отчёта, максимально презентабельного для данной задачи. \u003C\u002Fp\u003E\u003Cp\u003EИсходи из сказанного, ранее произнесённая фраза \"Я взял на себя смелость скорректировать балансы предприятий \" правильно звучит так: \"В процессе подготовки данных они были частично модифицированы без нарушения  целостности\".\u003C\u002Fp\u003E\u003Cp\u003EПосле открытия Power BI самым целесообразным, по моему убеждению, является переход в редактор Power Query. Не смотря на то, что есть предподготовленные диалоги импорта данных, склоняю вас к написанию кода в \"чистом\" виде. Тем не менее должен сказать, что Power Query предлагает графический интерфейс для многих действий. Переход в PQ выглядит так:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"285\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F431\u002Fa58\u002F1fc\u002F431a581fc6d3bc3eac89bf075db83c5d.png\" data-width=\"1035\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cfigure class=\"float \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"522\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb75\u002F350\u002F52d\u002Fb7535052de02e594b6d7e514d20d1058.png\" data-width=\"285\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПосле попадания в PQ можно сформировать необходимый запрос, воспользовавшись имеющимися диалогами, однако, моим предпочтением является создание пустого запроса. Поскольку любые действия в PQ - выполнение функции, то всё, что нам необходимо выполнить прописывается \"ручками\".\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EВначале, поскольку все файлы будут лежать в одном месте, целесообразно прописать путь к файлам, который будет использоваться во всех запросах. \u003Cbr\u002F\u003E\u003Cbr\u002F\u003EПри выполнении работы соблюдалась логика, что при вводе запроса для каждого нового файла потребуется лишь изменить год.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Elet\n    #\"Директория хранения файлов\" = \"\\\\ns\\Public\\Power BI\\Data\\\"\nin\n    #\"Директория хранения файлов\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EСоответственно, прописав однажды путь, значительно упрощается жизнь. Сам запрос был назван \u003Cstrong\u003EFilesDirectory\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\u003Cp\u003EДалее формируются тексты запросов для каждого года. Надо отметить, что запрос для 2011 года выстраивается на данных 2012, поэтому ниже приведён отдельно:\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003E2011\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cpre\u003E\u003Ccode\u003Elet\n    #\"Год\" = 2012,\n\t#\"Путь расположения файлов\" = #\"FilesDirectory\",\n\t#\"Наименование файла данных\" = Lines.ToText(\n\t\t\t\t\t{\n\t\t\t\t\t\t\"data-20200331-structure-\",\n\t\t\t\t\t\tNumber.ToText(#\"Год\"),\n\t\t\t\t\t\t\"1231\"\n\t\t\t\t\t},\n\t\t\t\t\t\"\") as text,\n\t#\"Наименование файла структуры\" = Lines.ToText(\n\t\t\t\t\t{\n\t\t\t\t\t\t\"structure-\",\n\t\t\t\t\t\tNumber.ToText(#\"Год\"),\n\t\t\t\t\t\t\"1231\"\n\t\t\t\t\t},\n\t\t\t\t\t\"\") as text,\n\t#\"Расширение файла\" = \"csv\",\n\t#\"Длина таблица данных\" = 124,\n\t\n\t#\"Импорт_1\" = Lines.ToText(\n\t\t{\n\t\t\t#\"Путь расположения файлов\",\n\t\t\t#\"Наименование файла данных\",\n\t\t\t\".\",\n\t\t\t#\"Расширение файла\"\t\t\t\n\t\t},\n\t\t\"\") as text,\n\t#\"Данные_1\" = Csv.Document(File.Contents(#\"Импорт_1\"),\n\t\t\t\t\t\t\t\t\t\t\t\t[Delimiter=\";\", \n\t\t\t\t\t\t\t\t\t\t\t\tColumns=#\"Длина таблица данных\", \n\t\t\t\t\t\t\t\t\t\t\t\tEncoding=1251, \n\t\t\t\t\t\t\t\t\t\t\t\tQuoteStyle=QuoteStyle.None]),\n\t#\"Импорт_2\" = Lines.ToText(\n\t\t{\n\t\t\t#\"Путь расположения файлов\",\n\t\t\t\"Help\",\n\t\t\t\".\",\n\t\t\t#\"Расширение файла\"\t\t\t\n\t\t},\n\t\t\"\") as text,\n\t#\"Расшифровка_1\" = Csv.Document(File.Contents(#\"Импорт_2\"),\n\t\t\t\t\t\t\t\t\t\t\t\t[Delimiter=\";\", \n\t\t\t\t\t\t\t\t\t\t\t\tColumns=3, \n\t\t\t\t\t\t\t\t\t\t\t\tEncoding=1251, \n\t\t\t\t\t\t\t\t\t\t\t\tQuoteStyle=QuoteStyle.None]),\t\n\t#\"Расшифровка_2\" = Table.RenameColumns(#\"Расшифровка_1\",{{\"Column1\", \"Numer\"}, {\"Column2\", \"Name_RUS\"}, {\"Column3\", \"Name_ENG\"}}),\n\t\n\t#\"Импорт_3\" = Lines.ToText(\n\t\t{\n\t\t\t#\"Путь расположения файлов\",\n\t\t\t#\"Наименование файла структуры\",\n\t\t\t\".\",\n\t\t\t#\"Расширение файла\"\t\t\t\n\t\t},\n\t\t\"\") as text,\n\t#\"Структура_1\" = Csv.Document(File.Contents(#\"Импорт_3\"),\n\t\t\t\t\t\t\t\t\t\t\t\t[Delimiter=\",\", \n\t\t\t\t\t\t\t\t\t\t\t\tColumns=4, \n\t\t\t\t\t\t\t\t\t\t\t\tEncoding=1251, \n\t\t\t\t\t\t\t\t\t\t\t\tQuoteStyle=QuoteStyle.Csv]),\n\t#\"Структура_2\" =  Table.PromoteHeaders (#\"Структура_1\"),\n\n\t#\"Список_полей_1\" = #\"Структура_2\"[#\"field name\"],\n\t#\"Список_полей_2\"=List.FirstN(#\"Список_полей_1\", #\"Длина таблица данных\"),\n\t#\"Список_полей_3\" = Table.ColumnNames(#\"Данные_1\"),\n\t#\"Список_полей_4\" =  List.Zip({#\"Список_полей_3\",#\"Список_полей_2\"}),\n\t\n\t#\"Данные_2\" = Table.RenameColumns(#\"Данные_1\", #\"Список_полей_4\"),\n\t\t\n\t#\"Перечень стобцов\" = Table.FromList(Table.ColumnNames(#\"Данные_2\")),\t\n\t#\"Перечень стобцов с фильтром\" = Table.SelectRows(#\"Перечень стобцов\", each \n\t\t(Text.Length([Column1]) =5) and (Text.At([Column1], 4)=\"3\")),\n\t#\"Перечень стобцов с фильтром в виде списка\" = #\"Перечень стобцов с фильтром\"[Column1],\n\n    #\"Удаленные столбцы\" = Table.RemoveColumns(#\"Данные_2\",#\"Перечень стобцов с фильтром в виде списка\", MissingField.Ignore),\n\n\t#\"Перечень стобцов новый\" = Table.FromList(Table.ColumnNames(#\"Удаленные столбцы\")),\n\t#\"Перечень стобцов новый с фильтром\" = Table.SelectRows(#\"Перечень стобцов новый\", each \n\t\t(Text.Length([Column1]) =5) and (Text.At([Column1], 4)=\"4\")),\n\t#\"Перечень стобцов новый с заменой\" = Table.AddColumn(#\"Перечень стобцов новый с фильтром\", \"Result\", each Text.Combine({Text.RemoveRange([Column1],Text.Length([Column1])-1),\"3\"})),\n\t#\"Список_полей_6\"=#\"Перечень стобцов новый с заменой\"[Result],\n\t#\"Список_полей_5\" =  List.Zip({Table.ToList(#\"Перечень стобцов новый с фильтром\"), #\"Список_полей_6\"}),\n\n\t#\"Удаленные столбцы новый\" = Table.RenameColumns(#\"Удаленные столбцы\", #\"Список_полей_5\"),\n\t#\"Вид таблицы с добавленным годом\" = Table.AddColumn(#\"Удаленные столбцы новый\" , \"Year\", each 2011), \n\n\t#\"Финальный вид таблицы\" = Table.TransformColumns(\n\t\t#\"Вид таблицы с добавленным годом\",\n\t\t{\n\t\t\t{\n\t\t\t\"okved\", \n\t\t\teach \n\t\t\t\tText.Insert(\n\t\t\t\t\t\t(_),0,\n\t\t\t\t\t\t(if #\"Год\" &lt;= 2016 \n\t\t\t\t\t\tthen \"ОКВЭД: \"\n\t\t\t\t\t\telse \"ОКВЭД2: \")\n\t\t\t\t),\n\t\t\ttype text\n\t\t\t}\n\t\t}\n\t),\n\n\t\u002F\u002FБлок конвертации по кода 383, 384 ...\n\tlst1 = List.Skip(Table.ColumnNames(#\"Финальный вид таблицы\" ), 8), \n\tlst=List.Range(lst1,0,58),\n\tf=(x,y)=\u003EList.Accumulate(lst,x,(s,c)=\u003ERecord.TransformFields(s,{c,(x)=\u003ENumber.From(x)*y})),\n\tg=(x)=\u003E f(x,Number.Power(10, (Number.FromText(x[#\"measure\"])-383)*3)),\n\t\n\ttbl = Table.ToRecords(#\"Финальный вид таблицы\"),\n\ttrnsf= List.Transform(tbl,g),\n\t#\"Окончательный вид таблицы перед дополнительными вычислениями\" = Table.FromRecords(trnsf),\n\t\u002F\u002F...\n\t\n\t\t\n\n\t#\"Измененный тип 1\" = \n\tTable.TransformColumnTypes(#\"Окончательный вид таблицы перед дополнительными вычислениями\",{\n\t\t{\"11103\", Int64.Type},\n\t\t{\"11203\", Int64.Type},\n\t\t{\"11303\", Int64.Type},\n\t\t{\"11403\", Int64.Type},\n\t\t{\"11503\", Int64.Type},\n\t\t{\"11603\", Int64.Type},\n\t\t{\"11703\", Int64.Type},\n\t\t{\"11803\", Int64.Type},\n\t\t{\"11903\", Int64.Type},\n\t\t{\"11003\", Int64.Type},\n\t\t{\"12103\", Int64.Type},\n\t\t{\"12203\", Int64.Type},\n\t\t{\"12303\", Int64.Type},\n\t\t{\"12403\", Int64.Type},\n\t\t{\"12503\", Int64.Type},\n\t\t{\"12603\", Int64.Type},\n\t\t{\"12003\", Int64.Type},\n\t\t{\"16003\", Int64.Type},\n\t\t{\"13103\", Int64.Type},\n\t\t{\"13203\", Int64.Type},\n\t\t{\"13403\", Int64.Type},\n\t\t{\"13503\", Int64.Type},\n\t\t{\"13603\", Int64.Type},\n\t\t{\"13703\", Int64.Type},\n\t\t{\"13003\", Int64.Type},\n\t\t{\"14103\", Int64.Type},\n\t\t{\"14203\", Int64.Type},\n\t\t{\"14303\", Int64.Type},\n\t\t{\"14503\", Int64.Type},\n\t\t{\"14003\", Int64.Type},\n\t\t{\"15103\", Int64.Type},\n\t\t{\"15203\", Int64.Type},\n\t\t{\"15303\", Int64.Type},\n\t\t{\"15403\", Int64.Type},\n\t\t{\"15503\", Int64.Type},\n\t\t{\"15003\", Int64.Type},\n\t\t{\"17003\", Int64.Type},\n\t\t{\"21103\", Int64.Type},\n\t\t{\"21203\", Int64.Type},\n\t\t{\"21003\", Int64.Type},\n\t\t{\"22103\", Int64.Type},\n\t\t{\"22203\", Int64.Type},\n\t\t{\"22003\", Int64.Type},\n\t\t{\"23103\", Int64.Type},\n\t\t{\"23203\", Int64.Type},\n\t\t{\"23303\", Int64.Type},\n\t\t{\"23403\", Int64.Type},\n\t\t{\"23503\", Int64.Type},\n\t\t{\"23003\", Int64.Type},\n\t\t{\"24103\", Int64.Type},\n\t\t{\"24213\", Int64.Type},\n\t\t{\"24303\", Int64.Type},\n\t\t{\"24503\", Int64.Type},\n\t\t{\"24603\", Int64.Type},\n\t\t{\"24003\", Int64.Type},\n\t\t{\"25103\", Int64.Type},\n\t\t{\"25203\", Int64.Type},\n\t\t{\"25003\", Int64.Type}\n\t}),\n\n\n\t#\"Дополнительные вычисления 1\" = #\"Измененный тип 1\",\n\t\n    #\"Переименованные столбцы 1\" = Table.RenameColumns(#\"Дополнительные вычисления 1\",{{\"11003\", \"11003.1\"}}),\n\t#\"Переименованные столбцы 2\" = Table.RenameColumns(#\"Переименованные столбцы 1\",{{\"12003\", \"12003.1\"}}),\n\t#\"Переименованные столбцы 3\" = Table.RenameColumns(#\"Переименованные столбцы 2\",{{\"13003\", \"13003.1\"}}),\n\t#\"Переименованные столбцы 4\" = Table.RenameColumns(#\"Переименованные столбцы 3\",{{\"14003\", \"14003.1\"}}),\n\t#\"Переименованные столбцы 5\" = Table.RenameColumns(#\"Переименованные столбцы 4\",{{\"15003\", \"15003.1\"}}),\n\t#\"Переименованные столбцы 6\" = Table.RenameColumns(#\"Переименованные столбцы 5\",{{\"16003\", \"16003.1\"}}),\n\t#\"Переименованные столбцы 7\" = Table.RenameColumns(#\"Переименованные столбцы 6\",{{\"17003\", \"17003.1\"}}),\n\t\t\n    #\"Добавлен пользовательский объект 1\" = Table.AddColumn(#\"Переименованные столбцы 7\", \"11003.2\", each [11103]+[11203]+[11303]+[11403]+[11503]+[11603]+[11703]+[11803]+[11903], Int64.Type),\n\t#\"Добавлен пользовательский объект 2\" = Table.AddColumn(#\"Добавлен пользовательский объект 1\", \"12003.2\", each [12103]+[12203]+[12303]+[12403]+[12503]+[12603], Int64.Type),\n\t#\"Добавлен пользовательский объект 3\" = Table.AddColumn(#\"Добавлен пользовательский объект 2\", \"13003.2\", each [13103]+[13203]+[13403]+[13503]+[13603]+[13703], Int64.Type),\n\t#\"Добавлен пользовательский объект 4\" = Table.AddColumn(#\"Добавлен пользовательский объект 3\", \"14003.2\", each [14103]+[14203]+[14303]+[14503], Int64.Type),\n\t#\"Добавлен пользовательский объект 5\" = Table.AddColumn(#\"Добавлен пользовательский объект 4\", \"15003.2\", each [15103]+[15203]+[15303]+[15403]+[15503], Int64.Type),\n\t#\"Добавлен пользовательский объект 6\" = Table.AddColumn(#\"Добавлен пользовательский объект 5\", \"16003.2\", each [11003.2]+[12003.2], Int64.Type),\n\t#\"Добавлен пользовательский объект 7\" = Table.AddColumn(#\"Добавлен пользовательский объект 6\", \"17003.2\", each [13003.2]+[14003.2]+[15003.2], Int64.Type),\n\t\n\t#\"Промежуточная проверка 1\" = Table.AddColumn(#\"Добавлен пользовательский объект 7\", \"Проверка 1\", each [13003.2]+[14003.2]+[15003.2]-[11003.2]-[12003.2], Int64.Type),\n\n    \u002F\u002F#\"Удаленные столбцы после преобразования\" = Table.RemoveColumns(#\"Добавлен пользовательский объект 7\",{\"11003.1\", \"12003.1\",\"13003.1\",\"14003.1\",\"15003.1\",\"16003.1\",\"17003.1\"}),\n\t\u002F\u002F#\"Переупорядоченные столбцы\" = Table.ReorderColumns(#\"Удаленные столбцы после преобразования\",{\"name\", \"okpo\", \"okopf\", \"okfs\", \"okved\", \"inn\", \"measure\", \"type\", \"11103\", \"11203\", \"11303\", \"11403\", \"11503\", \"11603\", \"11703\", \"11803\", \"11903\", \"11003\", \"12103\", \"12203\", \"12303\", \"12403\", \"12503\", \"12603\", \"12003\", \"16003\", \"13103\", \"13203\", \"13403\", \"13503\", \"13603\", \"13703\", \"13003\", \"14103\", \"14203\", \"14303\", \"14503\", \"14003\", \"15103\", \"15203\", \"15303\", \"15403\", \"15503\", \"15003\", \"17003\", \"21103\", \"21203\", \"21003\", \"22103\", \"22203\", \"22003\", \"23103\", \"23203\", \"23303\", \"23403\", \"23503\", \"23003\", \"24103\", \"24213\", \"24303\", \"24503\", \"24603\", \"24003\", \"25103\", \"25203\", \"25003\", \"Year\"}),\n\t\n\t#\"Финальные вычисления 1\" = Table.AddColumn(\n\t\t#\"Промежуточная проверка 1\",\n\t\t\"11003\",\n\t\teach  (\n\t\t\tif ([11003.2]&lt;\u003E0) then  [11003.2] else ([11003.1])\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Переименованные столбцы 1.1\" = Table.RenameColumns(#\"Финальные вычисления 1\",{{\"11503\", \"11503.1\"}}),\n\n\t#\"Финальные вычисления 1.1\" = Table.AddColumn(\n\t\t#\"Переименованные столбцы 1.1\",\n\t\t\t\"11503\",\n\t\t\teach  (\n\t\t\t\tif ([11003.2]=0 and [11003.1]&lt;\u003E0)\n\t\t\t\tthen [11503.1]+([11003.1]-[11003.2])\n\t\t\t\telse [11503.1]\n\t\t),\n\t\tInt64.Type),\n\n\n\t#\"Финальные вычисления 2\" = Table.AddColumn(\n\t\t#\"Финальные вычисления 1.1\",\n\t\t\"12003\",\n\t\teach  (\n\t\t\tif ([12003.2]&lt;\u003E0) then  [12003.2] else ([12003.1])\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Переименованные столбцы 2.1\" = Table.RenameColumns(#\"Финальные вычисления 2\",{{\"12303\", \"12303.1\"}}),\n\n\t#\"Финальные вычисления 2.1\" = Table.AddColumn(\n\t\t#\"Переименованные столбцы 2.1\",\n\t\t\t\"12303\",\n\t\t\teach  (\n\t\t\t\tif ([12003.2]=0 and [12003.1]&lt;\u003E0)\n\t\t\t\tthen [12303.1]+([12003.1]-[12003.2])\n\t\t\t\telse [12303.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Финальные вычисления 3\" = Table.AddColumn(\n\t\t#\"Финальные вычисления 2.1\",\n\t\t\"13003\",\n\t\teach  (\n\t\t\tif ([13003.2]&lt;\u003E0) then  [13003.2] else ([13003.1])\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Переименованные столбцы 3.1\" = Table.RenameColumns(#\"Финальные вычисления 3\",{{\"13703\", \"13703.1\"}}),\n\n\t#\"Финальные вычисления 3.1\" = Table.AddColumn(\n\t\t#\"Переименованные столбцы 3.1\",\n\t\t\t\"13703\",\n\t\t\teach  (\n\t\t\t\tif ([13003.2]=0 and [13003.1]&lt;\u003E0)\n\t\t\t\tthen [13703.1]+([13003.1]-[13003.2])\n\t\t\t\telse [13703.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Финальные вычисления 4\" = Table.AddColumn(\n\t\t#\"Финальные вычисления 3.1\",\n\t\t\"14003\",\n\t\teach  (\n\t\t\tif ([14003.2]&lt;\u003E0) then  [14003.2] else ([14003.1])\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Переименованные столбцы 4.1\" = Table.RenameColumns(#\"Финальные вычисления 4\",{{\"14103\", \"14103.1\"}}),\n\n\t#\"Финальные вычисления 4.1\" = Table.AddColumn(\n\t\t#\"Переименованные столбцы 4.1\",\n\t\t\t\"14103\",\n\t\t\teach  (\n\t\t\t\tif ([14003.2]=0 and [14003.1]&lt;\u003E0)\n\t\t\t\tthen [14103.1]+([14003.1]-[14003.2])\n\t\t\t\telse [14103.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Финальные вычисления 5\" = Table.AddColumn(\n\t\t#\"Финальные вычисления 4.1\",\n\t\t\"15003\",\n\t\teach  (\n\t\t\tif ([15003.2]&lt;\u003E0) then  [15003.2] else ([15003.1])\n\t\t),\n\t\tInt64.Type), \n\n\t#\"Переименованные столбцы 5.1\" = Table.RenameColumns(#\"Финальные вычисления 5\",{{\"15203\", \"15203.1\"}}),\n\n\t#\"Финальные вычисления 5.1\" = Table.AddColumn(\n\t\t#\"Переименованные столбцы 5.1\",\n\t\t\t\"15203\",\n\t\t\teach  (\n\t\t\t\tif ([15003.2]=0 and [15003.1]&lt;\u003E0)\n\t\t\t\tthen [15203.1]+([15003.1]-[15003.2])\n\t\t\t\telse [15203.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Промежуточная проверка 2\" = Table.AddColumn(#\"Финальные вычисления 5.1\" , \"Проверка 2\", each [13003]+[14003]+[15003]-[11003]-[12003], Int64.Type),\n\n\n\t#\"Вторая итерация корректировки 1\" = Table.RemoveColumns(#\"Промежуточная проверка 2\",\n\t\t{\"13703.1\",\"14103.1\",\"15203.1\"}\n\t\t),\n\t#\"Вторая итерация корректировки 2\" = Table.RenameColumns(#\"Вторая итерация корректировки 1\" ,\n\t\t{\n\t\t\t{\"13703\", \"13703.1\"},\n\t\t\t{\"14103\", \"14103.1\"},\n\t\t\t{\"15203\", \"15203.1\"}\n\t\t}),\t\n\t\t\n\t#\"Вторая итерация корректировки 3\" = Table.AddColumn(\n\t\t#\"Вторая итерация корректировки 2\",\n\t\t\t\"15203\",\n\t\t\teach  (\n\t\t\t\tif (([11003]+[12003])&lt;\u003E([13003]+[14003]+[15003]))\n\t\t\t\tthen [15203.1]+Number.RoundDown((([11003]+[12003])-([13003]+[14003]+[15003]))\u002F3)\n\t\t\t\telse [15203.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Вторая итерация корректировки 4\" = Table.AddColumn(\n\t\t#\"Вторая итерация корректировки 3\",\n\t\t\t\"14103\",\n\t\t\teach  (\n\t\t\t\tif (([11003]+[12003])&lt;\u003E([13003]+[14003]+[15003]))\n\t\t\t\tthen [14103.1]+Number.RoundDown((([11003]+[12003])-([13003]+[14003]+[15003]))\u002F3)\n\t\t\t\telse [14103.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Вторая итерация корректировки 5\" = Table.RemoveColumns(#\"Вторая итерация корректировки 4\" ,\n\t\t{\"13003.1\",\"14003.1\",\"15003.1\"}),\n\n\t#\"Вторая итерация корректировки 6\" = Table.RenameColumns(#\"Вторая итерация корректировки 5\" ,\n\t\t{\n\t\t\t{\"13003\", \"13003.1\"},\n\t\t\t{\"14003\", \"14003.1\"},\n\t\t\t{\"15003\", \"15003.1\"}\n\t\t}),\t\n\t\n\t#\"Вторая итерация корректировки 7\" = Table.AddColumn(#\"Вторая итерация корректировки 6\",\n\t\t\"14003\", each [14103]+[14203]+[14303]+[14503], Int64.Type),\n\n\n\t#\"Вторая итерация корректировки 8\"  = Table.AddColumn(#\"Вторая итерация корректировки 7\" ,\n\t\t\"15003\", each [15103]+[15203]+[15303]+[15403]+[15503], Int64.Type),\n\t\n\t#\"Вторая итерация корректировки 9\" = Table.AddColumn(\n\t\t#\"Вторая итерация корректировки 8\",\n\t\t\t\"13703\",\n\t\t\teach  (\n\t\t\t\tif (([11003]+[12003])&lt;\u003E([13003.1]+[14003]+[15003]))\n\t\t\t\tthen [13703.1]+([11003]+[12003])-([13003.1]+[14003]+[15003])\n\t\t\t\telse [13703.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Вторая итерация корректировки 10\" = Table.AddColumn(#\"Вторая итерация корректировки 9\",\n\t\t\"13003\", each [13103]+[13203]+[13403]+[13503]+[13603]+[13703], Int64.Type),\t\n\n\n\t#\"Финальные вычисления 6.1\" = Table.AddColumn(\n\t\t#\"Вторая итерация корректировки 10\",\n\t\t\t\"16003\",\n\t\t\teach  (\n\t\t\t\t[11003]+[12003]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Финальные вычисления 7.1\" = Table.AddColumn(\n\t\t#\"Финальные вычисления 6.1\" ,\n\t\t\t\"17003\",\n\t\t\teach  (\n\t\t\t\t[13003]+[14003]+[15003]\n\t\t),\n\t\tInt64.Type),\n\n\n\t#\"Промежуточная проверка 3\" = Table.AddColumn(#\"Финальные вычисления 7.1\" , \"Проверка 3\", each [13003]+[14003]+[15003]-[11003]-[12003], Int64.Type),\n\n\n\t#\"Финальные вычисления\" = Table.RemoveColumns(#\"Промежуточная проверка 3\",\n\t{\t\"11003.1\", \"11003.2\", \"11503.1\",\n\t\t\"12003.1\", \"12003.2\", \"12303.1\",\n\t\t\"13003.1\", \"13003.2\", \"13703.1\",\n\t\t\"14003.1\", \"14003.2\", \"14103.1\",\n\t\t\"15003.1\", \"15003.2\", \"15203.1\",\n\t\t\"16003.1\", \"16003.2\",\n\t\t\"17003.1\", \"17003.2\",\n\t\t\"Проверка 1\", \"Проверка 2\", \"Проверка 3\" \n\t}\n\t),\n\n\t#\"Измененный тип 3\" = \n\tTable.TransformColumnTypes(#\"Финальные вычисления\",{\t\t\n\t\t{\"11503\", Int64.Type},\n\t\t{\"12303\", Int64.Type},\n\t\t{\"13703\", Int64.Type},\n\t\t{\"14103\", Int64.Type},\n\t\t{\"15203\", Int64.Type},\n\t\t\n\t\t{\"11003\", Int64.Type},\n\t\t{\"12003\", Int64.Type},\n\t\t{\"16003\", Int64.Type},\n\t\t{\"13003\", Int64.Type},\n\t\t{\"14003\", Int64.Type},\n\t\t{\"15003\", Int64.Type},\n\t\t{\"17003\", Int64.Type}\n\t}),\n\n    #\"Переупорядоченные столбцы\"= Table.ReorderColumns(#\"Финальные вычисления\",{\"name\", \"okpo\", \"okopf\", \"okfs\", \"okved\", \"inn\", \"measure\", \"type\", \"11103\", \"11203\", \"11303\", \"11403\", \"11503\", \"11603\", \"11703\", \"11803\", \"11903\", \"11003\", \"12103\", \"12203\", \"12303\", \"12403\", \"12503\", \"12603\", \"12003\", \"16003\", \"13103\", \"13203\", \"13403\", \"13503\", \"13603\", \"13703\", \"13003\", \"14103\", \"14203\", \"14303\", \"14503\", \"14003\", \"15103\", \"15203\", \"15303\", \"15403\", \"15503\", \"15003\", \"17003\" , \"21103\", \"21203\", \"21003\", \"22103\", \"22203\", \"22003\", \"23103\", \"23203\", \"23303\", \"23403\", \"23503\", \"23003\", \"24103\", \"24213\", \"24303\", \"24503\", \"24603\", \"24003\", \"25103\", \"25203\", \"25003\", \"Year\"}),\n\t\n\n\t#\"Результат\" = #\"Переупорядоченные столбцы\"\nin\n    Результат\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003E2012\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cpre\u003E\u003Ccode\u003Elet\n    #\"Год\" = 2012,\n\t#\"Путь расположения файлов\" = #\"FilesDirectory\",\n\t#\"Наименование файла данных\" = Lines.ToText(\n\t\t\t\t\t{\n\t\t\t\t\t\t\"data-20200331-structure-\",\n\t\t\t\t\t\tNumber.ToText(#\"Год\"),\n\t\t\t\t\t\t\"1231\"\n\t\t\t\t\t},\n\t\t\t\t\t\"\") as text,\n\t#\"Наименование файла структуры\" = Lines.ToText(\n\t\t\t\t\t{\n\t\t\t\t\t\t\"structure-\",\n\t\t\t\t\t\tNumber.ToText(#\"Год\"),\n\t\t\t\t\t\t\"1231\"\n\t\t\t\t\t},\n\t\t\t\t\t\"\") as text,\n\t#\"Расширение файла\" = \"csv\",\n\t#\"Длина таблица данных\" = 124,\n\t\n\t#\"Импорт_1\" = Lines.ToText(\n\t\t{\n\t\t\t#\"Путь расположения файлов\",\n\t\t\t#\"Наименование файла данных\",\n\t\t\t\".\",\n\t\t\t#\"Расширение файла\"\t\t\t\n\t\t},\n\t\t\"\") as text,\n\t#\"Данные_1\" = Csv.Document(File.Contents(#\"Импорт_1\"),\n\t\t\t\t\t\t\t\t\t\t\t\t[Delimiter=\";\", \n\t\t\t\t\t\t\t\t\t\t\t\tColumns=#\"Длина таблица данных\", \n\t\t\t\t\t\t\t\t\t\t\t\tEncoding=1251, \n\t\t\t\t\t\t\t\t\t\t\t\tQuoteStyle=QuoteStyle.None]),\n\t#\"Импорт_2\" = Lines.ToText(\n\t\t{\n\t\t\t#\"Путь расположения файлов\",\n\t\t\t\"Help\",\n\t\t\t\".\",\n\t\t\t#\"Расширение файла\"\t\t\t\n\t\t},\n\t\t\"\") as text,\n\t#\"Расшифровка_1\" = Csv.Document(File.Contents(#\"Импорт_2\"),\n\t\t\t\t\t\t\t\t\t\t\t\t[Delimiter=\";\", \n\t\t\t\t\t\t\t\t\t\t\t\tColumns=3, \n\t\t\t\t\t\t\t\t\t\t\t\tEncoding=1251, \n\t\t\t\t\t\t\t\t\t\t\t\tQuoteStyle=QuoteStyle.None]),\t\n\t#\"Расшифровка_2\" = Table.RenameColumns(#\"Расшифровка_1\",{{\"Column1\", \"Numer\"}, {\"Column2\", \"Name_RUS\"}, {\"Column3\", \"Name_ENG\"}}),\n\t\n\t#\"Импорт_3\" = Lines.ToText(\n\t\t{\n\t\t\t#\"Путь расположения файлов\",\n\t\t\t#\"Наименование файла структуры\",\n\t\t\t\".\",\n\t\t\t#\"Расширение файла\"\t\t\t\n\t\t},\n\t\t\"\") as text,\n\t#\"Структура_1\" = Csv.Document(File.Contents(#\"Импорт_3\"),\n\t\t\t\t\t\t\t\t\t\t\t\t[Delimiter=\",\", \n\t\t\t\t\t\t\t\t\t\t\t\tColumns=4, \n\t\t\t\t\t\t\t\t\t\t\t\tEncoding=1251, \n\t\t\t\t\t\t\t\t\t\t\t\tQuoteStyle=QuoteStyle.Csv]),\n\t#\"Структура_2\" =  Table.PromoteHeaders (#\"Структура_1\"),\n\n\t#\"Список_полей_1\" = #\"Структура_2\"[#\"field name\"],\n\t#\"Список_полей_2\"=List.FirstN(#\"Список_полей_1\", #\"Длина таблица данных\"),\n\t#\"Список_полей_3\" = Table.ColumnNames(#\"Данные_1\"),\n\t#\"Список_полей_4\" =  List.Zip({#\"Список_полей_3\",#\"Список_полей_2\"}),\n\t\n\t#\"Данные_2\" = Table.RenameColumns(#\"Данные_1\", #\"Список_полей_4\"),\n\t\t\n\t#\"Перечень стобцов\" = Table.FromList(Table.ColumnNames(#\"Данные_2\")),\t\n\t#\"Перечень стобцов с фильтром\" = Table.SelectRows(#\"Перечень стобцов\", each \n\t\t(Text.Length([Column1]) =5) and (Text.At([Column1], 4)=\"4\")),\n\t#\"Перечень стобцов с фильтром в виде списка\" = #\"Перечень стобцов с фильтром\"[Column1],\n\n    #\"Удаленные столбцы новый\" = Table.RemoveColumns(#\"Данные_2\",#\"Перечень стобцов с фильтром в виде списка\", MissingField.Ignore),\n\t\n\t#\"Вид таблицы с добавленным годом\" = Table.AddColumn(#\"Удаленные столбцы новый\" , \"Year\", each #\"Год\"), \n\n\t#\"Финальный вид таблицы\" = Table.TransformColumns(\n\t\t#\"Вид таблицы с добавленным годом\",\n\t\t{\n\t\t\t{\n\t\t\t\"okved\", \n\t\t\teach \n\t\t\t\tText.Insert(\n\t\t\t\t\t\t(_),0,\n\t\t\t\t\t\t(if #\"Год\" &lt;= 2016 \n\t\t\t\t\t\tthen \"ОКВЭД: \"\n\t\t\t\t\t\telse \"ОКВЭД2: \")\n\t\t\t\t),\n\t\t\ttype text\n\t\t\t}\n\t\t}\n\t),\n\n\t\u002F\u002FБлок конвертации по кода 383, 384 ...\n\tlst1 = List.Skip(Table.ColumnNames(#\"Финальный вид таблицы\" ), 8), \n\tlst=List.Range(lst1,0,58),\n\tf=(x,y)=\u003EList.Accumulate(lst,x,(s,c)=\u003ERecord.TransformFields(s,{c,(x)=\u003ENumber.From(x)*y})),\n\tg=(x)=\u003E f(x,Number.Power(10, (Number.FromText(x[#\"measure\"])-383)*3)),\n\t\n\ttbl = Table.ToRecords(#\"Финальный вид таблицы\"),\n\ttrnsf= List.Transform(tbl,g),\n\t#\"Окончательный вид таблицы перед дополнительными вычислениями\" = Table.FromRecords(trnsf),\n\t\u002F\u002F...\n\t\n\t\t\n\n\t#\"Измененный тип 1\" = \n\tTable.TransformColumnTypes(#\"Окончательный вид таблицы перед дополнительными вычислениями\",{\n\t\t{\"11103\", Int64.Type},\n\t\t{\"11203\", Int64.Type},\n\t\t{\"11303\", Int64.Type},\n\t\t{\"11403\", Int64.Type},\n\t\t{\"11503\", Int64.Type},\n\t\t{\"11603\", Int64.Type},\n\t\t{\"11703\", Int64.Type},\n\t\t{\"11803\", Int64.Type},\n\t\t{\"11903\", Int64.Type},\n\t\t{\"11003\", Int64.Type},\n\t\t{\"12103\", Int64.Type},\n\t\t{\"12203\", Int64.Type},\n\t\t{\"12303\", Int64.Type},\n\t\t{\"12403\", Int64.Type},\n\t\t{\"12503\", Int64.Type},\n\t\t{\"12603\", Int64.Type},\n\t\t{\"12003\", Int64.Type},\n\t\t{\"16003\", Int64.Type},\n\t\t{\"13103\", Int64.Type},\n\t\t{\"13203\", Int64.Type},\n\t\t{\"13403\", Int64.Type},\n\t\t{\"13503\", Int64.Type},\n\t\t{\"13603\", Int64.Type},\n\t\t{\"13703\", Int64.Type},\n\t\t{\"13003\", Int64.Type},\n\t\t{\"14103\", Int64.Type},\n\t\t{\"14203\", Int64.Type},\n\t\t{\"14303\", Int64.Type},\n\t\t{\"14503\", Int64.Type},\n\t\t{\"14003\", Int64.Type},\n\t\t{\"15103\", Int64.Type},\n\t\t{\"15203\", Int64.Type},\n\t\t{\"15303\", Int64.Type},\n\t\t{\"15403\", Int64.Type},\n\t\t{\"15503\", Int64.Type},\n\t\t{\"15003\", Int64.Type},\n\t\t{\"17003\", Int64.Type},\n\t\t{\"21103\", Int64.Type},\n\t\t{\"21203\", Int64.Type},\n\t\t{\"21003\", Int64.Type},\n\t\t{\"22103\", Int64.Type},\n\t\t{\"22203\", Int64.Type},\n\t\t{\"22003\", Int64.Type},\n\t\t{\"23103\", Int64.Type},\n\t\t{\"23203\", Int64.Type},\n\t\t{\"23303\", Int64.Type},\n\t\t{\"23403\", Int64.Type},\n\t\t{\"23503\", Int64.Type},\n\t\t{\"23003\", Int64.Type},\n\t\t{\"24103\", Int64.Type},\n\t\t{\"24213\", Int64.Type},\n\t\t{\"24303\", Int64.Type},\n\t\t{\"24503\", Int64.Type},\n\t\t{\"24603\", Int64.Type},\n\t\t{\"24003\", Int64.Type},\n\t\t{\"25103\", Int64.Type},\n\t\t{\"25203\", Int64.Type},\n\t\t{\"25003\", Int64.Type}\n\t}),\n\n\n\t#\"Дополнительные вычисления 1\" = #\"Измененный тип 1\",\n\t\n    #\"Переименованные столбцы 1\" = Table.RenameColumns(#\"Дополнительные вычисления 1\",{{\"11003\", \"11003.1\"}}),\n\t#\"Переименованные столбцы 2\" = Table.RenameColumns(#\"Переименованные столбцы 1\",{{\"12003\", \"12003.1\"}}),\n\t#\"Переименованные столбцы 3\" = Table.RenameColumns(#\"Переименованные столбцы 2\",{{\"13003\", \"13003.1\"}}),\n\t#\"Переименованные столбцы 4\" = Table.RenameColumns(#\"Переименованные столбцы 3\",{{\"14003\", \"14003.1\"}}),\n\t#\"Переименованные столбцы 5\" = Table.RenameColumns(#\"Переименованные столбцы 4\",{{\"15003\", \"15003.1\"}}),\n\t#\"Переименованные столбцы 6\" = Table.RenameColumns(#\"Переименованные столбцы 5\",{{\"16003\", \"16003.1\"}}),\n\t#\"Переименованные столбцы 7\" = Table.RenameColumns(#\"Переименованные столбцы 6\",{{\"17003\", \"17003.1\"}}),\n\t\t\n    #\"Добавлен пользовательский объект 1\" = Table.AddColumn(#\"Переименованные столбцы 7\", \"11003.2\", each [11103]+[11203]+[11303]+[11403]+[11503]+[11603]+[11703]+[11803]+[11903], Int64.Type),\n\t#\"Добавлен пользовательский объект 2\" = Table.AddColumn(#\"Добавлен пользовательский объект 1\", \"12003.2\", each [12103]+[12203]+[12303]+[12403]+[12503]+[12603], Int64.Type),\n\t#\"Добавлен пользовательский объект 3\" = Table.AddColumn(#\"Добавлен пользовательский объект 2\", \"13003.2\", each [13103]+[13203]+[13403]+[13503]+[13603]+[13703], Int64.Type),\n\t#\"Добавлен пользовательский объект 4\" = Table.AddColumn(#\"Добавлен пользовательский объект 3\", \"14003.2\", each [14103]+[14203]+[14303]+[14503], Int64.Type),\n\t#\"Добавлен пользовательский объект 5\" = Table.AddColumn(#\"Добавлен пользовательский объект 4\", \"15003.2\", each [15103]+[15203]+[15303]+[15403]+[15503], Int64.Type),\n\t#\"Добавлен пользовательский объект 6\" = Table.AddColumn(#\"Добавлен пользовательский объект 5\", \"16003.2\", each [11003.2]+[12003.2], Int64.Type),\n\t#\"Добавлен пользовательский объект 7\" = Table.AddColumn(#\"Добавлен пользовательский объект 6\", \"17003.2\", each [13003.2]+[14003.2]+[15003.2], Int64.Type),\n\t\n\t#\"Промежуточная проверка 1\" = Table.AddColumn(#\"Добавлен пользовательский объект 7\", \"Проверка 1\", each [13003.2]+[14003.2]+[15003.2]-[11003.2]-[12003.2], Int64.Type),\n\n    \u002F\u002F#\"Удаленные столбцы после преобразования\" = Table.RemoveColumns(#\"Добавлен пользовательский объект 7\",{\"11003.1\", \"12003.1\",\"13003.1\",\"14003.1\",\"15003.1\",\"16003.1\",\"17003.1\"}),\n\t\u002F\u002F#\"Переупорядоченные столбцы\" = Table.ReorderColumns(#\"Удаленные столбцы после преобразования\",{\"name\", \"okpo\", \"okopf\", \"okfs\", \"okved\", \"inn\", \"measure\", \"type\", \"11103\", \"11203\", \"11303\", \"11403\", \"11503\", \"11603\", \"11703\", \"11803\", \"11903\", \"11003\", \"12103\", \"12203\", \"12303\", \"12403\", \"12503\", \"12603\", \"12003\", \"16003\", \"13103\", \"13203\", \"13403\", \"13503\", \"13603\", \"13703\", \"13003\", \"14103\", \"14203\", \"14303\", \"14503\", \"14003\", \"15103\", \"15203\", \"15303\", \"15403\", \"15503\", \"15003\", \"17003\", \"21103\", \"21203\", \"21003\", \"22103\", \"22203\", \"22003\", \"23103\", \"23203\", \"23303\", \"23403\", \"23503\", \"23003\", \"24103\", \"24213\", \"24303\", \"24503\", \"24603\", \"24003\", \"25103\", \"25203\", \"25003\", \"Year\"}),\n\t\n\t#\"Финальные вычисления 1\" = Table.AddColumn(\n\t\t#\"Промежуточная проверка 1\",\n\t\t\"11003\",\n\t\teach  (\n\t\t\tif ([11003.2]&lt;\u003E0) then  [11003.2] else ([11003.1])\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Переименованные столбцы 1.1\" = Table.RenameColumns(#\"Финальные вычисления 1\",{{\"11503\", \"11503.1\"}}),\n\n\t#\"Финальные вычисления 1.1\" = Table.AddColumn(\n\t\t#\"Переименованные столбцы 1.1\",\n\t\t\t\"11503\",\n\t\t\teach  (\n\t\t\t\tif ([11003.2]=0 and [11003.1]&lt;\u003E0)\n\t\t\t\tthen [11503.1]+([11003.1]-[11003.2])\n\t\t\t\telse [11503.1]\n\t\t),\n\t\tInt64.Type),\n\n\n\t#\"Финальные вычисления 2\" = Table.AddColumn(\n\t\t#\"Финальные вычисления 1.1\",\n\t\t\"12003\",\n\t\teach  (\n\t\t\tif ([12003.2]&lt;\u003E0) then  [12003.2] else ([12003.1])\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Переименованные столбцы 2.1\" = Table.RenameColumns(#\"Финальные вычисления 2\",{{\"12303\", \"12303.1\"}}),\n\n\t#\"Финальные вычисления 2.1\" = Table.AddColumn(\n\t\t#\"Переименованные столбцы 2.1\",\n\t\t\t\"12303\",\n\t\t\teach  (\n\t\t\t\tif ([12003.2]=0 and [12003.1]&lt;\u003E0)\n\t\t\t\tthen [12303.1]+([12003.1]-[12003.2])\n\t\t\t\telse [12303.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Финальные вычисления 3\" = Table.AddColumn(\n\t\t#\"Финальные вычисления 2.1\",\n\t\t\"13003\",\n\t\teach  (\n\t\t\tif ([13003.2]&lt;\u003E0) then  [13003.2] else ([13003.1])\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Переименованные столбцы 3.1\" = Table.RenameColumns(#\"Финальные вычисления 3\",{{\"13703\", \"13703.1\"}}),\n\n\t#\"Финальные вычисления 3.1\" = Table.AddColumn(\n\t\t#\"Переименованные столбцы 3.1\",\n\t\t\t\"13703\",\n\t\t\teach  (\n\t\t\t\tif ([13003.2]=0 and [13003.1]&lt;\u003E0)\n\t\t\t\tthen [13703.1]+([13003.1]-[13003.2])\n\t\t\t\telse [13703.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Финальные вычисления 4\" = Table.AddColumn(\n\t\t#\"Финальные вычисления 3.1\",\n\t\t\"14003\",\n\t\teach  (\n\t\t\tif ([14003.2]&lt;\u003E0) then  [14003.2] else ([14003.1])\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Переименованные столбцы 4.1\" = Table.RenameColumns(#\"Финальные вычисления 4\",{{\"14103\", \"14103.1\"}}),\n\n\t#\"Финальные вычисления 4.1\" = Table.AddColumn(\n\t\t#\"Переименованные столбцы 4.1\",\n\t\t\t\"14103\",\n\t\t\teach  (\n\t\t\t\tif ([14003.2]=0 and [14003.1]&lt;\u003E0)\n\t\t\t\tthen [14103.1]+([14003.1]-[14003.2])\n\t\t\t\telse [14103.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Финальные вычисления 5\" = Table.AddColumn(\n\t\t#\"Финальные вычисления 4.1\",\n\t\t\"15003\",\n\t\teach  (\n\t\t\tif ([15003.2]&lt;\u003E0) then  [15003.2] else ([15003.1])\n\t\t),\n\t\tInt64.Type), \n\n\t#\"Переименованные столбцы 5.1\" = Table.RenameColumns(#\"Финальные вычисления 5\",{{\"15203\", \"15203.1\"}}),\n\n\t#\"Финальные вычисления 5.1\" = Table.AddColumn(\n\t\t#\"Переименованные столбцы 5.1\",\n\t\t\t\"15203\",\n\t\t\teach  (\n\t\t\t\tif ([15003.2]=0 and [15003.1]&lt;\u003E0)\n\t\t\t\tthen [15203.1]+([15003.1]-[15003.2])\n\t\t\t\telse [15203.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Промежуточная проверка 2\" = Table.AddColumn(#\"Финальные вычисления 5.1\" , \"Проверка 2\", each [13003]+[14003]+[15003]-[11003]-[12003], Int64.Type),\n\n\n\t#\"Вторая итерация корректировки 1\" = Table.RemoveColumns(#\"Промежуточная проверка 2\",\n\t\t{\"13703.1\",\"14103.1\",\"15203.1\"}\n\t\t),\n\t#\"Вторая итерация корректировки 2\" = Table.RenameColumns(#\"Вторая итерация корректировки 1\" ,\n\t\t{\n\t\t\t{\"13703\", \"13703.1\"},\n\t\t\t{\"14103\", \"14103.1\"},\n\t\t\t{\"15203\", \"15203.1\"}\n\t\t}),\t\n\t\t\n\t#\"Вторая итерация корректировки 3\" = Table.AddColumn(\n\t\t#\"Вторая итерация корректировки 2\",\n\t\t\t\"15203\",\n\t\t\teach  (\n\t\t\t\tif (([11003]+[12003])&lt;\u003E([13003]+[14003]+[15003]))\n\t\t\t\tthen [15203.1]+Number.RoundDown((([11003]+[12003])-([13003]+[14003]+[15003]))\u002F3)\n\t\t\t\telse [15203.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Вторая итерация корректировки 4\" = Table.AddColumn(\n\t\t#\"Вторая итерация корректировки 3\",\n\t\t\t\"14103\",\n\t\t\teach  (\n\t\t\t\tif (([11003]+[12003])&lt;\u003E([13003]+[14003]+[15003]))\n\t\t\t\tthen [14103.1]+Number.RoundDown((([11003]+[12003])-([13003]+[14003]+[15003]))\u002F3)\n\t\t\t\telse [14103.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Вторая итерация корректировки 5\" = Table.RemoveColumns(#\"Вторая итерация корректировки 4\" ,\n\t\t{\"13003.1\",\"14003.1\",\"15003.1\"}),\n\n\t#\"Вторая итерация корректировки 6\" = Table.RenameColumns(#\"Вторая итерация корректировки 5\" ,\n\t\t{\n\t\t\t{\"13003\", \"13003.1\"},\n\t\t\t{\"14003\", \"14003.1\"},\n\t\t\t{\"15003\", \"15003.1\"}\n\t\t}),\t\n\t\n\t#\"Вторая итерация корректировки 7\" = Table.AddColumn(#\"Вторая итерация корректировки 6\",\n\t\t\"14003\", each [14103]+[14203]+[14303]+[14503], Int64.Type),\n\n\n\t#\"Вторая итерация корректировки 8\"  = Table.AddColumn(#\"Вторая итерация корректировки 7\" ,\n\t\t\"15003\", each [15103]+[15203]+[15303]+[15403]+[15503], Int64.Type),\n\t\n\t#\"Вторая итерация корректировки 9\" = Table.AddColumn(\n\t\t#\"Вторая итерация корректировки 8\",\n\t\t\t\"13703\",\n\t\t\teach  (\n\t\t\t\tif (([11003]+[12003])&lt;\u003E([13003.1]+[14003]+[15003]))\n\t\t\t\tthen [13703.1]+([11003]+[12003])-([13003.1]+[14003]+[15003])\n\t\t\t\telse [13703.1]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Вторая итерация корректировки 10\" = Table.AddColumn(#\"Вторая итерация корректировки 9\",\n\t\t\"13003\", each [13103]+[13203]+[13403]+[13503]+[13603]+[13703], Int64.Type),\t\n\n\n\t#\"Финальные вычисления 6.1\" = Table.AddColumn(\n\t\t#\"Вторая итерация корректировки 10\",\n\t\t\t\"16003\",\n\t\t\teach  (\n\t\t\t\t[11003]+[12003]\n\t\t),\n\t\tInt64.Type),\n\n\t#\"Финальные вычисления 7.1\" = Table.AddColumn(\n\t\t#\"Финальные вычисления 6.1\" ,\n\t\t\t\"17003\",\n\t\t\teach  (\n\t\t\t\t[13003]+[14003]+[15003]\n\t\t),\n\t\tInt64.Type),\n\n\n\t#\"Промежуточная проверка 3\" = Table.AddColumn(#\"Финальные вычисления 7.1\" , \"Проверка 3\", each [13003]+[14003]+[15003]-[11003]-[12003], Int64.Type),\n\n\n\t#\"Финальные вычисления\" = Table.RemoveColumns(#\"Промежуточная проверка 3\",\n\t{\t\"11003.1\", \"11003.2\", \"11503.1\",\n\t\t\"12003.1\", \"12003.2\", \"12303.1\",\n\t\t\"13003.1\", \"13003.2\", \"13703.1\",\n\t\t\"14003.1\", \"14003.2\", \"14103.1\",\n\t\t\"15003.1\", \"15003.2\", \"15203.1\",\n\t\t\"16003.1\", \"16003.2\",\n\t\t\"17003.1\", \"17003.2\",\n\t\t\"Проверка 1\", \"Проверка 2\", \"Проверка 3\" \n\t}\n\t),\n\n\t#\"Измененный тип 3\" = \n\tTable.TransformColumnTypes(#\"Финальные вычисления\",{\t\t\n\t\t{\"11503\", Int64.Type},\n\t\t{\"12303\", Int64.Type},\n\t\t{\"13703\", Int64.Type},\n\t\t{\"14103\", Int64.Type},\n\t\t{\"15203\", Int64.Type},\n\t\t\n\t\t{\"11003\", Int64.Type},\n\t\t{\"12003\", Int64.Type},\n\t\t{\"16003\", Int64.Type},\n\t\t{\"13003\", Int64.Type},\n\t\t{\"14003\", Int64.Type},\n\t\t{\"15003\", Int64.Type},\n\t\t{\"17003\", Int64.Type}\n\t}),\n\n    #\"Переупорядоченные столбцы\"= Table.ReorderColumns(#\"Финальные вычисления\",{\"name\", \"okpo\", \"okopf\", \"okfs\", \"okved\", \"inn\", \"measure\", \"type\", \"11103\", \"11203\", \"11303\", \"11403\", \"11503\", \"11603\", \"11703\", \"11803\", \"11903\", \"11003\", \"12103\", \"12203\", \"12303\", \"12403\", \"12503\", \"12603\", \"12003\", \"16003\", \"13103\", \"13203\", \"13403\", \"13503\", \"13603\", \"13703\", \"13003\", \"14103\", \"14203\", \"14303\", \"14503\", \"14003\", \"15103\", \"15203\", \"15303\", \"15403\", \"15503\", \"15003\", \"17003\" , \"21103\", \"21203\", \"21003\", \"22103\", \"22203\", \"22003\", \"23103\", \"23203\", \"23303\", \"23403\", \"23503\", \"23003\", \"24103\", \"24213\", \"24303\", \"24503\", \"24603\", \"24003\", \"25103\", \"25203\", \"25003\", \"Year\"}),\n\t\n\n\t#\"Результат\" = #\"Переупорядоченные столбцы\"\nin\n    #\"Результат\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЕсли скачанные файлы вами не переименовывались и лежат в одном месте, а также вы указали папку в \u003Cstrong\u003EFilesDirectory\u003C\u002Fstrong\u003E, то повторив запрос 2012  для каждого из файлов, мы их все интегрируем и предварительно обработаем, чего, собственно, и добивались.\u003C\u002Fp\u003E\u003Cp\u003EОднако работать с такими данными не представляется возможным, потому их потребуется переработать. Для этих целей создаётся запрос Fact:\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EFact\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cpre\u003E\u003Ccode\u003Elet\n    #\"Исходные данные\" = Table.Combine({#\"2018\", #\"2017\", #\"2016\", #\"2015\", #\"2014\", #\"2013\", #\"2012\", #\"2011\"}),\n    \u002F\u002F#\"Исходные данные\" = Table.Combine({#\"2012\"}),\n    #\"Развёрнутая таблица\" = Table.UnpivotOtherColumns(#\"Исходные данные\", \n        List.Combine({List.FirstN(Table.ColumnNames( #\"Исходные данные\"),8),{\"Year\"}}), \"Attribute\", \"Value\"),\n    #\"Список колонок на удаление\" = List.RemoveItems(Table.ColumnNames(#\"Развёрнутая таблица\"),{\"inn\", \"Year\", \"okved\", \"Attribute\", \"Value\"}),\n        \n    #\"Таблица с удалёнными колонками\" = Table.RemoveColumns(#\"Развёрнутая таблица\",#\"Список колонок на удаление\" ),\n    #\"Таблица с корректным типами\" = Table.TransformColumnTypes(#\"Таблица с удалёнными колонками\",{{\"inn\", Text.Type}, {\"okved\", Text.Type}, {\"Year\", Int64.Type}, {\"Value\", Int64.Type}}),\n    #\"Переупорядоченные столбцы\" = Table.ReorderColumns(#\"Таблица с корректным типами\",{\"inn\", \"okved\", \"Year\", \"Attribute\", \"Value\"}),\n    \u002F\u002F#\"Строки с примененным фильтром\" = Table.SelectRows(Результат, each true)\n    #\"Результат\" = #\"Переупорядоченные столбцы\"\nin\n    Результат\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Cp\u003EСобственно, данный запрос формирует то, что нам нужно - таблица приемлемого формата, по которой теперь можно \"фильтроваться\", считать суммы и т.д. Эта таблица соответствует и принципам нормальности из СУБД.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EЕсли вы, кстати, внимательно посмотрите на все запросы, то увидите, что помимо файлов с данными потребуется некоторое количество дополнительных файлов: файлы структуры для каждой из баз, файл help (там расшифровки и названия для колонок таблиц с данными).\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EДля файла Help также формируется отдельный запрос:\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EHelp\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cpre\u003E\u003Ccode\u003Elet\n\t#\"Путь расположения файлов\" = #\"FilesDirectory\",\n\t#\"Расширение файла\" = \"csv\",\n\t#\"Импорт_2\" = Lines.ToText(\n\t\t{\n\t\t\t#\"Путь расположения файлов\",\n\t\t\t\"Help\",\n\t\t\t\".\",\n\t\t\t#\"Расширение файла\"\t\t\t\n\t\t},\n\t\t\"\") as text,\n\t#\"Расшифровка_1\" = Csv.Document(File.Contents(#\"Импорт_2\"),\n\t\t\t\t\t\t\t\t\t\t\t\t[Delimiter=\";\", \n\t\t\t\t\t\t\t\t\t\t\t\tColumns=3, \n\t\t\t\t\t\t\t\t\t\t\t\tEncoding=1251, \n\t\t\t\t\t\t\t\t\t\t\t\tQuoteStyle=QuoteStyle.None]),\t\n\t#\"Расшифровка_2\" = Table.RenameColumns(#\"Расшифровка_1\",{{\"Column1\", \"Numer\"}, {\"Column2\", \"Name_RUS\"}, {\"Column3\", \"Name_ENG\"}}),\n    #\"Результат\"= #\"Расшифровка_2\",\n    #\"Измененный тип\" = Table.TransformColumnTypes(Результат,{{\"Numer\", type text}})\nin\n    #\"Измененный тип\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Cp\u003EДалее потребуется выгрузить элементы фильтрации, т.е. ОКВЭД, год, Регион. Выглядит это так:\u003C\u002Fp\u003E\u003Col start=\"2\"\u003E\u003Cli\u003E\u003Cp\u003EЧтобы можно было выделить отдельное предприятие и сразу просмотреть его анализ, выделяем весь имеющийся перечень:\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EEnterprises\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cpre\u003E\u003Ccode\u003Elet\n    #\"Source\" = Table.Combine({#\"2018\", #\"2017\", #\"2016\", #\"2015\", #\"2014\", #\"2013\", #\"2012\", #\"2011\"}),\n    #\"Переупорядоченные столбцы\" = Table.ReorderColumns(#\"Source\",{\"name\", \"okpo\", \"okopf\", \"okfs\", \"okved\", \"inn\", \"measure\", \"type\", \"11103\", \"11203\", \"11303\", \"11403\", \"11503\", \"11603\", \"11703\", \"11803\", \"11903\", \"11003\", \"12103\", \"12203\", \"12303\", \"12403\", \"12503\", \"12603\", \"12003\", \"16003\", \"13103\", \"13203\", \"13403\", \"13503\", \"13603\", \"13703\", \"13003\", \"14103\", \"14203\", \"14303\", \"14503\", \"14003\", \"15103\", \"15203\", \"15303\", \"15403\", \"15503\", \"15003\", \"17003\", \"21103\", \"21203\", \"21003\", \"22103\", \"22203\", \"22003\", \"23103\", \"23203\", \"23303\", \"23403\", \"23503\", \"23003\", \"24103\", \"24213\", \"24303\", \"24503\", \"24603\", \"24003\", \"25103\", \"25203\", \"25003\", \"Year\"}),\n    #\"Removed Other Columns\" = Table.SelectColumns(Source,List.FirstN(Table.ColumnNames(#\"Переупорядоченные столбцы\"),8)),\n    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\", \"inn\")\nin\n    #\"Removed Duplicates\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EМогут понадобиться коды всех используемых строк финансовой отчётности:\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003ECodes\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cpre\u003E\u003Ccode\u003Elet\n    Source = Fact,\n    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"Attribute\"}),\n    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\")\nin\n    #\"Removed Duplicates\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EВытащим отдельно годы:\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EYears\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cpre\u003E\u003Ccode\u003Elet\n    Source = Fact,\n    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"Year\"}),\n    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\")\nin\n    #\"Removed Duplicates\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСформируем перечень регионов:\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EReg\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cpre\u003E\u003Ccode\u003Elet\n    Источник = #table(\n        type table [ID = text, GegName = text],\n        {\n            {\"01\",\"Адыгея республика\"},\n            {\"02\",\"Башкортостан республика\"},\n            {\"03\",\"Бурятия республика\"},\n            {\"04\",\"Алтай республика\"},\n            {\"05\",\"Дагестан республика\"},\n            {\"06\",\"Ингушетия республика\"},\n            {\"07\",\"Кабардино-Балкарская республика\"},\n            {\"08\",\"Калмыкия республика\"},\n            {\"09\",\"Карачаево-Черкесская республика\"},\n            {\"10\",\"Карелия республика\"},\n            {\"11\",\"Коми республика\"},\n            {\"12\",\"Марий Эл республика\"},\n            {\"13\",\"Мордовия республика\"},\n            {\"14\",\"Саха \u002FЯкутия\u002F республика\"},\n            {\"15\",\"Северная Осетия - Алания республика\"},\n            {\"16\",\"Татарстан республика\"},\n            {\"17\",\"Тыва республика\"},\n            {\"18\",\"Удмуртская республика\"},\n            {\"19\",\"Хакасия республика\"},\n            {\"20\",\"Чеченская республика\"},\n            {\"21\",\"Чувашская Республика - Чувашия\"},\n            {\"22\",\"Алтайский край\"},\n            {\"23\",\"Краснодарский край\"},\n            {\"24\",\"Красноярский край\"},\n            {\"25\",\"Приморский край\"},\n            {\"26\",\"Ставропольский край\"},\n            {\"27\",\"Хабаровский край\"},\n            {\"28\",\"Амурская область\"},\n            {\"29\",\"Архангельская область\"},\n            {\"30\",\"Астраханская область\"},\n            {\"31\",\"Белгородская область\"},\n            {\"32\",\"Брянская область\"},\n            {\"33\",\"Владимирская область\"},\n            {\"34\",\"Волгоградская область\"},\n            {\"35\",\"Вологодская область\"},\n            {\"36\",\"Воронежская область\"},\n            {\"37\",\"Ивановская область\"},\n            {\"38\",\"Иркутская область\"},\n            {\"39\",\"Калининградская область\"},\n            {\"40\",\"Калужская область\"},\n            {\"41\",\"Камчатский край\"},\n            {\"42\",\"Кемеровская область\"},\n            {\"43\",\"Кировская область\"},\n            {\"44\",\"Костромская область\"},\n            {\"45\",\"Курганская область\"},\n            {\"46\",\"Курская область\"},\n            {\"47\",\"Ленинградская область\"},\n            {\"48\",\"Липецкая область\"},\n            {\"49\",\"Магаданская область\"},\n            {\"50\",\"Московская область\"},\n            {\"51\",\"Мурманская область\"},\n            {\"52\",\"Нижегородская область\"},\n            {\"53\",\"Новгородская область\"},\n            {\"54\",\"Новосибирская область\"},\n            {\"55\",\"Омская область\"},\n            {\"56\",\"Оренбургская область\"},\n            {\"57\",\"Орловская область\"},\n            {\"58\",\"Пензенская область\"},\n            {\"59\",\"Пермский край\"},\n            {\"60\",\"Псковская область\"},\n            {\"61\",\"Ростовская область\"},\n            {\"62\",\"Рязанская область\"},\n            {\"63\",\"Самарская область\"},\n            {\"64\",\"Саратовская область\"},\n            {\"65\",\"Сахалинская область\"},\n            {\"66\",\"Свердловская область\"},\n            {\"67\",\"Смоленская область\"},\n            {\"68\",\"Тамбовская область\"},\n            {\"69\",\"Тверская область\"},\n            {\"70\",\"Томская область\"},\n            {\"71\",\"Тульская область\"},\n            {\"72\",\"Тюменская область\"},\n            {\"73\",\"Ульяновская область\"},\n            {\"74\",\"Челябинская область\"},\n            {\"75\",\"Забайкальский край\"},\n            {\"76\",\"Ярославская область\"},\n            {\"77\",\"Москва город\"},\n            {\"78\",\"Санкт-Петербург город\"},\n            {\"79\",\"Еврейская автономная область\"},\n            {\"83\",\"Ненецкий автономный округ\"},\n            {\"86\",\"Ханты-Мансийский Автономный округ - Югра автономный округ\"},\n            {\"87\",\"Чукотский автономный округ\"},\n            {\"89\",\"Ямало-Ненецкий автономный округ\"},\n            {\"91\",\"Крым республика\"},\n            {\"92\",\"Севастополь город\"},\n            {\"99\",\"Байконур город\"}\n\n        }\n\n    ),\n    #\"Переименованные столбцы\" = Table.RenameColumns(Источник,{{\"GegName\", \"Регион\"}})\nin\n    #\"Переименованные столбцы\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EВыделим перечень ОКВЭД-ов:\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003Eokved\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cpre\u003E\u003Ccode\u003Elet\n    Source = Fact,\n    #\"Removed Other Columns\" = Table.SelectColumns(Source,{\"okved\"}),\n    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\")\nin\n    #\"Removed Duplicates\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cfigure class=\"float \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"578\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff4d\u002F8e1\u002F1bb\u002Ff4d8e11bb2b4b1432297bd904c710a1b.png\" data-width=\"184\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EСобственно, на этом временно с запросами можно закончить и выгрузить все, нажав на кнопку  \"Закрыть и применить\". Перечень запросов к этой стадии реализации выглядит указанным образом.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EНе обольщайтесь, проделана лишь часть работы, но она одна из ключевых.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EПосле начала загрузки у меня перерасчёт и дозагрузка происходит примерно ~ 24 часа. Не могу сказать норма ли это. При этом устройство, на котором выполнялась работа - достаточно мощное. \u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\"Заблюренные\" таблицы у Вас появятся чуть позже, а сейчас следует, согласно нашего плана, структурировать данные и выстроить взаимосвязи.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Cp\u003EПосле \"импорта\" данных потребуется их структурировать, указав взаимосвязи между таблицами. Это ключевой и необходимый момент, чтобы появилась возможность фильтрации и выбора данных по признакам. Общий вид таков:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"1040\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd88\u002Fb2e\u002Fd9c\u002Fd88b2ed9cb354e9e6ad6d3e77d16b703.png\" data-width=\"1574\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПрактически все связи выстраивались в логике 1 ко многим. Power BI предоставляет посмотреть структуру связей в формате таблицы:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"536\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc09\u002F86e\u002Fa7d\u002Fc0986ea7d2317319d6925e91edda76a1.png\" data-width=\"757\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПо итогу этих действий мы полностью готовы к формированию отчёта и разработке представлений. \u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EРазработка интерфейса (\u003C\u002Fstrong\u003Eплюшки, особенности\u003Cstrong\u003E)\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EИтоговый внешний вид пользовательского интерфейса получился таковым:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"868\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f7\u002Fbd6\u002Fbc2\u002F4f7bd6bc278d062a507ca64261bb39de.png\" data-width=\"1545\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EСлева пользователю доступны \"разделы\" (на самом деле, страницы) отчёта, перемещение по которым производится нажатием левой кнопки мыши (ЛКМ)  при зажатой клавише ctrl. \u003C\u002Fp\u003E\u003Cp\u003EИнтересным аспектом данной страницы является ограничение \"бегунком\" (модифицированным срезом) числа, демонстрируемых объектов в диаграмме и таблице. \u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003E\u003Cem\u003EКак реализовано? А вот так...\u003C\u002Fem\u003E\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EСначала создаётся простая одностолбцовая таблица:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003EКол-во в рейтинге = GENERATESERIES(5, 88, 1)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКидаем срез на лист, указываем его тип :\"одиночное значение\", в качестве поля (аргумента), указываем \"\u003Ccode\u003EКол-во в рейтинге\u003C\u002Fcode\u003E\". Теперь срез будет принимать только указанные в данной таблице значения. Следующая функция будет указывать, какое именно значение выбрано фильтром:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003EЗначение Кол-ва в рейтинге = SELECTEDVALUE('Кол-во в рейтинге'[Кол-во в рейтинге])\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТеперь необходимо по каждому региону выставить рейтинг в зависимости от числа предприятий в нём:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003EРангРегионаПоКоличествуПредприятий = \nVAR REGToRank = [Значение Кол-ва в рейтинге]\nVAR Ranking = \n    RANKX(\n        ALLSELECTED(NewReg[Регион]), COUNTROWS ( RELATEDTABLE (Enterprises))\n    )\nVAR IsOtherSelected = SELECTEDVALUE(NewReg[Регион]) = \"Другие\"\nVAR Result = IF (IsOtherSelected, REGToRank+1, \n        IF (Ranking&lt;=REGToRank,Ranking,Ranking+1))\nRETURN Result\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЧто осталось сделать... указать для регионов, чей рейтинг в пределе интересующего их соответствие, а остальным - нет:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003EКол-воВРейтинге = \nVAR Ranking = [РангРегионаПоКоличествуПредприятий]\nVAR TopNValue = [Значение Кол-ва в рейтинге]\nVAR Result = Int(Ranking&lt;=TopNValue+1)\nRETURN\n    Result\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ итоге, настроив для графического элемента фильтр, можно показывать только те регионы, что попали в интересующий рейтинг:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"680\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd36\u002Fa34\u002F55a\u002Fd36a3455aff7872afd1ff886b748bd28.png\" data-width=\"1920\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПоскольку суммарные значения по денежным позициям весьма велики, то для управления отображением значений пришлось реализовать переключатель единиц измерения. Например, на втором отчёте он уже появляется:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"868\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff44\u002F77d\u002F2c8\u002Ff4477d2c8517cbfbe6f3a008021ef5e3.png\" data-width=\"1544\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Cstrong\u003EРеализация переключения единиц измерения\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EВ первую очередь нужно прямо в Power BI создать таблицу с применением синтаксиса DAX (для разнообразия, так сказать, а то всё PQ, да PQ):\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003EDisplay = DATATABLE(\"Type\",STRING,\n{\n    {\"1. Рубли\"},\n    {\"2. Тысячи рублей\"},\n    {\"3. Миллионы рублей\"},\n    {\"4. Миллиарды рублей\"},\n    {\"5. Триллионы рублей\"},\n    {\"6. Квадриллионы рублей\"}\n}\n)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТеперь можно создать срез и сразу на него и разместить Type.\u003C\u002Fp\u003E\u003Cp\u003EНу а дальше всё достаточно просто. В любой элемент размещаются не сами значения, а их \"форматированные копии\". А для этих самых копий пишется такой синтаксис:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003EFormatted Value = \nSWITCH(\n    TRUE(),\n        SELECTEDVALUE(Display[Type]) = \"1. Рубли\", FORMAT(SUM(Fact[Value]), \"### ### ### ### ##0\"),\n        SELECTEDVALUE(Display[Type]) = \"2. Тысячи рублей\", FORMAT(SUM(Fact[Value])\u002F1000, \"### ### ### ### ##0\"),\n        SELECTEDVALUE(Display[Type]) = \"3. Миллионы рублей\", FORMAT(SUM(Fact[Value])\u002F1000000, \"### ### ### ### ##0\"),\n        SELECTEDVALUE(Display[Type]) = \"4. Миллиарды рублей\", FORMAT(SUM(Fact[Value])\u002F1000000000, \"### ### ### ### ##0\"),\n        SELECTEDVALUE(Display[Type]) = \"5. Триллионы рублей\", FORMAT(SUM(Fact[Value])\u002F1000000000000, \"### ### ### ### ##0\"),\n        SELECTEDVALUE(Display[Type]) = \"6. Квадриллионы рублей\", FORMAT(SUM(Fact[Value])\u002F1000000000000000, \"### ### ### ### ##0\")\n)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EНу вот, более-менее и прояснилось всё.\u003C\u002Fp\u003E\u003Cp\u003EВ отчёте содержится анализ по форме 2:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"862\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F141\u002F456\u002F2fb\u002F1414562fb3be2a16b30a22b179a35a24.png\" data-width=\"1920\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВключил в отчёт анализ по основным финансовым коэффициентам:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"929\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe86\u002Fdf0\u002F677\u002Fe86df0677b5c5a980f73d41e20f6ad83.png\" data-width=\"1591\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EОтдельное внимание стоило уделить анализу ликвидности, поэтому в отчёте ему посвящается отдельная страница:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"905\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F92a\u002F4fc\u002F393\u002F92a4fc3936cad54029f3de0263e711a9.png\" data-width=\"1545\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EИсключительного \"описательного\" внимания заслуживает реализация модели Дюпон.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"915\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F737\u002Fd17\u002Fcde\u002F737d17cdeb27aab9e553b2ceaf545644.png\" data-width=\"1545\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EИной способ отобразить всю модель и по всем периодам не пришёл на ум. Здесь требуется перемещаться по чёрным стрелкам. Внизу для модели указаны терминальные критерии, т.е. те, на основе которых выстраиваются все дальнейшие вычисления. Данные критерии принимаются или вычисляются по формам отчётности. Каждому такому критерию указан графический символ (кругляшом определённого цвета). Поднимаясь на уровень выше с критериями проводятся математические действия и результат также получает свой графический символ.\u003C\u002Fp\u003E\u003Cp\u003EЧто можно ещё добавить именно по разработке модели? Не приходит на ум.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКак исследовать и работать с моделью\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EМодель призвана для решения следующих задач (это не исчерпывающий список, а то, что пришло в голову):\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EСравнить тенденции регионов с общей тенденцией в России и между собой;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСравнить тенденции отдельных отраслей (через выбор ОКВЭД);\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСравнить тенденцию отдельного предприятия с общими по региону, ОКВЭД-ам и России в целом;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EОпределить применимость рекомендованных значений коэффициентов, моделей и т.д. для отдельных видов предприятий, отдельных субъектов;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EВыявить \"аномалии\" (странности) в динамики и попытаться определить основные причины этих событий.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EНаверно и всё.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EЗаключение\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cp\u003EЕщё раз позвольте выразить убеждённость, что данный труд, модель и статья не \"лягут на полку\", а окажутся действительно полезными для вас!  Если у Вас найдётся возможность помочь моему труду, предоставив актуальные базы за 2019,2020 годы, то буду крайне благодарен. Если сообщество решит меня поддержать материально, то уверяю, что если средств хватит - потрачу их на приобретение баз. \u003C\u002Fp\u003E\u003Cp\u003EОтдельно обращаюсь к службам статистики. Товарищи! Проверьте, пожалуйста, базы данных и корректность их ведения! В них есть и достаточно много ошибок. На основе этих данных проводится экономический анализ и принимаются решения в части финансирования и управления.\u003C\u002Fp\u003E\u003Cp\u003EОтдельное обращение к представителям финансовых организаций. Пожалуйста, не пользуйтесь слепо аналитическими моделями. Ситуация меняется, модели подходят не всем видам бизнеса, сами модели устаревают. \u003C\u002Fp\u003E\u003Cp\u003EРад был представить Вам эту работу.\u003C\u002Fp\u003E\u003Cp\u003EP.S. Данные и результаты работы можно совершенно бесплатно получить на моём канале в \u003Ca href=\"https:\u002F\u002Ft.me\u002Fework_pro\" rel=\"noopener noreferrer nofollow\"\u003ETelegramm\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Cp\u003EP.S.2. \u003Ca class=\"mention\" href=\"\u002Fusers\u002Fmicrosoft\"\u003E@Microsoft\u003C\u002Fa\u003E! Являюсь не просто Вашим поклонником, но и адептом! Позвольте порекомендовать Вам расширить возможность бесплатной публикации отчётов для некоммерческих и учебных проектов. С одной стороны, Вы повысите популярность собственного инструмента, с другой стороны, сделаете мир немного лучше. Я хотел опубликовать этот отчёт онлайн, но возможности Power BI для бесплатной публикации ограничиваются 1 Гб размещаемой информации.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"power bi desktop"},{"titleHtml":"power query"},{"titleHtml":"язык m"},{"titleHtml":"dax"},{"titleHtml":"анализ данных"},{"titleHtml":"финансы"},{"titleHtml":"бухгалтерская отчётность"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F581030\u002Fe00c693e9772343328b1370a871b6822\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F581030\u002Fe00c693e9772343328b1370a871b6822\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F581030\\\u002F\"},\"headline\":\"Как с применением Power BI создавалась система анализа финансово-хозяйственной деятельности предприятий России и зачем\",\"datePublished\":\"2021-10-18T01:18:51+03:00\",\"dateModified\":\"2021-10-19T13:17:16+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Гуреев Кирилл\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Вместо вступления выражаю надеждуИдея для данной работы вынашивалась какое-то время. Ранее не хватало навыков и знаний, но задавшись целью в течении года (52 нед...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F581030\\\u002F#post-content-body\",\"about\":[\"h_bigdata\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F80c\\\u002F44c\\\u002Fe0e\\\u002F80c44ce0e4c93d4adf2f67fcb335ffff.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F8bf\\\u002F556\\\u002Fe43\\\u002F8bf556e43d58e5cbca82daa0c2b13952.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fb8c\\\u002F866\\\u002Ff2e\\\u002Fb8c866f2e1aa65db6207634e10a8d1aa.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F431\\\u002Fa58\\\u002F1fc\\\u002F431a581fc6d3bc3eac89bf075db83c5d.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fb75\\\u002F350\\\u002F52d\\\u002Fb7535052de02e594b6d7e514d20d1058.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Ff4d\\\u002F8e1\\\u002F1bb\\\u002Ff4d8e11bb2b4b1432297bd904c710a1b.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fd88\\\u002Fb2e\\\u002Fd9c\\\u002Fd88b2ed9cb354e9e6ad6d3e77d16b703.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fc09\\\u002F86e\\\u002Fa7d\\\u002Fc0986ea7d2317319d6925e91edda76a1.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F4f7\\\u002Fbd6\\\u002Fbc2\\\u002F4f7bd6bc278d062a507ca64261bb39de.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fd36\\\u002Fa34\\\u002F55a\\\u002Fd36a3455aff7872afd1ff886b748bd28.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Ff44\\\u002F77d\\\u002F2c8\\\u002Ff4477d2c8517cbfbe6f3a008021ef5e3.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F141\\\u002F456\\\u002F2fb\\\u002F1414562fb3be2a16b30a22b179a35a24.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fe86\\\u002Fdf0\\\u002F677\\\u002Fe86df0677b5c5a980f73d41e20f6ad83.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F92a\\\u002F4fc\\\u002F393\\\u002F92a4fc3936cad54029f3de0263e711a9.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F737\\\u002Fd17\\\u002Fcde\\\u002F737d17cdeb27aab9e553b2ceaf545644.png\"]}","metaDescription":"Вместо вступления выражаю надеждуИдея для данной работы вынашивалась какое-то время. Ранее не хватало навыков и знаний, но задавшись целью в течении года (52 недели по 16 часов работы = 832 часа...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"bigdata"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
