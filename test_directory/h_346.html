<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Tun2Socks: прокси-сервер в качестве шлюза, или VPN через прокси / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/company\/itsoft\/blog\/584162\/"},"headline":"Tun2Socks: прокси-сервер в качестве шлюза, или VPN через прокси","datePublished":"2021-10-18T18:35:21+03:00","dateModified":"2021-10-22T21:03:46+03:00","author":{"@type":"Person","name":"acetone"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Что такое Tun2SocksИнструкция для WindowsИнструкция для LinuxВ бытовом случае в сетевых настройках вашего компьютера указан шлюз по умолчанию. Чаще всего устройс...","url":"https:\/\/habr.com\/ru\/company\/itsoft\/blog\/584162\/#post-content-body","about":["c_itsoft","h_sys_admin","h_network_technologies","h_network_hardware","h_lifehacks","f_admin","f_popsci"],"image":["https:\/\/habr.com\/share\/publication\/584162\/4ee3d252ff655a30dd4d481f5c5134da\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/f40\/55a\/524\/f4055a524bdcdf3b6fbaf8bab12d756f.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/a39\/601\/be4\/a39601be4c500439764e3fd8cfb13471.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Tun2Socks: прокси-сервер в качестве шлюза, или VPN через прокси" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Tun2Socks: прокси-сервер в качестве шлюза, или VPN через прокси" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Tun2Socks: прокси-сервер в качестве шлюза, или VPN через прокси" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Что такое Tun2SocksИнструкция для WindowsИнструкция для LinuxВ бытовом случае в сетевых настройках вашего компьютера указан шлюз по умолчанию. Чаще всего устройство, являющееся шлюзом, называют..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Что такое Tun2SocksИнструкция для WindowsИнструкция для LinuxВ бытовом случае в сетевых настройках вашего компьютера указан шлюз по умолчанию. Чаще всего устройство, являющееся шлюзом, называют..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Что такое Tun2SocksИнструкция для WindowsИнструкция для LinuxВ бытовом случае в сетевых настройках вашего компьютера указан шлюз по умолчанию. Чаще всего устройство, являющееся шлюзом, называют..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Что такое Tun2SocksИнструкция для WindowsИнструкция для LinuxВ бытовом случае в сетевых настройках вашего компьютера указан шлюз по умолчанию. Чаще всего устройство, являющееся шлюзом, называют..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Что такое Tun2SocksИнструкция для WindowsИнструкция для LinuxВ бытовом случае в сетевых настройках вашего компьютера указан шлюз по умолчанию. Чаще всего устройство, являющееся шлюзом, называют..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/f40/55a/524/f4055a524bdcdf3b6fbaf8bab12d756f.jpg" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/f40/55a/524/f4055a524bdcdf3b6fbaf8bab12d756f.jpg" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/f40/55a/524/f4055a524bdcdf3b6fbaf8bab12d756f.jpg" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/f40/55a/524/f4055a524bdcdf3b6fbaf8bab12d756f.jpg" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/f40/55a/524/f4055a524bdcdf3b6fbaf8bab12d756f.jpg" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="584162" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-18T15:35:21.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/584162/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/company/itsoft/blog/584162/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habrastorage.org/getpro/habr/upload_files/f40/55a/524/f4055a524bdcdf3b6fbaf8bab12d756f.jpg" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/584162/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" companyName="itsoft" data-async-called="true" class="tm-page"><div class="tm-page-width"><div class="tm-page__header"><div class="tm-company-card__branding tm-company-article__branding tm-company-card__branding_loading"><div class="tm-company-card__branding-placeholder"><!----></div> <a href="https://itsoft.ru"><img src="//habrastorage.org/getpro/habr/branding/4d2/60b/4ef/4d260b4ef0dd7c2b142afc0949a9c8b6.jpg" width="100%" class="tm-company-card__branding-image"></a></div></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"><div class="tm-company-card tm-company-article__company-card"><div class="tm-company-card__info"><div class="tm-company-card__header"><a href="/ru/company/itsoft/profile/" class="tm-company-card__avatar"><div class="tm-entity-image"><img alt="" height="48" src="//habrastorage.org/getpro/habr/company/f48/d46/029/f48d460297f1a9fe1a9e3e0a1e7aedc9.png" width="48" class="tm-entity-image__pic"></div></a> <!----> <div class="tm-rating tm-company-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">554.89</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div> <div class="tm-company-card__info"><a href="/ru/company/itsoft/profile/" class="tm-company-card__name">
        ITSOFT
      </a> <div class="tm-company-card__description">Дата-центры: размещение и аренда серверов и стоек.</div></div></div> <div class="tm-company-card__buttons"><!----> <!----></div></div> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/pureacetone/" title="pureacetone" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/053/a91/47d/053a9147d1635e229765d7f57af3db63.png" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/pureacetone/" class="tm-user-info__username">
      pureacetone
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-18T15:35:21.000Z" title="2021-10-18, 18:35">18  октября   в 18:35</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Tun2Socks: прокси-сервер в качестве шлюза, или VPN через прокси</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/company/itsoft/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании ITSOFT</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/sys_admin/" class="tm-article-snippet__hubs-item-link"><span>Системное администрирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/network_technologies/" class="tm-article-snippet__hubs-item-link"><span>Сетевые технологии</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/network_hardware/" class="tm-article-snippet__hubs-item-link"><span>Сетевое оборудование</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/lifehacks/" class="tm-article-snippet__hubs-item-link"><span>Лайфхаки для гиков</span> <!----></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Tutorial
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><ol><li><p><a href="#about">Что такое Tun2Socks</a></p></li><li><p><a href="#windows">Инструкция для Windows</a></p></li><li><p><a href="#linux">Инструкция для Linux</a></p></li></ol><p>В бытовом случае в сетевых настройках вашего компьютера указан шлюз по умолчанию. Чаще всего устройство, являющееся шлюзом, называют "роутер" или "маршрутизатор" — через него идут все запросы на IP-адреса, которые не входят в вашу локальную сеть. Прокси-сервер (от англ. "уполномоченный" или "доверенный") также выступает посредником между вами и целевым сетевым ресурсом, но не является шлюзом по умолчанию, то есть для его использования в приложении нужно явно указать соответствующие параметры. Самый простой пример — доступ в сети I2P или Tor. Всю внутреннюю логику этих сетей обеспечивает отдельное приложение, которое предоставляет пользователю прокси-интерфейс для подключения. Указав нужный прокси в настройках веб-браузера, мы можем посещать сайты с доменными именами ".i2p" и ".onion", о которых обычный маршрутизатор даже не догадывается. Также прокси-сервисы набирают популярность для обхода блокировок: прописал в настройках браузера какой-нибудь прокси из либеральной страны и открываешь любые сайты, не зная духоскрепного маразма.</p><p>Современные прокси-серверы имеют исчерпывающий функционал для контроля и мониторинга трафика — хорошее решение для офисов и государственных учреждений, в которых нужно огородить работников от нежелательных ресурсов, а также предоставлять доступ в интернет с дополнительной авторизацией и различной пропускной способностью канала для разных пользователей.</p><p>Какой бы сценарий использования прокси у вас ни был, использовать шлюз по умолчанию в большинстве случаев удобнее. Хотя бы потому, что некоторые приложения не умеют работать через прокси.</p><figure class="full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/f40/55a/524/f4055a524bdcdf3b6fbaf8bab12d756f.jpg" width="1280" height="720" data-src="https://habrastorage.org/getpro/habr/upload_files/f40/55a/524/f4055a524bdcdf3b6fbaf8bab12d756f.jpg" data-blurred="true"/><figcaption></figcaption></figure><a class="anchor" name="about" id="about"></a><h2>Tun2Socks</h2><p><a href="https://github.com/xjasonlyu/tun2socks/">Tun2Socks</a> — свободный кроссплатформенный проект (<a href="https://ru.wikipedia.org/wiki/GNU_General_Public_License">GPL-3.0</a>), написанный на Golang. Костяк команды разработчиков составляют китайцы. Приложение не имеет графической оболочки и конфигурируется незамысловатыми параметрами при запуске. Название Tun2Socks (Tunnel to SOCKS) трактуется как "туннель через SOCKS-прокси". Почему именно SOCKS, когда есть HTTP-прокси? Ответ прост: работать через HTTP-прокси Tun2Socks тоже умеет, но протокол HTTP не поддерживает передачу UDP-трафика. Через UDP идет большинство информации, доставка которой требует максимальной скорости (аудио- и видеозвонки, онлайн игры, а также DNS-запросы, разрешающие человекочитаемые имена сетевых ресурсов в IP-адреса). Поэтому поддержку UDP нельзя недооценивать.</p><p>Суть работы Tun2Socks сводится к созданию виртуального сетевого адаптера, который операционная система будет воспринимать как обычный сетевой интерфейс. Вся информация, пришедшая на такой виртуальный адаптер, фактически будет передана внутрь Tun2Socks, который обеспечит необходимую логику дальнейшей передачи информации на прокси-сервер.</p><p>Информация об использовании утилиты при запуске с параметром <code>--help</code>:</p><pre><code class="bash">Usage of tun2socks:
  -device string
    	Use this device [driver://]name
  -fwmark int
    	Set firewall MARK (Linux only)
  -interface string
    	Use network INTERFACE (Linux/MacOS only)
  -loglevel string
    	Log level [debug|info|warn|error|silent] (default "info")
  -mtu int
    	Set device maximum transmission unit (MTU)
  -proxy string
    	Use this proxy [protocol://]host[:port]
  -stats string
    	HTTP statistic server listen address
  -token string
    	HTTP statistic server auth token
  -udp-timeout int
    	Set timeout for each UDP session
  -version
    	Show version information and quit</code></pre><p>Всё может показаться ясным с первого взгляда только бывалому админу, либо тому, кто ничего на самом деле не понял. При практическом знакомстве с Tun2Socks встает вопрос: если в системе создастся виртуальный сетевой адаптер, то как он станет шлюзом по умолчанию и нужно ли вручную задавать ему адрес. На помощь приходит <a href="https://github.com/xjasonlyu/tun2socks/wiki">документация</a>.</p><p>Дублировать здесь официальное описание проекта и всю документацию не имеет смысла, поэтому перейдем к сути — к практической конфигурации шлюза с пояснением каждого шага.</p><a class="anchor" name="windows" id="windows"></a><h2>Windows</h2><p>Для начала необходимо скачать свежую версию Tun2Socks. Бинарники распространяются на <a href="https://github.com/xjasonlyu/tun2socks/releases">странице релизов</a> в официальном гит-репозитории проекта. Выберите один из пакетов, название которого начинается на <code>tun2socks-windows</code>. Если у вас 64-разрядная Windows на стареньком железе, вам наверняка подойдет <code>tun2socks-windows-amd64.zip</code> (так как архитектура ARM на старых машинах с Windows мне еще не встречалась). </p><figure class="full-width "><img src="/img/image-loader.svg" height="368" data-src="https://habrastorage.org/getpro/habr/upload_files/a39/601/be4/a39601be4c500439764e3fd8cfb13471.png" data-width="995"/><figcaption></figcaption></figure><p>После загрузки распакуйте архив в любое удобное место.</p><p>Tun2Socks создает виртуальный сетевой адаптер, но драйвер для этого (Wintun) нужно скачать отдельно. <a href="https://www.wintun.net/builds/wintun-0.11.zip">Вот прямая ссылка</a> для загрузки версии Wintun 0.11. Рекомендую именно эту версию, так как с более новыми версиями в моем случае Tun2Socks v2.3.1 работать отказался. При желании, свежий релиз драйвера можно найти на официальной <a href="https://www.wintun.net/">странице</a>. Из всего архива вам понадобится только один файл <code>wintun.dll</code>, который надо взять из нужной директории в зависимости от вашей операционной системы. В случае архитектуры amd64, путь до нужной библиотеки выглядит так: <code>wintun/bin/amd64/wintun.dll</code>. Положите подходящий файл <code>wintun.dll</code> в директорию, где находится исполняемый файл Tun2Socks.</p><p>Tun2Socks запускается с передаваемыми значениями через командную строку (команды, приведенные ниже, должны быть выполнены с правами администратора). Команда для простого запуска имеет следующий вид: </p><pre><code>tun2socks-windows-amd64.exe -device tun://gatewaytun -proxy socks5://10.10.100.1:1080</code></pre><ul><li><p><code>tun2socks-windows-amd64.exe</code> является именем исполняемого файла Tun2Socks;</p></li><li><p><code>-device tun://gatewaytun</code> определяет название нового виртуального сетевого интерфейса (gatewaytun);</p></li><li><p><code>-proxy socks5://10.10.100.1:1080</code> сообщает протокол (в моем случае это SOCKS5) и адрес прокси-сервера.</p></li></ul><p>Этого достаточно, чтобы создать в системе новый сетевой интерфейс, но работать, как нам хочется, он пока что не будет. Для этого необходимо вручную присвоить новому сетевому интерфейсу IP-адрес и объяснить операционной системе, что он является шлюзом. </p><p>Присвоить интерфейсу IP-адрес и указать маску подсети можно через стандартный графический интерфейс Windows, но воспользуемся благами командной строки:</p><pre><code>netsh interface ip set address name="gatewaytun" static 127.254.254.1 255.255.255.255</code></pre><p>В примере виртуальному интерфейсу присваивается адрес <code>127.254.254.1</code>, но фактически это может быть любой <a href="https://ru.wikipedia.org/wiki/%D0%A7%D0%B0%D1%81%D1%82%D0%BD%D1%8B%D0%B9_IP-%D0%B0%D0%B4%D1%80%D0%B5%D1%81">частный</a> адрес из подсети, которая, во-первых, не используется другими сетевыми адаптерами вашей операционной системы, во-вторых, не используется в локальной сети вашего предприятия или дома (иначе будет нарушена локальная маршрутизация). В большинстве случаев адрес из примера будет корректным значением (так как используется диапазон 127.0.0.1/8). Итак, будем считать, что адрес виртуальному сетевому интерфейсу присвоен.</p><p>Теперь нужно сообщить операционной системе новый интерфейс в качестве шлюза:</p><pre><code>route add 0.0.0.0 mask 0.0.0.0 127.254.254.1</code></pre><p>Внимание! Если прокси-сервер находится не в локальной сети с той же подсетью, что и один из сетевых интерфейсов вашего компьютера, т.е. обращение к прокси-серверу осуществляется через уже существующий шлюз, необходимо оставить доступ к прокси-серверу в прежнем виде, иначе приведенная конфигурация работать не будет — согласитесь, что попытка подключения к прокси-серверу через сам же прокси-сервер является абсурдом. На практике это означает, что для подключения к прокси-серверу нужно добавить еще один маршрут:</p><pre><code>route add 10.10.100.0 mask 255.255.255.0 10.10.5.25</code></pre><p>В примере указано правило маршрутизации в подсеть <code>10.10.100.0/24</code>, которая должна идти не через общий шлюз (gatewaytun), а через сетевой интерфейс, имеющий доступ к устройству с адресом <code>10.10.5.25</code> (которое является шлюзом в нужную подсеть). Это правило справедливо, во-первых, если нужно сохранить доступ в подсеть локальной сети, которая недоступна непосредственно и, во-вторых, что более важно — если в заданной подсети находится сам прокси-сервер, через который в дальнейшем пойдет весь наш трафик. </p><p>При домашнем использовании, когда нет никаких локальных подсетей, и всё, что требуется, это подключение к прокси-серверу через интернет-провайдера, приведенная выше команда заменяется этой:</p><pre><code>route add 11.11.11.11 mask 255.255.255.255 10.10.5.25</code></pre><ul><li><p><code>11.11.11.11</code> — адрес прокси-сервера в интернете;</p></li><li><p><code>255.255.255.255</code> — маска, означающая, что в правило входит только адрес прокси-сервера;</p></li><li><p><code>10.10.5.25</code> — адрес шлюза в локальной сети, который вам предоставляет интернет-провайдер.</p></li></ul><p>Если вы используете не HTTP-, а SOCKS-прокси (который поддерживает UDP), в настройках виртуального сетевого интерфейса можно указать адрес DNS-сервера, через который мы хотим резолвить доменные имена. Это возможно сделать как через графический интерфейс Windows, так и через командную строку:</p><pre><code>netsh interface ip set dns "gatewaytun" static 1.1.1.1</code></pre><p>В примере адрес <code>1.1.1.1</code> является адресом DNS-сервера.</p><p>В итоге получается следующий набор команд:</p><pre><code>tun2socks-windows-amd64.exe -device tun://gatewaytun -proxy ПРОТОКОЛ_ПРОКСИ://АДРЕС_ПРОКСИ_СЕРВЕРА:ПОРТ
netsh interface ip set address name="gatewaytun" static 127.254.254.1 255.255.255.255
route add 0.0.0.0 mask 0.0.0.0 127.254.254.1

# Опционально. Для локальной сети предприятия.
route add СЕГМЕНТ_ЛОКАЛЬНОЙ_СЕТИ mask МАСКА_СЕГМЕНТА АДРЕСА_ШЛЮЗА_В_СЕГМЕНТ

# Опционально. При использовании прокси-сервера в интернете.
route add АДРЕС_ПРОКСИ_СЕРВЕРА mask 255.255.255.255 АДРЕС_ШЛЮЗА_ПРОВАЙДЕРА

# Опционально. DNS-сервер, если прокси-сервер умеет работать с UDP.
netsh interface ip set dns "gatewaytun" static АДРЕС_СЕРВЕРА_DNS</code></pre><p>Большинству пользователей ручное выполнение всех команд может показать неудобным. Такие люди могут поэкспериментировать с автоматизированными сценариями (батниками). Например, вписать все нужные команды в какой-нибудь <code>start.bat</code> и добавить его в автозагрузку. В батниках и правах доступа Windows я не силён. В напутствие лишь замечу, что все команды должны быть исполнены с правами администратора. Возможно, кто-то поделится красивым скриптом в комментариях.</p><a class="anchor" name="linux" id="linux"></a><h2>Linux</h2><p>Пользователи GNU/Linux (и других *nix-систем) в своем большинстве являются более компетентными в вопросах командной строки и системных настроек, поэтому местами пояснения будут более скудные (тем более, что суть происходящего уже подробно описана чуть выше). Практическая инструкция дана на примере Debian.</p><p>Бинарники для Linux есть среди прочих на <a href="https://github.com/xjasonlyu/tun2socks/releases">странице релизов</a>. Например, для Debian amd64 подойдет вариант <code>tun2socks-linux-amd64.zip</code>. Внутри архива находится один файл. После извлечения присвойте ему флаг исполняемости (<code>chmod +x tun2socks-linux-amd64</code>) и положите в удобное место, например, <code>/usr/sbin/</code>.  Дополнительные драйвера для создания туннеля WireGuard в Linux не требуются — современные дистрибутивы поддерживают технологию на уровне ядра.</p><p>Все приведенные ниже команды нужно выполнять с правами суперпользователя.</p><p>Команда запуска выглядит следующим образом:</p><pre><code>/usr/sbin/tun2socks-linux-amd64 -device tun://gatewaytun -proxy socks5://10.10.100.1:1080</code></pre><ul><li><p><code>-device tun://gatewaytun</code> определяет название нового виртуального сетевого интерфейса (gatewaytun);</p></li><li><p><code>-proxy socks5://10.10.100.1:1080</code> сообщает протокол (в моем случае это SOCKS5) и адрес прокси-сервера.</p></li></ul><p>После запуска Tun2Socks в системе создается новый сетевой интерфейс с заданным именем. Теперь необходимо откорректировать правила маршрутизации:</p><pre><code># Присваиваем адрес новому интерфейсу
ip addr add 127.254.254.1/32 dev gatewaytun

# Включаем интерфейс
ip link set gatewaytun up

# Добавляем маршрут по умолчанию через новый интерфейс (спасибо @Aytuar)
ip route add default dev gatewaytun metric 50

# Опционально. Добавляем маршрут до прокси-сервера в локальной сети
ip route add АДРЕС_СЕТИ/ПРЕФИКС dev ИМЯ_ИНТЕРФЕЙСА_В_ЛОКАЛЬНОЙ_СЕТИ

# Опционально. Маршрут до прокси-сервера в интернете (наиболее вероятный вариант для дома)
ip route add АДРЕС_ПРОКСИ/32 dev ИМЯ_ИНТЕРФЕЙСА_В_СЕТИ_ПРОВАЙДЕРА</code></pre><p>Настройки DNS в *nix-системах, как правило, являются глобальными, поэтому нет нужды указывать их явно для каждого интерфейса. Однако, кому нужно, тот знает не только про <code>/etc/resolv.conf</code>, но и про возможность явного указания DNS-сервера в конфиге сетевых подключений. На этом останавливаться не будем. </p><p>Автоматизация — второе имя любого админа. Для Debian я напишу сервис systemd, который будет запускать Tun2Socks и поднимать интерфейс <code>gatewaytun</code>, а в конфигурации данного сетевого интерфейса укажу команды, которые нужно выполнять при его включении. При необходимости вы можете адаптировать данный подход под другие операционные системы с учетом их специфики.</p><p>Файл сервиса, который ляжет в <code>/etc/systemd/system/tun2socks.service</code>:</p><pre><code class="bash">[Unit]
Description=Tun2Socks gateway
After=network.target

[Service]
User=root
Type=idle
ExecStart=/usr/sbin/tun2socks-linux-amd64 -device tun://gatewaytun -proxy socks5://10.10.100.1:1080 &amp; sleep 3; ip link set gatewaytun up
Restart=on-failure

[Install]
WantedBy=multi-user.target</code></pre><p>Обратите внимание на путь до Tun2Socks и адрес прокси-сервера в строке <code>ExecStart</code>. Измените эти параметры под себя. После амперсанда указана пауза в три секунды, следом за которой осуществляется включение нового сетевого интерфейса. Пауза задается на случай высокой загрузки системы, чтобы дать время на создание интерфейса перед попыткой его включения.</p><p>Указываем в <code>/etc/network/interfaces</code> параметры интерфейса и дополнительные инструкции для исполнения после его включения. Строки добавляются в конец файла:</p><pre><code class="bash">allow-hotplug gatewaytun
iface gatewaytun inet static
address 127.254.254.0
netmask 255.255.255.255
post-up ip route add default dev gatewaytun metric 50

# Опционально. Добавляем маршрут до прокси-сервера в локальной сети
# post-up ip route add АДРЕС_СЕТИ/ПРЕФИКС dev ИМЯ_ИНТЕРФЕЙСА_В_ЛОКАЛЬНОЙ_СЕТИ

# Опционально. Маршрут до прокси-сервера в интернете (наиболее вероятный вариант для дома)
# post-up ip route add АДРЕС_ПРОКСИ/32 dev ИМЯ_ИНТЕРФЕЙСА_В_СЕТИ_ПРОВАЙДЕРА

# post-up &lt;прочие правила, исполняемые после включения интерфейса (при надобности)></code></pre><p>Теперь, когда всё готово, запускать и отключать шлюз можно двумя простыми командами:</p><pre><code>systemctl start tun2socks # ЗАПУСК
systemctl stop tun2socks # ОСТАНОВКА</code></pre><p>Если Tun2Socks нужен на постоянной основе, созданную службу можно добавить в автозагрузку:</p><pre><code>systemctl enable tun2socks</code></pre><h2>Послесловие</h2><p>Мотивом для статьи послужило отсутствие адекватной поисковой выдачи по запросам вроде "шлюз через прокси", "как пустить весь трафик через прокси" и тому подобные. Полагаю, материал будет полезен самой широкой аудитории.</p><p>С автоматизацией на Windows долго, честно говоря, не разбирался. Из коробки не завелось и — пусть отдыхает. Не люблю я винду, простите. Да и как любить ее, если для исполнения команды из bat-файла с правами администратора нужно создать ярлык этого батника и поставить в нем галочку "Запускать с правами администратора". Ярлык и галочка, Карл! Да и более того, команда добавления маршрута все равно не хотела отрабатывать.</p><p>Спасибо за внимание.</p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D1%80%D0%BE%D0%BA%D1%81%D0%B8%5D" class="tm-tags-list__link">прокси</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%88%D0%BB%D1%8E%D0%B7%5D" class="tm-tags-list__link">шлюз</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bgateway%5D" class="tm-tags-list__link">gateway</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bproxy%5D" class="tm-tags-list__link">proxy</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bsocks%5D" class="tm-tags-list__link">socks</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/company/itsoft/blog/" class="tm-hubs-list__link router-link-active">
    Блог компании ITSOFT
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/sys_admin/" class="tm-hubs-list__link">
    Системное администрирование
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/network_technologies/" class="tm-hubs-list__link">
    Сетевые технологии
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/network_hardware/" class="tm-hubs-list__link">
    Сетевое оборудование
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/lifehacks/" class="tm-hubs-list__link">
    Лайфхаки для гиков
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 15: ↑14 и ↓1</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 15: ↑14 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+13</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5.3K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    59
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="/ru/company/itsoft/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" height="40" src="//habrastorage.org/getpro/habr/company/f48/d46/029/f48d460297f1a9fe1a9e3e0a1e7aedc9.png" width="40" class="tm-entity-image__pic"></div></a> <div class="tm-company-snippet__info"><a href="/ru/company/itsoft/profile/" class="tm-company-snippet__title">ITSOFT</a> <div class="tm-company-snippet__description">Дата-центры: размещение и аренда серверов и стоек.</div></div></div> <div class="tm-article-author__buttons"><!----> <!----></div></div> <div class="tm-article-author__company-contacts"><a href="https://itsoft.ru" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a></div> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/pureacetone/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/053/a91/47d/053a9147d1635e229765d7f57af3db63.png" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 101 голос " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    82.2
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">43.1</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">acetone</span> <a href="/ru/users/pureacetone/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @pureacetone
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Энтузиаст отказоустойчивых и скрытых сетей</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <div class="tm-article-author__user-contacts"><a href="https://www.youtube.com/c/acetonevideo" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a><a href="https://notabug.org/acetone/video/wiki/donate" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a></div></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/company/itsoft/blog/584162/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 11 
    </span></a> <!----></div></div></div>  <!---->  <!----> <!----></div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section class="tm-block tm-block_spacing-bottom"><header class="tm-block__header"><h2 class="tm-block__title">Информация</h2> <!----></header> <div class="tm-block__body"><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата основания</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="1999-04-30T20:00:00.000Z" title="1999-05-01, 00:00">1  мая  1999</time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Местоположение</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    Россия
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Сайт</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="https://itsoft.ru" target="_blank" class="tm-company-basic-info__link">
      itsoft.ru
    </a></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Численность</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    11–30 человек
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата регистрации</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2020-12-25T09:04:41.000Z" title="2020-12-25, 12:04">25  декабря  2020</time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Представитель</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="/ru/users/itsoft/" class="tm-company-basic-info__link">
      Игорь Тарасов
    </a></dd></dl></div></div> <!----></section> <div class="tm-company-widgets"></div> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/company/itsoft/blog/584162/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/company/itsoft/blog/584162/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"584162":{"id":"584162","timePublished":"2021-10-18T15:35:21+00:00","isCorporative":true,"lang":"ru","titleHtml":"Tun2Socks: прокси-сервер в качестве шлюза, или VPN через прокси","leadData":{"textHtml":"\u003Cp\u003EСовременные прокси-серверы имеют исчерпывающий функционал для контроля и мониторинга трафика — хорошее решение для офисов и государственных учреждений, в которых нужно огородить работников от нежелательных ресурсов, а также предоставлять доступ в интернет с дополнительной авторизацией и различной пропускной способностью канала для разных пользователей.\u003C\u002Fp\u003E\u003Cp\u003EКакой бы сценарий использования прокси у вас ни был, использовать шлюз по умолчанию в большинстве случаев удобнее. Хотя бы потому, что некоторые приложения не умеют работать через прокси.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff40\u002F55a\u002F524\u002Ff4055a524bdcdf3b6fbaf8bab12d756f.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff40\u002F55a\u002F524\u002Ff4055a524bdcdf3b6fbaf8bab12d756f.jpg","fit":"cover","positionY":0,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"scoreStats":{"score":82.2,"votesCount":101},"rating":43.1,"relatedData":null,"contacts":[{"title":"Сайт","url":"https:\u002F\u002Fwww.youtube.com\u002Fc\u002Facetonevideo","value":"https:\u002F\u002Fwww.youtube.com\u002Fc\u002Facetonevideo"},{"title":"Сайт","url":"https:\u002F\u002Fnotabug.org\u002Facetone\u002Fvideo\u002Fwiki\u002Fdonate","value":"https:\u002F\u002Fnotabug.org\u002Facetone\u002Fvideo\u002Fwiki\u002Fdonate"}],"authorContacts":[{"title":"Сайт","url":"https:\u002F\u002Fwww.youtube.com\u002Fc\u002Facetonevideo","value":"https:\u002F\u002Fwww.youtube.com\u002Fc\u002Facetonevideo"},{"title":"Сайт","url":"https:\u002F\u002Fnotabug.org\u002Facetone\u002Fvideo\u002Fwiki\u002Fdonate","value":"https:\u002F\u002Fnotabug.org\u002Facetone\u002Fvideo\u002Fwiki\u002Fdonate"}],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"2637597","alias":"pureacetone","fullname":"acetone","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F053\u002Fa91\u002F47d\u002F053a9147d1635e229765d7f57af3db63.png","speciality":"Энтузиаст отказоустойчивых и скрытых сетей"},"statistics":{"commentsCount":11,"favoritesCount":59,"readingCount":5253,"score":13,"votesCount":15},"hubs":[{"relatedData":null,"id":"22626","alias":"itsoft","type":"corporative","title":"Блог компании ITSOFT","titleHtml":"Блог компании ITSOFT","isProfiled":false},{"relatedData":null,"id":"221","alias":"sys_admin","type":"collective","title":"Системное администрирование","titleHtml":"Системное администрирование","isProfiled":true},{"relatedData":null,"id":"17123","alias":"network_technologies","type":"collective","title":"Сетевые технологии","titleHtml":"Сетевые технологии","isProfiled":true},{"relatedData":null,"id":"21958","alias":"network_hardware","type":"collective","title":"Сетевое оборудование","titleHtml":"Сетевое оборудование","isProfiled":false},{"relatedData":null,"id":"21982","alias":"lifehacks","type":"collective","title":"Лайфхаки для гиков","titleHtml":"Лайфхаки для гиков","isProfiled":false}],"flows":[{"id":"6","alias":"admin","title":"Администрирование"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"#about\"\u003EЧто такое Tun2Socks\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"#windows\"\u003EИнструкция для Windows\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"#linux\"\u003EИнструкция для Linux\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp\u003EВ бытовом случае в сетевых настройках вашего компьютера указан шлюз по умолчанию. Чаще всего устройство, являющееся шлюзом, называют \"роутер\" или \"маршрутизатор\" — через него идут все запросы на IP-адреса, которые не входят в вашу локальную сеть. Прокси-сервер (от англ. \"уполномоченный\" или \"доверенный\") также выступает посредником между вами и целевым сетевым ресурсом, но не является шлюзом по умолчанию, то есть для его использования в приложении нужно явно указать соответствующие параметры. Самый простой пример — доступ в сети I2P или Tor. Всю внутреннюю логику этих сетей обеспечивает отдельное приложение, которое предоставляет пользователю прокси-интерфейс для подключения. Указав нужный прокси в настройках веб-браузера, мы можем посещать сайты с доменными именами \".i2p\" и \".onion\", о которых обычный маршрутизатор даже не догадывается. Также прокси-сервисы набирают популярность для обхода блокировок: прописал в настройках браузера какой-нибудь прокси из либеральной страны и открываешь любые сайты, не зная духоскрепного маразма.\u003C\u002Fp\u003E\u003Cp\u003EСовременные прокси-серверы имеют исчерпывающий функционал для контроля и мониторинга трафика — хорошее решение для офисов и государственных учреждений, в которых нужно огородить работников от нежелательных ресурсов, а также предоставлять доступ в интернет с дополнительной авторизацией и различной пропускной способностью канала для разных пользователей.\u003C\u002Fp\u003E\u003Cp\u003EКакой бы сценарий использования прокси у вас ни был, использовать шлюз по умолчанию в большинстве случаев удобнее. Хотя бы потому, что некоторые приложения не умеют работать через прокси.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff40\u002F55a\u002F524\u002Ff4055a524bdcdf3b6fbaf8bab12d756f.jpg\" width=\"1280\" height=\"720\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff40\u002F55a\u002F524\u002Ff4055a524bdcdf3b6fbaf8bab12d756f.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ca class=\"anchor\" name=\"about\" id=\"about\"\u003E\u003C\u002Fa\u003E\u003Ch2\u003ETun2Socks\u003C\u002Fh2\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fxjasonlyu\u002Ftun2socks\u002F\"\u003ETun2Socks\u003C\u002Fa\u003E — свободный кроссплатформенный проект (\u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002FGNU_General_Public_License\"\u003EGPL-3.0\u003C\u002Fa\u003E), написанный на Golang. Костяк команды разработчиков составляют китайцы. Приложение не имеет графической оболочки и конфигурируется незамысловатыми параметрами при запуске. Название Tun2Socks (Tunnel to SOCKS) трактуется как \"туннель через SOCKS-прокси\". Почему именно SOCKS, когда есть HTTP-прокси? Ответ прост: работать через HTTP-прокси Tun2Socks тоже умеет, но протокол HTTP не поддерживает передачу UDP-трафика. Через UDP идет большинство информации, доставка которой требует максимальной скорости (аудио- и видеозвонки, онлайн игры, а также DNS-запросы, разрешающие человекочитаемые имена сетевых ресурсов в IP-адреса). Поэтому поддержку UDP нельзя недооценивать.\u003C\u002Fp\u003E\u003Cp\u003EСуть работы Tun2Socks сводится к созданию виртуального сетевого адаптера, который операционная система будет воспринимать как обычный сетевой интерфейс. Вся информация, пришедшая на такой виртуальный адаптер, фактически будет передана внутрь Tun2Socks, который обеспечит необходимую логику дальнейшей передачи информации на прокси-сервер.\u003C\u002Fp\u003E\u003Cp\u003EИнформация об использовании утилиты при запуске с параметром \u003Ccode\u003E--help\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"bash\"\u003EUsage of tun2socks:\n  -device string\n    \tUse this device [driver:\u002F\u002F]name\n  -fwmark int\n    \tSet firewall MARK (Linux only)\n  -interface string\n    \tUse network INTERFACE (Linux\u002FMacOS only)\n  -loglevel string\n    \tLog level [debug|info|warn|error|silent] (default \"info\")\n  -mtu int\n    \tSet device maximum transmission unit (MTU)\n  -proxy string\n    \tUse this proxy [protocol:\u002F\u002F]host[:port]\n  -stats string\n    \tHTTP statistic server listen address\n  -token string\n    \tHTTP statistic server auth token\n  -udp-timeout int\n    \tSet timeout for each UDP session\n  -version\n    \tShow version information and quit\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВсё может показаться ясным с первого взгляда только бывалому админу, либо тому, кто ничего на самом деле не понял. При практическом знакомстве с Tun2Socks встает вопрос: если в системе создастся виртуальный сетевой адаптер, то как он станет шлюзом по умолчанию и нужно ли вручную задавать ему адрес. На помощь приходит \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fxjasonlyu\u002Ftun2socks\u002Fwiki\"\u003Eдокументация\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EДублировать здесь официальное описание проекта и всю документацию не имеет смысла, поэтому перейдем к сути — к практической конфигурации шлюза с пояснением каждого шага.\u003C\u002Fp\u003E\u003Ca class=\"anchor\" name=\"windows\" id=\"windows\"\u003E\u003C\u002Fa\u003E\u003Ch2\u003EWindows\u003C\u002Fh2\u003E\u003Cp\u003EДля начала необходимо скачать свежую версию Tun2Socks. Бинарники распространяются на \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fxjasonlyu\u002Ftun2socks\u002Freleases\"\u003Eстранице релизов\u003C\u002Fa\u003E в официальном гит-репозитории проекта. Выберите один из пакетов, название которого начинается на \u003Ccode\u003Etun2socks-windows\u003C\u002Fcode\u003E. Если у вас 64-разрядная Windows на стареньком железе, вам наверняка подойдет \u003Ccode\u003Etun2socks-windows-amd64.zip\u003C\u002Fcode\u003E (так как архитектура ARM на старых машинах с Windows мне еще не встречалась). \u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"368\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa39\u002F601\u002Fbe4\u002Fa39601be4c500439764e3fd8cfb13471.png\" data-width=\"995\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПосле загрузки распакуйте архив в любое удобное место.\u003C\u002Fp\u003E\u003Cp\u003ETun2Socks создает виртуальный сетевой адаптер, но драйвер для этого (Wintun) нужно скачать отдельно. \u003Ca href=\"https:\u002F\u002Fwww.wintun.net\u002Fbuilds\u002Fwintun-0.11.zip\"\u003EВот прямая ссылка\u003C\u002Fa\u003E для загрузки версии Wintun 0.11. Рекомендую именно эту версию, так как с более новыми версиями в моем случае Tun2Socks v2.3.1 работать отказался. При желании, свежий релиз драйвера можно найти на официальной \u003Ca href=\"https:\u002F\u002Fwww.wintun.net\u002F\"\u003Eстранице\u003C\u002Fa\u003E. Из всего архива вам понадобится только один файл \u003Ccode\u003Ewintun.dll\u003C\u002Fcode\u003E, который надо взять из нужной директории в зависимости от вашей операционной системы. В случае архитектуры amd64, путь до нужной библиотеки выглядит так: \u003Ccode\u003Ewintun\u002Fbin\u002Famd64\u002Fwintun.dll\u003C\u002Fcode\u003E. Положите подходящий файл \u003Ccode\u003Ewintun.dll\u003C\u002Fcode\u003E в директорию, где находится исполняемый файл Tun2Socks.\u003C\u002Fp\u003E\u003Cp\u003ETun2Socks запускается с передаваемыми значениями через командную строку (команды, приведенные ниже, должны быть выполнены с правами администратора). Команда для простого запуска имеет следующий вид: \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Etun2socks-windows-amd64.exe -device tun:\u002F\u002Fgatewaytun -proxy socks5:\u002F\u002F10.10.100.1:1080\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003Etun2socks-windows-amd64.exe\u003C\u002Fcode\u003E является именем исполняемого файла Tun2Socks;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-device tun:\u002F\u002Fgatewaytun\u003C\u002Fcode\u003E определяет название нового виртуального сетевого интерфейса (gatewaytun);\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-proxy socks5:\u002F\u002F10.10.100.1:1080\u003C\u002Fcode\u003E сообщает протокол (в моем случае это SOCKS5) и адрес прокси-сервера.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EЭтого достаточно, чтобы создать в системе новый сетевой интерфейс, но работать, как нам хочется, он пока что не будет. Для этого необходимо вручную присвоить новому сетевому интерфейсу IP-адрес и объяснить операционной системе, что он является шлюзом. \u003C\u002Fp\u003E\u003Cp\u003EПрисвоить интерфейсу IP-адрес и указать маску подсети можно через стандартный графический интерфейс Windows, но воспользуемся благами командной строки:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Enetsh interface ip set address name=\"gatewaytun\" static 127.254.254.1 255.255.255.255\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ примере виртуальному интерфейсу присваивается адрес \u003Ccode\u003E127.254.254.1\u003C\u002Fcode\u003E, но фактически это может быть любой \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%A7%D0%B0%D1%81%D1%82%D0%BD%D1%8B%D0%B9_IP-%D0%B0%D0%B4%D1%80%D0%B5%D1%81\"\u003Eчастный\u003C\u002Fa\u003E адрес из подсети, которая, во-первых, не используется другими сетевыми адаптерами вашей операционной системы, во-вторых, не используется в локальной сети вашего предприятия или дома (иначе будет нарушена локальная маршрутизация). В большинстве случаев адрес из примера будет корректным значением (так как используется диапазон 127.0.0.1\u002F8). Итак, будем считать, что адрес виртуальному сетевому интерфейсу присвоен.\u003C\u002Fp\u003E\u003Cp\u003EТеперь нужно сообщить операционной системе новый интерфейс в качестве шлюза:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Eroute add 0.0.0.0 mask 0.0.0.0 127.254.254.1\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВнимание! Если прокси-сервер находится не в локальной сети с той же подсетью, что и один из сетевых интерфейсов вашего компьютера, т.е. обращение к прокси-серверу осуществляется через уже существующий шлюз, необходимо оставить доступ к прокси-серверу в прежнем виде, иначе приведенная конфигурация работать не будет — согласитесь, что попытка подключения к прокси-серверу через сам же прокси-сервер является абсурдом. На практике это означает, что для подключения к прокси-серверу нужно добавить еще один маршрут:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Eroute add 10.10.100.0 mask 255.255.255.0 10.10.5.25\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ примере указано правило маршрутизации в подсеть \u003Ccode\u003E10.10.100.0\u002F24\u003C\u002Fcode\u003E, которая должна идти не через общий шлюз (gatewaytun), а через сетевой интерфейс, имеющий доступ к устройству с адресом \u003Ccode\u003E10.10.5.25\u003C\u002Fcode\u003E (которое является шлюзом в нужную подсеть). Это правило справедливо, во-первых, если нужно сохранить доступ в подсеть локальной сети, которая недоступна непосредственно и, во-вторых, что более важно — если в заданной подсети находится сам прокси-сервер, через который в дальнейшем пойдет весь наш трафик. \u003C\u002Fp\u003E\u003Cp\u003EПри домашнем использовании, когда нет никаких локальных подсетей, и всё, что требуется, это подключение к прокси-серверу через интернет-провайдера, приведенная выше команда заменяется этой:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Eroute add 11.11.11.11 mask 255.255.255.255 10.10.5.25\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E11.11.11.11\u003C\u002Fcode\u003E — адрес прокси-сервера в интернете;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E255.255.255.255\u003C\u002Fcode\u003E — маска, означающая, что в правило входит только адрес прокси-сервера;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E10.10.5.25\u003C\u002Fcode\u003E — адрес шлюза в локальной сети, который вам предоставляет интернет-провайдер.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EЕсли вы используете не HTTP-, а SOCKS-прокси (который поддерживает UDP), в настройках виртуального сетевого интерфейса можно указать адрес DNS-сервера, через который мы хотим резолвить доменные имена. Это возможно сделать как через графический интерфейс Windows, так и через командную строку:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Enetsh interface ip set dns \"gatewaytun\" static 1.1.1.1\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ примере адрес \u003Ccode\u003E1.1.1.1\u003C\u002Fcode\u003E является адресом DNS-сервера.\u003C\u002Fp\u003E\u003Cp\u003EВ итоге получается следующий набор команд:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Etun2socks-windows-amd64.exe -device tun:\u002F\u002Fgatewaytun -proxy ПРОТОКОЛ_ПРОКСИ:\u002F\u002FАДРЕС_ПРОКСИ_СЕРВЕРА:ПОРТ\nnetsh interface ip set address name=\"gatewaytun\" static 127.254.254.1 255.255.255.255\nroute add 0.0.0.0 mask 0.0.0.0 127.254.254.1\n\n# Опционально. Для локальной сети предприятия.\nroute add СЕГМЕНТ_ЛОКАЛЬНОЙ_СЕТИ mask МАСКА_СЕГМЕНТА АДРЕСА_ШЛЮЗА_В_СЕГМЕНТ\n\n# Опционально. При использовании прокси-сервера в интернете.\nroute add АДРЕС_ПРОКСИ_СЕРВЕРА mask 255.255.255.255 АДРЕС_ШЛЮЗА_ПРОВАЙДЕРА\n\n# Опционально. DNS-сервер, если прокси-сервер умеет работать с UDP.\nnetsh interface ip set dns \"gatewaytun\" static АДРЕС_СЕРВЕРА_DNS\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EБольшинству пользователей ручное выполнение всех команд может показать неудобным. Такие люди могут поэкспериментировать с автоматизированными сценариями (батниками). Например, вписать все нужные команды в какой-нибудь \u003Ccode\u003Estart.bat\u003C\u002Fcode\u003E и добавить его в автозагрузку. В батниках и правах доступа Windows я не силён. В напутствие лишь замечу, что все команды должны быть исполнены с правами администратора. Возможно, кто-то поделится красивым скриптом в комментариях.\u003C\u002Fp\u003E\u003Ca class=\"anchor\" name=\"linux\" id=\"linux\"\u003E\u003C\u002Fa\u003E\u003Ch2\u003ELinux\u003C\u002Fh2\u003E\u003Cp\u003EПользователи GNU\u002FLinux (и других *nix-систем) в своем большинстве являются более компетентными в вопросах командной строки и системных настроек, поэтому местами пояснения будут более скудные (тем более, что суть происходящего уже подробно описана чуть выше). Практическая инструкция дана на примере Debian.\u003C\u002Fp\u003E\u003Cp\u003EБинарники для Linux есть среди прочих на \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fxjasonlyu\u002Ftun2socks\u002Freleases\"\u003Eстранице релизов\u003C\u002Fa\u003E. Например, для Debian amd64 подойдет вариант \u003Ccode\u003Etun2socks-linux-amd64.zip\u003C\u002Fcode\u003E. Внутри архива находится один файл. После извлечения присвойте ему флаг исполняемости (\u003Ccode\u003Echmod +x tun2socks-linux-amd64\u003C\u002Fcode\u003E) и положите в удобное место, например, \u003Ccode\u003E\u002Fusr\u002Fsbin\u002F\u003C\u002Fcode\u003E.  Дополнительные драйвера для создания туннеля WireGuard в Linux не требуются — современные дистрибутивы поддерживают технологию на уровне ядра.\u003C\u002Fp\u003E\u003Cp\u003EВсе приведенные ниже команды нужно выполнять с правами суперпользователя.\u003C\u002Fp\u003E\u003Cp\u003EКоманда запуска выглядит следующим образом:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E\u002Fusr\u002Fsbin\u002Ftun2socks-linux-amd64 -device tun:\u002F\u002Fgatewaytun -proxy socks5:\u002F\u002F10.10.100.1:1080\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-device tun:\u002F\u002Fgatewaytun\u003C\u002Fcode\u003E определяет название нового виртуального сетевого интерфейса (gatewaytun);\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-proxy socks5:\u002F\u002F10.10.100.1:1080\u003C\u002Fcode\u003E сообщает протокол (в моем случае это SOCKS5) и адрес прокси-сервера.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EПосле запуска Tun2Socks в системе создается новый сетевой интерфейс с заданным именем. Теперь необходимо откорректировать правила маршрутизации:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E# Присваиваем адрес новому интерфейсу\nip addr add 127.254.254.1\u002F32 dev gatewaytun\n\n# Включаем интерфейс\nip link set gatewaytun up\n\n# Добавляем маршрут по умолчанию через новый интерфейс (спасибо @Aytuar)\nip route add default dev gatewaytun metric 50\n\n# Опционально. Добавляем маршрут до прокси-сервера в локальной сети\nip route add АДРЕС_СЕТИ\u002FПРЕФИКС dev ИМЯ_ИНТЕРФЕЙСА_В_ЛОКАЛЬНОЙ_СЕТИ\n\n# Опционально. Маршрут до прокси-сервера в интернете (наиболее вероятный вариант для дома)\nip route add АДРЕС_ПРОКСИ\u002F32 dev ИМЯ_ИНТЕРФЕЙСА_В_СЕТИ_ПРОВАЙДЕРА\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EНастройки DNS в *nix-системах, как правило, являются глобальными, поэтому нет нужды указывать их явно для каждого интерфейса. Однако, кому нужно, тот знает не только про \u003Ccode\u003E\u002Fetc\u002Fresolv.conf\u003C\u002Fcode\u003E, но и про возможность явного указания DNS-сервера в конфиге сетевых подключений. На этом останавливаться не будем. \u003C\u002Fp\u003E\u003Cp\u003EАвтоматизация — второе имя любого админа. Для Debian я напишу сервис systemd, который будет запускать Tun2Socks и поднимать интерфейс \u003Ccode\u003Egatewaytun\u003C\u002Fcode\u003E, а в конфигурации данного сетевого интерфейса укажу команды, которые нужно выполнять при его включении. При необходимости вы можете адаптировать данный подход под другие операционные системы с учетом их специфики.\u003C\u002Fp\u003E\u003Cp\u003EФайл сервиса, который ляжет в \u003Ccode\u003E\u002Fetc\u002Fsystemd\u002Fsystem\u002Ftun2socks.service\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"bash\"\u003E[Unit]\nDescription=Tun2Socks gateway\nAfter=network.target\n\n[Service]\nUser=root\nType=idle\nExecStart=\u002Fusr\u002Fsbin\u002Ftun2socks-linux-amd64 -device tun:\u002F\u002Fgatewaytun -proxy socks5:\u002F\u002F10.10.100.1:1080 &amp; sleep 3; ip link set gatewaytun up\nRestart=on-failure\n\n[Install]\nWantedBy=multi-user.target\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EОбратите внимание на путь до Tun2Socks и адрес прокси-сервера в строке \u003Ccode\u003EExecStart\u003C\u002Fcode\u003E. Измените эти параметры под себя. После амперсанда указана пауза в три секунды, следом за которой осуществляется включение нового сетевого интерфейса. Пауза задается на случай высокой загрузки системы, чтобы дать время на создание интерфейса перед попыткой его включения.\u003C\u002Fp\u003E\u003Cp\u003EУказываем в \u003Ccode\u003E\u002Fetc\u002Fnetwork\u002Finterfaces\u003C\u002Fcode\u003E параметры интерфейса и дополнительные инструкции для исполнения после его включения. Строки добавляются в конец файла:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Eallow-hotplug gatewaytun\niface gatewaytun inet static\naddress 127.254.254.0\nnetmask 255.255.255.255\npost-up ip route add default dev gatewaytun metric 50\n\n# Опционально. Добавляем маршрут до прокси-сервера в локальной сети\n# post-up ip route add АДРЕС_СЕТИ\u002FПРЕФИКС dev ИМЯ_ИНТЕРФЕЙСА_В_ЛОКАЛЬНОЙ_СЕТИ\n\n# Опционально. Маршрут до прокси-сервера в интернете (наиболее вероятный вариант для дома)\n# post-up ip route add АДРЕС_ПРОКСИ\u002F32 dev ИМЯ_ИНТЕРФЕЙСА_В_СЕТИ_ПРОВАЙДЕРА\n\n# post-up &lt;прочие правила, исполняемые после включения интерфейса (при надобности)\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТеперь, когда всё готово, запускать и отключать шлюз можно двумя простыми командами:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Esystemctl start tun2socks # ЗАПУСК\nsystemctl stop tun2socks # ОСТАНОВКА\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЕсли Tun2Socks нужен на постоянной основе, созданную службу можно добавить в автозагрузку:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Esystemctl enable tun2socks\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2\u003EПослесловие\u003C\u002Fh2\u003E\u003Cp\u003EМотивом для статьи послужило отсутствие адекватной поисковой выдачи по запросам вроде \"шлюз через прокси\", \"как пустить весь трафик через прокси\" и тому подобные. Полагаю, материал будет полезен самой широкой аудитории.\u003C\u002Fp\u003E\u003Cp\u003EС автоматизацией на Windows долго, честно говоря, не разбирался. Из коробки не завелось и — пусть отдыхает. Не люблю я винду, простите. Да и как любить ее, если для исполнения команды из bat-файла с правами администратора нужно создать ярлык этого батника и поставить в нем галочку \"Запускать с правами администратора\". Ярлык и галочка, Карл! Да и более того, команда добавления маршрута все равно не хотела отрабатывать.\u003C\u002Fp\u003E\u003Cp\u003EСпасибо за внимание.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"прокси"},{"titleHtml":"шлюз"},{"titleHtml":"gateway"},{"titleHtml":"proxy"},{"titleHtml":"socks"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff40\u002F55a\u002F524\u002Ff4055a524bdcdf3b6fbaf8bab12d756f.jpg","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff40\u002F55a\u002F524\u002Ff4055a524bdcdf3b6fbaf8bab12d756f.jpg","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fitsoft\\\u002Fblog\\\u002F584162\\\u002F\"},\"headline\":\"Tun2Socks: прокси-сервер в качестве шлюза, или VPN через прокси\",\"datePublished\":\"2021-10-18T18:35:21+03:00\",\"dateModified\":\"2021-10-22T21:03:46+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"acetone\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Что такое Tun2SocksИнструкция для WindowsИнструкция для LinuxВ бытовом случае в сетевых настройках вашего компьютера указан шлюз по умолчанию. Чаще всего устройс...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fitsoft\\\u002Fblog\\\u002F584162\\\u002F#post-content-body\",\"about\":[\"c_itsoft\",\"h_sys_admin\",\"h_network_technologies\",\"h_network_hardware\",\"h_lifehacks\",\"f_admin\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F584162\\\u002F4ee3d252ff655a30dd4d481f5c5134da\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Ff40\\\u002F55a\\\u002F524\\\u002Ff4055a524bdcdf3b6fbaf8bab12d756f.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fa39\\\u002F601\\\u002Fbe4\\\u002Fa39601be4c500439764e3fd8cfb13471.png\"]}","metaDescription":"Что такое Tun2SocksИнструкция для WindowsИнструкция для LinuxВ бытовом случае в сетевых настройках вашего компьютера указан шлюз по умолчанию. Чаще всего устройство, являющееся шлюзом, называют...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{"itsoft":{"alias":"itsoft","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002Ff48\u002Fd46\u002F029\u002Ff48d460297f1a9fe1a9e3e0a1e7aedc9.png","titleHtml":"ITSOFT","descriptionHtml":"Дата-центры: размещение и аренда серверов и стоек.","relatedData":null,"statistics":{"postsCount":229,"newsCount":24,"vacanciesCount":5,"employeesCount":53,"careerRating":null,"subscribersCount":978,"rating":554.89,"invest":null},"foundationDate":{"year":"1999","month":"05","day":"01"},"location":{"city":{"id":"447159","title":"Москва"},"region":{"id":"1885","title":"Москва и Московская обл."},"country":{"id":"168","title":"Россия"}},"siteUrl":"https:\u002F\u002Fitsoft.ru","staffNumber":"11–30 человек","registrationDate":"2020-12-25T09:04:41+00:00","representativeUser":{"alias":"itsoft","fullname":"Игорь Тарасов"},"contacts":[{"title":"Сайт","url":"https:\u002F\u002Fitsoft.ru"}],"settings":{"analyticsSettings":[],"branding":{"imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fbranding\u002F4d2\u002F60b\u002F4ef\u002F4d260b4ef0dd7c2b142afc0949a9c8b6.jpg","linkUrl":"https:\u002F\u002Fitsoft.ru","pixelUrl":""},"status":"active"},"metadata":{"titleHtml":"ITSOFT, Москва - Дата-центры: размещение и аренда серверов и стоек. с 1 мая 1999 г.","title":"ITSOFT, Москва - Дата-центры: размещение и аренда серверов и стоек. с 1 мая 1999 г.","keywords":["Научно-популярное","Будущее здесь","Информационная безопасность","Космонавтика","Сетевые технологии"],"descriptionHtml":"229 статей от авторов компании ITSOFT","description":"229 статей от авторов компании ITSOFT"},"aDeskSettings":null,"careerAlias":"itsoft","maxCustomTrackerLinks":3}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
