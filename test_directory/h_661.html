<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Представление объектами: трудности роста / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/582920\/"},"headline":"Представление объектами: трудности роста","datePublished":"2021-10-12T10:17:06+03:00","dateModified":"2021-10-12T13:06:00+03:00","author":{"@type":"Person","name":"Maxim Mozgovoy"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"В этой небольшой заметке я хотел бы поделиться соображениями, которые возникли в процессе разбора одного нехитрого упражнения. У меня нет хороших выводов, но общ...","url":"https:\/\/habr.com\/ru\/post\/582920\/#post-content-body","about":["h_programming","h_analysis_design","h_refactoring","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/582920\/bd1ba18766b4800722945449565639a9\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/1f0\/f8d\/7c9\/1f0f8d7c9b8e4613a50f18f3065430f1.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Представление объектами: трудности роста" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Представление объектами: трудности роста" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Представление объектами: трудности роста" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="В этой небольшой заметке я хотел бы поделиться соображениями, которые возникли в процессе разбора одного нехитрого упражнения. У меня нет хороших выводов, но общее направление мысли состоит в том,..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="В этой небольшой заметке я хотел бы поделиться соображениями, которые возникли в процессе разбора одного нехитрого упражнения. У меня нет хороших выводов, но общее направление мысли состоит в том,..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="В этой небольшой заметке я хотел бы поделиться соображениями, которые возникли в процессе разбора одного нехитрого упражнения. У меня нет хороших выводов, но общее направление мысли состоит в том,..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="В этой небольшой заметке я хотел бы поделиться соображениями, которые возникли в процессе разбора одного нехитрого упражнения. У меня нет хороших выводов, но общее направление мысли состоит в том,..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="В этой небольшой заметке я хотел бы поделиться соображениями, которые возникли в процессе разбора одного нехитрого упражнения. У меня нет хороших выводов, но общее направление мысли состоит в том,..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/1fc/541/a1c/1fc541a1c021ec458498d710f8665b63.png" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/1fc/541/a1c/1fc541a1c021ec458498d710f8665b63.png" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/1fc/541/a1c/1fc541a1c021ec458498d710f8665b63.png" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/1fc/541/a1c/1fc541a1c021ec458498d710f8665b63.png" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/1fc/541/a1c/1fc541a1c021ec458498d710f8665b63.png" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="582920" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-12T07:17:06.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/582920/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/582920/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habrastorage.org/getpro/habr/upload_files/1fc/541/a1c/1fc541a1c021ec458498d710f8665b63.png" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/582920/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/rg_software/" title="rg_software" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/039/6e2/bfb/0396e2bfb32924c0ed1c919ce4af6aae.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/rg_software/" class="tm-user-info__username">
      rg_software
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-12T07:17:06.000Z" title="2021-10-12, 10:17">12  октября   в 10:17</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Представление объектами: трудности роста</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/programming/" class="tm-article-snippet__hubs-item-link"><span>Программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/analysis_design/" class="tm-article-snippet__hubs-item-link"><span>Анализ и проектирование систем</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/refactoring/" class="tm-article-snippet__hubs-item-link"><span>Проектирование и рефакторинг</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Перевод
      </span></div></div> <!----> <!----></div></div> <div class="tm-article-presenter__origin"><a href="https://mmozgovoy.dev/posts/representing-the-world-with-objects/" target="_blank" class="tm-article-presenter__origin-link">
                Автор оригинала:
                <span>
                  rg_software
                </span></a></div> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><p>В этой небольшой заметке я хотел бы поделиться соображениями, которые возникли в процессе разбора одного нехитрого упражнения. У меня нет хороших выводов, но общее направление мысли состоит в том, что <em>эволюционный</em> рост системы приводит к своего рода локальному оптимуму архитектуры, выбираться из которого приходится ценой существенной перестройки устройства проекта.</p><h3>Начало</h3><p>Мне хотелось придумать очень простую задачу, которая бы иллюстрировала процесс перевода понятий реального мира в компьютерную программу. Думаю, используемый далее объектно-ориентированный стиль всего лишь отражает тот факт, что мир данной конкретной задачи действительно состоит из "объектов" в обыденном смысле этого слова, и тут я просто иду по пути наименьшего сопротивления.</p><p>Итак, задача звучит следующим образом.</p><p>Требуется разработать простейшую текстовую игру-приключение. Мир игры состоит из <em>комнат</em>. У каждой комнаты есть <em>название</em> и список возможных <em>выходов</em>. Выходы помечаются сторонами света, такими как N, S, NE и т.д. Когда игрок попадает в комнату, игра выводит её название и список возможных выходов:</p><pre><code>You are in: Kitchen
Exits: N, E, S</code></pre><h3>Простое решение</h3><p>Учитывая, что это всего лишь упражнение, имеет смысл начать с простого решения, чтобы иметь хоть какой-то ориентир на будущее. Предположим, что имена комнат уникальны, а выходы не обязательно симметричны (т.е. если мы можем переместиться на север, это ещё не означает, что можно вернуться обратно через южный выход). Второе предположение имеет смысл, например, в случае прыжка с высокого забора: спрыгнуть легко, залезть обратно сложно. Также давайте зафиксируем карту:</p><figure class="full-width "><img src="/img/image-loader.svg" height="247" data-src="https://habrastorage.org/getpro/habr/upload_files/1f0/f8d/7c9/1f0f8d7c9b8e4613a50f18f3065430f1.png" data-width="623"/><figcaption></figcaption></figure><p>Моё решение задачи выглядит так:</p><pre><code class="python">game_map = {
    "Kitchen": {"N": "Dining room", "E": "Bathroom", "W": "Street"},
    "Bathroom": {"W": "Kitchen", "NW": "Dining room"},
    "Dining room": {"S": "Kitchen", "SE": "Bathroom", "U": "Playroom"},
    "Playroom": {"D": "Dining room", "S": "Bedroom"},
    "Bedroom": {"N": "Playroom"},
    "Street": {},
}

now = "Bedroom"
goal = "Street"

while now != goal:
    print(f"You are in: {now}")
    print(f"Exits: {', '.join(list(game_map[now].keys()))}")

    dir = input("Where to go? ").upper()
    if dir in game_map[now]:
        now = game_map[now][dir]
    else:
        print("You can't go there.")

print("Well done!")</code></pre><p>Конечно, это решение в долгосрочной перспективе ненадёжно: оно использует уникальность названий комнат, не рассчитано "на вырост", ну и тому подобное. Однако оно показывает простоту и лаконичность "холистического" подхода, когда задача полностью решается за один присест. Даже в такой простой задаче видно, как удачно сочетаются отдельные части решения.</p><p>Например, названия комнат — это строки, а базовой структурой данных для хранения чего угодного являются словари. Таким образом, мы можем легко сопоставить комнатам выходы, состоящие, в свою очередь, из названий и целевых комнат. Строковые имена комнат позволяют легко проверять критерий победы и передвигаться между комнатами. Даже вывод названий выходов осуществляется простым вызовом <code>join()</code> для списка ключей словаря.</p><h3>Переход к ООП</h3><p>Программирование во многих случаях можно рассматривать как процесс моделирования предметной области на компьютере. Если мы работаем с <em>клиентами</em> и <em>заказами</em>, в программе так или иначе будут отражены эти сущности. Это некое общее замечание, выходящее за рамки конкретной парадигмы программирования. Думаю, что вполне конструктивно следующее соображение. Допустим, мы собираемся реализовать некоторую функциональность, например, "клиент при желании должен иметь возможность выбрать подарочную упаковку для товара из списка предлагаемых нами вариантов". Хорошо, если разработчик этой функциональности сумеет быстро найти и модифицировать относящиеся к делу части системы. Исходная задача заказчика, по всей вероятности, будет сформулирована на нашем обыденном языке. Таким образом, если код отходит от языка задачи слишком далеко, его будет сложнее поддерживать. Иначе говоря, соотнесение понятий кода и реального мира — это <em>работа</em>, требующая усилий и времени, и в наших интересах её минимизировать.</p><p>Приведённое выше решение по сути не выполняет никакого разумного соотнесения понятий. Вместо этого оно полагается на <em>случайные</em> свойства понятий, взятых из исходной постановки задачи, и пользуется их <em>случайной</em> схожестью со встроенными типами Python, извлекая выгоду из возможностей последних.</p><p>Давайте попробуем подойти к задаче более системно. ООП в данном случае представляется естественным выбором, поскольку мы имеем дело с действительными сущностями реального мира: комнатами и выходами (ну или "коридорами", если угодно). Мы создаём виртуальный мир, очень похожий на настоящий, так что соотнесение виртуальных и реальных сущностей не должно представлять проблемы.</p><p>Итак, имеются "комнаты". У каждой комнаты есть название и список выходов. Также имеются "выходы". Каждый выход связан с некоторой стороной света и ведёт в некоторую комнату. Эти наблюдения можно легко изложить в коде:</p><pre><code class="python">class Room:
    def __init__(self, name, exits):
        self._name = name
        self._exits = exits


class Exit:
    def init(self, direction, target):
        self._direction = direction
        self._target = target</code></pre><p>Теперь попробуем описать часть игрового мира:</p><pre><code class="python">street = Room("Street", [])  # ok!
bedroom = Room("Bedroom", 
               [Exit("N", Room("Playroom", [Exit("S", bedroom)]))])  # ouch!
</code></pre><p>Только не это, рекурсивная зависимость! Для определения выходов комнаты "Bedroom" мне нужна "Playroom", но по той же причине для определения "Playroom" мне требуется "Bedroom"! Так что же делать?</p><p>Разумеется, можно предложить массу очевидных решений (и вообще, полное решение уже приведено). Вероятно, самым простым будет разделить создание комнат и определение выходов следующим образом:</p><pre><code class="python">bedroom = Room("Bedroom")
playroom = Room("Playroom")

bedroom.add_exit("N", playroom)
playroom.add_exit("S", bedroom)</code></pre><p>Можно также снова воспользоваться тем фактом, что названия комнат по сути являются их уникальными идентификаторами, и передавать названия вместо комнат при создании выходов. Однако вопрос же не в этом: мы все понимаем, как тут всё быстро починить. Вопрос в том, что в процессе моделирования пошло не так, и почему мы в принципе столкнулись с такой неприятностью.</p><p><em>Имеются комнаты. Комнате соответствуют выходы. Выходы ведут в другие комнаты</em>. Что не так с этим описанием? Почему на естественном языке всё в порядке, а в коде уже нет?</p><h3>Снова о мире идей и мире вещей</h3><p>Моя текущая теория проста: фразы вроде <em>"есть комната Bedroom с North-выходом, ведущая в комнату Playroom"</em> обманчивы. Они звучат так, словно мы обсуждаем две комнаты, хотя на самом деле слово "Playroom" в данном контексте является ссылкой на "абстрактную комнату", а не на реальную. Например, к текущему моменту я могу ничего не знать о комнате Playroom, кроме самого факта её существования. Скажем, я могу не знать списка выходов из неё, и это не проблема.</p><p>Когда мы приводим полноценное описание комнаты (со списком выходов), абстрактное понятие становится реальностью. Комнаты и "понятия о комнатах" связаны именами. Говоря "Playroom (понятие)", я подразумеваю, что где-то должна существовать реальная комната под названием "Playroom". Понятия могут существовать без полноценных определений соответствующих комнат (так что их можно воспринимать как <em>предварительные объявления</em> своего рода), но каждой комнате соответствует абстрактное понятие о комнате, которое возникает в нашей мысленной картине мира при первом упоминании.</p><p>Давайте попробуем отразить это соображение в коде. Идея состоит в возможности обращаться к абстрактным комнатам используя вызовы <code>Room.Concept(name)</code>:</p><pre><code class="python">class Room:
    _game_map = {}  # map of concepts

    class _RoomConcept:
        def __init__(self, name):
            self._name = name
            self._room = None

        def connect_room(self, room):
            self._room = room

        @property
        def room(self):
            return self._room

    @staticmethod
    def Concept(name):
        # create a concept if it is not yet in the map
        if name not in Room._game_map:
            Room._game_map[name] = Room._RoomConcept(name)
        return Room._game_map[name]

    def __init__(self, name, exits):
        Room.Concept(name).connect_room(self)
        self._name = name
        self._exits = exits

    @property
    def name(self):
        return self._name

    @property
    def exit_directions(self):
        return [e.direction for e in self._exits]

    def room_at(self, exit_direction):
        for e in self._exits:
            if e.direction == exit_direction:
                return e.target
        assert False, "Exit does not exist"</code></pre><p>Не могу сказать, что я в восторге от этого кода, но это первое, что приходит в голову. Центральная его идея состоит в организации скрытой "карты понятий", своего рода платонического <a href="https://en.wikipedia.org/wiki/Theory_of_forms" rel="noopener noreferrer nofollow">мира идей</a>, в котором они существуют. При каждом создании комнаты создаётся и соответствующее "понятие" ("абстрактная комната", "идея комнаты"). В остальном здесь предлагается вполне обыкновенный класс <code>Room</code> с ожидаемым интерфейсом: вернуть список выходов, вернуть комнату на другом конце выхода, и тому подобное.</p><p>Теперь нам потребуется простой класс <code>Exit</code>:</p><pre><code class="python">class Exit:
    def __init__(self, direction, target):
        self._direction = direction
        self._target = target

    @property
    def direction(self):
        return self._direction
    @property
    def target(self):
        return self._target.room
</code></pre><p>Имея комнаты и выходы, можно описать весь уровень. Теперь уже нет необходимости присваивать объекты <code>Room</code> именованным переменным: реальные комнаты соответствуют абстрактным комнатам из "мира идей", который обеспечивает доступ к ним и защищает от сборщика мусора.</p><pre><code class="python">Room(
    "Kitchen",
    [
        Exit("N", Room.Concept("Dining room")),
        Exit("E", Room.Concept("Bathroom")),
        Exit("W", Room.Concept("Street")),
    ],
)

Room(
    "Bathroom",
    [Exit("W", Room.Concept("Kitchen")), Exit("NW", Room.Concept("Dining room"))],
)
Room(
    "Dining room",
    [
        Exit("S", Room.Concept("Kitchen")),
        Exit("SE", Room.Concept("Bathroom")),
        Exit("U", Room.Concept("Playroom")),
    ],
)
Room(
    "Playroom",
    [Exit("D", Room.Concept("Dining room")), Exit("S", Room.Concept("Bedroom"))],
)
now = Room("Bedroom", [Exit("N", Room.Concept("Playroom"))])
goal = Room("Street", [])
</code></pre><p>Теперь всё готово, чтобы собрать воедино оставшиеся фрагменты головоломки:</p><pre><code class="python">while now != goal:
    print(f"You are in: {now.name}")
    print(f"Exits: {', '.join(now.exit_directions)}")

    dir = input("Where to go? ").upper()
    if dir in now.exit_directions:
        now = now.room_at(dir)
    else:
        print("You can't go there.")

print("Well done!")</code></pre><h3>Обсуждение</h3><p>Сравним два приведённых здесь решения. Можно аргументировать, что первое решение лучше второго практически <em>во всех отношениях</em>. Оно гораздо короче (23 строки против 100), его карта хранится в легко читаемом и сериализуемом виде, оно проще для понимания и содержит гораздо меньше "движущихся деталей". Ко всему прочему, в нём используется <em>словарь</em> для хранения выходов, что позволяет обращаться к ним быстрее. Думаю, я могу упростить второе решение без особых потерь его "объектно-ориентированности", если принять за данность, что комнаты и понятия связаны именами. Это позволит использовать имена вместо понятий, сведя тем самым абстрактные комнаты до простых строк. Это сблизит второе решение с первым. С другой стороны, я сообразил, что всё здесь завязано на именах лишь будучи уже на полпути к решению. Таким образом, моё изначальное соображение о неважности или "случайности" имён оказалось неверным: уникальное имя является важной характеристикой комнаты, хотя это стало ясно не сразу.</p><p>ООП-решение уже чересчур сильно напоминает <a href="https://medium.com/@webseanhickey/the-evolution-of-a-software-engineer-db854689243" rel="noopener noreferrer nofollow">"Hello, World!"-версию разработчика на пятом году работы</a>, так что хорошо бы понимать, в чём его преимущества, и каким образом мы дошли до него, казалось бы, идя обычным путём объектного анализа.</p><p>Потенциальной выгодой второго решения можно считать его (предполагаемую) расширяемость. Если свести разницу к чему-то простому, это будет <em>подход к разработке типов</em>. Логика первой программы состоит в попытке втиснуть наши типы в систему существующих типов Python везде, где это возможно. У комнаты есть уникальное имя и список связанных уникальных элементов (выходов). Звучит как пара "строка / словарь", так что мы просто используем строку и словарь. Этот подход позволяет сэкономить массу труда, поскольку встроенные типы прямо поддерживаются стандартной библиотекой, так что мы можем получить выгоду от существующей функциональности. Однако нам может и не повезти, и этот "бесплатный проезд" кончится. Вторая программа создаёт типы с нуля, так что нет ничего неожиданного в том, что самостоятельная разработка оказывается сложнее, многословнее и корявее. Мне кажется, всё могло быть ещё хуже: мы не создали никакой дополнительной сложности, которая возникает "сама собой" при попытке создать самостоятельные типы с хорошо продуманными интерфейсами. Создание независимых и при этом хорошо совместимых типов — это тоже <em>работа</em>, требующая как усилий, так и дополнительных строк кода.</p><p>Не думаю, что вина за раздутый текст решения в данном случае лежит на ООП. Мне кажется. это хороший пример 1) обманчивой простоты и неочевидной неоднозначности обыденного языка и 2) скрытой цены за разработку чего-то "своего", проявляющейся в потере функциональности и синтаксического сахара.</p><p>Кроме того, вторая программа показывает процесс <em>эволюционного</em> роста системы со всеми его преимуществами и недостатками. Эволюция движется туда, "где лучше", но попав в локальный оптимум, выбраться из него уже не может. Мой результат во многом схож с опытом Боба Мартина, попытавшегося написать <a href="https://blog.cleancoder.com/uncle-bob/2016/10/26/DijkstrasAlg.html" rel="noopener noreferrer nofollow">алгоритм Дейкстры в стиле TDD</a>. Не буду, однако, делать далеко идущих выводов. Достаточно заметить, что в короткой программе нетрудно применить кучу самых разных трюков и воспользоваться теми или иными особенностями библиотеки. "Выращивание" же более крупной системы — это деятельность совершенно иного характера с массой сюрпризов по дороге.</p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%9E%D0%9E%D0%9F%5D" class="tm-tags-list__link">ООП</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0%20%D0%BF%D0%BE%5D" class="tm-tags-list__link">архитектура по</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%5D" class="tm-tags-list__link">проектирование систем</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/programming/" class="tm-hubs-list__link">
    Программирование
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/analysis_design/" class="tm-hubs-list__link">
    Анализ и проектирование систем
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/refactoring/" class="tm-hubs-list__link">
    Проектирование и рефакторинг
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 5: ↑5 и ↓0</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 5: ↑5 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+5</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">1.3K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    15
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/rg_software/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/039/6e2/bfb/0396e2bfb32924c0ed1c919ce4af6aae.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 562 голоса " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    297.3
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">2.5</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Maxim Mozgovoy</span> <a href="/ru/users/rg_software/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @rg_software
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">university professor and software developer</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/582920/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 15 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/582920/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/582920/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"582920":{"id":"582920","timePublished":"2021-10-12T07:17:06+00:00","isCorporative":false,"lang":"ru","titleHtml":"Представление объектами: трудности роста","leadData":{"textHtml":"\u003Cp\u003EВ этой небольшой заметке я хотел бы поделиться соображениями, которые возникли в процессе разбора одного нехитрого упражнения. У меня нет хороших выводов, но общее направление мысли состоит в том, что \u003Cem\u003E*эволюционный*\u003C\u002Fem\u003E рост системы приводит к своего рода локальному оптимуму архитектуры, выбираться из которого приходится ценой существенной перестройки устройства проекта.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1fc\u002F541\u002Fa1c\u002F1fc541a1c021ec458498d710f8665b63.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1fc\u002F541\u002Fa1c\u002F1fc541a1c021ec458498d710f8665b63.png","fit":"cover","positionY":0,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"rg_software","originalUrl":"https:\u002F\u002Fmmozgovoy.dev\u002Fposts\u002Frepresenting-the-world-with-objects\u002F"}}],"author":{"scoreStats":{"score":297.3,"votesCount":562},"rating":2.5,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"21411","alias":"rg_software","fullname":"Maxim Mozgovoy","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F039\u002F6e2\u002Fbfb\u002F0396e2bfb32924c0ed1c919ce4af6aae.jpg","speciality":"university professor and software developer"},"statistics":{"commentsCount":15,"favoritesCount":15,"readingCount":1278,"score":5,"votesCount":5},"hubs":[{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"397","alias":"analysis_design","type":"collective","title":"Анализ и проектирование систем","titleHtml":"Анализ и проектирование систем","isProfiled":true},{"relatedData":null,"id":"7504","alias":"refactoring","type":"collective","title":"Проектирование и рефакторинг","titleHtml":"Проектирование и рефакторинг","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EВ этой небольшой заметке я хотел бы поделиться соображениями, которые возникли в процессе разбора одного нехитрого упражнения. У меня нет хороших выводов, но общее направление мысли состоит в том, что \u003Cem\u003Eэволюционный\u003C\u002Fem\u003E рост системы приводит к своего рода локальному оптимуму архитектуры, выбираться из которого приходится ценой существенной перестройки устройства проекта.\u003C\u002Fp\u003E\u003Ch3\u003EНачало\u003C\u002Fh3\u003E\u003Cp\u003EМне хотелось придумать очень простую задачу, которая бы иллюстрировала процесс перевода понятий реального мира в компьютерную программу. Думаю, используемый далее объектно-ориентированный стиль всего лишь отражает тот факт, что мир данной конкретной задачи действительно состоит из \"объектов\" в обыденном смысле этого слова, и тут я просто иду по пути наименьшего сопротивления.\u003C\u002Fp\u003E\u003Cp\u003EИтак, задача звучит следующим образом.\u003C\u002Fp\u003E\u003Cp\u003EТребуется разработать простейшую текстовую игру-приключение. Мир игры состоит из \u003Cem\u003Eкомнат\u003C\u002Fem\u003E. У каждой комнаты есть \u003Cem\u003Eназвание\u003C\u002Fem\u003E и список возможных \u003Cem\u003Eвыходов\u003C\u002Fem\u003E. Выходы помечаются сторонами света, такими как N, S, NE и т.д. Когда игрок попадает в комнату, игра выводит её название и список возможных выходов:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003EYou are in: Kitchen\nExits: N, E, S\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3\u003EПростое решение\u003C\u002Fh3\u003E\u003Cp\u003EУчитывая, что это всего лишь упражнение, имеет смысл начать с простого решения, чтобы иметь хоть какой-то ориентир на будущее. Предположим, что имена комнат уникальны, а выходы не обязательно симметричны (т.е. если мы можем переместиться на север, это ещё не означает, что можно вернуться обратно через южный выход). Второе предположение имеет смысл, например, в случае прыжка с высокого забора: спрыгнуть легко, залезть обратно сложно. Также давайте зафиксируем карту:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"247\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1f0\u002Ff8d\u002F7c9\u002F1f0f8d7c9b8e4613a50f18f3065430f1.png\" data-width=\"623\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EМоё решение задачи выглядит так:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Egame_map = {\n    \"Kitchen\": {\"N\": \"Dining room\", \"E\": \"Bathroom\", \"W\": \"Street\"},\n    \"Bathroom\": {\"W\": \"Kitchen\", \"NW\": \"Dining room\"},\n    \"Dining room\": {\"S\": \"Kitchen\", \"SE\": \"Bathroom\", \"U\": \"Playroom\"},\n    \"Playroom\": {\"D\": \"Dining room\", \"S\": \"Bedroom\"},\n    \"Bedroom\": {\"N\": \"Playroom\"},\n    \"Street\": {},\n}\n\nnow = \"Bedroom\"\ngoal = \"Street\"\n\nwhile now != goal:\n    print(f\"You are in: {now}\")\n    print(f\"Exits: {', '.join(list(game_map[now].keys()))}\")\n\n    dir = input(\"Where to go? \").upper()\n    if dir in game_map[now]:\n        now = game_map[now][dir]\n    else:\n        print(\"You can't go there.\")\n\nprint(\"Well done!\")\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКонечно, это решение в долгосрочной перспективе ненадёжно: оно использует уникальность названий комнат, не рассчитано \"на вырост\", ну и тому подобное. Однако оно показывает простоту и лаконичность \"холистического\" подхода, когда задача полностью решается за один присест. Даже в такой простой задаче видно, как удачно сочетаются отдельные части решения.\u003C\u002Fp\u003E\u003Cp\u003EНапример, названия комнат — это строки, а базовой структурой данных для хранения чего угодного являются словари. Таким образом, мы можем легко сопоставить комнатам выходы, состоящие, в свою очередь, из названий и целевых комнат. Строковые имена комнат позволяют легко проверять критерий победы и передвигаться между комнатами. Даже вывод названий выходов осуществляется простым вызовом \u003Ccode\u003Ejoin()\u003C\u002Fcode\u003E для списка ключей словаря.\u003C\u002Fp\u003E\u003Ch3\u003EПереход к ООП\u003C\u002Fh3\u003E\u003Cp\u003EПрограммирование во многих случаях можно рассматривать как процесс моделирования предметной области на компьютере. Если мы работаем с \u003Cem\u003Eклиентами\u003C\u002Fem\u003E и \u003Cem\u003Eзаказами\u003C\u002Fem\u003E, в программе так или иначе будут отражены эти сущности. Это некое общее замечание, выходящее за рамки конкретной парадигмы программирования. Думаю, что вполне конструктивно следующее соображение. Допустим, мы собираемся реализовать некоторую функциональность, например, \"клиент при желании должен иметь возможность выбрать подарочную упаковку для товара из списка предлагаемых нами вариантов\". Хорошо, если разработчик этой функциональности сумеет быстро найти и модифицировать относящиеся к делу части системы. Исходная задача заказчика, по всей вероятности, будет сформулирована на нашем обыденном языке. Таким образом, если код отходит от языка задачи слишком далеко, его будет сложнее поддерживать. Иначе говоря, соотнесение понятий кода и реального мира — это \u003Cem\u003Eработа\u003C\u002Fem\u003E, требующая усилий и времени, и в наших интересах её минимизировать.\u003C\u002Fp\u003E\u003Cp\u003EПриведённое выше решение по сути не выполняет никакого разумного соотнесения понятий. Вместо этого оно полагается на \u003Cem\u003Eслучайные\u003C\u002Fem\u003E свойства понятий, взятых из исходной постановки задачи, и пользуется их \u003Cem\u003Eслучайной\u003C\u002Fem\u003E схожестью со встроенными типами Python, извлекая выгоду из возможностей последних.\u003C\u002Fp\u003E\u003Cp\u003EДавайте попробуем подойти к задаче более системно. ООП в данном случае представляется естественным выбором, поскольку мы имеем дело с действительными сущностями реального мира: комнатами и выходами (ну или \"коридорами\", если угодно). Мы создаём виртуальный мир, очень похожий на настоящий, так что соотнесение виртуальных и реальных сущностей не должно представлять проблемы.\u003C\u002Fp\u003E\u003Cp\u003EИтак, имеются \"комнаты\". У каждой комнаты есть название и список выходов. Также имеются \"выходы\". Каждый выход связан с некоторой стороной света и ведёт в некоторую комнату. Эти наблюдения можно легко изложить в коде:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Eclass Room:\n    def __init__(self, name, exits):\n        self._name = name\n        self._exits = exits\n\n\nclass Exit:\n    def init(self, direction, target):\n        self._direction = direction\n        self._target = target\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТеперь попробуем описать часть игрового мира:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Estreet = Room(\"Street\", [])  # ok!\nbedroom = Room(\"Bedroom\", \n               [Exit(\"N\", Room(\"Playroom\", [Exit(\"S\", bedroom)]))])  # ouch!\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТолько не это, рекурсивная зависимость! Для определения выходов комнаты \"Bedroom\" мне нужна \"Playroom\", но по той же причине для определения \"Playroom\" мне требуется \"Bedroom\"! Так что же делать?\u003C\u002Fp\u003E\u003Cp\u003EРазумеется, можно предложить массу очевидных решений (и вообще, полное решение уже приведено). Вероятно, самым простым будет разделить создание комнат и определение выходов следующим образом:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Ebedroom = Room(\"Bedroom\")\nplayroom = Room(\"Playroom\")\n\nbedroom.add_exit(\"N\", playroom)\nplayroom.add_exit(\"S\", bedroom)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EМожно также снова воспользоваться тем фактом, что названия комнат по сути являются их уникальными идентификаторами, и передавать названия вместо комнат при создании выходов. Однако вопрос же не в этом: мы все понимаем, как тут всё быстро починить. Вопрос в том, что в процессе моделирования пошло не так, и почему мы в принципе столкнулись с такой неприятностью.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cem\u003EИмеются комнаты. Комнате соответствуют выходы. Выходы ведут в другие комнаты\u003C\u002Fem\u003E. Что не так с этим описанием? Почему на естественном языке всё в порядке, а в коде уже нет?\u003C\u002Fp\u003E\u003Ch3\u003EСнова о мире идей и мире вещей\u003C\u002Fh3\u003E\u003Cp\u003EМоя текущая теория проста: фразы вроде \u003Cem\u003E\"есть комната Bedroom с North-выходом, ведущая в комнату Playroom\"\u003C\u002Fem\u003E обманчивы. Они звучат так, словно мы обсуждаем две комнаты, хотя на самом деле слово \"Playroom\" в данном контексте является ссылкой на \"абстрактную комнату\", а не на реальную. Например, к текущему моменту я могу ничего не знать о комнате Playroom, кроме самого факта её существования. Скажем, я могу не знать списка выходов из неё, и это не проблема.\u003C\u002Fp\u003E\u003Cp\u003EКогда мы приводим полноценное описание комнаты (со списком выходов), абстрактное понятие становится реальностью. Комнаты и \"понятия о комнатах\" связаны именами. Говоря \"Playroom (понятие)\", я подразумеваю, что где-то должна существовать реальная комната под названием \"Playroom\". Понятия могут существовать без полноценных определений соответствующих комнат (так что их можно воспринимать как \u003Cem\u003Eпредварительные объявления\u003C\u002Fem\u003E своего рода), но каждой комнате соответствует абстрактное понятие о комнате, которое возникает в нашей мысленной картине мира при первом упоминании.\u003C\u002Fp\u003E\u003Cp\u003EДавайте попробуем отразить это соображение в коде. Идея состоит в возможности обращаться к абстрактным комнатам используя вызовы \u003Ccode\u003ERoom.Concept(name)\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Eclass Room:\n    _game_map = {}  # map of concepts\n\n    class _RoomConcept:\n        def __init__(self, name):\n            self._name = name\n            self._room = None\n\n        def connect_room(self, room):\n            self._room = room\n\n        @property\n        def room(self):\n            return self._room\n\n    @staticmethod\n    def Concept(name):\n        # create a concept if it is not yet in the map\n        if name not in Room._game_map:\n            Room._game_map[name] = Room._RoomConcept(name)\n        return Room._game_map[name]\n\n    def __init__(self, name, exits):\n        Room.Concept(name).connect_room(self)\n        self._name = name\n        self._exits = exits\n\n    @property\n    def name(self):\n        return self._name\n\n    @property\n    def exit_directions(self):\n        return [e.direction for e in self._exits]\n\n    def room_at(self, exit_direction):\n        for e in self._exits:\n            if e.direction == exit_direction:\n                return e.target\n        assert False, \"Exit does not exist\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EНе могу сказать, что я в восторге от этого кода, но это первое, что приходит в голову. Центральная его идея состоит в организации скрытой \"карты понятий\", своего рода платонического \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FTheory_of_forms\" rel=\"noopener noreferrer nofollow\"\u003Eмира идей\u003C\u002Fa\u003E, в котором они существуют. При каждом создании комнаты создаётся и соответствующее \"понятие\" (\"абстрактная комната\", \"идея комнаты\"). В остальном здесь предлагается вполне обыкновенный класс \u003Ccode\u003ERoom\u003C\u002Fcode\u003E с ожидаемым интерфейсом: вернуть список выходов, вернуть комнату на другом конце выхода, и тому подобное.\u003C\u002Fp\u003E\u003Cp\u003EТеперь нам потребуется простой класс \u003Ccode\u003EExit\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Eclass Exit:\n    def __init__(self, direction, target):\n        self._direction = direction\n        self._target = target\n\n    @property\n    def direction(self):\n        return self._direction\n    @property\n    def target(self):\n        return self._target.room\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EИмея комнаты и выходы, можно описать весь уровень. Теперь уже нет необходимости присваивать объекты \u003Ccode\u003ERoom\u003C\u002Fcode\u003E именованным переменным: реальные комнаты соответствуют абстрактным комнатам из \"мира идей\", который обеспечивает доступ к ним и защищает от сборщика мусора.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003ERoom(\n    \"Kitchen\",\n    [\n        Exit(\"N\", Room.Concept(\"Dining room\")),\n        Exit(\"E\", Room.Concept(\"Bathroom\")),\n        Exit(\"W\", Room.Concept(\"Street\")),\n    ],\n)\n\nRoom(\n    \"Bathroom\",\n    [Exit(\"W\", Room.Concept(\"Kitchen\")), Exit(\"NW\", Room.Concept(\"Dining room\"))],\n)\nRoom(\n    \"Dining room\",\n    [\n        Exit(\"S\", Room.Concept(\"Kitchen\")),\n        Exit(\"SE\", Room.Concept(\"Bathroom\")),\n        Exit(\"U\", Room.Concept(\"Playroom\")),\n    ],\n)\nRoom(\n    \"Playroom\",\n    [Exit(\"D\", Room.Concept(\"Dining room\")), Exit(\"S\", Room.Concept(\"Bedroom\"))],\n)\nnow = Room(\"Bedroom\", [Exit(\"N\", Room.Concept(\"Playroom\"))])\ngoal = Room(\"Street\", [])\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТеперь всё готово, чтобы собрать воедино оставшиеся фрагменты головоломки:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Ewhile now != goal:\n    print(f\"You are in: {now.name}\")\n    print(f\"Exits: {', '.join(now.exit_directions)}\")\n\n    dir = input(\"Where to go? \").upper()\n    if dir in now.exit_directions:\n        now = now.room_at(dir)\n    else:\n        print(\"You can't go there.\")\n\nprint(\"Well done!\")\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3\u003EОбсуждение\u003C\u002Fh3\u003E\u003Cp\u003EСравним два приведённых здесь решения. Можно аргументировать, что первое решение лучше второго практически \u003Cem\u003Eво всех отношениях\u003C\u002Fem\u003E. Оно гораздо короче (23 строки против 100), его карта хранится в легко читаемом и сериализуемом виде, оно проще для понимания и содержит гораздо меньше \"движущихся деталей\". Ко всему прочему, в нём используется \u003Cem\u003Eсловарь\u003C\u002Fem\u003E для хранения выходов, что позволяет обращаться к ним быстрее. Думаю, я могу упростить второе решение без особых потерь его \"объектно-ориентированности\", если принять за данность, что комнаты и понятия связаны именами. Это позволит использовать имена вместо понятий, сведя тем самым абстрактные комнаты до простых строк. Это сблизит второе решение с первым. С другой стороны, я сообразил, что всё здесь завязано на именах лишь будучи уже на полпути к решению. Таким образом, моё изначальное соображение о неважности или \"случайности\" имён оказалось неверным: уникальное имя является важной характеристикой комнаты, хотя это стало ясно не сразу.\u003C\u002Fp\u003E\u003Cp\u003EООП-решение уже чересчур сильно напоминает \u003Ca href=\"https:\u002F\u002Fmedium.com\u002F@webseanhickey\u002Fthe-evolution-of-a-software-engineer-db854689243\" rel=\"noopener noreferrer nofollow\"\u003E\"Hello, World!\"-версию разработчика на пятом году работы\u003C\u002Fa\u003E, так что хорошо бы понимать, в чём его преимущества, и каким образом мы дошли до него, казалось бы, идя обычным путём объектного анализа.\u003C\u002Fp\u003E\u003Cp\u003EПотенциальной выгодой второго решения можно считать его (предполагаемую) расширяемость. Если свести разницу к чему-то простому, это будет \u003Cem\u003Eподход к разработке типов\u003C\u002Fem\u003E. Логика первой программы состоит в попытке втиснуть наши типы в систему существующих типов Python везде, где это возможно. У комнаты есть уникальное имя и список связанных уникальных элементов (выходов). Звучит как пара \"строка \u002F словарь\", так что мы просто используем строку и словарь. Этот подход позволяет сэкономить массу труда, поскольку встроенные типы прямо поддерживаются стандартной библиотекой, так что мы можем получить выгоду от существующей функциональности. Однако нам может и не повезти, и этот \"бесплатный проезд\" кончится. Вторая программа создаёт типы с нуля, так что нет ничего неожиданного в том, что самостоятельная разработка оказывается сложнее, многословнее и корявее. Мне кажется, всё могло быть ещё хуже: мы не создали никакой дополнительной сложности, которая возникает \"сама собой\" при попытке создать самостоятельные типы с хорошо продуманными интерфейсами. Создание независимых и при этом хорошо совместимых типов — это тоже \u003Cem\u003Eработа\u003C\u002Fem\u003E, требующая как усилий, так и дополнительных строк кода.\u003C\u002Fp\u003E\u003Cp\u003EНе думаю, что вина за раздутый текст решения в данном случае лежит на ООП. Мне кажется. это хороший пример 1) обманчивой простоты и неочевидной неоднозначности обыденного языка и 2) скрытой цены за разработку чего-то \"своего\", проявляющейся в потере функциональности и синтаксического сахара.\u003C\u002Fp\u003E\u003Cp\u003EКроме того, вторая программа показывает процесс \u003Cem\u003Eэволюционного\u003C\u002Fem\u003E роста системы со всеми его преимуществами и недостатками. Эволюция движется туда, \"где лучше\", но попав в локальный оптимум, выбраться из него уже не может. Мой результат во многом схож с опытом Боба Мартина, попытавшегося написать \u003Ca href=\"https:\u002F\u002Fblog.cleancoder.com\u002Funcle-bob\u002F2016\u002F10\u002F26\u002FDijkstrasAlg.html\" rel=\"noopener noreferrer nofollow\"\u003Eалгоритм Дейкстры в стиле TDD\u003C\u002Fa\u003E. Не буду, однако, делать далеко идущих выводов. Достаточно заметить, что в короткой программе нетрудно применить кучу самых разных трюков и воспользоваться теми или иными особенностями библиотеки. \"Выращивание\" же более крупной системы — это деятельность совершенно иного характера с массой сюрпризов по дороге.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"ООП"},{"titleHtml":"архитектура по"},{"titleHtml":"проектирование систем"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1fc\u002F541\u002Fa1c\u002F1fc541a1c021ec458498d710f8665b63.png","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1fc\u002F541\u002Fa1c\u002F1fc541a1c021ec458498d710f8665b63.png","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F582920\\\u002F\"},\"headline\":\"Представление объектами: трудности роста\",\"datePublished\":\"2021-10-12T10:17:06+03:00\",\"dateModified\":\"2021-10-12T13:06:00+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Maxim Mozgovoy\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"В этой небольшой заметке я хотел бы поделиться соображениями, которые возникли в процессе разбора одного нехитрого упражнения. У меня нет хороших выводов, но общ...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F582920\\\u002F#post-content-body\",\"about\":[\"h_programming\",\"h_analysis_design\",\"h_refactoring\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F582920\\\u002Fbd1ba18766b4800722945449565639a9\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F1f0\\\u002Ff8d\\\u002F7c9\\\u002F1f0f8d7c9b8e4613a50f18f3065430f1.png\"]}","metaDescription":"В этой небольшой заметке я хотел бы поделиться соображениями, которые возникли в процессе разбора одного нехитрого упражнения. У меня нет хороших выводов, но общее направление мысли состоит в том,...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"programming,analysis_design,refactoring"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
