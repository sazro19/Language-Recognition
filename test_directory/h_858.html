<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>UHF RFID: Бюджетное решение для шлагбаума, после тестирования / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/575048\/"},"headline":"UHF RFID: Бюджетное решение для шлагбаума, после тестирования","datePublished":"2021-10-07T22:51:41+03:00","dateModified":"2021-10-08T00:46:39+03:00","author":{"@type":"Person","name":"ffasm"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"В предыдущей статье я рассмотрел решение по созданию недорогого варианта для открывания шлагбаума. После нескольких месяцев тестирования в посёлке были выявлены...","url":"https:\/\/habr.com\/ru\/post\/575048\/#post-content-body","about":["h_controllers","h_DIY","h_transport","f_develop","f_popsci"],"image":["https:\/\/habr.com\/share\/publication\/575048\/82308fa13cfe167b88ec6ff412e34587\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/8e2\/585\/023\/8e258502356143f4a713dbc4bd6a4aea.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/1e8\/d56\/1e3\/1e8d561e37d9d710158788b644434e8b.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/9b9\/622\/159\/9b96221595fd24739100ad0d982771ce.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/06b\/0b2\/309\/06b0b23094c57c2ba86a30de2ca1ca4b.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/cbe\/ebf\/e73\/cbeebfe73574e8bb1d28e2381d2c4a4d.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/d0a\/11c\/691\/d0a11c69155b9b0d09959a032ca5758a.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/937\/805\/3eb\/9378053eb7fd5b8e949bb69c4fd1a8e2.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/53e\/dfe\/842\/53edfe8424c0b60b05537c575a69ed51.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/0ce\/54a\/c49\/0ce54ac4916409ff5a600e23cb668bc0.JPG","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/374\/c44\/265\/374c442658e92d9514fd068112739471.JPG","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/04e\/b24\/e1e\/04eb24e1e67becf5c9d54dc6b47aa5a0.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/6cc\/1ce\/3c1\/6cc1ce3c1b3a58299600f2ffa7e38042.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="UHF RFID: Бюджетное решение для шлагбаума, после тестирования" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="UHF RFID: Бюджетное решение для шлагбаума, после тестирования" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="UHF RFID: Бюджетное решение для шлагбаума, после тестирования" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="В предыдущей статье я рассмотрел решение по созданию недорогого варианта для открывания шлагбаума. После нескольких месяцев тестирования в посёлке были выявлены проблемы, исправлены ошибки. Статья..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="В предыдущей статье я рассмотрел решение по созданию недорогого варианта для открывания шлагбаума. После нескольких месяцев тестирования в посёлке были выявлены проблемы, исправлены ошибки. Статья..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="В предыдущей статье я рассмотрел решение по созданию недорогого варианта для открывания шлагбаума. После нескольких месяцев тестирования в посёлке были выявлены проблемы, исправлены ошибки. Статья..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="В предыдущей статье я рассмотрел решение по созданию недорогого варианта для открывания шлагбаума. После нескольких месяцев тестирования в посёлке были выявлены проблемы, исправлены ошибки. Статья..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="В предыдущей статье я рассмотрел решение по созданию недорогого варианта для открывания шлагбаума. После нескольких месяцев тестирования в посёлке были выявлены проблемы, исправлены ошибки. Статья..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/f1a/b97/41c/f1ab9741c500552776e94d11d1f58d6e.jpg" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/f1a/b97/41c/f1ab9741c500552776e94d11d1f58d6e.jpg" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/f1a/b97/41c/f1ab9741c500552776e94d11d1f58d6e.jpg" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/f1a/b97/41c/f1ab9741c500552776e94d11d1f58d6e.jpg" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/f1a/b97/41c/f1ab9741c500552776e94d11d1f58d6e.jpg" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="575048" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-07T19:51:41.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/575048/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/575048/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habrastorage.org/getpro/habr/upload_files/f1a/b97/41c/f1ab9741c500552776e94d11d1f58d6e.jpg" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/575048/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/ffasm/" title="ffasm" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/ffasm/" class="tm-user-info__username">
      ffasm
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-07T19:51:41.000Z" title="2021-10-07, 22:51">7  октября   в 22:51</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>UHF RFID: Бюджетное решение для шлагбаума, после тестирования</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/controllers/" class="tm-article-snippet__hubs-item-link"><span>Программирование микроконтроллеров</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/DIY/" class="tm-article-snippet__hubs-item-link"><span>DIY или Сделай сам</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/transport/" class="tm-article-snippet__hubs-item-link"><span>Транспорт</span> <!----></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><p>В предыдущей статье я рассмотрел решение по созданию недорогого варианта для открывания шлагбаума. После нескольких месяцев тестирования в посёлке были выявлены проблемы, исправлены ошибки. Статья повторяет первую, но основана на практическом опыте, в ней много фотографий, ссылки на исходники. Информации должно быть достаточно, чтобы каждый смог это быстро повторить.</p><h2>Общая концепция</h2><p>На автомобили наклеиваются метки, на КПП вешаются считыватели меток, которые по wifi передают коды на роутер, роутер генерирует wiegand посылки, которые передаются в СКУД. СКУД принимает решение об открытии шлагбаума.</p><p>Первоначально я хотел использовать пароли, зачитывать один раз TID, второй раз по паролю. Как выяснилось в боевых условиях, ручное зачитывание (ReadCard) меток происходит достаточно долго, метка может считываться с ошибками, а значит надо делать множество попыток повторного чтения. Суммарно всё это приводило к долгому ожиданию перед открытием шлагбаума. Первым этапом был отказ от паролей, вторым - перевод считывателя в Active Mode, что значительно ускорило реакцию на метку: за секунду считыватель зачитывает больше 5 меток. Вариант включать пароли в Active Mode не проверял. </p><p>Сами считыватели можно купить с уже запаянными wifi модулями, которые отправляют в сеть информацию по меткам, так что если нет желания заморачиваться, можно купить готовый, написав только wiegand генератор на роутере.</p><p>Считыватели RU5306 отлично работают на всех автомобилях с обычным стеклом. Если же стекло с электроподогревом, качество считывания сразу очень сильно падает, в итоге я выставил RU5306 на продажу и купил RU5312. В этих моделях разница только в размере антенны и наличии светодиода, контроллеры совершенно одинаковые.</p><h2>Модификация считывателей CF-RU5312</h2><figure class="float bordered full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/8e2/585/023/8e258502356143f4a713dbc4bd6a4aea.jpg" alt="Прям вспомнилось начало первого фильма про Эйса Вентуру" title="Прям вспомнилось начало первого фильма про Эйса Вентуру" width="720" height="924" data-src="https://habrastorage.org/getpro/habr/upload_files/8e2/585/023/8e258502356143f4a713dbc4bd6a4aea.jpg" data-blurred="true"/><figcaption>Прям вспомнилось начало первого фильма про Эйса Вентуру</figcaption></figure><p>Мне привезли заказ - две большие коробки со считывателями. Первая в отличном состоянии, второй считыватель оказался помят. К счастью дефект не повлиял на работоспособность. В коробке со считывателем не оказалось блока питания, что несколько испортило моё отношение к продавцу. По просьбе читателей я решил разобрать все считыватели и устроить фотосессию с обнажёнкой. В RU5312 крышка, скрывающая антенну, оказалась приклеена на силикон или что-то подобное. В RU5306 используются прокладки, что позволяет ничего не отдирать.</p><figure class="float full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/1e8/d56/1e3/1e8d561e37d9d710158788b644434e8b.jpg" alt="Антенна считывателя RU5312" title="Антенна считывателя RU5312" width="720" height="701" data-src="https://habrastorage.org/getpro/habr/upload_files/1e8/d56/1e3/1e8d561e37d9d710158788b644434e8b.jpg" data-blurred="true"/><figcaption>Антенна считывателя RU5312</figcaption></figure><p>К сожалению, у меня крайне мало опыта в антеннах, так что никаких комментариев дать не смогу.  </p><figure class="float full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/9b9/622/159/9b96221595fd24739100ad0d982771ce.jpg" width="720" height="726" data-src="https://habrastorage.org/getpro/habr/upload_files/9b9/622/159/9b96221595fd24739100ad0d982771ce.jpg" data-blurred="true"/><figcaption></figcaption></figure><p>К считывателю добавляем модуль ESP8266, прошивку можно взять из форка Tasmota <a href="https://github.com/BASM/Tasmota/tree/uhr" rel="noopener noreferrer nofollow">https://github.com/BASM/Tasmota/</a> ветка uhf_nopass. Перед сборкой следует создать файл tasmota/mypass.inc, в котором указать логин/пароль от wifi, к которому будет подключаться модуль:</p><pre><code>#define STA_SSID1              "uhfbarrer" 
#define STA_PASS1              "zpubpR78T"
#define STA_SSID2              "reserve"
#define STA_PASS2              "pXNWo3Bmn"
#define WIFI_AP_PASSPHRASE     "gR8I81mHC0" </code></pre><p>Стоит заметить, что tasmota в каких-то случаях начинает пытаться получить время и дату по NTP и делает это крайне неоптимальным способом. Если же до NTP сервера достучаться не получается, считыватель переводится почти в неработоспособное состояние, постоянно "подвисает".  Я сделал грязный хак, отключающий этот функционал. Если вам нужна правильная дата, сделайте revert этого коммита.</p><p>Для сборки нужно воспользоваться инструментарием platformio, для упрощения я добавил Makefile, так что достаточно набрать make для сборки. После сборки будет создано две прошивки: tasmota-minimal и tasmota-sensors. Прошивки архивируются. </p><figure class="float "><img src="/img/image-loader.svg" alt="Не самый правильный, но самый простой способ перевести ESP8266 в режим программирования." title="Не самый правильный, но самый простой способ перевести ESP8266 в режим программирования." height="372" data-src="https://habrastorage.org/getpro/habr/upload_files/06b/0b2/309/06b0b23094c57c2ba86a30de2ca1ca4b.png" data-width="431"/><figcaption>Не самый правильный, но самый простой способ перевести ESP8266 в режим программирования.</figcaption></figure><p>Для записи в ESP8266 нужно загрузить МК в режим программирования, это можно сделать, запаяв провода как на картинке. Для прошивки можно набрать "make flash", будет зашита прошивка tasmota-sensors. Перед прошивкой рекомендуется очистить память, это можно сделать командой "make flashclean". Если память не почистить, то области, где находятся настройки tasmota, не будут перетёрты, а значит могут возникнуть проблемы. </p><p>После прошивки нужно отпаять все провода кроме питания, а затем подать питание. Модуль подключится к wifi. Если это произошло, модуль можно запаивать, т.к. дальнейшее обновление можно делать через web-интерфейс. Из-за малого количества памяти на микроконтроллере обновление в tasmota сделано в два этапа: необходимо отправить сжатый образ minimal, после прошивки ещё раз перепрошить уже sensors версией.</p><figure class="float "><img src="/img/image-loader.svg" alt="Запайка ESP8266 в штатный разъём на ножки." title="Запайка ESP8266 в штатный разъём на ножки." height="212" data-src="https://habrastorage.org/getpro/habr/upload_files/cbe/ebf/e73/cbeebfe73574e8bb1d28e2381d2c4a4d.png" data-width="240"/><figcaption>Запайка ESP8266 в штатный разъём на ножки.</figcaption></figure><p>Можно запаять модуль прямо на штатный разъём, но (при необходимости) выпаять его будет крайне сложно. Если припаять на ножки, то это значительно облегчит задачу. </p><p>В стандартной схеме ESP модуль UART-ом подключён к управляющему микроконтроллеру и является ведомым устройством. Мы сделаем его главным, для этого мы подключаем выход UART считывателя к ESP модулю. UART подпаиваем прямо в параллель к RS-232 драйверу, ножка 12 (удобнее запаять к стабилитрону) и 11. Идеально было бы, конечно, переписать прошивку управляющего микроконтроллера, но я пошёл более топорным вариантом.</p><p>Считыватель можно настраивать в разные режимы работы, нас интересует режим считывания TID и выдача его в UART. Делается это с помощью программы Reader Software, которую можно скачать с сайта фирмы chafon. В идеальном случае настраивать считыватель нужно из ESP модуля, но я так и не заставил себя дописать этот функционал в прошивку.</p><figure class="float "><img src="/img/image-loader.svg" alt="Модификация закончена." title="Модификация закончена." height="377" data-src="https://habrastorage.org/getpro/habr/upload_files/d0a/11c/691/d0a11c69155b9b0d09959a032ca5758a.png" data-width="425"/><figcaption>Модификация закончена.</figcaption></figure><p>Из считывателя выходит масса проводов: питание, RS-232, wiegand, выход на реле и т.п. В нашем случае реально задействован будет только один - провод питания. Я установил на считыватель дополнительный 12v разъём питания и убрал все остальные провода. В большом считывателе RU5312 есть двухцветный светодиод, он очень помогает при анализе проблем, в RU5306 его не подключают, при кастомизации очень советую его добавлять. Разъём с бело-чёрно-красным проводом отвечает за него. Если на считывателе есть питание - горит красный светодиод, если считыватель зачитывает данные с метки - загорается зелёный светодиод. Причём загорается он, даже если данные были зачитаны с ошибкой (crc не совпала).</p><h2>Делаем wiegand генератор на роутере</h2><figure class="float "><img src="/img/image-loader.svg" height="410" data-src="https://habrastorage.org/getpro/habr/upload_files/937/805/3eb/9378053eb7fd5b8e949bb69c4fd1a8e2.png" data-width="298"/><figcaption></figcaption></figure><p>Вариантов открыть шлагбаум, получив правильную UDP посылку, можно предложить массу. Наш вариант - прошить OpenWRT на роутер и вставить туда silabs cp2104, который с помощью PIO будет генерировать wiegand посылки. У меня старый роутер, куда устанавливается только старая версия OpenWRT, где старое ядро со старым драйвером cp2104, которое не поддерживает PIO. Наиболее простой выход из ситуации для использования PIO использовать libusb библиотеку. На радость такую библиотеку уже написал Андрей (nekromant): <a href="https://github.com/nekromant/pl2303gpio" rel="noopener noreferrer nofollow">https://github.com/nekromant/pl2303gpio</a><br/> </p><p>Саму утилиту можно скачать тут: <a href="https://github.com/BASM/ufhudp2wiegand.git" rel="noopener noreferrer nofollow">https://github.com/BASM/ufhudp2wiegand.git</a>, команда make соберёт утилиту. Я не вижу особого смысла писать ещё одну подробную инструкцию, как заставить утилиту запускаться на роутере. Так что лишь кратко опишу, куда двигаться: скачиваем кросскомпилятор с проекта OpenWRT под ваш роутер, исправляем Makefile, указывая кросскомпилятор, собираем командой make, при желании проверяем с помощью qemu-mips (qemu-user позволяет запускать утилиты, собранные под другую архитектуру, на инструментальной машине), копируем на роутер, добавляем в автозапуск. Наиболее простой способ добавить в автозапуск - это поправить скрипт в /etc/rc.local, не забыв про знак "&amp;", чтобы не блокировать скрипт /etc/rc.local.</p><h2>Утилита для компьютера</h2><figure class="float full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/53e/dfe/842/53edfe8424c0b60b05537c575a69ed51.jpg" alt="LJYNZ-105" title="LJYNZ-105" width="1199" height="720" data-src="https://habrastorage.org/getpro/habr/upload_files/53e/dfe/842/53edfe8424c0b60b05537c575a69ed51.jpg" data-blurred="true"/><figcaption>LJYNZ-105</figcaption></figure><p>Настольных считывателей я в общей сложности купил два, один Chafon CF-RU5102, второй LJYNZ-105, так как на него появилась очень хорошая скидка. Оба считывателя имеют совершенно одинаковые интерфейсы, даже документация отличалась только первой страницей. Но внутренности оказались немного разные.</p><figure class="float full-width "><img src="https://habrastorage.org/getpro/habr/upload_files/0ce/54a/c49/0ce54ac4916409ff5a600e23cb668bc0.JPG" alt="CF-RU5102" title="CF-RU5102" width="4000" height="3000"/><figcaption>CF-RU5102</figcaption></figure><p>В LJYNZ-105 были заботливо затёрты все наименования чипов, в CF-RU5102 затёрт только чип, отвечающий за управление. Для RF используется ADF7020, для USB Silabs CP2101. С точки зрения общей схемы считыватели крайне похожи, это USB&lt;->Uart преобразователь, микроконтроллер, реализующий интерфейс общения, и RF контроллер. В LJYNZ-105 была обнаружена незначительная проблема, при включении и выключении бизера он продолжал очень тихо пищать. Прошу прощения за качество фотографии CF-RU5102, заметил это после того как уже отдал оборудование.</p><figure class="float full-width "><img src="https://habrastorage.org/getpro/habr/upload_files/374/c44/265/374c442658e92d9514fd068112739471.JPG" alt="CF-RU5102 с Wiegand интерфейсом" title="CF-RU5102 с Wiegand интерфейсом" width="4000" height="3000"/><figcaption>CF-RU5102 с Wiegand интерфейсом</figcaption></figure><p>Я припаялся к DTR и RTS, тем самым получил возможность генерировать wiegand посылки из системы, куда подключён считыватель.</p><p>К сожалению, библиотек для работы со считывателем для языка C я найти не смог, поэтому решил написать свою. Я её разместил тут: <a href="https://github.com/BASM/UHFreader" rel="noopener noreferrer nofollow">https://github.com/BASM/UHFreader</a>:  библиотека и пример использования. Пример - это программа, которая решает две задачи: устанавливает пароли на метки (если метки поддерживают), что позволяет защитить метки от уничтожения, и позволяет внести код метки в СКУД, не вставая со стула. Ещё на метку в EPC записывается содержимое TID, использовалось в период тестирования, я решил не убирать эту функциональность.</p><h2>Какие метки использовать</h2><figure class="float "><img src="/img/image-loader.svg" height="248" data-src="https://habrastorage.org/getpro/habr/upload_files/04e/b24/e1e/04eb24e1e67becf5c9d54dc6b47aa5a0.png" data-width="412"/><figcaption></figcaption></figure><p>Я накупил разных видов меток. Метки вида (2) работали крайне плохо, они имеют малый радиус и при чтении постоянно не совпадает CRC; лучше всего ловит (1), которые продаёт сам chafon. После того как был выявлен лидер, жителям по умолчанию выдавались метки вида (1). Было создано 3 тестовых комплекта, состоящих из всех видов, любой желающий мог взять его, протестировать и составить отчёт. Но к сожалению кроме меня этим никто не занялся. Так что по субъективным оценкам (3), (4) и (6) работают несколько хуже, чем (1), но лучше, чем (2). Метка (5) ко мне приехала в единственном экземпляре в качестве "пробника", я её наклеил на машину соседу и в целом дать оценку её работы не могу.</p><figure class="float "><img src="/img/image-loader.svg" height="67" data-src="https://habrastorage.org/getpro/habr/upload_files/6cc/1ce/3c1/6cc1ce3c1b3a58299600f2ffa7e38042.png" data-width="254"/><figcaption></figcaption></figure><p>Если зайти в магазин Decatlon, то можно заметить, что там используется UHF для отслеживания и пробивания товара на кассе. Метки фирмы NXP, но модель отсутствуют в базе gs1.org. В метках выставлен пароль на запись. Их TID успешно считывается и потенциально может использоваться для открытия шлагбаума если вы, например, выезжаете на велосипеде. Практических опытов не проводилось.</p><h2>А можно обойтись без модификаций считывателя?</h2><p>Я пытался написать эту статью с минимумом теоретических рассуждений и воды, но всё же не смог удержаться. Я немного опишу, как можно было сделать систему без модификации считывателя, и расскажу о проблемах, которые могут возникнуть.   </p><p>Помимо проводов питания необходимо будет тянуть провода для данных, будь то wiegand или UART. Либо можно заказать считыватели сразу с запаянным wifi модулем, проверить на практике такое решение у меня не было возможности.</p><p>Если настроить считыватель на выдачу кодов по wiegand, мы ограничиваемся размером wiegand посылок 24 или 32 бита. TID состоит из 96 бит: сначала идёт информация по протоколу, модели метки и т.п., в конце - уникальный идентификатор. Размер этого идентификатора больше 32 бит. Сначала я возвращал последние 32 бита TID для меток (1) и это работало правильно, но после тестирования меток Monza R6 (2) выяснилось, что метки изменяют старшую часть идентификатора. Специально для них пришлось делать XOR последних двух 32 битных блоков TID, чтобы от метки к метке у нас не совпадали номера.</p><p>Другой проблемой оказалась невозможность считывателя возвращать нужное смещение в TID, несмотря на явную возможность это задать в параметрах конфигурирования. При выдаче в wiegand всегда возвращалась начальная часть TID, которая совпадает для меток одинаковых моделей. Т.е. единственный вариант - это зачитывать EPC, а как известно, EPC является открытой для записи памятью, и любой желающий может записать туда любое значение, а значит легко сделать копию метки.</p><p>Ещё она проблема, это таксисты. Почти у любого таксиста есть метка; когда он паркуется у КПП в ожидании клиента, считыватель начинает посылать массу сообщений о том, что метка найдена. СКУД конечно не знает этой метки и не открывает шлагбаум, но сообщает об этом в журнал. Считыватель может зачитывать по несколько меток в секунду, из-за чего журнал сильно замусоривается. Можно включить ограничение на скорость считывания, но тогда если в зоне чтения больше двух меток, ожидаемая метка может быть прочитана с большой задержкой. В своей прошивке я обошёл эту проблему созданием буфера прочитанных меток. Считыватель выдаёт метки с максимальной скоростью, если метки нет в буфере; её код выдаётся в wiegand и записывается в буфер. Если метка в буфере есть, ничего не происходит. Алгоритм, в свою очередь, следит, чтобы коды, попавшие в буфер, удалялись оттуда через 3 секунды. В результате скорость реакции на правильную метку оказывается максимально высокой, даже если вокруг находятся другие метки. </p><h2>Использование считывателя без СКУД</h2><p>На считывателях есть реле, его можно замыкать с помощью управляющего контроллера. Если это реле подключить к шлагбауму, можно открывать по какой-то логике. Наиболее простой вариант - это считывать TID, делать какое-либо преобразование и результат сверять с EPC. Это позволит организовать открывание шлагбаума только на основании специально созданных меток без использования СКУД. </p><h2>Заключение</h2><p>Запуск системы был сделан в апреле 2021, система работала успешно у 80-90% жителей. К августу работоспособность доведена до 100%. Последний тест покажет, будут ли проблемы в зимний период.  </p><p>Мы встретили метку с другого объекта, при попытке добавить эту метку в нашу систему оказалось, что пароль на метке не выставлен. Наше оборудование заботливо переписало EPC и установило пароль на метку, в результате чего на том объекте она работать перестала. Если метка наклеена на вашу машину, следует осознавать, что потенциально к ней имеет доступ любой человек, который может подойти на расстояние в 10 метров, а значит оставление метки без пароля является грубой ошибкой. Рано или поздно её кто-нибудь затрёт, будь то моя заботливая программа или школьник-радиолюбитель.</p><p>В российском интернет-магазине мне удалось найти в продаже метки с открытой на запись TID, цена таких меток около 800 рублей. Если требуется использовать действительно защищённую систему, следует рассмотреть метки с AES, например, NXP DNA. </p><p>К сожалению, моя статься затрагивает в основном одного производителя, сравнить работоспособность разных считывателей не удалось из-за отсутствия времени и бюджета. Статей, подобных этой, крайне мало, так что я буду очень рад увидеть аналогичные статьи с опытом использования считывателей от других производителей.</p><p>Первоначально я назвал статью "Бюджетное решение", но цена этого проекта перевалила за $1300, наверное, назвать это бюджетным будет не очень корректно. В целом если убрать из этой цены все мои ошибки, найти способы сэкономить на доставке (стоимость доставки соразмерна цене самого считывателя), то вполне реально выйти в бюджет $250-500.    </p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Besp8266%5D" class="tm-tags-list__link">esp8266</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Btasmota%5D" class="tm-tags-list__link">tasmota</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Buhf%20rfid%20epc%20class1%20gen2%5D" class="tm-tags-list__link">uhf rfid epc class1 gen2</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Buhf%5D" class="tm-tags-list__link">uhf</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%88%D0%BB%D0%B0%D0%B3%D0%B1%D0%B0%D1%83%D0%BC%D1%8B%5D" class="tm-tags-list__link">шлагбаумы</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/controllers/" class="tm-hubs-list__link">
    Программирование микроконтроллеров
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/DIY/" class="tm-hubs-list__link">
    DIY или Сделай сам
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/transport/" class="tm-hubs-list__link">
    Транспорт
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 14: ↑14 и ↓0</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 14: ↑14 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+14</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">4.8K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    46
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/ffasm/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 12 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    10
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">14</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/ffasm/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @ffasm
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Программист</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/575048/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 3 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/575048/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/575048/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"575048":{"id":"575048","timePublished":"2021-10-07T19:51:41+00:00","isCorporative":false,"lang":"ru","titleHtml":"UHF RFID: Бюджетное решение для шлагбаума, после тестирования","leadData":{"textHtml":"\u003Cp\u003EРешение по созданию недорогого варианта для открывания шлагбаума. После нескольких месяцев тестирования в посёлке были выявлены проблемы, исправлены ошибки. Статья повторяет первую, но основана на практическом опыте, в ней много фотографий, ссылки на исходники. Информации должно быть достаточно, чтобы каждый смог это быстро повторить.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff1a\u002Fb97\u002F41c\u002Ff1ab9741c500552776e94d11d1f58d6e.jpg","buttonTextHtml":"наслаждайтесь","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff1a\u002Fb97\u002F41c\u002Ff1ab9741c500552776e94d11d1f58d6e.jpg","fit":"cover","positionY":0,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":10,"votesCount":12},"rating":14,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"1941811","alias":"ffasm","fullname":null,"avatarUrl":null,"speciality":"Программист"},"statistics":{"commentsCount":3,"favoritesCount":46,"readingCount":4819,"score":14,"votesCount":14},"hubs":[{"relatedData":null,"id":"19737","alias":"controllers","type":"collective","title":"Программирование микроконтроллеров","titleHtml":"Программирование микроконтроллеров","isProfiled":true},{"relatedData":null,"id":"21976","alias":"DIY","type":"collective","title":"DIY или Сделай сам","titleHtml":"DIY или Сделай сам","isProfiled":false},{"relatedData":null,"id":"22004","alias":"transport","type":"collective","title":"Транспорт","titleHtml":"Транспорт","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EВ предыдущей статье я рассмотрел решение по созданию недорогого варианта для открывания шлагбаума. После нескольких месяцев тестирования в посёлке были выявлены проблемы, исправлены ошибки. Статья повторяет первую, но основана на практическом опыте, в ней много фотографий, ссылки на исходники. Информации должно быть достаточно, чтобы каждый смог это быстро повторить.\u003C\u002Fp\u003E\u003Ch2\u003EОбщая концепция\u003C\u002Fh2\u003E\u003Cp\u003EНа автомобили наклеиваются метки, на КПП вешаются считыватели меток, которые по wifi передают коды на роутер, роутер генерирует wiegand посылки, которые передаются в СКУД. СКУД принимает решение об открытии шлагбаума.\u003C\u002Fp\u003E\u003Cp\u003EПервоначально я хотел использовать пароли, зачитывать один раз TID, второй раз по паролю. Как выяснилось в боевых условиях, ручное зачитывание (ReadCard) меток происходит достаточно долго, метка может считываться с ошибками, а значит надо делать множество попыток повторного чтения. Суммарно всё это приводило к долгому ожиданию перед открытием шлагбаума. Первым этапом был отказ от паролей, вторым - перевод считывателя в Active Mode, что значительно ускорило реакцию на метку: за секунду считыватель зачитывает больше 5 меток. Вариант включать пароли в Active Mode не проверял. \u003C\u002Fp\u003E\u003Cp\u003EСами считыватели можно купить с уже запаянными wifi модулями, которые отправляют в сеть информацию по меткам, так что если нет желания заморачиваться, можно купить готовый, написав только wiegand генератор на роутере.\u003C\u002Fp\u003E\u003Cp\u003EСчитыватели RU5306 отлично работают на всех автомобилях с обычным стеклом. Если же стекло с электроподогревом, качество считывания сразу очень сильно падает, в итоге я выставил RU5306 на продажу и купил RU5312. В этих моделях разница только в размере антенны и наличии светодиода, контроллеры совершенно одинаковые.\u003C\u002Fp\u003E\u003Ch2\u003EМодификация считывателей CF-RU5312\u003C\u002Fh2\u003E\u003Cfigure class=\"float bordered full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8e2\u002F585\u002F023\u002F8e258502356143f4a713dbc4bd6a4aea.jpg\" alt=\"Прям вспомнилось начало первого фильма про Эйса Вентуру\" title=\"Прям вспомнилось начало первого фильма про Эйса Вентуру\" width=\"720\" height=\"924\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8e2\u002F585\u002F023\u002F8e258502356143f4a713dbc4bd6a4aea.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003EПрям вспомнилось начало первого фильма про Эйса Вентуру\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EМне привезли заказ - две большие коробки со считывателями. Первая в отличном состоянии, второй считыватель оказался помят. К счастью дефект не повлиял на работоспособность. В коробке со считывателем не оказалось блока питания, что несколько испортило моё отношение к продавцу. По просьбе читателей я решил разобрать все считыватели и устроить фотосессию с обнажёнкой. В RU5312 крышка, скрывающая антенну, оказалась приклеена на силикон или что-то подобное. В RU5306 используются прокладки, что позволяет ничего не отдирать.\u003C\u002Fp\u003E\u003Cfigure class=\"float full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1e8\u002Fd56\u002F1e3\u002F1e8d561e37d9d710158788b644434e8b.jpg\" alt=\"Антенна считывателя RU5312\" title=\"Антенна считывателя RU5312\" width=\"720\" height=\"701\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1e8\u002Fd56\u002F1e3\u002F1e8d561e37d9d710158788b644434e8b.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003EАнтенна считывателя RU5312\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EК сожалению, у меня крайне мало опыта в антеннах, так что никаких комментариев дать не смогу.  \u003C\u002Fp\u003E\u003Cfigure class=\"float full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9b9\u002F622\u002F159\u002F9b96221595fd24739100ad0d982771ce.jpg\" width=\"720\" height=\"726\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9b9\u002F622\u002F159\u002F9b96221595fd24739100ad0d982771ce.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EК считывателю добавляем модуль ESP8266, прошивку можно взять из форка Tasmota \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FBASM\u002FTasmota\u002Ftree\u002Fuhr\" rel=\"noopener noreferrer nofollow\"\u003Ehttps:\u002F\u002Fgithub.com\u002FBASM\u002FTasmota\u002F\u003C\u002Fa\u003E ветка uhf_nopass. Перед сборкой следует создать файл tasmota\u002Fmypass.inc, в котором указать логин\u002Fпароль от wifi, к которому будет подключаться модуль:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E#define STA_SSID1              \"uhfbarrer\" \n#define STA_PASS1              \"zpubpR78T\"\n#define STA_SSID2              \"reserve\"\n#define STA_PASS2              \"pXNWo3Bmn\"\n#define WIFI_AP_PASSPHRASE     \"gR8I81mHC0\" \u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EСтоит заметить, что tasmota в каких-то случаях начинает пытаться получить время и дату по NTP и делает это крайне неоптимальным способом. Если же до NTP сервера достучаться не получается, считыватель переводится почти в неработоспособное состояние, постоянно \"подвисает\".  Я сделал грязный хак, отключающий этот функционал. Если вам нужна правильная дата, сделайте revert этого коммита.\u003C\u002Fp\u003E\u003Cp\u003EДля сборки нужно воспользоваться инструментарием platformio, для упрощения я добавил Makefile, так что достаточно набрать make для сборки. После сборки будет создано две прошивки: tasmota-minimal и tasmota-sensors. Прошивки архивируются. \u003C\u002Fp\u003E\u003Cfigure class=\"float \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Не самый правильный, но самый простой способ перевести ESP8266 в режим программирования.\" title=\"Не самый правильный, но самый простой способ перевести ESP8266 в режим программирования.\" height=\"372\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F06b\u002F0b2\u002F309\u002F06b0b23094c57c2ba86a30de2ca1ca4b.png\" data-width=\"431\"\u002F\u003E\u003Cfigcaption\u003EНе самый правильный, но самый простой способ перевести ESP8266 в режим программирования.\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EДля записи в ESP8266 нужно загрузить МК в режим программирования, это можно сделать, запаяв провода как на картинке. Для прошивки можно набрать \"make flash\", будет зашита прошивка tasmota-sensors. Перед прошивкой рекомендуется очистить память, это можно сделать командой \"make flashclean\". Если память не почистить, то области, где находятся настройки tasmota, не будут перетёрты, а значит могут возникнуть проблемы. \u003C\u002Fp\u003E\u003Cp\u003EПосле прошивки нужно отпаять все провода кроме питания, а затем подать питание. Модуль подключится к wifi. Если это произошло, модуль можно запаивать, т.к. дальнейшее обновление можно делать через web-интерфейс. Из-за малого количества памяти на микроконтроллере обновление в tasmota сделано в два этапа: необходимо отправить сжатый образ minimal, после прошивки ещё раз перепрошить уже sensors версией.\u003C\u002Fp\u003E\u003Cfigure class=\"float \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Запайка ESP8266 в штатный разъём на ножки.\" title=\"Запайка ESP8266 в штатный разъём на ножки.\" height=\"212\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcbe\u002Febf\u002Fe73\u002Fcbeebfe73574e8bb1d28e2381d2c4a4d.png\" data-width=\"240\"\u002F\u003E\u003Cfigcaption\u003EЗапайка ESP8266 в штатный разъём на ножки.\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EМожно запаять модуль прямо на штатный разъём, но (при необходимости) выпаять его будет крайне сложно. Если припаять на ножки, то это значительно облегчит задачу. \u003C\u002Fp\u003E\u003Cp\u003EВ стандартной схеме ESP модуль UART-ом подключён к управляющему микроконтроллеру и является ведомым устройством. Мы сделаем его главным, для этого мы подключаем выход UART считывателя к ESP модулю. UART подпаиваем прямо в параллель к RS-232 драйверу, ножка 12 (удобнее запаять к стабилитрону) и 11. Идеально было бы, конечно, переписать прошивку управляющего микроконтроллера, но я пошёл более топорным вариантом.\u003C\u002Fp\u003E\u003Cp\u003EСчитыватель можно настраивать в разные режимы работы, нас интересует режим считывания TID и выдача его в UART. Делается это с помощью программы Reader Software, которую можно скачать с сайта фирмы chafon. В идеальном случае настраивать считыватель нужно из ESP модуля, но я так и не заставил себя дописать этот функционал в прошивку.\u003C\u002Fp\u003E\u003Cfigure class=\"float \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Модификация закончена.\" title=\"Модификация закончена.\" height=\"377\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd0a\u002F11c\u002F691\u002Fd0a11c69155b9b0d09959a032ca5758a.png\" data-width=\"425\"\u002F\u003E\u003Cfigcaption\u003EМодификация закончена.\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EИз считывателя выходит масса проводов: питание, RS-232, wiegand, выход на реле и т.п. В нашем случае реально задействован будет только один - провод питания. Я установил на считыватель дополнительный 12v разъём питания и убрал все остальные провода. В большом считывателе RU5312 есть двухцветный светодиод, он очень помогает при анализе проблем, в RU5306 его не подключают, при кастомизации очень советую его добавлять. Разъём с бело-чёрно-красным проводом отвечает за него. Если на считывателе есть питание - горит красный светодиод, если считыватель зачитывает данные с метки - загорается зелёный светодиод. Причём загорается он, даже если данные были зачитаны с ошибкой (crc не совпала).\u003C\u002Fp\u003E\u003Ch2\u003EДелаем wiegand генератор на роутере\u003C\u002Fh2\u003E\u003Cfigure class=\"float \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"410\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F937\u002F805\u002F3eb\u002F9378053eb7fd5b8e949bb69c4fd1a8e2.png\" data-width=\"298\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВариантов открыть шлагбаум, получив правильную UDP посылку, можно предложить массу. Наш вариант - прошить OpenWRT на роутер и вставить туда silabs cp2104, который с помощью PIO будет генерировать wiegand посылки. У меня старый роутер, куда устанавливается только старая версия OpenWRT, где старое ядро со старым драйвером cp2104, которое не поддерживает PIO. Наиболее простой выход из ситуации для использования PIO использовать libusb библиотеку. На радость такую библиотеку уже написал Андрей (nekromant): \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fnekromant\u002Fpl2303gpio\" rel=\"noopener noreferrer nofollow\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fnekromant\u002Fpl2303gpio\u003C\u002Fa\u003E\u003Cbr\u002F\u003E \u003C\u002Fp\u003E\u003Cp\u003EСаму утилиту можно скачать тут: \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FBASM\u002Fufhudp2wiegand.git\" rel=\"noopener noreferrer nofollow\"\u003Ehttps:\u002F\u002Fgithub.com\u002FBASM\u002Fufhudp2wiegand.git\u003C\u002Fa\u003E, команда make соберёт утилиту. Я не вижу особого смысла писать ещё одну подробную инструкцию, как заставить утилиту запускаться на роутере. Так что лишь кратко опишу, куда двигаться: скачиваем кросскомпилятор с проекта OpenWRT под ваш роутер, исправляем Makefile, указывая кросскомпилятор, собираем командой make, при желании проверяем с помощью qemu-mips (qemu-user позволяет запускать утилиты, собранные под другую архитектуру, на инструментальной машине), копируем на роутер, добавляем в автозапуск. Наиболее простой способ добавить в автозапуск - это поправить скрипт в \u002Fetc\u002Frc.local, не забыв про знак \"&amp;\", чтобы не блокировать скрипт \u002Fetc\u002Frc.local.\u003C\u002Fp\u003E\u003Ch2\u003EУтилита для компьютера\u003C\u002Fh2\u003E\u003Cfigure class=\"float full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F53e\u002Fdfe\u002F842\u002F53edfe8424c0b60b05537c575a69ed51.jpg\" alt=\"LJYNZ-105\" title=\"LJYNZ-105\" width=\"1199\" height=\"720\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F53e\u002Fdfe\u002F842\u002F53edfe8424c0b60b05537c575a69ed51.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003ELJYNZ-105\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EНастольных считывателей я в общей сложности купил два, один Chafon CF-RU5102, второй LJYNZ-105, так как на него появилась очень хорошая скидка. Оба считывателя имеют совершенно одинаковые интерфейсы, даже документация отличалась только первой страницей. Но внутренности оказались немного разные.\u003C\u002Fp\u003E\u003Cfigure class=\"float full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0ce\u002F54a\u002Fc49\u002F0ce54ac4916409ff5a600e23cb668bc0.JPG\" alt=\"CF-RU5102\" title=\"CF-RU5102\" width=\"4000\" height=\"3000\"\u002F\u003E\u003Cfigcaption\u003ECF-RU5102\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВ LJYNZ-105 были заботливо затёрты все наименования чипов, в CF-RU5102 затёрт только чип, отвечающий за управление. Для RF используется ADF7020, для USB Silabs CP2101. С точки зрения общей схемы считыватели крайне похожи, это USB&lt;-\u003EUart преобразователь, микроконтроллер, реализующий интерфейс общения, и RF контроллер. В LJYNZ-105 была обнаружена незначительная проблема, при включении и выключении бизера он продолжал очень тихо пищать. Прошу прощения за качество фотографии CF-RU5102, заметил это после того как уже отдал оборудование.\u003C\u002Fp\u003E\u003Cfigure class=\"float full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F374\u002Fc44\u002F265\u002F374c442658e92d9514fd068112739471.JPG\" alt=\"CF-RU5102 с Wiegand интерфейсом\" title=\"CF-RU5102 с Wiegand интерфейсом\" width=\"4000\" height=\"3000\"\u002F\u003E\u003Cfigcaption\u003ECF-RU5102 с Wiegand интерфейсом\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EЯ припаялся к DTR и RTS, тем самым получил возможность генерировать wiegand посылки из системы, куда подключён считыватель.\u003C\u002Fp\u003E\u003Cp\u003EК сожалению, библиотек для работы со считывателем для языка C я найти не смог, поэтому решил написать свою. Я её разместил тут: \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FBASM\u002FUHFreader\" rel=\"noopener noreferrer nofollow\"\u003Ehttps:\u002F\u002Fgithub.com\u002FBASM\u002FUHFreader\u003C\u002Fa\u003E:  библиотека и пример использования. Пример - это программа, которая решает две задачи: устанавливает пароли на метки (если метки поддерживают), что позволяет защитить метки от уничтожения, и позволяет внести код метки в СКУД, не вставая со стула. Ещё на метку в EPC записывается содержимое TID, использовалось в период тестирования, я решил не убирать эту функциональность.\u003C\u002Fp\u003E\u003Ch2\u003EКакие метки использовать\u003C\u002Fh2\u003E\u003Cfigure class=\"float \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"248\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F04e\u002Fb24\u002Fe1e\u002F04eb24e1e67becf5c9d54dc6b47aa5a0.png\" data-width=\"412\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EЯ накупил разных видов меток. Метки вида (2) работали крайне плохо, они имеют малый радиус и при чтении постоянно не совпадает CRC; лучше всего ловит (1), которые продаёт сам chafon. После того как был выявлен лидер, жителям по умолчанию выдавались метки вида (1). Было создано 3 тестовых комплекта, состоящих из всех видов, любой желающий мог взять его, протестировать и составить отчёт. Но к сожалению кроме меня этим никто не занялся. Так что по субъективным оценкам (3), (4) и (6) работают несколько хуже, чем (1), но лучше, чем (2). Метка (5) ко мне приехала в единственном экземпляре в качестве \"пробника\", я её наклеил на машину соседу и в целом дать оценку её работы не могу.\u003C\u002Fp\u003E\u003Cfigure class=\"float \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"67\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6cc\u002F1ce\u002F3c1\u002F6cc1ce3c1b3a58299600f2ffa7e38042.png\" data-width=\"254\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EЕсли зайти в магазин Decatlon, то можно заметить, что там используется UHF для отслеживания и пробивания товара на кассе. Метки фирмы NXP, но модель отсутствуют в базе gs1.org. В метках выставлен пароль на запись. Их TID успешно считывается и потенциально может использоваться для открытия шлагбаума если вы, например, выезжаете на велосипеде. Практических опытов не проводилось.\u003C\u002Fp\u003E\u003Ch2\u003EА можно обойтись без модификаций считывателя?\u003C\u002Fh2\u003E\u003Cp\u003EЯ пытался написать эту статью с минимумом теоретических рассуждений и воды, но всё же не смог удержаться. Я немного опишу, как можно было сделать систему без модификации считывателя, и расскажу о проблемах, которые могут возникнуть.   \u003C\u002Fp\u003E\u003Cp\u003EПомимо проводов питания необходимо будет тянуть провода для данных, будь то wiegand или UART. Либо можно заказать считыватели сразу с запаянным wifi модулем, проверить на практике такое решение у меня не было возможности.\u003C\u002Fp\u003E\u003Cp\u003EЕсли настроить считыватель на выдачу кодов по wiegand, мы ограничиваемся размером wiegand посылок 24 или 32 бита. TID состоит из 96 бит: сначала идёт информация по протоколу, модели метки и т.п., в конце - уникальный идентификатор. Размер этого идентификатора больше 32 бит. Сначала я возвращал последние 32 бита TID для меток (1) и это работало правильно, но после тестирования меток Monza R6 (2) выяснилось, что метки изменяют старшую часть идентификатора. Специально для них пришлось делать XOR последних двух 32 битных блоков TID, чтобы от метки к метке у нас не совпадали номера.\u003C\u002Fp\u003E\u003Cp\u003EДругой проблемой оказалась невозможность считывателя возвращать нужное смещение в TID, несмотря на явную возможность это задать в параметрах конфигурирования. При выдаче в wiegand всегда возвращалась начальная часть TID, которая совпадает для меток одинаковых моделей. Т.е. единственный вариант - это зачитывать EPC, а как известно, EPC является открытой для записи памятью, и любой желающий может записать туда любое значение, а значит легко сделать копию метки.\u003C\u002Fp\u003E\u003Cp\u003EЕщё она проблема, это таксисты. Почти у любого таксиста есть метка; когда он паркуется у КПП в ожидании клиента, считыватель начинает посылать массу сообщений о том, что метка найдена. СКУД конечно не знает этой метки и не открывает шлагбаум, но сообщает об этом в журнал. Считыватель может зачитывать по несколько меток в секунду, из-за чего журнал сильно замусоривается. Можно включить ограничение на скорость считывания, но тогда если в зоне чтения больше двух меток, ожидаемая метка может быть прочитана с большой задержкой. В своей прошивке я обошёл эту проблему созданием буфера прочитанных меток. Считыватель выдаёт метки с максимальной скоростью, если метки нет в буфере; её код выдаётся в wiegand и записывается в буфер. Если метка в буфере есть, ничего не происходит. Алгоритм, в свою очередь, следит, чтобы коды, попавшие в буфер, удалялись оттуда через 3 секунды. В результате скорость реакции на правильную метку оказывается максимально высокой, даже если вокруг находятся другие метки. \u003C\u002Fp\u003E\u003Ch2\u003EИспользование считывателя без СКУД\u003C\u002Fh2\u003E\u003Cp\u003EНа считывателях есть реле, его можно замыкать с помощью управляющего контроллера. Если это реле подключить к шлагбауму, можно открывать по какой-то логике. Наиболее простой вариант - это считывать TID, делать какое-либо преобразование и результат сверять с EPC. Это позволит организовать открывание шлагбаума только на основании специально созданных меток без использования СКУД. \u003C\u002Fp\u003E\u003Ch2\u003EЗаключение\u003C\u002Fh2\u003E\u003Cp\u003EЗапуск системы был сделан в апреле 2021, система работала успешно у 80-90% жителей. К августу работоспособность доведена до 100%. Последний тест покажет, будут ли проблемы в зимний период.  \u003C\u002Fp\u003E\u003Cp\u003EМы встретили метку с другого объекта, при попытке добавить эту метку в нашу систему оказалось, что пароль на метке не выставлен. Наше оборудование заботливо переписало EPC и установило пароль на метку, в результате чего на том объекте она работать перестала. Если метка наклеена на вашу машину, следует осознавать, что потенциально к ней имеет доступ любой человек, который может подойти на расстояние в 10 метров, а значит оставление метки без пароля является грубой ошибкой. Рано или поздно её кто-нибудь затрёт, будь то моя заботливая программа или школьник-радиолюбитель.\u003C\u002Fp\u003E\u003Cp\u003EВ российском интернет-магазине мне удалось найти в продаже метки с открытой на запись TID, цена таких меток около 800 рублей. Если требуется использовать действительно защищённую систему, следует рассмотреть метки с AES, например, NXP DNA. \u003C\u002Fp\u003E\u003Cp\u003EК сожалению, моя статься затрагивает в основном одного производителя, сравнить работоспособность разных считывателей не удалось из-за отсутствия времени и бюджета. Статей, подобных этой, крайне мало, так что я буду очень рад увидеть аналогичные статьи с опытом использования считывателей от других производителей.\u003C\u002Fp\u003E\u003Cp\u003EПервоначально я назвал статью \"Бюджетное решение\", но цена этого проекта перевалила за $1300, наверное, назвать это бюджетным будет не очень корректно. В целом если убрать из этой цены все мои ошибки, найти способы сэкономить на доставке (стоимость доставки соразмерна цене самого считывателя), то вполне реально выйти в бюджет $250-500.    \u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"esp8266"},{"titleHtml":"tasmota"},{"titleHtml":"uhf rfid epc class1 gen2"},{"titleHtml":"uhf"},{"titleHtml":"шлагбаумы"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff1a\u002Fb97\u002F41c\u002Ff1ab9741c500552776e94d11d1f58d6e.jpg","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff1a\u002Fb97\u002F41c\u002Ff1ab9741c500552776e94d11d1f58d6e.jpg","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F575048\\\u002F\"},\"headline\":\"UHF RFID: Бюджетное решение для шлагбаума, после тестирования\",\"datePublished\":\"2021-10-07T22:51:41+03:00\",\"dateModified\":\"2021-10-08T00:46:39+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"ffasm\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"В предыдущей статье я рассмотрел решение по созданию недорогого варианта для открывания шлагбаума. После нескольких месяцев тестирования в посёлке были выявлены...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F575048\\\u002F#post-content-body\",\"about\":[\"h_controllers\",\"h_DIY\",\"h_transport\",\"f_develop\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F575048\\\u002F82308fa13cfe167b88ec6ff412e34587\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F8e2\\\u002F585\\\u002F023\\\u002F8e258502356143f4a713dbc4bd6a4aea.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F1e8\\\u002Fd56\\\u002F1e3\\\u002F1e8d561e37d9d710158788b644434e8b.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F9b9\\\u002F622\\\u002F159\\\u002F9b96221595fd24739100ad0d982771ce.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F06b\\\u002F0b2\\\u002F309\\\u002F06b0b23094c57c2ba86a30de2ca1ca4b.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fcbe\\\u002Febf\\\u002Fe73\\\u002Fcbeebfe73574e8bb1d28e2381d2c4a4d.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fd0a\\\u002F11c\\\u002F691\\\u002Fd0a11c69155b9b0d09959a032ca5758a.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F937\\\u002F805\\\u002F3eb\\\u002F9378053eb7fd5b8e949bb69c4fd1a8e2.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F53e\\\u002Fdfe\\\u002F842\\\u002F53edfe8424c0b60b05537c575a69ed51.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F0ce\\\u002F54a\\\u002Fc49\\\u002F0ce54ac4916409ff5a600e23cb668bc0.JPG\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F374\\\u002Fc44\\\u002F265\\\u002F374c442658e92d9514fd068112739471.JPG\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F04e\\\u002Fb24\\\u002Fe1e\\\u002F04eb24e1e67becf5c9d54dc6b47aa5a0.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F6cc\\\u002F1ce\\\u002F3c1\\\u002F6cc1ce3c1b3a58299600f2ffa7e38042.png\"]}","metaDescription":"В предыдущей статье я рассмотрел решение по созданию недорогого варианта для открывания шлагбаума. После нескольких месяцев тестирования в посёлке были выявлены проблемы, исправлены ошибки. Статья...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"controllers,DIY,transport"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
