<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Создание собственных RequestBody и ResponseBody / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/582532\/"},"headline":"Создание собственных RequestBody и ResponseBody","datePublished":"2021-10-09T15:24:16+03:00","dateModified":"2021-10-09T16:25:28+03:00","author":{"@type":"Person","name":"Андрей Сулыз"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Для начала стоит оговориться, что данная статья носит сугубо информационный харакер. Я не думаю, что данное решение стоит применять в большинстве задач, так как...","url":"https:\/\/habr.com\/ru\/post\/582532\/#post-content-body","about":["h_java","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/582532\/1199db4331b9130e9107bf828d7b12d1\/"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Создание собственных RequestBody и ResponseBody" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Создание собственных RequestBody и ResponseBody" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Создание собственных RequestBody и ResponseBody" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Для начала стоит оговориться, что данная статья носит сугубо информационный харакер. Я не думаю, что данное решение стоит применять в большинстве задач, так как есть более простые варианты. Конкретно..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Для начала стоит оговориться, что данная статья носит сугубо информационный харакер. Я не думаю, что данное решение стоит применять в большинстве задач, так как есть более простые варианты. Конкретно..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Для начала стоит оговориться, что данная статья носит сугубо информационный харакер. Я не думаю, что данное решение стоит применять в большинстве задач, так как есть более простые варианты. Конкретно..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Для начала стоит оговориться, что данная статья носит сугубо информационный харакер. Я не думаю, что данное решение стоит применять в большинстве задач, так как есть более простые варианты. Конкретно..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Для начала стоит оговориться, что данная статья носит сугубо информационный харакер. Я не думаю, что данное решение стоит применять в большинстве задач, так как есть более простые варианты. Конкретно..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/582532/1199db4331b9130e9107bf828d7b12d1/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/582532/1199db4331b9130e9107bf828d7b12d1/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/582532/1199db4331b9130e9107bf828d7b12d1/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/582532/1199db4331b9130e9107bf828d7b12d1/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/582532/1199db4331b9130e9107bf828d7b12d1/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="582532" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-09T12:24:16.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/582532/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/582532/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/582532/1199db4331b9130e9107bf828d7b12d1/" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/582532/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/andrew_slz/" title="andrew_slz" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/andrew_slz/" class="tm-user-info__username">
      andrew_slz
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-09T12:24:16.000Z" title="2021-10-09, 15:24">9  октября   в 15:24</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Создание собственных RequestBody и ResponseBody</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/java/" class="tm-article-snippet__hubs-item-link"><span>Java</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Из песочницы
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><p>Для начала стоит оговориться, что данная статья носит сугубо информационный харакер. Я не думаю, что данное решение стоит применять в большинстве задач, так как есть более простые варианты. Конкретно в моём случае, была задача, для которой создание собственных аннотаций и, соответственно, кастомного <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/http/converter/HttpMessageConverter.html" rel="noopener noreferrer nofollow"><em>HttpMessageConverter </em></a>для сериализации и десериализации body оказалось полезным.</p><p>Думаю, что многие из вас сталкивались с добавлением собственных <em>HttpMessageConverter</em> в своём проекте. Ну или хотя бы слышали за такую возможность. Однако, возникают ситуации, когда мы хотим не только добавить свой собственный конвертер, но и создать собственную аннотацию для явного обозначения того, что тело ответа или запроса будут обработаны нестандартными способами <em>Spring</em>. Более того, данные аннотации могут содержать дополнительную информацию, которая потребуется вашему конвертеру. </p><p>Как вы увидите дальше, поддержка аннотации для обработки ответа перекликается с поддержкой обработки запроса. Однако, в данной статье мне хотелось бы также продемонстрировать возможность добавление поддержки нового параметра метода контроллера в ситуации, когда из одного тела запроса требуется тянуть два разных объекта.</p><h2>@CustomResponseBody</h2><p>Итак, начнем с простого. Создадим аннотацию <em>@CustomResponseBody</em></p><pre><code class="java">@Target({ElementType.TYPE, ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
public @interface CustomResponseBody { }</code></pre><p>Далее сделаем простой <em>HttpMessageConverter</em>, первоначально создав для него интерфейс (он нам понадобится в дальнейшем). Создадим интерфейс <em>CustomMessageConverter</em>, который будет являться наследником <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/http/converter/GenericHttpMessageConverter.html" rel="noopener noreferrer nofollow"><em>GenericHttpMessageConverter</em></a>.</p><pre><code class="java">public interface CustomMessageConverter 
  extends GenericHttpMessageConverter&lt;Object> { }</code></pre><p>В качестве реалиазации самого конвертера можно создать наследника любого нужного вам класса или интерфейса, например, <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/http/converter/AbstractGenericHttpMessageConverter.html" rel="noopener noreferrer nofollow"><em>AbstractGenericHttpMessageConverter</em></a>. Если ваш конвертер будет работать по схожей схеме, что и обычный <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/http/converter/json/MappingJackson2HttpMessageConverter.html" rel="noopener noreferrer nofollow"><em>MappingJackson2HttpMessageConverter</em></a>, то можно создать наследника именно от него, переопределив метод <em>writeInternal</em>.</p><pre><code class="java">public class MappingCustomJackson2HttpMessageConverter 
  extends MappingJackson2HttpMessageConverter implements CustomMessageConverter {

    @Override
    protected void writeInternal(Object o, HttpOutputMessage outputMessage) 
      throws IOException, HttpMessageNotWritableException {
        
      	super.writeInternal(o, outputMessage);
    }
}</code></pre><p>Дальше требуется создать наследника класса <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/mvc/method/annotation/AbstractMessageConverterMethodProcessor.html" rel="noopener noreferrer nofollow"><em>AbstractMessageConverterMethodProcessor</em></a>, в котором и будут идентифицироваться наши кастомные аннотации, и переобпределить его абстрактные методы. Рассмотрим пока только <em>supportsReturnType</em> и <em>handleReturnValue</em>. Ведь именно они потребуются для обработки ответа.</p><pre><code class="java">public class CustomRequestResponseBodyMethodProcessor 
  extends AbstractMessageConverterMethodProcessor {

    private final CustomMessageConverter converter;

    protected CustomRequestResponseBodyMethodProcessor(
      CustomMessageConverter converter) {
      
        super(List.of(converter));
        this.converter = converter;
    }

    @Override
    public boolean supportsReturnType(MethodParameter returnType) {
        return returnType.hasMethodAnnotation(CustomResponseBody.class);
    }

    @Override
    public void handleReturnValue(Object returnValue, MethodParameter returnType,
                                  ModelAndViewContainer mavContainer, 
                                  NativeWebRequest webRequest) throws Exception {
        // some code…
    }
}</code></pre><p>В приведенном примере я опустил реализацию <em>handleReturnValue</em>, оставляя её на ваше усмотрение. Реализацию данного метода можно взять из класса <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/mvc/method/annotation/RequestResponseBodyMethodProcessor.html" rel="noopener noreferrer nofollow"><em>RequestResponseBodyMethodProcessor</em></a>, который как раз и отвечает за обработку стандартной аннотации @<em>ResponseBody.</em></p><pre><code class="java">@Override
public void handleReturnValue(@Nullable Object returnValue, 
                              MethodParameter returnType,
      												ModelAndViewContainer mavContainer, 
                              NativeWebRequest webRequest)
      throws IOException, HttpMediaTypeNotAcceptableException, 
HttpMessageNotWritableException {

   mavContainer.setRequestHandled(true);
   ServletServerHttpRequest inputMessage = createInputMessage(webRequest);
   ServletServerHttpResponse outputMessage = createOutputMessage(webRequest);

   // Try even with null return value. ResponseBodyAdvice could get involved.
   writeWithMessageConverters(returnValue, returnType, 
                              inputMessage, outputMessage);
}</code></pre><p>На последней строчке тут вызывается метод определяющий конвертер для обработки ответа. Однако, полагаю, что в случае, когда вы создаете собственную аннотацию этот метод вам не пригодится и его можно смело опустить, передав параметры напрямую на вход вашему конвертеру, вызвав переопределенный метод <em>write</em>, который сделегирует вызов переопределенному методу <em>writeInternal</em>. Стоит отметить, что из данного метода можно скопипастить немного кода, который поможет вам определить параметры для метода <em>write</em>.</p><p>Последним же шагом в данном пункте рассмотрим регистрацию <em>CustomRequestResponseBodyMethodProcessor</em>, предварительно в другой конфигурации создав его бин. </p><pre><code class="java">@Configuration
public class CustomHandlerMethodConfiguration {

    private final RequestMappingHandlerAdapter requestMappingHandlerAdapter;
    private final CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor;

    public CustomHandlerMethodConfiguration(RequestMappingHandlerAdapter requestMappingHandlerAdapter, 
                                            CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor) {
        
        this.requestMappingHandlerAdapter = requestMappingHandlerAdapter;
        this.customRequestResponseBodyMethodProcessor = customRequestResponseBodyMethodProcessor;
    }

    @PostConstruct
    public void init() {
        setReturnValueHttpHandler();
    }

    private void setReturnValueHttpHandler() {
        List&lt;HandlerMethodReturnValueHandler> updatedValues = new ArrayList&lt;>();

        updatedValues.add(0, customRequestResponseBodyMethodProcessor);
        updatedValues.addAll(requestMappingHandlerAdapter.getReturnValueHandlers());

        requestMappingHandlerAdapter.setReturnValueHandlers(updatedValues);
    }

}</code></pre><p>Как видно из примера, регистрация <em>CustomRequestResponseBodyMethodProcessor</em> происходит путем создания нового списка хендлеров для обработки возвращаемого значения из методов контроллеров и подкладывание его в <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/mvc/method/annotation/RequestMappingHandlerAdapter.html" rel="noopener noreferrer nofollow"><em>RequestMappingHandlerAdapter</em></a>.</p><p>После этого, можно смело устанавливать над вашим методом контроллера аннотацию @<em>CustomResponseBody</em> и реализовывать нужную обработку возвращаемого значения в методе writeInternal класса <em>MappingCustomJackson2HttpMessageConverter</em>.</p><h2>@CustomRequestBody/@CustomArg</h2><p>В данном пункте, как я и писал раньше, мы разберем возможность переопределения <em>@RequestBody</em>, но с условием, что нам надо из JSON тянуть два объекта и раскидывать их в два разных параметра метода контроллера. Примерно такого вида:</p><pre><code class="java">@PostMapping
public ResponseEntity&lt;?> addEntityWithSmthInfo(@CustomRequestBody Entity firstEntity,
                                                    @CustomArg SmthInfo smthInfo) {
    // some code...
}</code></pre><p>Можно, конечно, сделать поддержку добавления второй сущности из тела запроса и без дополнительной аннотации, но, на мой взгляд, её наличие только улучшит читабельность вашего кода, продемонстрировав присутствие кастомной логики. Вопрос необходимости такой реализации обуславливается тем, что, возможно, вы захотите сохранять вашу сущность с дополнительным объектом, который получаете из тела запроса, в одной транзакции.</p><p>Итак, для переопределения <em>@RequestBody</em> нам надо вернуться к классам <em>CustomRequestResponseBodyMethodProcessor</em> и <em>MappingCustomJackson2HttpMessageConverter</em>. В первом случае требуется реализовать два метода <em>supportsParameter</em> и <em>resolveArgument</em>.</p><pre><code class="java">@Override
public boolean supportsParameter(MethodParameter parameter) {
    return parameter.hasParameterAnnotation(CustomRequestBody.class);
}

@Override
public Object resolveArgument(MethodParameter parameter, 
                              ModelAndViewContainer mavContainer, 
                              NativeWebRequest webRequest, 
                              WebDataBinderFactory binderFactory) 
  throws Exception {
// some code….
}</code></pre><p>Прежде чем приступать к доработкам в <em>MappingCustomJackson2HttpMessageConverter</em> добавим в интерфейс <em>CustomMessageConverter</em> метод, который будет вызываться для десериализации тела запроса и как раз применяться в вышеприведенном методе <em>resolveArgument</em>.</p><pre><code class="java">// CustomMessageConverter.java
public interface CustomMessageConverter 
  extends GenericHttpMessageConverter&lt;Object> {

    EntityWithSmth readWithSmthInfo(Class&lt;?> clazz, 
                                    HttpInputMessage inputMessage) 
      throws Exception;
}

// EntityWithSmth.java
public class EntityWithSmth {
    FirstEntity entity;
    SmthInfo info;
}</code></pre><p>Дальше переопределим данный метод в <em>MappingCustomJackson2HttpMessageConverter</em>  и реализуем обработку тела запроса. Там же код за основу можно вытянуть из родительских классов. Например, метод <em>readJavaType</em> из <em>AbstractJackson2HttpMessageConverter</em>. Тут все просто, при десериализации JSON вытягиваем из узлов дерева нужную нам структуру и перегоняем её в нужные объекты. Далее создаем объект <em>EntityWithSmth</em> и возвращаем. </p><p>Однако, далее нужно сделать обработку объекта нашего класса <em>EntityWithSmth</em>, который будет возвращаться из метода <em>resolveArgument</em>. Для этого необходимо создать наследника класса <em>ServletInvocableHandlerMethod</em>, в котором, по сути, как и в остальных классах будет копипаста кода из родителя / родителей с небольшими доработками. В нашем же случае требуется переопределить метод <em>getMethodArgumentValues</em> и при проверке параметров метода на основании аннотации определять кем обрабатывать тело нашего запроса. Так как реализация данного метода не маленькая, я оставлю её в <a href="https://github.com/AndrewIISM/custom-request-response-body-spring" rel="noopener noreferrer nofollow">репозитории на гитхабе</a>, который был подготовлен для данного материала.</p><p> После этого нам необходимо зарегистрировать наш новый класс. Сделать это можно переопределив метод <em>createInvocableHandlerMethod</em> в дочернем классе <em>RequestMappingHandlerAdapter</em>. </p><pre><code class="java">public class CustomRequestMappingHandlerAdapter 
  extends RequestMappingHandlerAdapter {
    private final CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor;

    public CustomRequestMappingHandlerAdapter(CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor) {
        this.customRequestResponseBodyMethodProcessor = customRequestResponseBodyMethodProcessor;
    }

    @Override
    protected ServletInvocableHandlerMethod createInvocableHandlerMethod(HandlerMethod handlerMethod) {
        return new CustomServletInvocableHandlerMethod(handlerMethod, 
                                                       customRequestResponseBodyMethodProcessor);
    }
}</code></pre><p>И в классе конфигурации реализовать интерфейс <em>WebMvcRegistrations</em>, где переопределить дефолтный метод <em>getRequestMappingHandlerAdapter</em>.</p><pre><code class="java">@Configuration
public class CustomWebMvcRegistrationsConfiguration 
  implements WebMvcRegistrations {
    private final CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor;

    public CustomWebMvcRegistrationsConfiguration(CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor) {
        this.customRequestResponseBodyMethodProcessor = customRequestResponseBodyMethodProcessor;
    }
    
    @Override
    public RequestMappingHandlerAdapter getRequestMappingHandlerAdapter() {
        return new CustomRequestMappingHandlerAdapter(customRequestResponseBodyMethodProcessor);
    }
}</code></pre><h2>Заключение</h2><p>В заключении, хочу ещё раз отметить, что данная статья является более информационной и, можно сказать, справочной, а не призывом к действию. Но, если вдруг вам захочется “обогощать” ваш ответ какими-то дополнительными данными для сущности и уметь обрабатывать такие запросы, то данная статья станет вам сопрводительным материалом.</p><p>Что же касается моей задачи, мы на проекте, используя данный подход, добавляли информацию о правах сущности, работая со <a href="https://docs.spring.io/spring-security/site/docs/3.0.x/reference/domain-acls.html" rel="noopener noreferrer nofollow">Spring Security ACL</a>, где права хранятся в отдельных таблицах. И такой подход позволил нам неявно отдавать информацию о правах не создавая кучу DTO для каждой из защищаемых сущностей.<br/><br/><a href="https://github.com/AndrewIISM/custom-request-response-body-spring" rel="noopener noreferrer nofollow"><strong>Продублирую ссылку на репозиторий с простой реализацией данного материала</strong></a></p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bjava%5D" class="tm-tags-list__link">java</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bspring%20framework%5D" class="tm-tags-list__link">spring framework</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bspring%20mvc%5D" class="tm-tags-list__link">spring mvc</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/java/" class="tm-hubs-list__link">
    Java
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 1: ↑1 и ↓0</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 1: ↑1 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+1</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">2.1K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    21
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/andrew_slz/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 2 голоса " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    2
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">1</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Андрей Сулыз</span> <a href="/ru/users/andrew_slz/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @andrew_slz
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Java Developer</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/582532/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментировать 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/582532/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/582532/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"582532":{"id":"582532","timePublished":"2021-10-09T12:24:16+00:00","isCorporative":false,"lang":"ru","titleHtml":"Создание собственных RequestBody и ResponseBody","leadData":{"textHtml":"\u003Cp\u003EДумаю, что многие из вас сталкивались с добавлением собственных \u003Cem\u003EHttpMessageConverter\u003C\u002Fem\u003E в своём проекте. Ну или хотя бы слышали за такую возможность. Однако, возникают ситуации, когда мы хотим не только добавить свой собственный конвертер, но и создать собственную аннотацию для явного обозначения того, что тело ответа или запроса будут обработаны нестандартными способами \u003Cem\u003ESpring\u003C\u002Fem\u003E. Более того, данные аннотации могут содержать дополнительную информацию, которая потребуется вашему конвертеру. \u003C\u002Fp\u003E\u003Cp\u003EКак вы увидите дальше, поддержка аннотации для обработки ответа перекликается с поддержкой обработки запроса. Однако, в данной статье мне хотелось бы также продемонстрировать возможность добавление поддержки нового параметра метода контроллера в ситуации, когда из одного тела запроса требуется тянуть два разных объекта.\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"sandbox","data":null}],"author":{"scoreStats":{"score":2,"votesCount":2},"rating":1,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"1440424","alias":"andrew_slz","fullname":"Андрей Сулыз","avatarUrl":null,"speciality":"Java Developer"},"statistics":{"commentsCount":0,"favoritesCount":21,"readingCount":2139,"score":1,"votesCount":1},"hubs":[{"relatedData":null,"id":"375","alias":"java","type":"collective","title":"Java","titleHtml":"Java","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EДля начала стоит оговориться, что данная статья носит сугубо информационный харакер. Я не думаю, что данное решение стоит применять в большинстве задач, так как есть более простые варианты. Конкретно в моём случае, была задача, для которой создание собственных аннотаций и, соответственно, кастомного \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-framework\u002Fdocs\u002Fcurrent\u002Fjavadoc-api\u002Forg\u002Fspringframework\u002Fhttp\u002Fconverter\u002FHttpMessageConverter.html\" rel=\"noopener noreferrer nofollow\"\u003E\u003Cem\u003EHttpMessageConverter \u003C\u002Fem\u003E\u003C\u002Fa\u003Eдля сериализации и десериализации body оказалось полезным.\u003C\u002Fp\u003E\u003Cp\u003EДумаю, что многие из вас сталкивались с добавлением собственных \u003Cem\u003EHttpMessageConverter\u003C\u002Fem\u003E в своём проекте. Ну или хотя бы слышали за такую возможность. Однако, возникают ситуации, когда мы хотим не только добавить свой собственный конвертер, но и создать собственную аннотацию для явного обозначения того, что тело ответа или запроса будут обработаны нестандартными способами \u003Cem\u003ESpring\u003C\u002Fem\u003E. Более того, данные аннотации могут содержать дополнительную информацию, которая потребуется вашему конвертеру. \u003C\u002Fp\u003E\u003Cp\u003EКак вы увидите дальше, поддержка аннотации для обработки ответа перекликается с поддержкой обработки запроса. Однако, в данной статье мне хотелось бы также продемонстрировать возможность добавление поддержки нового параметра метода контроллера в ситуации, когда из одного тела запроса требуется тянуть два разных объекта.\u003C\u002Fp\u003E\u003Ch2\u003E@CustomResponseBody\u003C\u002Fh2\u003E\u003Cp\u003EИтак, начнем с простого. Создадим аннотацию \u003Cem\u003E@CustomResponseBody\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"java\"\u003E@Target({ElementType.TYPE, ElementType.METHOD})\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface CustomResponseBody { }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДалее сделаем простой \u003Cem\u003EHttpMessageConverter\u003C\u002Fem\u003E, первоначально создав для него интерфейс (он нам понадобится в дальнейшем). Создадим интерфейс \u003Cem\u003ECustomMessageConverter\u003C\u002Fem\u003E, который будет являться наследником \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-framework\u002Fdocs\u002Fcurrent\u002Fjavadoc-api\u002Forg\u002Fspringframework\u002Fhttp\u002Fconverter\u002FGenericHttpMessageConverter.html\" rel=\"noopener noreferrer nofollow\"\u003E\u003Cem\u003EGenericHttpMessageConverter\u003C\u002Fem\u003E\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"java\"\u003Epublic interface CustomMessageConverter \n  extends GenericHttpMessageConverter&lt;Object\u003E { }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ качестве реалиазации самого конвертера можно создать наследника любого нужного вам класса или интерфейса, например, \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-framework\u002Fdocs\u002Fcurrent\u002Fjavadoc-api\u002Forg\u002Fspringframework\u002Fhttp\u002Fconverter\u002FAbstractGenericHttpMessageConverter.html\" rel=\"noopener noreferrer nofollow\"\u003E\u003Cem\u003EAbstractGenericHttpMessageConverter\u003C\u002Fem\u003E\u003C\u002Fa\u003E. Если ваш конвертер будет работать по схожей схеме, что и обычный \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-framework\u002Fdocs\u002Fcurrent\u002Fjavadoc-api\u002Forg\u002Fspringframework\u002Fhttp\u002Fconverter\u002Fjson\u002FMappingJackson2HttpMessageConverter.html\" rel=\"noopener noreferrer nofollow\"\u003E\u003Cem\u003EMappingJackson2HttpMessageConverter\u003C\u002Fem\u003E\u003C\u002Fa\u003E, то можно создать наследника именно от него, переопределив метод \u003Cem\u003EwriteInternal\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"java\"\u003Epublic class MappingCustomJackson2HttpMessageConverter \n  extends MappingJackson2HttpMessageConverter implements CustomMessageConverter {\n\n    @Override\n    protected void writeInternal(Object o, HttpOutputMessage outputMessage) \n      throws IOException, HttpMessageNotWritableException {\n        \n      \tsuper.writeInternal(o, outputMessage);\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДальше требуется создать наследника класса \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-framework\u002Fdocs\u002Fcurrent\u002Fjavadoc-api\u002Forg\u002Fspringframework\u002Fweb\u002Fservlet\u002Fmvc\u002Fmethod\u002Fannotation\u002FAbstractMessageConverterMethodProcessor.html\" rel=\"noopener noreferrer nofollow\"\u003E\u003Cem\u003EAbstractMessageConverterMethodProcessor\u003C\u002Fem\u003E\u003C\u002Fa\u003E, в котором и будут идентифицироваться наши кастомные аннотации, и переобпределить его абстрактные методы. Рассмотрим пока только \u003Cem\u003EsupportsReturnType\u003C\u002Fem\u003E и \u003Cem\u003EhandleReturnValue\u003C\u002Fem\u003E. Ведь именно они потребуются для обработки ответа.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"java\"\u003Epublic class CustomRequestResponseBodyMethodProcessor \n  extends AbstractMessageConverterMethodProcessor {\n\n    private final CustomMessageConverter converter;\n\n    protected CustomRequestResponseBodyMethodProcessor(\n      CustomMessageConverter converter) {\n      \n        super(List.of(converter));\n        this.converter = converter;\n    }\n\n    @Override\n    public boolean supportsReturnType(MethodParameter returnType) {\n        return returnType.hasMethodAnnotation(CustomResponseBody.class);\n    }\n\n    @Override\n    public void handleReturnValue(Object returnValue, MethodParameter returnType,\n                                  ModelAndViewContainer mavContainer, \n                                  NativeWebRequest webRequest) throws Exception {\n        \u002F\u002F some code…\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ приведенном примере я опустил реализацию \u003Cem\u003EhandleReturnValue\u003C\u002Fem\u003E, оставляя её на ваше усмотрение. Реализацию данного метода можно взять из класса \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-framework\u002Fdocs\u002Fcurrent\u002Fjavadoc-api\u002Forg\u002Fspringframework\u002Fweb\u002Fservlet\u002Fmvc\u002Fmethod\u002Fannotation\u002FRequestResponseBodyMethodProcessor.html\" rel=\"noopener noreferrer nofollow\"\u003E\u003Cem\u003ERequestResponseBodyMethodProcessor\u003C\u002Fem\u003E\u003C\u002Fa\u003E, который как раз и отвечает за обработку стандартной аннотации @\u003Cem\u003EResponseBody.\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"java\"\u003E@Override\npublic void handleReturnValue(@Nullable Object returnValue, \n                              MethodParameter returnType,\n      \t\t\t\t\t\t\t\t\t\t\t\tModelAndViewContainer mavContainer, \n                              NativeWebRequest webRequest)\n      throws IOException, HttpMediaTypeNotAcceptableException, \nHttpMessageNotWritableException {\n\n   mavContainer.setRequestHandled(true);\n   ServletServerHttpRequest inputMessage = createInputMessage(webRequest);\n   ServletServerHttpResponse outputMessage = createOutputMessage(webRequest);\n\n   \u002F\u002F Try even with null return value. ResponseBodyAdvice could get involved.\n   writeWithMessageConverters(returnValue, returnType, \n                              inputMessage, outputMessage);\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EНа последней строчке тут вызывается метод определяющий конвертер для обработки ответа. Однако, полагаю, что в случае, когда вы создаете собственную аннотацию этот метод вам не пригодится и его можно смело опустить, передав параметры напрямую на вход вашему конвертеру, вызвав переопределенный метод \u003Cem\u003Ewrite\u003C\u002Fem\u003E, который сделегирует вызов переопределенному методу \u003Cem\u003EwriteInternal\u003C\u002Fem\u003E. Стоит отметить, что из данного метода можно скопипастить немного кода, который поможет вам определить параметры для метода \u003Cem\u003Ewrite\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\u003Cp\u003EПоследним же шагом в данном пункте рассмотрим регистрацию \u003Cem\u003ECustomRequestResponseBodyMethodProcessor\u003C\u002Fem\u003E, предварительно в другой конфигурации создав его бин. \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"java\"\u003E@Configuration\npublic class CustomHandlerMethodConfiguration {\n\n    private final RequestMappingHandlerAdapter requestMappingHandlerAdapter;\n    private final CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor;\n\n    public CustomHandlerMethodConfiguration(RequestMappingHandlerAdapter requestMappingHandlerAdapter, \n                                            CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor) {\n        \n        this.requestMappingHandlerAdapter = requestMappingHandlerAdapter;\n        this.customRequestResponseBodyMethodProcessor = customRequestResponseBodyMethodProcessor;\n    }\n\n    @PostConstruct\n    public void init() {\n        setReturnValueHttpHandler();\n    }\n\n    private void setReturnValueHttpHandler() {\n        List&lt;HandlerMethodReturnValueHandler\u003E updatedValues = new ArrayList&lt;\u003E();\n\n        updatedValues.add(0, customRequestResponseBodyMethodProcessor);\n        updatedValues.addAll(requestMappingHandlerAdapter.getReturnValueHandlers());\n\n        requestMappingHandlerAdapter.setReturnValueHandlers(updatedValues);\n    }\n\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКак видно из примера, регистрация \u003Cem\u003ECustomRequestResponseBodyMethodProcessor\u003C\u002Fem\u003E происходит путем создания нового списка хендлеров для обработки возвращаемого значения из методов контроллеров и подкладывание его в \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-framework\u002Fdocs\u002Fcurrent\u002Fjavadoc-api\u002Forg\u002Fspringframework\u002Fweb\u002Fservlet\u002Fmvc\u002Fmethod\u002Fannotation\u002FRequestMappingHandlerAdapter.html\" rel=\"noopener noreferrer nofollow\"\u003E\u003Cem\u003ERequestMappingHandlerAdapter\u003C\u002Fem\u003E\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EПосле этого, можно смело устанавливать над вашим методом контроллера аннотацию @\u003Cem\u003ECustomResponseBody\u003C\u002Fem\u003E и реализовывать нужную обработку возвращаемого значения в методе writeInternal класса \u003Cem\u003EMappingCustomJackson2HttpMessageConverter\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\u003Ch2\u003E@CustomRequestBody\u002F@CustomArg\u003C\u002Fh2\u003E\u003Cp\u003EВ данном пункте, как я и писал раньше, мы разберем возможность переопределения \u003Cem\u003E@RequestBody\u003C\u002Fem\u003E, но с условием, что нам надо из JSON тянуть два объекта и раскидывать их в два разных параметра метода контроллера. Примерно такого вида:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"java\"\u003E@PostMapping\npublic ResponseEntity&lt;?\u003E addEntityWithSmthInfo(@CustomRequestBody Entity firstEntity,\n                                                    @CustomArg SmthInfo smthInfo) {\n    \u002F\u002F some code...\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EМожно, конечно, сделать поддержку добавления второй сущности из тела запроса и без дополнительной аннотации, но, на мой взгляд, её наличие только улучшит читабельность вашего кода, продемонстрировав присутствие кастомной логики. Вопрос необходимости такой реализации обуславливается тем, что, возможно, вы захотите сохранять вашу сущность с дополнительным объектом, который получаете из тела запроса, в одной транзакции.\u003C\u002Fp\u003E\u003Cp\u003EИтак, для переопределения \u003Cem\u003E@RequestBody\u003C\u002Fem\u003E нам надо вернуться к классам \u003Cem\u003ECustomRequestResponseBodyMethodProcessor\u003C\u002Fem\u003E и \u003Cem\u003EMappingCustomJackson2HttpMessageConverter\u003C\u002Fem\u003E. В первом случае требуется реализовать два метода \u003Cem\u003EsupportsParameter\u003C\u002Fem\u003E и \u003Cem\u003EresolveArgument\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"java\"\u003E@Override\npublic boolean supportsParameter(MethodParameter parameter) {\n    return parameter.hasParameterAnnotation(CustomRequestBody.class);\n}\n\n@Override\npublic Object resolveArgument(MethodParameter parameter, \n                              ModelAndViewContainer mavContainer, \n                              NativeWebRequest webRequest, \n                              WebDataBinderFactory binderFactory) \n  throws Exception {\n\u002F\u002F some code….\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПрежде чем приступать к доработкам в \u003Cem\u003EMappingCustomJackson2HttpMessageConverter\u003C\u002Fem\u003E добавим в интерфейс \u003Cem\u003ECustomMessageConverter\u003C\u002Fem\u003E метод, который будет вызываться для десериализации тела запроса и как раз применяться в вышеприведенном методе \u003Cem\u003EresolveArgument\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"java\"\u003E\u002F\u002F CustomMessageConverter.java\npublic interface CustomMessageConverter \n  extends GenericHttpMessageConverter&lt;Object\u003E {\n\n    EntityWithSmth readWithSmthInfo(Class&lt;?\u003E clazz, \n                                    HttpInputMessage inputMessage) \n      throws Exception;\n}\n\n\u002F\u002F EntityWithSmth.java\npublic class EntityWithSmth {\n    FirstEntity entity;\n    SmthInfo info;\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДальше переопределим данный метод в \u003Cem\u003EMappingCustomJackson2HttpMessageConverter\u003C\u002Fem\u003E  и реализуем обработку тела запроса. Там же код за основу можно вытянуть из родительских классов. Например, метод \u003Cem\u003EreadJavaType\u003C\u002Fem\u003E из \u003Cem\u003EAbstractJackson2HttpMessageConverter\u003C\u002Fem\u003E. Тут все просто, при десериализации JSON вытягиваем из узлов дерева нужную нам структуру и перегоняем её в нужные объекты. Далее создаем объект \u003Cem\u003EEntityWithSmth\u003C\u002Fem\u003E и возвращаем. \u003C\u002Fp\u003E\u003Cp\u003EОднако, далее нужно сделать обработку объекта нашего класса \u003Cem\u003EEntityWithSmth\u003C\u002Fem\u003E, который будет возвращаться из метода \u003Cem\u003EresolveArgument\u003C\u002Fem\u003E. Для этого необходимо создать наследника класса \u003Cem\u003EServletInvocableHandlerMethod\u003C\u002Fem\u003E, в котором, по сути, как и в остальных классах будет копипаста кода из родителя \u002F родителей с небольшими доработками. В нашем же случае требуется переопределить метод \u003Cem\u003EgetMethodArgumentValues\u003C\u002Fem\u003E и при проверке параметров метода на основании аннотации определять кем обрабатывать тело нашего запроса. Так как реализация данного метода не маленькая, я оставлю её в \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAndrewIISM\u002Fcustom-request-response-body-spring\" rel=\"noopener noreferrer nofollow\"\u003Eрепозитории на гитхабе\u003C\u002Fa\u003E, который был подготовлен для данного материала.\u003C\u002Fp\u003E\u003Cp\u003E После этого нам необходимо зарегистрировать наш новый класс. Сделать это можно переопределив метод \u003Cem\u003EcreateInvocableHandlerMethod\u003C\u002Fem\u003E в дочернем классе \u003Cem\u003ERequestMappingHandlerAdapter\u003C\u002Fem\u003E. \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"java\"\u003Epublic class CustomRequestMappingHandlerAdapter \n  extends RequestMappingHandlerAdapter {\n    private final CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor;\n\n    public CustomRequestMappingHandlerAdapter(CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor) {\n        this.customRequestResponseBodyMethodProcessor = customRequestResponseBodyMethodProcessor;\n    }\n\n    @Override\n    protected ServletInvocableHandlerMethod createInvocableHandlerMethod(HandlerMethod handlerMethod) {\n        return new CustomServletInvocableHandlerMethod(handlerMethod, \n                                                       customRequestResponseBodyMethodProcessor);\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EИ в классе конфигурации реализовать интерфейс \u003Cem\u003EWebMvcRegistrations\u003C\u002Fem\u003E, где переопределить дефолтный метод \u003Cem\u003EgetRequestMappingHandlerAdapter\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"java\"\u003E@Configuration\npublic class CustomWebMvcRegistrationsConfiguration \n  implements WebMvcRegistrations {\n    private final CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor;\n\n    public CustomWebMvcRegistrationsConfiguration(CustomRequestResponseBodyMethodProcessor customRequestResponseBodyMethodProcessor) {\n        this.customRequestResponseBodyMethodProcessor = customRequestResponseBodyMethodProcessor;\n    }\n    \n    @Override\n    public RequestMappingHandlerAdapter getRequestMappingHandlerAdapter() {\n        return new CustomRequestMappingHandlerAdapter(customRequestResponseBodyMethodProcessor);\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2\u003EЗаключение\u003C\u002Fh2\u003E\u003Cp\u003EВ заключении, хочу ещё раз отметить, что данная статья является более информационной и, можно сказать, справочной, а не призывом к действию. Но, если вдруг вам захочется “обогощать” ваш ответ какими-то дополнительными данными для сущности и уметь обрабатывать такие запросы, то данная статья станет вам сопрводительным материалом.\u003C\u002Fp\u003E\u003Cp\u003EЧто же касается моей задачи, мы на проекте, используя данный подход, добавляли информацию о правах сущности, работая со \u003Ca href=\"https:\u002F\u002Fdocs.spring.io\u002Fspring-security\u002Fsite\u002Fdocs\u002F3.0.x\u002Freference\u002Fdomain-acls.html\" rel=\"noopener noreferrer nofollow\"\u003ESpring Security ACL\u003C\u002Fa\u003E, где права хранятся в отдельных таблицах. И такой подход позволил нам неявно отдавать информацию о правах не создавая кучу DTO для каждой из защищаемых сущностей.\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAndrewIISM\u002Fcustom-request-response-body-spring\" rel=\"noopener noreferrer nofollow\"\u003E\u003Cstrong\u003EПродублирую ссылку на репозиторий с простой реализацией данного материала\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"java"},{"titleHtml":"spring framework"},{"titleHtml":"spring mvc"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F582532\u002F1199db4331b9130e9107bf828d7b12d1\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F582532\u002F1199db4331b9130e9107bf828d7b12d1\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F582532\\\u002F\"},\"headline\":\"Создание собственных RequestBody и ResponseBody\",\"datePublished\":\"2021-10-09T15:24:16+03:00\",\"dateModified\":\"2021-10-09T16:25:28+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Андрей Сулыз\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Для начала стоит оговориться, что данная статья носит сугубо информационный харакер. Я не думаю, что данное решение стоит применять в большинстве задач, так как...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F582532\\\u002F#post-content-body\",\"about\":[\"h_java\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F582532\\\u002F1199db4331b9130e9107bf828d7b12d1\\\u002F\"]}","metaDescription":"Для начала стоит оговориться, что данная статья носит сугубо информационный харакер. Я не думаю, что данное решение стоит применять в большинстве задач, так как есть более простые варианты. Конкретно...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"java"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
