<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Идеальный код: битва при Sonar / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/company\/parallels\/blog\/584998\/"},"headline":"Идеальный код: битва при Sonar","datePublished":"2021-10-22T15:03:57+03:00","dateModified":"2021-10-25T11:20:22+03:00","author":{"@type":"Person","name":"andrey_danin"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Идеальный код &ndash; это код, которого нет, а функция его выполняется. Понятно, что в реальной жизни ни идеальных технических систем, ни идеального программного кода...","url":"https:\/\/habr.com\/ru\/company\/parallels\/blog\/584998\/#post-content-body","about":["c_parallels","h_it_testing","h_web_testing","h_mobile_testing","h_read","f_develop","f_management"],"image":["https:\/\/habr.com\/share\/publication\/584998\/c85d8d22157f4d2d15825c0b03346305\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/221\/c4e\/1d8\/221c4e1d87d0de9a116b91da64292d77.jpg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/6d4\/3e6\/536\/6d43e6536ece76820217255e8b5b878b.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Идеальный код: битва при Sonar" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Идеальный код: битва при Sonar" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Идеальный код: битва при Sonar" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Идеальный код – это код, которого нет, а функция его выполняется. Понятно, что в реальной жизни ни идеальных технических систем, ни идеального программного кода не существует. Но так порой хочется,..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Идеальный код – это код, которого нет, а функция его выполняется. Понятно, что в реальной жизни ни идеальных технических систем, ни идеального программного кода не существует. Но так порой хочется,..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Идеальный код – это код, которого нет, а функция его выполняется. Понятно, что в реальной жизни ни идеальных технических систем, ни идеального программного кода не существует. Но так порой хочется,..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Идеальный код – это код, которого нет, а функция его выполняется. Понятно, что в реальной жизни ни идеальных технических систем, ни идеального программного кода не существует. Но так порой хочется,..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Идеальный код – это код, которого нет, а функция его выполняется. Понятно, что в реальной жизни ни идеальных технических систем, ни идеального программного кода не существует. Но так порой хочется,..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/221/c4e/1d8/221c4e1d87d0de9a116b91da64292d77.jpg" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/221/c4e/1d8/221c4e1d87d0de9a116b91da64292d77.jpg" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/221/c4e/1d8/221c4e1d87d0de9a116b91da64292d77.jpg" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/221/c4e/1d8/221c4e1d87d0de9a116b91da64292d77.jpg" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/221/c4e/1d8/221c4e1d87d0de9a116b91da64292d77.jpg" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="584998" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-22T12:03:57.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/584998/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/company/parallels/blog/584998/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habrastorage.org/getpro/habr/upload_files/221/c4e/1d8/221c4e1d87d0de9a116b91da64292d77.jpg" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/584998/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" companyName="parallels" data-async-called="true" class="tm-page"><div class="tm-page-width"><div class="tm-page__header"><!----></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"><div class="tm-company-card tm-company-article__company-card"><div class="tm-company-card__info"><div class="tm-company-card__header"><a href="/ru/company/parallels/profile/" class="tm-company-card__avatar"><div class="tm-entity-image"><img alt="" height="48" src="//habrastorage.org/getpro/habr/company/d72/9d6/932/d729d6932981ad0f6b49fcf43369bc06.png" width="48" class="tm-entity-image__pic"></div></a> <!----> <div class="tm-rating tm-company-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">101.11</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div> <div class="tm-company-card__info"><a href="/ru/company/parallels/profile/" class="tm-company-card__name">
        Parallels
      </a> <div class="tm-company-card__description">Мировой лидер на рынке межплатформенных решений</div></div></div> <div class="tm-company-card__buttons"><!----> <!----></div></div> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/andrey_danin/" title="andrey_danin" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_blue"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/andrey_danin/" class="tm-user-info__username">
      andrey_danin
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-22T12:03:57.000Z" title="2021-10-22, 15:03">22  октября   в 15:03</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Идеальный код: битва при Sonar</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/company/parallels/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании Parallels</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/it_testing/" class="tm-article-snippet__hubs-item-link"><span>Тестирование IT-систем</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/web_testing/" class="tm-article-snippet__hubs-item-link"><span>Тестирование веб-сервисов</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/mobile_testing/" class="tm-article-snippet__hubs-item-link"><span>Тестирование мобильных приложений</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/read/" class="tm-article-snippet__hubs-item-link"><span>Читальный зал</span> <!----></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><figure class="full-width "><img src="https://habrastorage.org/r/w780q1/getpro/habr/upload_files/221/c4e/1d8/221c4e1d87d0de9a116b91da64292d77.jpg" width="689" height="580" data-src="https://habrastorage.org/getpro/habr/upload_files/221/c4e/1d8/221c4e1d87d0de9a116b91da64292d77.jpg" data-blurred="true"/><figcaption></figcaption></figure><p>Идеальный код – это код, которого нет, а функция его выполняется. Понятно, что в реальной жизни ни идеальных технических систем, ни идеального программного кода не существует. Но так порой хочется, чтобы ошибок и кривого кода было меньше, а стилистика и архитектура выбранных решений вызывала уважение коллег по цеху.</p><p>Команда Parallels работает над своими проектами больше 20 лет. Сотни человек в России, Эстонии, на Мальте, в США, Японии и других странах развивают наше ПО. Коллектив большой, продуктов много (намного больше, чем один всемирно известный Parallels Desktop), репозиторий тоже внушительный.</p><p>Как следствие, не исключены ситуации, при которых, даже самое совершенное ревью не исключает попадание кривого кода в общую базу. Все это когда-то обязательно вылезает, ломает какую-то часть функциональности. Потом начинаются долгие разбирательства, почему сломалось и так далее. Выясняется, что кто-то где-то что-то не то написал, потом начинаются исправления. В итоге получается всем все очень долго, дорого и больно. И зачастую все вылезает на этапе, когда не хотелось бы что-то менять.</p><p>Именно поэтому сложно жить без инструмента, который бы помогал нам в автоматическом режиме следить за качеством кода. Также мы хотели, чтобы наши продукты соответствовали определённым правилам и стилю кодирования. Речь про автоматические метрики, которые можно было бы посчитать (например, сложность кода) и сделать его логику простой для понимания, без излишеств. Это не значит, что мы захотели отказаться от написания сложного кода, просто если существует возможность написать простой и сложный код для одной функциональности, лучше выбрать первое, глядишь и дебажить придется меньше. Так в нашей жизни появился SonarQube.</p><h3>Sonar здорового человека</h3><p><a href="https://www.sonarqube.org/">SonarQube</a> — это платформа для анализа и измерения качества кода. Что это и с чем ее едят, подробно и доступно описано на Хабре:<a href="https://habr.com/ru/company/pvs-studio/blog/315422/"> здесь</a>,<a href="https://habr.com/ru/post/213985/"> здесь</a> или<a href="https://habr.com/ru/post/259149/"> здесь</a>.</p><p>Справедливости ради, стоит сказать, что автоматизацию мы начинали с дополнительного плагина к Jenkins (<a href="https://plugins.jenkins.io/warnings-ng">Warnings Next Generation</a>). С его помощью можно собирать, агрегировать и визуализировать отчеты различных утилит статического анализа, компиляторов, линтеров. Можно настроить так называемый Quality Gate и посылать уведомления разработчикам о новых проблемах в коде.</p><p>Мы начали с ночных проверок, чтобы отчет для разработчиков был готов утром. Но это оказалось не очень удобно и невозможно было понять, смотрел ли разработчик отчет или нет. Можно было попробовать проверять таким образом pull-request’ы (мы до этого не дошли). Но это не очень удобно для разработчиков, потому что ревью в одной системе, а найденные баги в совершенно другой. Было бы здорово иметь возможность видеть найденные проблемы прямо в ревью. Тут то и пришел на помощь SonarQube. </p><p>Вообще существует довольно много приятных плагинов для Jenkins:</p><ol><li><p><strong>Ant Plug-in</strong> - Ant поддержка.</p></li><li><p><strong>ChuckNorris      Plug-in</strong> – Чак Норис показывающий свой вид, если      что-то не так.</p></li><li><p><strong>Dashboard View</strong> - для создания дашборда с графиками и дополнительными таблицами      результатов.</p></li><li><p><strong>Email Extension Plug-in</strong> - более удобная отправка email.</p></li><li><p><strong>Extra Columns      Plug-in</strong> - возможность добавлять в таблицы      дополнительные колонки.</p></li><li><p><a href="https://automated-testing.info/tags/git"><strong>Git</strong></a><strong> Client Plug-in</strong> <strong>и Git Plug-in</strong> - для поддержки <a href="https://automated-testing.info/tags/git">git</a>.</p></li><li><p><strong>Green Balls</strong> - озеленение удачных билдов, по умолчанию цвет синий.</p></li><li><p><strong>HTML Publisher      Plug-in</strong> - публикация и ссылка на сформированный      HTML репорт.</p></li><li><p><strong>inheritance      Plug-in</strong> - создание однотипных задач с      возможностью множественного изменения всех одновременно.</p></li><li><p><a href="https://automated-testing.info/tags/jenkins"><strong>Jenkins</strong></a><strong> Violations Plug-in</strong> - статистический анализатор кода и отображение результатов.</p></li><li><p><strong>Violation      Columns (List View Columns)</strong> - добавляет колонку в      список по соответствующему плагину.</p></li><li><p><a href="https://automated-testing.info/tags/maven"><strong>Maven</strong></a><strong> Project Plug-in</strong> - поддержка maven.</p></li><li><p><strong>Next-executions</strong> - добавляет панель со списком задач, которые скоро начнутся.</p></li><li><p><strong>Progress Bar      Column Plug-in</strong> - показывает прогресс бар      выполнения таблице билдов.</p></li><li><p><a href="https://automated-testing.info/tags/python"><strong>Python</strong></a><strong> Plug-in</strong> - запуск <a href="https://automated-testing.info/tags/python">python</a> скрипта в качестве шага.</p></li><li><p><strong>Warnings      Plug-in</strong> - анализатор кода и визуализация      результатов</p></li><li><p><strong>xUnit      Plug-in</strong> - запуск и подключение результатов с      возможностью задать условия для нестабильных и проблемных билдов.</p></li></ol><h3>Анализируй это…</h3><p>Сам анализ в SonarQube, в нашем случае условно можно разделить на две части: первое – метрики по коду, второе – проблемы в коде (неверное использование функций, ошибки работы с памятью, неинициализированные переменные и т. д.).</p><p>Метрики нужны нам для анализа структуры кода, размеров функций, количества параметров, размеров файлов, содержимого функций (насколько там сложная логика и сколько ветвлений внутри).</p><p>Сейчас у нас существует пять основных требований к сложности кода:</p><p>1.     Размер функций</p><p>2.     Размер файла</p><p>3.     Сложность функций</p><p>4.     Количество параметров функции на входе</p><p>5.     Стиль кодирования (требования к оформлению кода)</p><p>У нас все построено вокруг pull-requests. Команда пишет код (фичу) до состояния готовности «замержить» его в основную ветку разработки или в релиз. Т. е. условно, мы готовы заливать готовый код в точку слияния всех изменений. Тогда создается pull-requests и вместе с ним в SonarQube стартует анализ кода, который предлагается к включению в ветку.</p><p>Платформа анализирует данные и определяет, удовлетворяет ли новый код принятым в данном проекте требованиям (пройден ли Quality Gate). При положительной оценке формируется отчет Success, при найденных багах и несоответствии заданным параметрам Failed. </p><p>Статус Success/Failed направляется назад в pull-requests и соответственно там может ставиться блокировка и ничего нельзя «замержить» по причине несоответствия кода заданным параметрам качества. Далее разработчикам нужно разбираться с причинами. При прохождении тестов SonarQube ничего не блокирует и вам остается лишь дать остальным процессам зеленый свет.</p><p>Для каждого проекта SonarQube формирует дашборд, на котором можно видеть количество проблем и другие метрики по коду. Основываясь на этом можно работать с аналитикой и принимать решения относительно дальнейших шагов по рабочим проектам.</p><h3>Грабли, подводные камни…</h3><p>Вариант, при котором SonarQube спит, код идет, а функциональности здравствуют так же реален, как и вариант, когда система ничего криминального не видит, но ничего не работает. А все потому, что система не проверяет логику происходящего. SonarQube всего лишь анализирует соответствие кода заданным параметрам. Глобально платформа не знает, какую фичу мы делаем, что код должен делать. Она всего лишь проверяет его соответствие правилам и доступность для понимания.</p><p>Анализатор не может глубоко залезть в логику, но первичные баги отследить вполне способен. Например, ошибки, связанные с неправильным использованием API. Тривиальные ошибки, когда используют переменную и только после этого проверяют, имеет ли она корректное значение. Например, пришел нулевой указатель, мы его вначале использовали, а только потом проверили. Такие вещи анализатор отлавливает и дает о себе знать.</p><figure class="full-width "><img src="/img/image-loader.svg" height="602" data-src="https://habrastorage.org/getpro/habr/upload_files/6d4/3e6/536/6d43e6536ece76820217255e8b5b878b.png" data-width="636"/><figcaption></figcaption></figure><p>Подобные вещи разработчик может не отловить, и даже тестирование код может пройти и в итоге выстрелить где-то у клиента, потому что сценарий может оказаться какой-то редкий. Просмотреть это довольно легко, особенно если ты вносишь изменения в какую-то усложненную большую функцию и тебе элементарно тяжело глазами обозреть все ее части.</p><p>К дополнительным плюсам SonarQube можно отнести и то, что платформа работает с более чем 20 различных языками программирования. Мы в основном работаем с С++, JavaScript, HTML, CSS, C#, Python.</p><p>Из минусов можно отметить то, что набор правил для SonarQube достаточно общий и не всегда подходит для каждого из наших проектов. Это требует внесения дополнительных индивидуальных настроек. Тюнинг – требует дополнительного времени. Не каждый готов его тратить.</p><p>Вообще идеально, если получается внедрять SonarQube на старте проекта. Но этот сценарий можно отнести к разряду несбыточных мечт, особенно для компаний с историей и большим количеством проектов. С другой стороны, всегда можно настроить платформу так, чтобы она реагировала на новые грабли в коде, постепенно разбирая грехи прошлых лет. В <a href="https://docs.sonarqube.org/latest/project-administration/new-code-period/#:~:text=in%20Developer%20Edition).-,New%20Code%20definitions,-You%20can%20define">Sonar</a> есть два дашборда (для старого и нового кода).</p><p>Платформа находит проблемы, дальше воля владельца продукта, что-то с этим сделать или не делать, а талант разработчиков в том, чтобы, копаясь в «преданьях старины глубокой» ничего не поломать и не уронить.</p><h3>Еще про страхи</h3><p>Сгружать свой божественный код в черную коробочку – сомнительное удовольствие. Всегда есть риск отдать свои ноу-хау заморскому или отечественному «большому брату». Для здоровых снов и крепких нервов мы крутим все на наших серверах и в нашей базе данных. Дополнительно можно прикрыть тылы файрволом, чтобы анализатор не ходил, куда не нужно.   </p><p>Иногда утечки кода связаны с тем, что использовались дефолтные админские логины и пароли. В последних версиях SonarQube платформа настойчиво склоняет вас к сознательности, безопасной жизни и форсированной смене пароля администратора. (hint: если вы деплоите платформу автоматически и включаете SSO, не забудьте сходить админом и сменить пароль. Или же предусмотрите смену пароля при деплое.)</p><h3>Год с Sonar</h3><p>Позади 365 дней с SonarQube. В начале мы жили с ним в тестовом режиме. Платформа ничего не блокировала, работая в информационном режиме, высылая разработчикам отчеты с анализом кода.</p><p>По прошествии года с SonarQube, мы можем сказать, что делать какие-то выводы мы еще не готовы. Нельзя сказать, что без него все было ужасно, а с его пришествием жизнь изменилась до неузнаваемости. Единые качественные метрики мы будем только вводить. До этого их не было, они просто были выключены. Мы смотрели исключительно на проблемы, найденные анализатором.</p><p>Логика была такая: анализатор находит косяк, разработчик его исправляет. В начале бывало и такое, что несмотря на возмущения Sonar, команда двигалась дальше. Хорошая новость – ничего вопиющего не находилось (того, что прошло проверку и было «закомитчено»).</p><p>Бывали и такие ситуации, когда анализатор не находил существующие проблемы. Как в известном фильме: «Видишь суслика? И я не вижу, а он есть». Вообще стоит сказать, что статический анализ – это такая штука, где лучше использовать сразу несколько инструментов. Это существенно повышает шансы на безошибочную работу. Если есть возможность взять сразу несколько анализаторов – не отказывайте себе в удовольствии. Каждый из них точно что-то найдет. Так ваши нервы и код будут целее. У нас бывали случаи, когда используемые нами сторонние анализаторы ничего не находили, а штатный от Microsoft исправно сигналил.</p><p>Если вы спросите, кто больше всего у нас счастлив от наличия в компании SonarQube, ответ будет: «Примерно никто». Мы все-таки еще в процессе адаптации системы к жизненным процессам в нашей разработке.</p><p>Еще один плюс – это удовольствие не стоит компании каких-то денег. Даже в базовой версии SonarQube поддерживает практически все используемые нами языки. Практически, но не все. Для анализа C/C++ кода стали использовать бесплатный плагин. Единственный его минус – низкая скорость анализа проектов (отчасти из-за того, что анализ реализован в один поток). Но, в принципе, не смертельно. Даже с учетом расширения количества метрик можно помедитировать пару часов над другими задачами.</p><h3>Творческие планы</h3><p>Постепенно мы расширяем возможности применения SonarQube. Задача – распространить анализ на максимальное число наших проектов. Цель – находить баги в самом начале, чтобы как у классика: «Не было мучительно больно за бесцельно прожитые годы». На самом деле главное требование к любому анализатору, он должен не мешать, а помогать разработчикам.</p><p><strong>P.S.</strong> Расскажите, какими анализаторами пользуетесь вы в своей работе и какие вы точно можете порекомендовать. Спасибо за внимание.</p><p><strong>Бонус:</strong> <a href="https://cacm.acm.org/magazines/2018/4/226371-lessons-from-building-static-analysis-tools-at-google/fulltext">полезная статья</a> о том, что внедрять анализ кода надо на уровне компилятора или сборки.</p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bparallels%5D" class="tm-tags-list__link">parallels</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bparallels%20desktop%5D" class="tm-tags-list__link">parallels desktop</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bparallels%20ras%5D" class="tm-tags-list__link">parallels ras</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bparallels%20access%5D" class="tm-tags-list__link">parallels access</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bparallels.parallels%20desktop%5D" class="tm-tags-list__link">parallels.parallels desktop</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bparallels%20remote%20application%20server%5D" class="tm-tags-list__link">parallels remote application server</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bparallels%20plesk%20panel%5D" class="tm-tags-list__link">parallels plesk panel</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bparallels%20desktop%20for%20mac%5D" class="tm-tags-list__link">parallels desktop for mac</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bparallels%20automation%5D" class="tm-tags-list__link">parallels automation</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bparallels%20cloud%20server%5D" class="tm-tags-list__link">parallels cloud server</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/company/parallels/blog/" class="tm-hubs-list__link router-link-active">
    Блог компании Parallels
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/it_testing/" class="tm-hubs-list__link">
    Тестирование IT-систем
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/web_testing/" class="tm-hubs-list__link">
    Тестирование веб-сервисов
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/mobile_testing/" class="tm-hubs-list__link">
    Тестирование мобильных приложений
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/read/" class="tm-hubs-list__link">
    Читальный зал
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 13: ↑12 и ↓1</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 13: ↑12 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+11</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">2K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    17
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="/ru/company/parallels/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" height="40" src="//habrastorage.org/getpro/habr/company/d72/9d6/932/d729d6932981ad0f6b49fcf43369bc06.png" width="40" class="tm-entity-image__pic"></div></a> <div class="tm-company-snippet__info"><a href="/ru/company/parallels/profile/" class="tm-company-snippet__title">Parallels</a> <div class="tm-company-snippet__description">Мировой лидер на рынке межплатформенных решений</div></div></div> <div class="tm-article-author__buttons"><!----> <!----></div></div> <div class="tm-article-author__company-contacts"><a href="http://www.parallels.com/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a><a href="https://facebook.com/ParallelsRussia" rel="noopener" target="_blank" class="tm-article-author__contact">
      Facebook
    </a><a href="https://twitter.com/ru_Parallels" rel="noopener" target="_blank" class="tm-article-author__contact">
      Twitter
    </a></div> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/andrey_danin/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_blue"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 17 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    17
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">11</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/andrey_danin/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @andrey_danin
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/company/parallels/blog/584998/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 8 
    </span></a> <!----></div></div></div>  <!---->  <!----> <!----></div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section class="tm-block tm-block_spacing-bottom"><header class="tm-block__header"><h2 class="tm-block__title">Информация</h2> <!----></header> <div class="tm-block__body"><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата основания</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="1999-11-29T21:00:00.000Z" title="1999-11-30, 00:00">30  ноября  1999</time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Местоположение</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    США
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Сайт</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="http://www.parallels.com/" target="_blank" class="tm-company-basic-info__link">
      www.parallels.com
    </a></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Численность</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    201–500 человек
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата регистрации</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2008-08-09T07:43:03.000Z" title="2008-08-09, 11:43">9  августа  2008</time></dd></dl> <!----></div></div> <!----></section> <div class="tm-company-widgets"></div> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/company/parallels/blog/584998/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/company/parallels/blog/584998/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"584998":{"id":"584998","timePublished":"2021-10-22T12:03:57+00:00","isCorporative":true,"lang":"ru","titleHtml":"Идеальный код: битва при Sonar","leadData":{"textHtml":"\u003Cp\u003EИдеальный код – это код, которого нет, а функция его выполняется. Понятно, что в реальной жизни ни идеальных технических систем, ни идеального программного кода не существует. Но так порой хочется, чтобы ошибок и кривого кода было меньше, а стилистика и архитектура выбранных решений вызывала уважение коллег по цеху.\u003C\u002Fp\u003E\u003Cp\u003EИменно поэтому сложно жить без инструмента, который бы помогал нам в автоматическом режиме следить за качеством кода. Также мы хотели, чтобы наши продукты соответствовали определённым правилам и стилю кодирования. Речь про автоматические метрики, которые можно было бы посчитать (например, сложность кода) и сделать его логику простой для понимания, без излишеств. Это не значит, что мы захотели отказаться от написания сложного кода, просто если существует возможность написать простой и сложный код для одной функциональности, лучше выбрать первое, глядишь и дебажить придется меньше. Так в нашей жизни появился SonarQube.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F221\u002Fc4e\u002F1d8\u002F221c4e1d87d0de9a116b91da64292d77.jpg","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F221\u002Fc4e\u002F1d8\u002F221c4e1d87d0de9a116b91da64292d77.jpg","fit":"cover","positionY":0,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":17,"votesCount":17},"rating":11,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"2226174","alias":"andrey_danin","fullname":null,"avatarUrl":null,"speciality":null},"statistics":{"commentsCount":8,"favoritesCount":17,"readingCount":1951,"score":11,"votesCount":13},"hubs":[{"relatedData":null,"id":"5372","alias":"parallels","type":"corporative","title":"Блог компании Parallels","titleHtml":"Блог компании Parallels","isProfiled":false},{"relatedData":null,"id":"210","alias":"it_testing","type":"collective","title":"Тестирование IT-систем","titleHtml":"Тестирование IT-систем","isProfiled":true},{"relatedData":null,"id":"19279","alias":"web_testing","type":"collective","title":"Тестирование веб-сервисов","titleHtml":"Тестирование веб-сервисов","isProfiled":true},{"relatedData":null,"id":"19281","alias":"mobile_testing","type":"collective","title":"Тестирование мобильных приложений","titleHtml":"Тестирование мобильных приложений","isProfiled":true},{"relatedData":null,"id":"20742","alias":"read","type":"collective","title":"Читальный зал","titleHtml":"Читальный зал","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"3","alias":"management","title":"Менеджмент"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F221\u002Fc4e\u002F1d8\u002F221c4e1d87d0de9a116b91da64292d77.jpg\" width=\"689\" height=\"580\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F221\u002Fc4e\u002F1d8\u002F221c4e1d87d0de9a116b91da64292d77.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EИдеальный код – это код, которого нет, а функция его выполняется. Понятно, что в реальной жизни ни идеальных технических систем, ни идеального программного кода не существует. Но так порой хочется, чтобы ошибок и кривого кода было меньше, а стилистика и архитектура выбранных решений вызывала уважение коллег по цеху.\u003C\u002Fp\u003E\u003Cp\u003EКоманда Parallels работает над своими проектами больше 20 лет. Сотни человек в России, Эстонии, на Мальте, в США, Японии и других странах развивают наше ПО. Коллектив большой, продуктов много (намного больше, чем один всемирно известный Parallels Desktop), репозиторий тоже внушительный.\u003C\u002Fp\u003E\u003Cp\u003EКак следствие, не исключены ситуации, при которых, даже самое совершенное ревью не исключает попадание кривого кода в общую базу. Все это когда-то обязательно вылезает, ломает какую-то часть функциональности. Потом начинаются долгие разбирательства, почему сломалось и так далее. Выясняется, что кто-то где-то что-то не то написал, потом начинаются исправления. В итоге получается всем все очень долго, дорого и больно. И зачастую все вылезает на этапе, когда не хотелось бы что-то менять.\u003C\u002Fp\u003E\u003Cp\u003EИменно поэтому сложно жить без инструмента, который бы помогал нам в автоматическом режиме следить за качеством кода. Также мы хотели, чтобы наши продукты соответствовали определённым правилам и стилю кодирования. Речь про автоматические метрики, которые можно было бы посчитать (например, сложность кода) и сделать его логику простой для понимания, без излишеств. Это не значит, что мы захотели отказаться от написания сложного кода, просто если существует возможность написать простой и сложный код для одной функциональности, лучше выбрать первое, глядишь и дебажить придется меньше. Так в нашей жизни появился SonarQube.\u003C\u002Fp\u003E\u003Ch3\u003ESonar здорового человека\u003C\u002Fh3\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwww.sonarqube.org\u002F\"\u003ESonarQube\u003C\u002Fa\u003E — это платформа для анализа и измерения качества кода. Что это и с чем ее едят, подробно и доступно описано на Хабре:\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fpvs-studio\u002Fblog\u002F315422\u002F\"\u003E здесь\u003C\u002Fa\u003E,\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F213985\u002F\"\u003E здесь\u003C\u002Fa\u003E или\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F259149\u002F\"\u003E здесь\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EСправедливости ради, стоит сказать, что автоматизацию мы начинали с дополнительного плагина к Jenkins (\u003Ca href=\"https:\u002F\u002Fplugins.jenkins.io\u002Fwarnings-ng\"\u003EWarnings Next Generation\u003C\u002Fa\u003E). С его помощью можно собирать, агрегировать и визуализировать отчеты различных утилит статического анализа, компиляторов, линтеров. Можно настроить так называемый Quality Gate и посылать уведомления разработчикам о новых проблемах в коде.\u003C\u002Fp\u003E\u003Cp\u003EМы начали с ночных проверок, чтобы отчет для разработчиков был готов утром. Но это оказалось не очень удобно и невозможно было понять, смотрел ли разработчик отчет или нет. Можно было попробовать проверять таким образом pull-request’ы (мы до этого не дошли). Но это не очень удобно для разработчиков, потому что ревью в одной системе, а найденные баги в совершенно другой. Было бы здорово иметь возможность видеть найденные проблемы прямо в ревью. Тут то и пришел на помощь SonarQube. \u003C\u002Fp\u003E\u003Cp\u003EВообще существует довольно много приятных плагинов для Jenkins:\u003C\u002Fp\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003EAnt Plug-in\u003C\u002Fstrong\u003E - Ant поддержка.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003EChuckNorris      Plug-in\u003C\u002Fstrong\u003E – Чак Норис показывающий свой вид, если      что-то не так.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003EDashboard View\u003C\u002Fstrong\u003E - для создания дашборда с графиками и дополнительными таблицами      результатов.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003EEmail Extension Plug-in\u003C\u002Fstrong\u003E - более удобная отправка email.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003EExtra Columns      Plug-in\u003C\u002Fstrong\u003E - возможность добавлять в таблицы      дополнительные колонки.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fautomated-testing.info\u002Ftags\u002Fgit\"\u003E\u003Cstrong\u003EGit\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E\u003Cstrong\u003E Client Plug-in\u003C\u002Fstrong\u003E \u003Cstrong\u003Eи Git Plug-in\u003C\u002Fstrong\u003E - для поддержки \u003Ca href=\"https:\u002F\u002Fautomated-testing.info\u002Ftags\u002Fgit\"\u003Egit\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003EGreen Balls\u003C\u002Fstrong\u003E - озеленение удачных билдов, по умолчанию цвет синий.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003EHTML Publisher      Plug-in\u003C\u002Fstrong\u003E - публикация и ссылка на сформированный      HTML репорт.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003Einheritance      Plug-in\u003C\u002Fstrong\u003E - создание однотипных задач с      возможностью множественного изменения всех одновременно.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fautomated-testing.info\u002Ftags\u002Fjenkins\"\u003E\u003Cstrong\u003EJenkins\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E\u003Cstrong\u003E Violations Plug-in\u003C\u002Fstrong\u003E - статистический анализатор кода и отображение результатов.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003EViolation      Columns (List View Columns)\u003C\u002Fstrong\u003E - добавляет колонку в      список по соответствующему плагину.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fautomated-testing.info\u002Ftags\u002Fmaven\"\u003E\u003Cstrong\u003EMaven\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E\u003Cstrong\u003E Project Plug-in\u003C\u002Fstrong\u003E - поддержка maven.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003ENext-executions\u003C\u002Fstrong\u003E - добавляет панель со списком задач, которые скоро начнутся.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003EProgress Bar      Column Plug-in\u003C\u002Fstrong\u003E - показывает прогресс бар      выполнения таблице билдов.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fautomated-testing.info\u002Ftags\u002Fpython\"\u003E\u003Cstrong\u003EPython\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E\u003Cstrong\u003E Plug-in\u003C\u002Fstrong\u003E - запуск \u003Ca href=\"https:\u002F\u002Fautomated-testing.info\u002Ftags\u002Fpython\"\u003Epython\u003C\u002Fa\u003E скрипта в качестве шага.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003EWarnings      Plug-in\u003C\u002Fstrong\u003E - анализатор кода и визуализация      результатов\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Cstrong\u003ExUnit      Plug-in\u003C\u002Fstrong\u003E - запуск и подключение результатов с      возможностью задать условия для нестабильных и проблемных билдов.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Ch3\u003EАнализируй это…\u003C\u002Fh3\u003E\u003Cp\u003EСам анализ в SonarQube, в нашем случае условно можно разделить на две части: первое – метрики по коду, второе – проблемы в коде (неверное использование функций, ошибки работы с памятью, неинициализированные переменные и т. д.).\u003C\u002Fp\u003E\u003Cp\u003EМетрики нужны нам для анализа структуры кода, размеров функций, количества параметров, размеров файлов, содержимого функций (насколько там сложная логика и сколько ветвлений внутри).\u003C\u002Fp\u003E\u003Cp\u003EСейчас у нас существует пять основных требований к сложности кода:\u003C\u002Fp\u003E\u003Cp\u003E1.     Размер функций\u003C\u002Fp\u003E\u003Cp\u003E2.     Размер файла\u003C\u002Fp\u003E\u003Cp\u003E3.     Сложность функций\u003C\u002Fp\u003E\u003Cp\u003E4.     Количество параметров функции на входе\u003C\u002Fp\u003E\u003Cp\u003E5.     Стиль кодирования (требования к оформлению кода)\u003C\u002Fp\u003E\u003Cp\u003EУ нас все построено вокруг pull-requests. Команда пишет код (фичу) до состояния готовности «замержить» его в основную ветку разработки или в релиз. Т. е. условно, мы готовы заливать готовый код в точку слияния всех изменений. Тогда создается pull-requests и вместе с ним в SonarQube стартует анализ кода, который предлагается к включению в ветку.\u003C\u002Fp\u003E\u003Cp\u003EПлатформа анализирует данные и определяет, удовлетворяет ли новый код принятым в данном проекте требованиям (пройден ли Quality Gate). При положительной оценке формируется отчет Success, при найденных багах и несоответствии заданным параметрам Failed. \u003C\u002Fp\u003E\u003Cp\u003EСтатус Success\u002FFailed направляется назад в pull-requests и соответственно там может ставиться блокировка и ничего нельзя «замержить» по причине несоответствия кода заданным параметрам качества. Далее разработчикам нужно разбираться с причинами. При прохождении тестов SonarQube ничего не блокирует и вам остается лишь дать остальным процессам зеленый свет.\u003C\u002Fp\u003E\u003Cp\u003EДля каждого проекта SonarQube формирует дашборд, на котором можно видеть количество проблем и другие метрики по коду. Основываясь на этом можно работать с аналитикой и принимать решения относительно дальнейших шагов по рабочим проектам.\u003C\u002Fp\u003E\u003Ch3\u003EГрабли, подводные камни…\u003C\u002Fh3\u003E\u003Cp\u003EВариант, при котором SonarQube спит, код идет, а функциональности здравствуют так же реален, как и вариант, когда система ничего криминального не видит, но ничего не работает. А все потому, что система не проверяет логику происходящего. SonarQube всего лишь анализирует соответствие кода заданным параметрам. Глобально платформа не знает, какую фичу мы делаем, что код должен делать. Она всего лишь проверяет его соответствие правилам и доступность для понимания.\u003C\u002Fp\u003E\u003Cp\u003EАнализатор не может глубоко залезть в логику, но первичные баги отследить вполне способен. Например, ошибки, связанные с неправильным использованием API. Тривиальные ошибки, когда используют переменную и только после этого проверяют, имеет ли она корректное значение. Например, пришел нулевой указатель, мы его вначале использовали, а только потом проверили. Такие вещи анализатор отлавливает и дает о себе знать.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"602\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6d4\u002F3e6\u002F536\u002F6d43e6536ece76820217255e8b5b878b.png\" data-width=\"636\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПодобные вещи разработчик может не отловить, и даже тестирование код может пройти и в итоге выстрелить где-то у клиента, потому что сценарий может оказаться какой-то редкий. Просмотреть это довольно легко, особенно если ты вносишь изменения в какую-то усложненную большую функцию и тебе элементарно тяжело глазами обозреть все ее части.\u003C\u002Fp\u003E\u003Cp\u003EК дополнительным плюсам SonarQube можно отнести и то, что платформа работает с более чем 20 различных языками программирования. Мы в основном работаем с С++, JavaScript, HTML, CSS, C#, Python.\u003C\u002Fp\u003E\u003Cp\u003EИз минусов можно отметить то, что набор правил для SonarQube достаточно общий и не всегда подходит для каждого из наших проектов. Это требует внесения дополнительных индивидуальных настроек. Тюнинг – требует дополнительного времени. Не каждый готов его тратить.\u003C\u002Fp\u003E\u003Cp\u003EВообще идеально, если получается внедрять SonarQube на старте проекта. Но этот сценарий можно отнести к разряду несбыточных мечт, особенно для компаний с историей и большим количеством проектов. С другой стороны, всегда можно настроить платформу так, чтобы она реагировала на новые грабли в коде, постепенно разбирая грехи прошлых лет. В \u003Ca href=\"https:\u002F\u002Fdocs.sonarqube.org\u002Flatest\u002Fproject-administration\u002Fnew-code-period\u002F#:~:text=in%20Developer%20Edition).-,New%20Code%20definitions,-You%20can%20define\"\u003ESonar\u003C\u002Fa\u003E есть два дашборда (для старого и нового кода).\u003C\u002Fp\u003E\u003Cp\u003EПлатформа находит проблемы, дальше воля владельца продукта, что-то с этим сделать или не делать, а талант разработчиков в том, чтобы, копаясь в «преданьях старины глубокой» ничего не поломать и не уронить.\u003C\u002Fp\u003E\u003Ch3\u003EЕще про страхи\u003C\u002Fh3\u003E\u003Cp\u003EСгружать свой божественный код в черную коробочку – сомнительное удовольствие. Всегда есть риск отдать свои ноу-хау заморскому или отечественному «большому брату». Для здоровых снов и крепких нервов мы крутим все на наших серверах и в нашей базе данных. Дополнительно можно прикрыть тылы файрволом, чтобы анализатор не ходил, куда не нужно.   \u003C\u002Fp\u003E\u003Cp\u003EИногда утечки кода связаны с тем, что использовались дефолтные админские логины и пароли. В последних версиях SonarQube платформа настойчиво склоняет вас к сознательности, безопасной жизни и форсированной смене пароля администратора. (hint: если вы деплоите платформу автоматически и включаете SSO, не забудьте сходить админом и сменить пароль. Или же предусмотрите смену пароля при деплое.)\u003C\u002Fp\u003E\u003Ch3\u003EГод с Sonar\u003C\u002Fh3\u003E\u003Cp\u003EПозади 365 дней с SonarQube. В начале мы жили с ним в тестовом режиме. Платформа ничего не блокировала, работая в информационном режиме, высылая разработчикам отчеты с анализом кода.\u003C\u002Fp\u003E\u003Cp\u003EПо прошествии года с SonarQube, мы можем сказать, что делать какие-то выводы мы еще не готовы. Нельзя сказать, что без него все было ужасно, а с его пришествием жизнь изменилась до неузнаваемости. Единые качественные метрики мы будем только вводить. До этого их не было, они просто были выключены. Мы смотрели исключительно на проблемы, найденные анализатором.\u003C\u002Fp\u003E\u003Cp\u003EЛогика была такая: анализатор находит косяк, разработчик его исправляет. В начале бывало и такое, что несмотря на возмущения Sonar, команда двигалась дальше. Хорошая новость – ничего вопиющего не находилось (того, что прошло проверку и было «закомитчено»).\u003C\u002Fp\u003E\u003Cp\u003EБывали и такие ситуации, когда анализатор не находил существующие проблемы. Как в известном фильме: «Видишь суслика? И я не вижу, а он есть». Вообще стоит сказать, что статический анализ – это такая штука, где лучше использовать сразу несколько инструментов. Это существенно повышает шансы на безошибочную работу. Если есть возможность взять сразу несколько анализаторов – не отказывайте себе в удовольствии. Каждый из них точно что-то найдет. Так ваши нервы и код будут целее. У нас бывали случаи, когда используемые нами сторонние анализаторы ничего не находили, а штатный от Microsoft исправно сигналил.\u003C\u002Fp\u003E\u003Cp\u003EЕсли вы спросите, кто больше всего у нас счастлив от наличия в компании SonarQube, ответ будет: «Примерно никто». Мы все-таки еще в процессе адаптации системы к жизненным процессам в нашей разработке.\u003C\u002Fp\u003E\u003Cp\u003EЕще один плюс – это удовольствие не стоит компании каких-то денег. Даже в базовой версии SonarQube поддерживает практически все используемые нами языки. Практически, но не все. Для анализа C\u002FC++ кода стали использовать бесплатный плагин. Единственный его минус – низкая скорость анализа проектов (отчасти из-за того, что анализ реализован в один поток). Но, в принципе, не смертельно. Даже с учетом расширения количества метрик можно помедитировать пару часов над другими задачами.\u003C\u002Fp\u003E\u003Ch3\u003EТворческие планы\u003C\u002Fh3\u003E\u003Cp\u003EПостепенно мы расширяем возможности применения SonarQube. Задача – распространить анализ на максимальное число наших проектов. Цель – находить баги в самом начале, чтобы как у классика: «Не было мучительно больно за бесцельно прожитые годы». На самом деле главное требование к любому анализатору, он должен не мешать, а помогать разработчикам.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EP.S.\u003C\u002Fstrong\u003E Расскажите, какими анализаторами пользуетесь вы в своей работе и какие вы точно можете порекомендовать. Спасибо за внимание.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EБонус:\u003C\u002Fstrong\u003E \u003Ca href=\"https:\u002F\u002Fcacm.acm.org\u002Fmagazines\u002F2018\u002F4\u002F226371-lessons-from-building-static-analysis-tools-at-google\u002Ffulltext\"\u003Eполезная статья\u003C\u002Fa\u003E о том, что внедрять анализ кода надо на уровне компилятора или сборки.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"parallels"},{"titleHtml":"parallels desktop"},{"titleHtml":"parallels ras"},{"titleHtml":"parallels access"},{"titleHtml":"parallels.parallels desktop"},{"titleHtml":"parallels remote application server"},{"titleHtml":"parallels plesk panel"},{"titleHtml":"parallels desktop for mac"},{"titleHtml":"parallels automation"},{"titleHtml":"parallels cloud server"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F221\u002Fc4e\u002F1d8\u002F221c4e1d87d0de9a116b91da64292d77.jpg","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F221\u002Fc4e\u002F1d8\u002F221c4e1d87d0de9a116b91da64292d77.jpg","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fparallels\\\u002Fblog\\\u002F584998\\\u002F\"},\"headline\":\"Идеальный код: битва при Sonar\",\"datePublished\":\"2021-10-22T15:03:57+03:00\",\"dateModified\":\"2021-10-25T11:20:22+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"andrey_danin\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Идеальный код &ndash; это код, которого нет, а функция его выполняется. Понятно, что в реальной жизни ни идеальных технических систем, ни идеального программного кода...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fparallels\\\u002Fblog\\\u002F584998\\\u002F#post-content-body\",\"about\":[\"c_parallels\",\"h_it_testing\",\"h_web_testing\",\"h_mobile_testing\",\"h_read\",\"f_develop\",\"f_management\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F584998\\\u002Fc85d8d22157f4d2d15825c0b03346305\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F221\\\u002Fc4e\\\u002F1d8\\\u002F221c4e1d87d0de9a116b91da64292d77.jpg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F6d4\\\u002F3e6\\\u002F536\\\u002F6d43e6536ece76820217255e8b5b878b.png\"]}","metaDescription":"Идеальный код – это код, которого нет, а функция его выполняется. Понятно, что в реальной жизни ни идеальных технических систем, ни идеального программного кода не существует. Но так порой хочется,...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{"parallels":{"alias":"parallels","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002Fd72\u002F9d6\u002F932\u002Fd729d6932981ad0f6b49fcf43369bc06.png","titleHtml":"Parallels","descriptionHtml":"Мировой лидер на рынке межплатформенных решений","relatedData":null,"statistics":{"postsCount":251,"newsCount":4,"vacanciesCount":0,"employeesCount":49,"careerRating":null,"subscribersCount":37806,"rating":101.11,"invest":null},"foundationDate":{"year":"1999","month":"11","day":"30"},"location":{"city":null,"region":null,"country":{"id":"198","title":"США"}},"siteUrl":"http:\u002F\u002Fwww.parallels.com\u002F","staffNumber":"201–500 человек","registrationDate":"2008-08-09T07:43:03+00:00","representativeUser":null,"contacts":[{"title":"Сайт","url":"http:\u002F\u002Fwww.parallels.com\u002F"},{"title":"Facebook","url":"https:\u002F\u002Ffacebook.com\u002FParallelsRussia"},{"title":"Twitter","url":"https:\u002F\u002Ftwitter.com\u002Fru_Parallels"}],"settings":{"analyticsSettings":[],"branding":null,"status":"active"},"metadata":{"titleHtml":"Parallels, США - Мировой лидер на рынке межплатформенных решений с 30 ноября 1999 г.","title":"Parallels, США - Мировой лидер на рынке межплатформенных решений с 30 ноября 1999 г.","keywords":["Читальный зал","Карьера в IT-индустрии","Виртуализация","IT-инфраструктура","Разработка под MacOS"],"descriptionHtml":"251 статья от авторов компании Parallels","description":"251 статья от авторов компании Parallels"},"aDeskSettings":null,"careerAlias":"parallels","maxCustomTrackerLinks":0}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
