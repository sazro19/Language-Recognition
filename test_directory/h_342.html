<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Приближение многочленом с условием прохождения через точки / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/583988\/"},"headline":"Приближение многочленом с условием прохождения через точки","datePublished":"2021-10-18T21:41:34+03:00","dateModified":"2021-10-18T21:41:34+03:00","author":{"@type":"Person","name":"Михаил Борисов"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"При моделировании данных методом наименьших квадратов, кривая обычно не проходит через точки измерений (рис. 1).Что, если нужно, чтобы эта кривая точно проходила...","url":"https:\/\/habr.com\/ru\/post\/583988\/#post-content-body","about":["h_algorithms","h_maths","h_machine_learning","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/583988\/f8993b8c9a7966ef9cc1e8667b536da1\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/7d9\/6eb\/092\/7d96eb0924a929fe6869492c1b94bcbc.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/b9c\/795\/024\/b9c7950248e198e8d89a91624f242a99.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/f35\/cca\/b65\/f35ccab659c08f6f6738cc07d85af9e6.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/7e8\/6d3\/11a\/7e86d311a1415d1b8546ae1cbc8b3e8f.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/ca8\/f8a\/646\/ca8f8a646f537177de7dc8f392209b56.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/04b\/4a7\/c4b\/04b4a7c4b71f2a4a714039b5134698c5.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/da2\/9bd\/3c5\/da29bd3c54f510286930caef7e57ba00.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/120\/52b\/c4a\/12052bc4a18420663bb109fc2b19ee60.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/016\/436\/03a\/01643603ad66c827f584987d370edfad.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/969\/f2b\/8c4\/969f2b8c4016bcd1d26a6fc64b19f510.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/7fc\/583\/f49\/7fc583f49d9ed1e4b0de464f3016f57e.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/7d4\/a84\/8ae\/7d4a848ae9084301f1af420adb29e45e.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/df8\/504\/9e6\/df85049e6820f71a1ca4aad54897cf61.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/1b0\/32b\/b81\/1b032bb81b69106f7b1cc018244df7f0.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/f77\/35e\/c9b\/f7735ec9b1a623d56ff69d3db1a98d3a.svg","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/72a\/8ed\/978\/72a8ed9789ba1416f431af5f72c948f9.svg"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Приближение многочленом с условием прохождения через точки" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Приближение многочленом с условием прохождения через точки" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Приближение многочленом с условием прохождения через точки" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="При моделировании данных методом наименьших квадратов, кривая обычно не проходит через точки измерений (рис. 1).Что, если нужно, чтобы эта кривая точно проходила через одну или несколько особо..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="При моделировании данных методом наименьших квадратов, кривая обычно не проходит через точки измерений (рис. 1).Что, если нужно, чтобы эта кривая точно проходила через одну или несколько особо..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="При моделировании данных методом наименьших квадратов, кривая обычно не проходит через точки измерений (рис. 1).Что, если нужно, чтобы эта кривая точно проходила через одну или несколько особо..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="При моделировании данных методом наименьших квадратов, кривая обычно не проходит через точки измерений (рис. 1).Что, если нужно, чтобы эта кривая точно проходила через одну или несколько особо..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="При моделировании данных методом наименьших квадратов, кривая обычно не проходит через точки измерений (рис. 1).Что, если нужно, чтобы эта кривая точно проходила через одну или несколько особо..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/7d9/6eb/092/7d96eb0924a929fe6869492c1b94bcbc.png" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/7d9/6eb/092/7d96eb0924a929fe6869492c1b94bcbc.png" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/7d9/6eb/092/7d96eb0924a929fe6869492c1b94bcbc.png" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/7d9/6eb/092/7d96eb0924a929fe6869492c1b94bcbc.png" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/7d9/6eb/092/7d96eb0924a929fe6869492c1b94bcbc.png" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="583988" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-18T18:41:34.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/583988/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/583988/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habrastorage.org/getpro/habr/upload_files/7d9/6eb/092/7d96eb0924a929fe6869492c1b94bcbc.png" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/583988/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/MichaelBorisov/" title="MichaelBorisov" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/MichaelBorisov/" class="tm-user-info__username">
      MichaelBorisov
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-18T18:41:34.000Z" title="2021-10-18, 21:41">18  октября   в 21:41</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Приближение многочленом с условием прохождения через точки</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/algorithms/" class="tm-article-snippet__hubs-item-link"><span>Алгоритмы</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/maths/" class="tm-article-snippet__hubs-item-link"><span>Математика</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/machine_learning/" class="tm-article-snippet__hubs-item-link"><span>Машинное обучение</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><p>При моделировании данных методом наименьших квадратов, кривая обычно не проходит через точки измерений (рис. 1).</p><figure class="full-width "><img src="/img/image-loader.svg" height="715" data-src="https://habrastorage.org/getpro/habr/upload_files/7d9/6eb/092/7d96eb0924a929fe6869492c1b94bcbc.png" data-width="1237"/><figcaption></figcaption></figure><p>Что, если нужно, чтобы эта кривая точно проходила через одну или несколько особо выделенных точек (рис. 2 - показаны зелёными кружочками)?</p><p>Тогда читаем дальше.</p><h2>1. Мотивация</h2><p>Рассмотрим обычную задачу приближения многочленом и посмотрим, чего нам в ней не хватает.</p><p>Дано N точек на плоскости (x<sub>i</sub>,y<sub>i</sub>) - значения неизвестной функции f(x). Требуется найти многочлен p(x) степени M (M&lt;N), наилучшим образом приближающий эту функцию.</p><img class="formula" source="p(x)=\sum_{j=0}^M {a_j x^j}" alt="p(x)=\sum_{j=0}^M {a_j x^j}" src="https://habrastorage.org/getpro/habr/upload_files/b9c/795/024/b9c7950248e198e8d89a91624f242a99.svg" width="109" height="53"/><p>Часто полагают, что "наилучшим" является многочлен, сумма квадратов отклонений<sup> </sup>которого от заданных точек минимальна:</p><img class="formula" source="\lbrace a_j \rbrace = \arg \min \sum_{i=1}^N (p(x_i)-y_i)^2" alt="\lbrace a_j \rbrace = \arg \min \sum_{i=1}^N (p(x_i)-y_i)^2" src="https://habrastorage.org/getpro/habr/upload_files/f35/cca/b65/f35ccab659c08f6f6738cc07d85af9e6.svg" width="221" height="51"/><p>В таком виде задача решается широко известным <a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%BD%D0%B0%D0%B8%D0%BC%D0%B5%D0%BD%D1%8C%D1%88%D0%B8%D1%85_%D0%BA%D0%B2%D0%B0%D0%B4%D1%80%D0%B0%D1%82%D0%BE%D0%B2#%D0%A1%D0%BB%D1%83%D1%87%D0%B0%D0%B9_%D0%BF%D0%BE%D0%BB%D0%B8%D0%BD%D0%BE%D0%BC%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8" rel="noopener noreferrer nofollow">методом наименьших квадратов</a> (МНК).</p><p>При M&lt;N-1 многочлен p(x), вообще говоря, не проходит через все заданные точки (x<sub>i</sub>, y<sub>i</sub>) (рис. 1). Более того, часто оказывается, что он не проходит ни через одну из них.</p><p>Само по себе это не плохо. Обычно данные, по которым строится приближение, содержат погрешности измерений. Даже лучше, что многочлен не проходит через все точки, так как при этом ошибки измерений сглаживаются.</p><p>Однако бывает, что о моделируемой зависимости имеются дополнительные сведения. Например, моделируется отклик датчика на некую величину. И из физических соображений ясно, что этот отклик строго равен нулю при равенстве нулю величины. При моделировании характеристики такого датчика может оказаться, что аппроксимирующий многочлен не пройдет через нуль. В результате модель  даст большую погрешность в районе нуля.</p><p>В такой ситуации хотелось бы найти многочлен со следующими свойствами:</p><ol><li><p>Точно проходит через нуль</p></li><li><p>Имеет наименьшую сумму квадратов отклонений от остальных измеренных значений</p></li></ol><p>В статье описывается метод, позволяющий найти такой многочлен. Более того, можно потребовать точного прохождения многочлена не через одну, а несколько выделенных точек.</p><h2>2. Решение</h2><h3>2.1. Взвешенный метод наименьших квадратов</h3><p>Как ингредиент нам потребуется <a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%BD%D0%B0%D0%B8%D0%BC%D0%B5%D0%BD%D1%8C%D1%88%D0%B8%D1%85_%D0%BA%D0%B2%D0%B0%D0%B4%D1%80%D0%B0%D1%82%D0%BE%D0%B2#%D0%92%D0%B7%D0%B2%D0%B5%D1%88%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_%D0%9C%D0%9D%D0%9A" rel="noopener noreferrer nofollow">взвешенный метод наименьших квадратов</a>, который минимизирует сумму квадратов отклонений с весовыми коэффициентами в каждой точке:</p><img class="formula" source="\lbrace a_j \rbrace = \arg \min \sum_{i=1}^N{w_i (p(x_i)-y_i)^2}" alt="\lbrace a_j \rbrace = \arg \min \sum_{i=1}^N{w_i (p(x_i)-y_i)^2}" src="https://habrastorage.org/getpro/habr/upload_files/7e8/6d3/11a/7e86d311a1415d1b8546ae1cbc8b3e8f.svg" width="241" height="51"/><p>Где w<sub>i</sub> - весовые коэффициенты. Обычно взвешенный МНК используется для учета погрешностей измерений в каждой точке, поэтому в литературе часто используют не понятие веса, а обратную дисперсию σ<sup>2</sup> погрешностей:</p><img class="formula" source="w_i={1 \over \sigma_i ^ 2}" alt="w_i={1 \over \sigma_i ^ 2}" src="https://habrastorage.org/getpro/habr/upload_files/ca8/f8a/646/ca8f8a646f537177de7dc8f392209b56.svg" width="61" height="43"/><p>Взвешенный МНК хорошо описан в книге [1], гл. 15.1, 15.4.</p><h3>2.2. Точное прохождение через нуль</h3><p>Начнём с простого случая: потребуем точного прохождения многочлена p(x) через нуль.</p><p>Для этого найдём многочлен q(x) степени M-1 по модифицированным точкам (x<sub>i</sub>, y<sub>i</sub>/x<sub>i</sub>) с помощью взвешеннго МНК, выбрав в качестве весов w<sub>i</sub>=x<sub>i</sub><sup>2</sup>; и умножим его на x. Тогда:</p><img class="formula" source="p(x)=x q(x)" alt="p(x)=x q(x)" src="https://habrastorage.org/getpro/habr/upload_files/04b/4a7/c4b/04b4a7c4b71f2a4a714039b5134698c5.svg" width="91" height="20"/><p>Он будет иметь степень M и точно проходить через нуль.</p><p>Рассмотрим сумму квадратов его отклонений от остальных точек (x<sub>i</sub>, y<sub>i</sub>):</p><img class="formula" source="\sum_{i=1}^N (p( x_i )-y_i) ^ 2 = \sum_{i=1}^N ( x_i q(x_i ) - y_i)^2=\sum_{i=1}^N x_i ^ 2 \left( q(x_i ) - {y_i \over x_i}\right)^2" alt="\sum_{i=1}^N (p( x_i )-y_i) ^ 2 = \sum_{i=1}^N ( x_i q(x_i ) - y_i)^2=\sum_{i=1}^N x_i ^ 2 \left( q(x_i ) - {y_i \over x_i}\right)^2" src="https://habrastorage.org/getpro/habr/upload_files/da2/9bd/3c5/da29bd3c54f510286930caef7e57ba00.svg" width="433" height="51"/><p>Но именно эта величина и минимизируется взвешенным МНК по модифицированным точкам. Поэтому многочлен p(x) будет соответствовать и второму условию задачи - иметь наименьшую сумму квадратов отклонений от (x<sub>i</sub>, y<sub>i</sub>).</p><h3>2.3. Точное прохождение через одну произвольную точку</h3><p>Усложним задачу и потребуем точного прохождения многочлена p(x) через одну произвольно заданную точку (ξ,η).</p><p>Путём замены переменных u=x-ξ, v=y-η, задача сводится к рассмотренной выше. Находим коэффициенты многочлена p<sub>0</sub>(u), проходящего через нуль и имеющего наименьшую сумму квадратов отклонений p<sub>0</sub>(u<sub>i</sub>)-v<sub>i</sub>. Далее переходим к исходным переменным:</p><img class="formula" source="p( x )=p_0( x-\xi)+\eta \tag{1}" alt="p( x )=p_0( x-\xi)+\eta \tag{1}" src="https://habrastorage.org/getpro/habr/upload_files/120/52b/c4a/12052bc4a18420663bb109fc2b19ee60.svg" width="733" height="20"/><p>Для нахождения коэффициентов p(x) можно провести алгебраические манипуляции с коэффициентами p<sub>0</sub>(x-ξ), но есть и более простой на практике способ. Поскольку у нас в программе уже имеется реализация обычного МНК, то можно просто вычислить значения p(x) по формуле (1) в каких-нибудь M+1 или более точках, и применить к этим значениям обычный МНК, задав степень многочлена M. Тем самым и будут найдены коэффициенты p(x).</p><h3>2.4. Точное прохождение через несколько точек</h3><p>И, наконец, самый общий случай - потребуем точного прохождения многочлена p(x) через K заданных точек (ξ<sub>i</sub>, η<sub>i</sub>). Следует выбирать K ≤ M, в противном случае задача вырождается в интерполяцию.</p><p>Переходя к решению, введем многочлен z(x) степени K:</p><img class="formula" source="z( x)=(x-\xi_1 )( x-\xi_2 ) ... ( x-\xi_K )" alt="z( x)=(x-\xi_1 )( x-\xi_2 ) ... ( x-\xi_K )" src="https://habrastorage.org/getpro/habr/upload_files/016/436/03a/01643603ad66c827f584987d370edfad.svg" width="247" height="20"/><p>Он имеет нули в точках ξ<sub>1</sub>, ξ<sub>2</sub>, ... ξ<sub>K</sub>.</p><p>Также введем <a href="https://ru.wikipedia.org/wiki/%D0%98%D0%BD%D1%82%D0%B5%D1%80%D0%BF%D0%BE%D0%BB%D1%8F%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D1%8B%D0%B9_%D0%BC%D0%BD%D0%BE%D0%B3%D0%BE%D1%87%D0%BB%D0%B5%D0%BD_%D0%9B%D0%B0%D0%B3%D1%80%D0%B0%D0%BD%D0%B6%D0%B0" rel="noopener noreferrer nofollow">интерполяционный многочлен Лагранжа</a> L(x) степени K-1, проходящий через точки (ξ<sub>i</sub>, η<sub>i</sub>) [1], гл. 3.1.</p><p>Используем взвешенный МНК для нахождения многочлена q(x) степени M-K по модифицированным точкам: (x<sub>i</sub>, (y<sub>i</sub>-L(x<sub>i</sub>))/z(x<sub>i</sub>)) с весовыми коэффициентами w<sub>i</sub>=z(x<sub>i</sub>)<sup>2</sup>. Получим коэффициенты {a<sub>j</sub>} для q(x), которые минимизируют сумму:</p><img class="formula" source="\lbrace a_j \rbrace = \arg \min \sum_{i=1}^N {z(x_i) ^ 2 \left(q( x_i ) - {{y_i - L(x_i)} \over {z(x_i)}}  \right) ^ 2} \tag{2}" alt="\lbrace a_j \rbrace = \arg \min \sum_{i=1}^N {z(x_i) ^ 2 \left(q( x_i ) - {{y_i - L(x_i)} \over {z(x_i)}}  \right) ^ 2} \tag{2}" src="https://habrastorage.org/getpro/habr/upload_files/969/f2b/8c4/969f2b8c4016bcd1d26a6fc64b19f510.svg" width="733" height="50"/><p>Теперь составим многочлен p(x) как:</p><img class="formula" source="p( x ) = q( x) z(x)+L(x) \tag{3}" alt="p( x ) = q( x) z(x)+L(x) \tag{3}" src="https://habrastorage.org/getpro/habr/upload_files/7fc/583/f49/7fc583f49d9ed1e4b0de464f3016f57e.svg" width="733" height="20"/><p>Докажем, что p(x) является решением задачи.</p><ol><li><p>Прохождение через точки (ξ<sub>i</sub>, η<sub>i</sub>) обеспечивается тем, что z(ξ<sub>i</sub>)=0, обращая в нуль первое слагаемое. Второе слагаемое в этих же точках, L(x), проходит через (ξ<sub>i</sub>, η<sub>i</sub>) по построению.</p></li><li><p>Степень p(x) равна M, так как степень произведения многочленов q(x) и z(x) равна сумме степеней множителей. В данном случае M-K+K=M. Сумма же многочленов имеет степень старшего из слагаемых. Степень L(x) равна K-1, что по условию меньше M.</p></li><li><p>Запишем сумму квадратов отклонений в точках (x<sub>i</sub>, y<sub>i</sub>):</p></li></ol><img class="formula" source="\sum_{i=1}^N (p( x_i )-y_i) ^ 2 = \sum_{i=1}^N (q(x_i)z(x_i)+L(x_i)-y_i) ^ 2=\sum_{i=1}^N z(x_i)^2 \left(q(x_i)+{{L(x_i)-y_i} \over {z(x_i)}} \right) ^ 2" alt="\sum_{i=1}^N (p( x_i )-y_i) ^ 2 = \sum_{i=1}^N (q(x_i)z(x_i)+L(x_i)-y_i) ^ 2=\sum_{i=1}^N z(x_i)^2 \left(q(x_i)+{{L(x_i)-y_i} \over {z(x_i)}} \right) ^ 2" src="https://habrastorage.org/getpro/habr/upload_files/7d4/a84/8ae/7d4a848ae9084301f1af420adb29e45e.svg" width="595" height="51"/><p>Но это совпадает с величиной (2), которая минимизировалась при нахождении коэффициентов q(x). Следовательно, p(x<sub>i</sub>) имеет наименьшую сумму квадратов отклонений от y<sub>i</sub>. Что и требовалось доказать.</p><p>Для нахождения коэффициентов p(x) можно провести алгебраические манипуляции с q(x), z(x) и L(x), но это еще сложнее, чем в разделе 2.3. выше. Так что здесь тоже рекомендуется вычислить значения p(x) в M+1 или более точках по формуле (3) и применить к ним обычный МНК.</p><h2>3. Цена вопроса и рекомендации к применению</h2><p>За всё в этой жизни приходится платить. Наложение условия точного прохождения через точки (ξ<sub>i</sub>, η<sub>i</sub>) на многочлен p(x) приводит к тому, что сумма квадратов его отклонений от остальных точек (x<sub>i</sub>, y<sub>i</sub>) оказывается, вообще говоря, выше, чем без наложения условий.</p><p>Фактически, мы решили задачу условной оптимизации суммы квадратов отклонений p(x<sub>i</sub>)-y<sub>i</sub>. Как и в других задачах условной оптимизации, достигаемое значение целевой функции получается хуже, чем при оптимизации безусловной. В противном случае и безусловная оптимизация дала бы тот же результат.</p><p>Когда же следует применять описанный метод? Тогда, когда о моделируемой зависимости имеются "железобетонные" сведения, что она должна проходить через точки (ξ<sub>i</sub>, η<sub>i</sub>) независимо от экспериментальных данных (x<sub>i</sub>, y<sub>i</sub>).</p><p>В моей практике был один такой случай. Моделировалась нелинейная характеристика датчика. Истинный вид функциональной зависимости был неизвестен. Оставалось только использовать многочлены в попытке хоть как-то компенсировать нелинейность. Но многочлены плохо описывали характеристику около нуля. Полученные обычным МНК, они стремились не проходить через нуль. Тем не менее, из физических соображений было ясно, что характеристика датчика должна проходить через нуль. Вот тогда наложение условия и пригодилось. Его применение позволило улучшить компенсацию нелинейности в окрестностях нуля и уменьшить относительную погрешность прибора в целом.</p><h2>4. Пример с конкретными числами</h2><p>Этот пример был использован для построения графиков, приведенных на рис. 1 и рис. 2.</p><p>В качестве "истинной зависимости" был взят следующий многочлен:</p><img class="formula" source="p_1(x)={{T_3(2x-1)+1} \over 2}" alt="p_1(x)={{T_3(2x-1)+1} \over 2}" src="https://habrastorage.org/getpro/habr/upload_files/df8/504/9e6/df85049e6820f71a1ca4aad54897cf61.svg" width="169" height="39"/><p>Где T<sub>3</sub>(x) - <a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%BD%D0%BE%D0%B3%D0%BE%D1%87%D0%BB%D0%B5%D0%BD%D1%8B_%D0%A7%D0%B5%D0%B1%D1%8B%D1%88%D1%91%D0%B2%D0%B0" rel="noopener noreferrer nofollow">многочлен Чебышева</a> третьего порядка. Модификации применены к нему для того, чтобы отобразить интересный участок графика в диапазон x,y ∈ [0; 1]. p<sub>1</sub>(x) проходит через точки (0,0) и (1,1). Разложение его по степеням x выглядит так:</p><img class="formula" source="p_1(x)=16 x^3 - 24 x^2 + 9 x" alt="p_1(x)=16 x^3 - 24 x^2 + 9 x" src="https://habrastorage.org/getpro/habr/upload_files/1b0/32b/b81/1b032bb81b69106f7b1cc018244df7f0.svg" width="183" height="22"/><p>В качестве данных для метода наименьших квадратов (обычного и условного) взяты значения p<sub>1</sub>(x) в 11 равноотстоящих точках между 0 и 1 с шагом в 0,1. К значениям многочлена была добавлена нормально распределенная "ошибка измерений" δ<sub>i</sub> с дисперсией σ<sup>2</sup>=0,04. В точках x<sub>1</sub>=0 и x<sub>11</sub>=1 ошибка не добавлялась. По случайным числам карты легли следующим образом:</p><div class="table"><table><tbody><tr><td data-colwidth="50" width="50"><p>i</p></td><td><p>1</p></td><td data-colwidth="95" width="95"><p>2</p></td><td data-colwidth="86" width="86"><p>3</p></td><td data-colwidth="86" width="86"><p>4</p></td><td data-colwidth="91" width="91"><p>5</p></td><td data-colwidth="85" width="85"><p>6</p></td><td data-colwidth="84" width="84"><p>7</p></td><td data-colwidth="93" width="93"><p>8</p></td><td data-colwidth="90" width="90"><p>9</p></td><td data-colwidth="91" width="91"><p>10</p></td><td><p>11</p></td></tr><tr><td data-colwidth="50" width="50"><p>x<sub>i</sub></p></td><td><p>0</p></td><td data-colwidth="95" width="95"><p>0,1</p></td><td data-colwidth="86" width="86"><p>0,2</p></td><td data-colwidth="86" width="86"><p>0,3</p></td><td data-colwidth="91" width="91"><p>0,4</p></td><td data-colwidth="85" width="85"><p>0,5</p></td><td data-colwidth="84" width="84"><p>0,6</p></td><td data-colwidth="93" width="93"><p>0,7</p></td><td data-colwidth="90" width="90"><p>0,8</p></td><td data-colwidth="91" width="91"><p>0,9</p></td><td><p>1</p></td></tr><tr><td data-colwidth="50" width="50"><p>δ<sub>i</sub></p></td><td><p>0</p></td><td data-colwidth="95" width="95"><p>-0,1617</p></td><td data-colwidth="86" width="86"><p>0,0162</p></td><td data-colwidth="86" width="86"><p>0,0294</p></td><td data-colwidth="91" width="91"><p>-0,0458</p></td><td data-colwidth="85" width="85"><p>0,3358</p></td><td data-colwidth="84" width="84"><p>0,2476</p></td><td data-colwidth="93" width="93"><p>-0,1325</p></td><td data-colwidth="90" width="90"><p>-0,3986</p></td><td data-colwidth="91" width="91"><p>-0,4477</p></td><td><p>0</p></td></tr></tbody></table></div><p>Приближение обычным МНК по заданным точкам при M=3 дало следующие коэффициенты:</p><img class="formula" source="p_2( x )=18,0318x^3 - 27,9602x^2 + 10,8547x -0,1507" alt="p_2( x )=18,0318x^3 - 27,9602x^2 + 10,8547x -0,1507" src="https://habrastorage.org/getpro/habr/upload_files/f77/35e/c9b/f7735ec9b1a623d56ff69d3db1a98d3a.svg" width="378" height="22"/><p>График p<sub>2</sub>(x) изображен на рис. 1. Достигнутая сумма квадратов отклонений p<sub>2</sub>(x)-y<sub>i</sub> составила 0,4019.</p><p>Для испытания описываемого в разд. 2.4. метода было поставлено условие точного прохождения многочлена через точки (0,0) и (1,1), а в остальных точках - минимизация суммы квадратов отклонений. В результате был получен следующий многочлен:</p><img class="formula" source="p_3(x)=18,5227x^3 - 27,7681x^2 + 10,2454x" alt="p_3(x)=18,5227x^3 - 27,7681x^2 + 10,2454x" src="https://habrastorage.org/getpro/habr/upload_files/72a/8ed/978/72a8ed9789ba1416f431af5f72c948f9.svg" width="310" height="22"/><p>Его график изображен на рис. 2. Достигнутая сумма квадратов отклонений p<sub>3</sub>(x)-y<sub>i</sub> составила 0,5046.</p><p>Из приведенного примера можно сделать вывод, что теоретические выкладки подтвердились. Был найден многочлен p<sub>3</sub>(x), приближающий "экспериментальные данные" и проходящий через точки (0,0) и (1,1). Как предсказывалось в разд. 3, сумма квадратов его отклонений от точек (x<sub>i</sub>, y<sub>i</sub>) оказалась больше, чем у многочлена p<sub>2</sub>(x), найденного обычным МНК. Тем не менее, эта жертва может быть оправданной, если прохождение p<sub>3</sub>(x) через точки (0,0) и (1,1) важнее.</p><p>Что касается совпадения коэффициентов многочленов p<sub>2</sub>(x) и p<sub>3</sub>(x) с коэффициентами "истинного" многочлена p<sub>1</sub>(x) - то на паре-тройке наборов тестовых данных особой закономерности не выявилось. Наверное, есть смысл провести тест Монте-Карло и сравнить распределения коэффициентов p<sub>2</sub>(x) и p<sub>3</sub>(x) на большой выборке.</p><h2>Заключение</h2><p>В статье был получено обобщение метода наименьших квадратов, позволяющее налагать на многочлен условие прохождения через заданные точки.</p><p>Задачу удалось свести к применению взвешенного метода наименьших квадратов и интерполяции многочленом Лагранжа. Поскольку обе операции сводятся к решению системы линейных уравнений, то и описанный в статье метод сохраняет эту (невысокую) вычислительную сложность. Точное решение можно получить за конечное число действий и (при должной усидчивости или использовании систем компьютерной алгебры) выразить аналитически.</p><p>Возможны обобщения метода для задач приближения не только многочленами, а и другими функциями. Но эта тема обширна и может быть рассмотрена только в отдельных публикациях.</p><h2>Литература</h2><p>[1] William H. Press и др. "Numerical Recipes in C++: The Art of Scientific Computing", Second Edition. Cambridge University Press, ISBN 0-521-75033-4</p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%20%D0%BD%D0%B0%D0%B8%D0%BC%D0%B5%D0%BD%D1%8C%D1%88%D0%B8%D1%85%20%D0%BA%D0%B2%D0%B0%D0%B4%D1%80%D0%B0%D1%82%D0%BE%D0%B2%5D" class="tm-tags-list__link">метод наименьших квадратов</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%83%D1%81%D0%BB%D0%BE%D0%B2%D0%BD%D0%B0%D1%8F%20%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%5D" class="tm-tags-list__link">условная оптимизация</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BC%D0%BD%D0%BE%D0%B3%D0%BE%D1%87%D0%BB%D0%B5%D0%BD%D1%8B%5D" class="tm-tags-list__link">многочлены</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/algorithms/" class="tm-hubs-list__link">
    Алгоритмы
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/maths/" class="tm-hubs-list__link">
    Математика
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/machine_learning/" class="tm-hubs-list__link">
    Машинное обучение
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 21: ↑18 и ↓3</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 21: ↑18 и ↓3" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+15</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.4K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    39
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/MichaelBorisov/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 172 голоса " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    106.5
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">15.2</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Михаил Борисов</span> <a href="/ru/users/MichaelBorisov/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @MichaelBorisov
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/583988/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 28 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/583988/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/583988/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"583988":{"id":"583988","timePublished":"2021-10-18T18:41:34+00:00","isCorporative":false,"lang":"ru","titleHtml":"Приближение многочленом с условием прохождения через точки","leadData":{"textHtml":"\u003Cp\u003EПри моделировании данных методом наименьших квадратов, кривая обычно не проходит через точки измерений (рис. 1).\u003C\u002Fp\u003E\u003Cp\u003EЧто, если нужно, чтобы эта кривая точно проходила через одну или несколько особо выделенных точек (рис. 2)?\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7d9\u002F6eb\u002F092\u002F7d96eb0924a929fe6869492c1b94bcbc.png","buttonTextHtml":"Тогда читаем дальше","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7d9\u002F6eb\u002F092\u002F7d96eb0924a929fe6869492c1b94bcbc.png","fit":"cover","positionY":0,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":106.5,"votesCount":172},"rating":15.2,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"205363","alias":"MichaelBorisov","fullname":"Михаил Борисов","avatarUrl":null,"speciality":null},"statistics":{"commentsCount":28,"favoritesCount":39,"readingCount":3353,"score":15,"votesCount":21},"hubs":[{"relatedData":null,"id":"8000","alias":"algorithms","type":"collective","title":"Алгоритмы","titleHtml":"Алгоритмы","isProfiled":true},{"relatedData":null,"id":"17812","alias":"maths","type":"collective","title":"Математика","titleHtml":"Математика","isProfiled":true},{"relatedData":null,"id":"19439","alias":"machine_learning","type":"collective","title":"Машинное обучение","titleHtml":"Машинное обучение","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EПри моделировании данных методом наименьших квадратов, кривая обычно не проходит через точки измерений (рис. 1).\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"715\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7d9\u002F6eb\u002F092\u002F7d96eb0924a929fe6869492c1b94bcbc.png\" data-width=\"1237\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EЧто, если нужно, чтобы эта кривая точно проходила через одну или несколько особо выделенных точек (рис. 2 - показаны зелёными кружочками)?\u003C\u002Fp\u003E\u003Cp\u003EТогда читаем дальше.\u003C\u002Fp\u003E\u003Ch2\u003E1. Мотивация\u003C\u002Fh2\u003E\u003Cp\u003EРассмотрим обычную задачу приближения многочленом и посмотрим, чего нам в ней не хватает.\u003C\u002Fp\u003E\u003Cp\u003EДано N точек на плоскости (x\u003Csub\u003Ei\u003C\u002Fsub\u003E,y\u003Csub\u003Ei\u003C\u002Fsub\u003E) - значения неизвестной функции f(x). Требуется найти многочлен p(x) степени M (M&lt;N), наилучшим образом приближающий эту функцию.\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"p(x)=\\sum_{j=0}^M {a_j x^j}\" alt=\"p(x)=\\sum_{j=0}^M {a_j x^j}\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb9c\u002F795\u002F024\u002Fb9c7950248e198e8d89a91624f242a99.svg\" width=\"109\" height=\"53\"\u002F\u003E\u003Cp\u003EЧасто полагают, что \"наилучшим\" является многочлен, сумма квадратов отклонений\u003Csup\u003E \u003C\u002Fsup\u003Eкоторого от заданных точек минимальна:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"\\lbrace a_j \\rbrace = \\arg \\min \\sum_{i=1}^N (p(x_i)-y_i)^2\" alt=\"\\lbrace a_j \\rbrace = \\arg \\min \\sum_{i=1}^N (p(x_i)-y_i)^2\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff35\u002Fcca\u002Fb65\u002Ff35ccab659c08f6f6738cc07d85af9e6.svg\" width=\"221\" height=\"51\"\u002F\u003E\u003Cp\u003EВ таком виде задача решается широко известным \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%BD%D0%B0%D0%B8%D0%BC%D0%B5%D0%BD%D1%8C%D1%88%D0%B8%D1%85_%D0%BA%D0%B2%D0%B0%D0%B4%D1%80%D0%B0%D1%82%D0%BE%D0%B2#%D0%A1%D0%BB%D1%83%D1%87%D0%B0%D0%B9_%D0%BF%D0%BE%D0%BB%D0%B8%D0%BD%D0%BE%D0%BC%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D0%B8\" rel=\"noopener noreferrer nofollow\"\u003Eметодом наименьших квадратов\u003C\u002Fa\u003E (МНК).\u003C\u002Fp\u003E\u003Cp\u003EПри M&lt;N-1 многочлен p(x), вообще говоря, не проходит через все заданные точки (x\u003Csub\u003Ei\u003C\u002Fsub\u003E, y\u003Csub\u003Ei\u003C\u002Fsub\u003E) (рис. 1). Более того, часто оказывается, что он не проходит ни через одну из них.\u003C\u002Fp\u003E\u003Cp\u003EСамо по себе это не плохо. Обычно данные, по которым строится приближение, содержат погрешности измерений. Даже лучше, что многочлен не проходит через все точки, так как при этом ошибки измерений сглаживаются.\u003C\u002Fp\u003E\u003Cp\u003EОднако бывает, что о моделируемой зависимости имеются дополнительные сведения. Например, моделируется отклик датчика на некую величину. И из физических соображений ясно, что этот отклик строго равен нулю при равенстве нулю величины. При моделировании характеристики такого датчика может оказаться, что аппроксимирующий многочлен не пройдет через нуль. В результате модель  даст большую погрешность в районе нуля.\u003C\u002Fp\u003E\u003Cp\u003EВ такой ситуации хотелось бы найти многочлен со следующими свойствами:\u003C\u002Fp\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003EТочно проходит через нуль\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EИмеет наименьшую сумму квадратов отклонений от остальных измеренных значений\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp\u003EВ статье описывается метод, позволяющий найти такой многочлен. Более того, можно потребовать точного прохождения многочлена не через одну, а несколько выделенных точек.\u003C\u002Fp\u003E\u003Ch2\u003E2. Решение\u003C\u002Fh2\u003E\u003Ch3\u003E2.1. Взвешенный метод наименьших квадратов\u003C\u002Fh3\u003E\u003Cp\u003EКак ингредиент нам потребуется \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%BD%D0%B0%D0%B8%D0%BC%D0%B5%D0%BD%D1%8C%D1%88%D0%B8%D1%85_%D0%BA%D0%B2%D0%B0%D0%B4%D1%80%D0%B0%D1%82%D0%BE%D0%B2#%D0%92%D0%B7%D0%B2%D0%B5%D1%88%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_%D0%9C%D0%9D%D0%9A\" rel=\"noopener noreferrer nofollow\"\u003Eвзвешенный метод наименьших квадратов\u003C\u002Fa\u003E, который минимизирует сумму квадратов отклонений с весовыми коэффициентами в каждой точке:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"\\lbrace a_j \\rbrace = \\arg \\min \\sum_{i=1}^N{w_i (p(x_i)-y_i)^2}\" alt=\"\\lbrace a_j \\rbrace = \\arg \\min \\sum_{i=1}^N{w_i (p(x_i)-y_i)^2}\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7e8\u002F6d3\u002F11a\u002F7e86d311a1415d1b8546ae1cbc8b3e8f.svg\" width=\"241\" height=\"51\"\u002F\u003E\u003Cp\u003EГде w\u003Csub\u003Ei\u003C\u002Fsub\u003E - весовые коэффициенты. Обычно взвешенный МНК используется для учета погрешностей измерений в каждой точке, поэтому в литературе часто используют не понятие веса, а обратную дисперсию σ\u003Csup\u003E2\u003C\u002Fsup\u003E погрешностей:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"w_i={1 \\over \\sigma_i ^ 2}\" alt=\"w_i={1 \\over \\sigma_i ^ 2}\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fca8\u002Ff8a\u002F646\u002Fca8f8a646f537177de7dc8f392209b56.svg\" width=\"61\" height=\"43\"\u002F\u003E\u003Cp\u003EВзвешенный МНК хорошо описан в книге [1], гл. 15.1, 15.4.\u003C\u002Fp\u003E\u003Ch3\u003E2.2. Точное прохождение через нуль\u003C\u002Fh3\u003E\u003Cp\u003EНачнём с простого случая: потребуем точного прохождения многочлена p(x) через нуль.\u003C\u002Fp\u003E\u003Cp\u003EДля этого найдём многочлен q(x) степени M-1 по модифицированным точкам (x\u003Csub\u003Ei\u003C\u002Fsub\u003E, y\u003Csub\u003Ei\u003C\u002Fsub\u003E\u002Fx\u003Csub\u003Ei\u003C\u002Fsub\u003E) с помощью взвешеннго МНК, выбрав в качестве весов w\u003Csub\u003Ei\u003C\u002Fsub\u003E=x\u003Csub\u003Ei\u003C\u002Fsub\u003E\u003Csup\u003E2\u003C\u002Fsup\u003E; и умножим его на x. Тогда:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"p(x)=x q(x)\" alt=\"p(x)=x q(x)\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F04b\u002F4a7\u002Fc4b\u002F04b4a7c4b71f2a4a714039b5134698c5.svg\" width=\"91\" height=\"20\"\u002F\u003E\u003Cp\u003EОн будет иметь степень M и точно проходить через нуль.\u003C\u002Fp\u003E\u003Cp\u003EРассмотрим сумму квадратов его отклонений от остальных точек (x\u003Csub\u003Ei\u003C\u002Fsub\u003E, y\u003Csub\u003Ei\u003C\u002Fsub\u003E):\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"\\sum_{i=1}^N (p( x_i )-y_i) ^ 2 = \\sum_{i=1}^N ( x_i q(x_i ) - y_i)^2=\\sum_{i=1}^N x_i ^ 2 \\left( q(x_i ) - {y_i \\over x_i}\\right)^2\" alt=\"\\sum_{i=1}^N (p( x_i )-y_i) ^ 2 = \\sum_{i=1}^N ( x_i q(x_i ) - y_i)^2=\\sum_{i=1}^N x_i ^ 2 \\left( q(x_i ) - {y_i \\over x_i}\\right)^2\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fda2\u002F9bd\u002F3c5\u002Fda29bd3c54f510286930caef7e57ba00.svg\" width=\"433\" height=\"51\"\u002F\u003E\u003Cp\u003EНо именно эта величина и минимизируется взвешенным МНК по модифицированным точкам. Поэтому многочлен p(x) будет соответствовать и второму условию задачи - иметь наименьшую сумму квадратов отклонений от (x\u003Csub\u003Ei\u003C\u002Fsub\u003E, y\u003Csub\u003Ei\u003C\u002Fsub\u003E).\u003C\u002Fp\u003E\u003Ch3\u003E2.3. Точное прохождение через одну произвольную точку\u003C\u002Fh3\u003E\u003Cp\u003EУсложним задачу и потребуем точного прохождения многочлена p(x) через одну произвольно заданную точку (ξ,η).\u003C\u002Fp\u003E\u003Cp\u003EПутём замены переменных u=x-ξ, v=y-η, задача сводится к рассмотренной выше. Находим коэффициенты многочлена p\u003Csub\u003E0\u003C\u002Fsub\u003E(u), проходящего через нуль и имеющего наименьшую сумму квадратов отклонений p\u003Csub\u003E0\u003C\u002Fsub\u003E(u\u003Csub\u003Ei\u003C\u002Fsub\u003E)-v\u003Csub\u003Ei\u003C\u002Fsub\u003E. Далее переходим к исходным переменным:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"p( x )=p_0( x-\\xi)+\\eta \\tag{1}\" alt=\"p( x )=p_0( x-\\xi)+\\eta \\tag{1}\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F120\u002F52b\u002Fc4a\u002F12052bc4a18420663bb109fc2b19ee60.svg\" width=\"733\" height=\"20\"\u002F\u003E\u003Cp\u003EДля нахождения коэффициентов p(x) можно провести алгебраические манипуляции с коэффициентами p\u003Csub\u003E0\u003C\u002Fsub\u003E(x-ξ), но есть и более простой на практике способ. Поскольку у нас в программе уже имеется реализация обычного МНК, то можно просто вычислить значения p(x) по формуле (1) в каких-нибудь M+1 или более точках, и применить к этим значениям обычный МНК, задав степень многочлена M. Тем самым и будут найдены коэффициенты p(x).\u003C\u002Fp\u003E\u003Ch3\u003E2.4. Точное прохождение через несколько точек\u003C\u002Fh3\u003E\u003Cp\u003EИ, наконец, самый общий случай - потребуем точного прохождения многочлена p(x) через K заданных точек (ξ\u003Csub\u003Ei\u003C\u002Fsub\u003E, η\u003Csub\u003Ei\u003C\u002Fsub\u003E). Следует выбирать K ≤ M, в противном случае задача вырождается в интерполяцию.\u003C\u002Fp\u003E\u003Cp\u003EПереходя к решению, введем многочлен z(x) степени K:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"z( x)=(x-\\xi_1 )( x-\\xi_2 ) ... ( x-\\xi_K )\" alt=\"z( x)=(x-\\xi_1 )( x-\\xi_2 ) ... ( x-\\xi_K )\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F016\u002F436\u002F03a\u002F01643603ad66c827f584987d370edfad.svg\" width=\"247\" height=\"20\"\u002F\u003E\u003Cp\u003EОн имеет нули в точках ξ\u003Csub\u003E1\u003C\u002Fsub\u003E, ξ\u003Csub\u003E2\u003C\u002Fsub\u003E, ... ξ\u003Csub\u003EK\u003C\u002Fsub\u003E.\u003C\u002Fp\u003E\u003Cp\u003EТакже введем \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%98%D0%BD%D1%82%D0%B5%D1%80%D0%BF%D0%BE%D0%BB%D1%8F%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D1%8B%D0%B9_%D0%BC%D0%BD%D0%BE%D0%B3%D0%BE%D1%87%D0%BB%D0%B5%D0%BD_%D0%9B%D0%B0%D0%B3%D1%80%D0%B0%D0%BD%D0%B6%D0%B0\" rel=\"noopener noreferrer nofollow\"\u003Eинтерполяционный многочлен Лагранжа\u003C\u002Fa\u003E L(x) степени K-1, проходящий через точки (ξ\u003Csub\u003Ei\u003C\u002Fsub\u003E, η\u003Csub\u003Ei\u003C\u002Fsub\u003E) [1], гл. 3.1.\u003C\u002Fp\u003E\u003Cp\u003EИспользуем взвешенный МНК для нахождения многочлена q(x) степени M-K по модифицированным точкам: (x\u003Csub\u003Ei\u003C\u002Fsub\u003E, (y\u003Csub\u003Ei\u003C\u002Fsub\u003E-L(x\u003Csub\u003Ei\u003C\u002Fsub\u003E))\u002Fz(x\u003Csub\u003Ei\u003C\u002Fsub\u003E)) с весовыми коэффициентами w\u003Csub\u003Ei\u003C\u002Fsub\u003E=z(x\u003Csub\u003Ei\u003C\u002Fsub\u003E)\u003Csup\u003E2\u003C\u002Fsup\u003E. Получим коэффициенты {a\u003Csub\u003Ej\u003C\u002Fsub\u003E} для q(x), которые минимизируют сумму:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"\\lbrace a_j \\rbrace = \\arg \\min \\sum_{i=1}^N {z(x_i) ^ 2 \\left(q( x_i ) - {{y_i - L(x_i)} \\over {z(x_i)}}  \\right) ^ 2} \\tag{2}\" alt=\"\\lbrace a_j \\rbrace = \\arg \\min \\sum_{i=1}^N {z(x_i) ^ 2 \\left(q( x_i ) - {{y_i - L(x_i)} \\over {z(x_i)}}  \\right) ^ 2} \\tag{2}\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F969\u002Ff2b\u002F8c4\u002F969f2b8c4016bcd1d26a6fc64b19f510.svg\" width=\"733\" height=\"50\"\u002F\u003E\u003Cp\u003EТеперь составим многочлен p(x) как:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"p( x ) = q( x) z(x)+L(x) \\tag{3}\" alt=\"p( x ) = q( x) z(x)+L(x) \\tag{3}\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7fc\u002F583\u002Ff49\u002F7fc583f49d9ed1e4b0de464f3016f57e.svg\" width=\"733\" height=\"20\"\u002F\u003E\u003Cp\u003EДокажем, что p(x) является решением задачи.\u003C\u002Fp\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003EПрохождение через точки (ξ\u003Csub\u003Ei\u003C\u002Fsub\u003E, η\u003Csub\u003Ei\u003C\u002Fsub\u003E) обеспечивается тем, что z(ξ\u003Csub\u003Ei\u003C\u002Fsub\u003E)=0, обращая в нуль первое слагаемое. Второе слагаемое в этих же точках, L(x), проходит через (ξ\u003Csub\u003Ei\u003C\u002Fsub\u003E, η\u003Csub\u003Ei\u003C\u002Fsub\u003E) по построению.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСтепень p(x) равна M, так как степень произведения многочленов q(x) и z(x) равна сумме степеней множителей. В данном случае M-K+K=M. Сумма же многочленов имеет степень старшего из слагаемых. Степень L(x) равна K-1, что по условию меньше M.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EЗапишем сумму квадратов отклонений в точках (x\u003Csub\u003Ei\u003C\u002Fsub\u003E, y\u003Csub\u003Ei\u003C\u002Fsub\u003E):\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cimg class=\"formula\" source=\"\\sum_{i=1}^N (p( x_i )-y_i) ^ 2 = \\sum_{i=1}^N (q(x_i)z(x_i)+L(x_i)-y_i) ^ 2=\\sum_{i=1}^N z(x_i)^2 \\left(q(x_i)+{{L(x_i)-y_i} \\over {z(x_i)}} \\right) ^ 2\" alt=\"\\sum_{i=1}^N (p( x_i )-y_i) ^ 2 = \\sum_{i=1}^N (q(x_i)z(x_i)+L(x_i)-y_i) ^ 2=\\sum_{i=1}^N z(x_i)^2 \\left(q(x_i)+{{L(x_i)-y_i} \\over {z(x_i)}} \\right) ^ 2\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7d4\u002Fa84\u002F8ae\u002F7d4a848ae9084301f1af420adb29e45e.svg\" width=\"595\" height=\"51\"\u002F\u003E\u003Cp\u003EНо это совпадает с величиной (2), которая минимизировалась при нахождении коэффициентов q(x). Следовательно, p(x\u003Csub\u003Ei\u003C\u002Fsub\u003E) имеет наименьшую сумму квадратов отклонений от y\u003Csub\u003Ei\u003C\u002Fsub\u003E. Что и требовалось доказать.\u003C\u002Fp\u003E\u003Cp\u003EДля нахождения коэффициентов p(x) можно провести алгебраические манипуляции с q(x), z(x) и L(x), но это еще сложнее, чем в разделе 2.3. выше. Так что здесь тоже рекомендуется вычислить значения p(x) в M+1 или более точках по формуле (3) и применить к ним обычный МНК.\u003C\u002Fp\u003E\u003Ch2\u003E3. Цена вопроса и рекомендации к применению\u003C\u002Fh2\u003E\u003Cp\u003EЗа всё в этой жизни приходится платить. Наложение условия точного прохождения через точки (ξ\u003Csub\u003Ei\u003C\u002Fsub\u003E, η\u003Csub\u003Ei\u003C\u002Fsub\u003E) на многочлен p(x) приводит к тому, что сумма квадратов его отклонений от остальных точек (x\u003Csub\u003Ei\u003C\u002Fsub\u003E, y\u003Csub\u003Ei\u003C\u002Fsub\u003E) оказывается, вообще говоря, выше, чем без наложения условий.\u003C\u002Fp\u003E\u003Cp\u003EФактически, мы решили задачу условной оптимизации суммы квадратов отклонений p(x\u003Csub\u003Ei\u003C\u002Fsub\u003E)-y\u003Csub\u003Ei\u003C\u002Fsub\u003E. Как и в других задачах условной оптимизации, достигаемое значение целевой функции получается хуже, чем при оптимизации безусловной. В противном случае и безусловная оптимизация дала бы тот же результат.\u003C\u002Fp\u003E\u003Cp\u003EКогда же следует применять описанный метод? Тогда, когда о моделируемой зависимости имеются \"железобетонные\" сведения, что она должна проходить через точки (ξ\u003Csub\u003Ei\u003C\u002Fsub\u003E, η\u003Csub\u003Ei\u003C\u002Fsub\u003E) независимо от экспериментальных данных (x\u003Csub\u003Ei\u003C\u002Fsub\u003E, y\u003Csub\u003Ei\u003C\u002Fsub\u003E).\u003C\u002Fp\u003E\u003Cp\u003EВ моей практике был один такой случай. Моделировалась нелинейная характеристика датчика. Истинный вид функциональной зависимости был неизвестен. Оставалось только использовать многочлены в попытке хоть как-то компенсировать нелинейность. Но многочлены плохо описывали характеристику около нуля. Полученные обычным МНК, они стремились не проходить через нуль. Тем не менее, из физических соображений было ясно, что характеристика датчика должна проходить через нуль. Вот тогда наложение условия и пригодилось. Его применение позволило улучшить компенсацию нелинейности в окрестностях нуля и уменьшить относительную погрешность прибора в целом.\u003C\u002Fp\u003E\u003Ch2\u003E4. Пример с конкретными числами\u003C\u002Fh2\u003E\u003Cp\u003EЭтот пример был использован для построения графиков, приведенных на рис. 1 и рис. 2.\u003C\u002Fp\u003E\u003Cp\u003EВ качестве \"истинной зависимости\" был взят следующий многочлен:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"p_1(x)={{T_3(2x-1)+1} \\over 2}\" alt=\"p_1(x)={{T_3(2x-1)+1} \\over 2}\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdf8\u002F504\u002F9e6\u002Fdf85049e6820f71a1ca4aad54897cf61.svg\" width=\"169\" height=\"39\"\u002F\u003E\u003Cp\u003EГде T\u003Csub\u003E3\u003C\u002Fsub\u003E(x) - \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%9C%D0%BD%D0%BE%D0%B3%D0%BE%D1%87%D0%BB%D0%B5%D0%BD%D1%8B_%D0%A7%D0%B5%D0%B1%D1%8B%D1%88%D1%91%D0%B2%D0%B0\" rel=\"noopener noreferrer nofollow\"\u003Eмногочлен Чебышева\u003C\u002Fa\u003E третьего порядка. Модификации применены к нему для того, чтобы отобразить интересный участок графика в диапазон x,y ∈ [0; 1]. p\u003Csub\u003E1\u003C\u002Fsub\u003E(x) проходит через точки (0,0) и (1,1). Разложение его по степеням x выглядит так:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"p_1(x)=16 x^3 - 24 x^2 + 9 x\" alt=\"p_1(x)=16 x^3 - 24 x^2 + 9 x\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1b0\u002F32b\u002Fb81\u002F1b032bb81b69106f7b1cc018244df7f0.svg\" width=\"183\" height=\"22\"\u002F\u003E\u003Cp\u003EВ качестве данных для метода наименьших квадратов (обычного и условного) взяты значения p\u003Csub\u003E1\u003C\u002Fsub\u003E(x) в 11 равноотстоящих точках между 0 и 1 с шагом в 0,1. К значениям многочлена была добавлена нормально распределенная \"ошибка измерений\" δ\u003Csub\u003Ei\u003C\u002Fsub\u003E с дисперсией σ\u003Csup\u003E2\u003C\u002Fsup\u003E=0,04. В точках x\u003Csub\u003E1\u003C\u002Fsub\u003E=0 и x\u003Csub\u003E11\u003C\u002Fsub\u003E=1 ошибка не добавлялась. По случайным числам карты легли следующим образом:\u003C\u002Fp\u003E\u003Cdiv class=\"table\"\u003E\u003Ctable\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"50\" width=\"50\"\u003E\u003Cp\u003Ei\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp\u003E1\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"95\" width=\"95\"\u003E\u003Cp\u003E2\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"86\" width=\"86\"\u003E\u003Cp\u003E3\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"86\" width=\"86\"\u003E\u003Cp\u003E4\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"91\" width=\"91\"\u003E\u003Cp\u003E5\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"85\" width=\"85\"\u003E\u003Cp\u003E6\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"84\" width=\"84\"\u003E\u003Cp\u003E7\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"93\" width=\"93\"\u003E\u003Cp\u003E8\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"90\" width=\"90\"\u003E\u003Cp\u003E9\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"91\" width=\"91\"\u003E\u003Cp\u003E10\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp\u003E11\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"50\" width=\"50\"\u003E\u003Cp\u003Ex\u003Csub\u003Ei\u003C\u002Fsub\u003E\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp\u003E0\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"95\" width=\"95\"\u003E\u003Cp\u003E0,1\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"86\" width=\"86\"\u003E\u003Cp\u003E0,2\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"86\" width=\"86\"\u003E\u003Cp\u003E0,3\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"91\" width=\"91\"\u003E\u003Cp\u003E0,4\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"85\" width=\"85\"\u003E\u003Cp\u003E0,5\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"84\" width=\"84\"\u003E\u003Cp\u003E0,6\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"93\" width=\"93\"\u003E\u003Cp\u003E0,7\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"90\" width=\"90\"\u003E\u003Cp\u003E0,8\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"91\" width=\"91\"\u003E\u003Cp\u003E0,9\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp\u003E1\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"50\" width=\"50\"\u003E\u003Cp\u003Eδ\u003Csub\u003Ei\u003C\u002Fsub\u003E\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp\u003E0\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"95\" width=\"95\"\u003E\u003Cp\u003E-0,1617\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"86\" width=\"86\"\u003E\u003Cp\u003E0,0162\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"86\" width=\"86\"\u003E\u003Cp\u003E0,0294\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"91\" width=\"91\"\u003E\u003Cp\u003E-0,0458\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"85\" width=\"85\"\u003E\u003Cp\u003E0,3358\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"84\" width=\"84\"\u003E\u003Cp\u003E0,2476\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"93\" width=\"93\"\u003E\u003Cp\u003E-0,1325\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"90\" width=\"90\"\u003E\u003Cp\u003E-0,3986\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"91\" width=\"91\"\u003E\u003Cp\u003E-0,4477\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp\u003E0\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\u003C\u002Fdiv\u003E\u003Cp\u003EПриближение обычным МНК по заданным точкам при M=3 дало следующие коэффициенты:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"p_2( x )=18,0318x^3 - 27,9602x^2 + 10,8547x -0,1507\" alt=\"p_2( x )=18,0318x^3 - 27,9602x^2 + 10,8547x -0,1507\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff77\u002F35e\u002Fc9b\u002Ff7735ec9b1a623d56ff69d3db1a98d3a.svg\" width=\"378\" height=\"22\"\u002F\u003E\u003Cp\u003EГрафик p\u003Csub\u003E2\u003C\u002Fsub\u003E(x) изображен на рис. 1. Достигнутая сумма квадратов отклонений p\u003Csub\u003E2\u003C\u002Fsub\u003E(x)-y\u003Csub\u003Ei\u003C\u002Fsub\u003E составила 0,4019.\u003C\u002Fp\u003E\u003Cp\u003EДля испытания описываемого в разд. 2.4. метода было поставлено условие точного прохождения многочлена через точки (0,0) и (1,1), а в остальных точках - минимизация суммы квадратов отклонений. В результате был получен следующий многочлен:\u003C\u002Fp\u003E\u003Cimg class=\"formula\" source=\"p_3(x)=18,5227x^3 - 27,7681x^2 + 10,2454x\" alt=\"p_3(x)=18,5227x^3 - 27,7681x^2 + 10,2454x\" src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F72a\u002F8ed\u002F978\u002F72a8ed9789ba1416f431af5f72c948f9.svg\" width=\"310\" height=\"22\"\u002F\u003E\u003Cp\u003EЕго график изображен на рис. 2. Достигнутая сумма квадратов отклонений p\u003Csub\u003E3\u003C\u002Fsub\u003E(x)-y\u003Csub\u003Ei\u003C\u002Fsub\u003E составила 0,5046.\u003C\u002Fp\u003E\u003Cp\u003EИз приведенного примера можно сделать вывод, что теоретические выкладки подтвердились. Был найден многочлен p\u003Csub\u003E3\u003C\u002Fsub\u003E(x), приближающий \"экспериментальные данные\" и проходящий через точки (0,0) и (1,1). Как предсказывалось в разд. 3, сумма квадратов его отклонений от точек (x\u003Csub\u003Ei\u003C\u002Fsub\u003E, y\u003Csub\u003Ei\u003C\u002Fsub\u003E) оказалась больше, чем у многочлена p\u003Csub\u003E2\u003C\u002Fsub\u003E(x), найденного обычным МНК. Тем не менее, эта жертва может быть оправданной, если прохождение p\u003Csub\u003E3\u003C\u002Fsub\u003E(x) через точки (0,0) и (1,1) важнее.\u003C\u002Fp\u003E\u003Cp\u003EЧто касается совпадения коэффициентов многочленов p\u003Csub\u003E2\u003C\u002Fsub\u003E(x) и p\u003Csub\u003E3\u003C\u002Fsub\u003E(x) с коэффициентами \"истинного\" многочлена p\u003Csub\u003E1\u003C\u002Fsub\u003E(x) - то на паре-тройке наборов тестовых данных особой закономерности не выявилось. Наверное, есть смысл провести тест Монте-Карло и сравнить распределения коэффициентов p\u003Csub\u003E2\u003C\u002Fsub\u003E(x) и p\u003Csub\u003E3\u003C\u002Fsub\u003E(x) на большой выборке.\u003C\u002Fp\u003E\u003Ch2\u003EЗаключение\u003C\u002Fh2\u003E\u003Cp\u003EВ статье был получено обобщение метода наименьших квадратов, позволяющее налагать на многочлен условие прохождения через заданные точки.\u003C\u002Fp\u003E\u003Cp\u003EЗадачу удалось свести к применению взвешенного метода наименьших квадратов и интерполяции многочленом Лагранжа. Поскольку обе операции сводятся к решению системы линейных уравнений, то и описанный в статье метод сохраняет эту (невысокую) вычислительную сложность. Точное решение можно получить за конечное число действий и (при должной усидчивости или использовании систем компьютерной алгебры) выразить аналитически.\u003C\u002Fp\u003E\u003Cp\u003EВозможны обобщения метода для задач приближения не только многочленами, а и другими функциями. Но эта тема обширна и может быть рассмотрена только в отдельных публикациях.\u003C\u002Fp\u003E\u003Ch2\u003EЛитература\u003C\u002Fh2\u003E\u003Cp\u003E[1] William H. Press и др. \"Numerical Recipes in C++: The Art of Scientific Computing\", Second Edition. Cambridge University Press, ISBN 0-521-75033-4\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"метод наименьших квадратов"},{"titleHtml":"условная оптимизация"},{"titleHtml":"многочлены"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7d9\u002F6eb\u002F092\u002F7d96eb0924a929fe6869492c1b94bcbc.png","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7d9\u002F6eb\u002F092\u002F7d96eb0924a929fe6869492c1b94bcbc.png","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F583988\\\u002F\"},\"headline\":\"Приближение многочленом с условием прохождения через точки\",\"datePublished\":\"2021-10-18T21:41:34+03:00\",\"dateModified\":\"2021-10-18T21:41:34+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Михаил Борисов\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"При моделировании данных методом наименьших квадратов, кривая обычно не проходит через точки измерений (рис. 1).Что, если нужно, чтобы эта кривая точно проходила...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F583988\\\u002F#post-content-body\",\"about\":[\"h_algorithms\",\"h_maths\",\"h_machine_learning\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F583988\\\u002Ff8993b8c9a7966ef9cc1e8667b536da1\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F7d9\\\u002F6eb\\\u002F092\\\u002F7d96eb0924a929fe6869492c1b94bcbc.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fb9c\\\u002F795\\\u002F024\\\u002Fb9c7950248e198e8d89a91624f242a99.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Ff35\\\u002Fcca\\\u002Fb65\\\u002Ff35ccab659c08f6f6738cc07d85af9e6.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F7e8\\\u002F6d3\\\u002F11a\\\u002F7e86d311a1415d1b8546ae1cbc8b3e8f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fca8\\\u002Ff8a\\\u002F646\\\u002Fca8f8a646f537177de7dc8f392209b56.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F04b\\\u002F4a7\\\u002Fc4b\\\u002F04b4a7c4b71f2a4a714039b5134698c5.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fda2\\\u002F9bd\\\u002F3c5\\\u002Fda29bd3c54f510286930caef7e57ba00.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F120\\\u002F52b\\\u002Fc4a\\\u002F12052bc4a18420663bb109fc2b19ee60.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F016\\\u002F436\\\u002F03a\\\u002F01643603ad66c827f584987d370edfad.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F969\\\u002Ff2b\\\u002F8c4\\\u002F969f2b8c4016bcd1d26a6fc64b19f510.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F7fc\\\u002F583\\\u002Ff49\\\u002F7fc583f49d9ed1e4b0de464f3016f57e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F7d4\\\u002Fa84\\\u002F8ae\\\u002F7d4a848ae9084301f1af420adb29e45e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fdf8\\\u002F504\\\u002F9e6\\\u002Fdf85049e6820f71a1ca4aad54897cf61.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F1b0\\\u002F32b\\\u002Fb81\\\u002F1b032bb81b69106f7b1cc018244df7f0.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Ff77\\\u002F35e\\\u002Fc9b\\\u002Ff7735ec9b1a623d56ff69d3db1a98d3a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F72a\\\u002F8ed\\\u002F978\\\u002F72a8ed9789ba1416f431af5f72c948f9.svg\"]}","metaDescription":"При моделировании данных методом наименьших квадратов, кривая обычно не проходит через точки измерений (рис. 1).Что, если нужно, чтобы эта кривая точно проходила через одну или несколько особо...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"algorithms,maths,machine_learning"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
