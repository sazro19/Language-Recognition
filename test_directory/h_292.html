<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Брутфорс хэшей в Active Directory / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/company\/deiteriylab\/blog\/584160\/"},"headline":"Брутфорс хэшей в Active Directory","datePublished":"2021-10-19T19:34:11+03:00","dateModified":"2021-10-20T10:35:49+03:00","author":{"@type":"Person","name":"kukuxumushi"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Слабые пароли пользователей &mdash; очень распространенная проблема, которая может позволить злоумышленнику повысить свои привилегии и закрепиться в сети компании.Чтоб...","url":"https:\/\/habr.com\/ru\/company\/deiteriylab\/blog\/584160\/#post-content-body","about":["c_deiteriylab","h_infosecurity","h_sys_admin","f_develop","f_admin"],"image":["https:\/\/habr.com\/share\/publication\/584160\/56235dc30cf80706fafa3b41cb6696c7\/","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/fb1\/deb\/497\/fb1deb497e4627ef832f5e23779a116f.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/a1a\/5e2\/d27\/a1a5e2d27ca60c67243de13980121f4c.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/753\/db2\/20f\/753db220fc12bfe5e0127268441c6261.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/77c\/576\/d4f\/77c576d4fa0f2fc8b084168dd5726efb.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/691\/9e8\/106\/6919e8106a88480b82956e2f8be81286.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/cea\/662\/26a\/cea66226a38ca700c871d4b8d3a44c92.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/629\/5bc\/8f7\/6295bc8f723402cad292ad6129c75a02.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/6ac\/34f\/2e7\/6ac34f2e78a301b033effc9025ff4b62.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/f5e\/565\/97d\/f5e56597d51a83f43d1cb92740e465d6.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/c26\/e9c\/272\/c26e9c2728884ea641fc572c1100df7a.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/697\/c9b\/c7a\/697c9bc7a0f8c9c9d28a6f262e561f08.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/e80\/531\/f33\/e80531f33fbdf9bae5edc1846d8018d7.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/473\/383\/472\/473383472310e56da92c14b838a149ed.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/849\/1bc\/e93\/8491bce935f38fa5833eebc786772110.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/a71\/6d2\/61f\/a716d261fb81760b8e206c78ed98a58b.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/cda\/2fc\/2f2\/cda2fc2f201449a4b13c878a361edafb.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/e74\/2e9\/9bd\/e742e99bde0b964858336e2932a44ea7.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/c92\/3de\/f39\/c923def3948f9e28d0ef076fa9e93adf.png","https:\/\/habrastorage.org\/getpro\/habr\/upload_files\/b54\/47c\/e74\/b5447ce74260142866571092da871650.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Брутфорс хэшей в Active Directory" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Брутфорс хэшей в Active Directory" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Брутфорс хэшей в Active Directory" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Слабые пароли пользователей — очень распространенная проблема, которая может позволить злоумышленнику повысить свои привилегии и закрепиться в сети компании.Чтобы этого не допустить, необходимо..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Слабые пароли пользователей — очень распространенная проблема, которая может позволить злоумышленнику повысить свои привилегии и закрепиться в сети компании.Чтобы этого не допустить, необходимо..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Слабые пароли пользователей — очень распространенная проблема, которая может позволить злоумышленнику повысить свои привилегии и закрепиться в сети компании.Чтобы этого не допустить, необходимо..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Слабые пароли пользователей — очень распространенная проблема, которая может позволить злоумышленнику повысить свои привилегии и закрепиться в сети компании.Чтобы этого не допустить, необходимо..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Слабые пароли пользователей — очень распространенная проблема, которая может позволить злоумышленнику повысить свои привилегии и закрепиться в сети компании.Чтобы этого не допустить, необходимо..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/b2f/d15/de7/b2fd15de7671326b47166c3275d34f33.png" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/b2f/d15/de7/b2fd15de7671326b47166c3275d34f33.png" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/b2f/d15/de7/b2fd15de7671326b47166c3275d34f33.png" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/b2f/d15/de7/b2fd15de7671326b47166c3275d34f33.png" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/b2f/d15/de7/b2fd15de7671326b47166c3275d34f33.png" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="584160" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2021-10-19T16:34:11.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/584160/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/company/deiteriylab/blog/584160/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habrastorage.org/getpro/habr/upload_files/b2f/d15/de7/b2fd15de7671326b47166c3275d34f33.png" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/584160/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" companyName="deiteriylab" data-async-called="true" class="tm-page"><div class="tm-page-width"><div class="tm-page__header"><!----></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"><div class="tm-company-card tm-company-article__company-card"><div class="tm-company-card__info"><div class="tm-company-card__header"><a href="/ru/company/deiteriylab/profile/" class="tm-company-card__avatar"><div class="tm-entity-image"><img alt="" height="48" src="//habrastorage.org/getpro/habr/company/655/e13/ab1/655e13ab17c25e01d5a93824fa872af3.png" width="48" class="tm-entity-image__pic"></div></a> <!----> <div class="tm-rating tm-company-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">146.15</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div> <div class="tm-company-card__info"><a href="/ru/company/deiteriylab/profile/" class="tm-company-card__name">
        Deiteriy Lab
      </a> <div class="tm-company-card__description">Делаем пентесты</div></div></div> <div class="tm-company-card__buttons"><!----> <!----></div></div> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/kukuxumushi/" title="kukuxumushi" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/c47/6a5/472/c476a5472f5f93a37fa99db7fd09b0b0.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/kukuxumushi/" class="tm-user-info__username">
      kukuxumushi
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2021-10-19T16:34:11.000Z" title="2021-10-19, 19:34">19  октября   в 19:34</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Брутфорс хэшей в Active Directory</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/company/deiteriylab/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании Deiteriy Lab</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/infosecurity/" class="tm-article-snippet__hubs-item-link"><span>Информационная безопасность</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/sys_admin/" class="tm-article-snippet__hubs-item-link"><span>Системное администрирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Tutorial
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><figure class="full-width "><img src="/img/image-loader.svg" height="1179" data-src="https://habrastorage.org/getpro/habr/upload_files/fb1/deb/497/fb1deb497e4627ef832f5e23779a116f.png" data-width="1490"/><figcaption></figcaption></figure><p>Слабые пароли пользователей — очень распространенная проблема, которая может позволить злоумышленнику повысить свои привилегии и закрепиться в сети компании.</p><p>Чтобы этого не допустить, необходимо регулярно анализировать стойкость паролей пользователей.</p><p>У системных администраторов нет возможности увидеть пароли пользователей в открытом виде, но они могут выгрузить хэши паролей и провести их перебор.</p><p>В этой статье мы расскажем о том, как можно легко получить хэши паролей пользователей и провести эффективный перебор паролей, используя различные методы.</p><p>Данный материал также будет полезен пентестерам, которым для развития атаки требуется восстановить пароли пользователей из их хэш-значений.</p><details class="spoiler"><summary>TL;DR</summary><div class="spoiler__content"><h3>Чем перебирать?</h3><p>Скачать в GitHub <a href="https://github.com/hashcat/hashcat/releases/">репозитории</a> последнюю сборку приложения в архиве. Разархивировать и запустить hashcat.exe в командной строке.</p><h3>Где взять хэши?</h3><p>Скачать с контроллера домена, утилитой <a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py">secretsdump.py</a>.</p><pre><code class="powershell">python secretsdump.py deiteriy.local/Administrator@192.168.88.32 -just-dc-ntlm</code></pre><h3>Как перебирать?</h3><p>Если нет времени или желания долго ждать перебора, то рекомендуется использовать комбинацию из всех четырех методов из списка ниже:</p><ul><li><p>Словарь <a href="https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm">realuniq.lst</a>.</p><p>Запускаем hashcat с предварительно загруженным словарем:</p><pre><code class="powershell">  hashcat.exe -m 1000 -a 0 -O -w 4 E:\hashs.txt E:\dicts\realuniq.lst</code></pre></li><li><p>Словарь из календарных единиц (файл для генерации ниже) с правилами мутации dive.rule (правила из комплекта hashcat).</p><p>Запустить скрипт на Python, который создаст словарь calendar_passwords.txt:</p><p><a href="https://raw.githubusercontent.com/kukuxumushi/calendar_password_generator/main/wordlist_generator.py">wordlist_generator.py</a></p><p>Запускаем hashcat со сгенерированным словарем:</p><pre><code class="powershell"> hashcat.exe -m 1000 -a 0 -O -w 4 E:\hashs.txt E:\dicts\calendar_passwords.txt -r rules\dive.rule</code></pre></li><li><p>Словарь <a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Leaked-Databases/rockyou.txt.tar.gz">rockyou.txt</a> с правилами мутации dive.rule (стандартное правило).</p><p>Запускаем hashcat с предварительно загруженным словарем:</p><pre><code class="powershell">  hashcat.exe -m 1000 -a 0 -O -w 4 E:\hashs.txt E:\dicts\rockyou.txt -r rules\dive.rule</code></pre></li><li><p>Словарь <a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Leaked-Databases/rockyou.txt.tar.gz">rockyou.txt</a> с правилами мутации <a href="https://raw.githubusercontent.com/NotSoSecure/password_cracking_rules/master/OneRuleToRuleThemAll.rule">OneRuleToRuleThemAll.rule</a>.</p><pre><code class="powershell">  hashcat.exe -m 1000 -a 0 -O -w 4 E:\hashs.txt E:\dicts\rockyou.txt -r rules\OneRuleToRuleThemAll.rule</code></pre></li></ul></div></details><h2>Конфигурация тестового стенда</h2><p>Для демонстрации получения хэшей была создана Active Directory инфраструктура, состоящая из одного контроллера домена и одного компьютера в сети.</p><figure class=""><img src="/img/image-loader.svg" height="380" data-src="https://habrastorage.org/getpro/habr/upload_files/a1a/5e2/d27/a1a5e2d27ca60c67243de13980121f4c.png" data-width="431"/><figcaption></figcaption></figure><p>Конфигурация компьютера для перебора паролей:</p><ul><li><p>Intel Core i7-7700.</p></li><li><p>32GB RAM.</p></li><li><p>Nvidia GeForce GTX 1060 6GB.</p></li><li><p>hashcat 6.1.</p></li><li><p>Windows 10 build 19041.572.</p></li><li><p>GeForce Game Ready Driver 460.89.</p></li><li><p>CUDA 11.2.0.</p></li></ul><h2>Подготовка</h2><h3>Как получить хэши для перебора?</h3><details class="spoiler"><summary>Что такое NTLM-хэш?</summary><div class="spoiler__content"><p>Хэш — это результат работы хэш-функции, которая осуществляет преобразование строки произвольной длины в строку фиксированной длины.</p><p>NT-хэш или NTLM-хэш является результатом работы функции MD4(UTF-16-LE(password)) — функции хэширования MD4 от пароля, закодированного в кодировке UTF-16 little-endian.</p><p>Слабости алгоритма MD4 были известны еще с 1991 года, а в 2011 году его признали устаревшим, однако он все еще повсеместно используется для хранения паролей в Windows-инфраструктуре. Данный алгоритм также обладает низкой вычислительной сложностью, что позволяет относительно быстро перебирать возможные значения.</p><p>В NTLM-хэш не применяется криптографическая соль, следовательно один пароль всегда будет соответствовать одному хэш-значению. Это позволяет находить пользователей, которые используют одинаковые пароли даже если мы не знаем их значения. Также это позволяет проводить поиск хэш-значений в радужных таблицах.</p></div></details><p>Для получения хэшей всех пользователей домена можно воспользоваться утилитой <a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py">secretsdump.py</a>, входящей в состав пакета <a href="https://github.com/SecureAuthCorp/impacket">impacket</a>. Для использования утилиты необходимо иметь установленный интерпретатор языка программирования <a href="https://www.python.org/downloads/">Python</a> версии 2.7 или выше. Также существуют сборки утилиты <a href="https://github.com/maaaaz/impacket-examples-windows/blob/master/secretsdump.exe">secretsdump</a>, специально созданные для работы под OS Windows, и не требующие наличия сторонних интерпретаторов.</p><p>Данная утилита может быть запущена на любом устройстве, имеющем сетевой доступ к контроллеру домена.</p><p>Для получения NTLM-хэшей с контроллера домена, можно воспользоваться следующей командой. Данная команда может быть выполнена на любом устройстве, имеющем сетевой доступ к контроллеру домена.</p><pre><code class="powershell">secretsdump.exe deiteriy.local/Administrator@192.168.88.32 -just-dc-ntlm</code></pre><p>где:</p><ul><li><p><code>deiteriy.local</code> — название домена.</p></li><li><p><code>Administrator</code> — имя учетной записи с правами доменного администратора.</p></li><li><p><code>192.168.88.32</code> — IP-адрес или доменное имя контроллера домена.</p></li><li><p><code>-just-dc-ntlm</code> — аргумент, позволяющий получить только NTLM-хэши в формате domain\uid:rid:lmhash:nthash.</p></li></ul><figure class="full-width "><img src="/img/image-loader.svg" alt="Пример успешного получения NTLM-хэшей с тестового контроллера домена" title="Пример успешного получения NTLM-хэшей с тестового контроллера домена" height="623" data-src="https://habrastorage.org/getpro/habr/upload_files/753/db2/20f/753db220fc12bfe5e0127268441c6261.png" data-width="864"/><figcaption>Пример успешного получения NTLM-хэшей с тестового контроллера домена</figcaption></figure><h3>Чем перебирать?</h3><p><strong>Offline:</strong></p><ul><li><p><a href="https://hashcat.net/hashcat/">hashcat</a> — Самая популярная и производительная утилита, поддерживающая множество различных алгоритмов хэширования. Данная статья посвящена этой программе.</p></li><li><p><a href="https://www.openwall.com/john/">John the Ripper</a> — Старейший набор программ для перебора хэшей и преобразования различных файлов в их хэш-значения для последующего перебора. Кросплатформенный, поддерживает множество алгоритмов, однако имеет меньшую производительность, чем hashcat.</p></li><li><p><a href="http://project-rainbowcrack.com/">RainbowCrack</a> — Данное приложение использует другой подход к перебору хешей: не вычисление хэшей от паролей и их последующее сравнение, а поиск хэшей по заранее сгенерированным таблицам, содержащим пары хэш — значение. Отличается очень высокой скоростью подбора (быстрее в ~5000 раз), по сравнению с остальными утилитами, однако требует хранения заранее сгенерированных таблиц для каждого алгоритма хэширования, которые занимают <strong>десятки</strong> <strong>терабайт</strong> дискового пространства.</p></li></ul><p><strong>Online:</strong></p><ul><li><p><a href="https://crackstation.net/">crackstation</a> — Сервис, позволяющий производить поиск хэшей в словаре, содержащем 1,6 миллиарда паролей.</p></li><li><p><a href="https://www.onlinehashcrack.com/">onlinehashcrack</a> — Сервис, предоставляющий возможность полного перебора и перебора паролей по словарю в облаке. При успешном восстановлении исходного значения, будет предложено оплатить услуги для получения этого значения. Для проверки сложности паролей, может быть достаточно информации о том, что исходное значение хэша можно восстановить за приемлемое время.</p></li><li><p>Поисковые системы (Google, Yandex, …) — Любой хэш можно “загуглить”. Если в поисковой выдаче есть проиндексированная страница с данным хешем, то велик шанс, что на ней находится соответствие хэш — исходное значение.</p></li></ul><h3>Установка hashcat</h3><ol><li><p>Скачать в GitHub <a href="https://github.com/hashcat/hashcat/releases/">репозитории</a> последнюю сборку приложения в архиве. Архив содержит программу под операционные системы Windows и Linux.</p></li><li><p>Скачать и установить последнюю версию драйверов GPU (<a href="https://www.nvidia.com/Download/index.aspx">Nvidia</a>, <a href="https://www.amd.com/en/support">AMD</a>).</p></li><li><p>Разархивировать файл из первого пункта и запустить hashcat.exe из командой строки. Для проверки корректности установки можно использовать следующую команду:</p><pre><code class="powershell"> hashcat.exe -w 4 -O -m 1000 --benchmark</code></pre><p>где:</p><ul><li><p><code>-w 4</code> — Выбор режима рабочей нагрузки из заданного набора, где 1 — самая минимальная нагрузка, а 4 — максимальная. Если вы заметили существенное ухудшение производительности, которое мешает работе с устройством, рекомендуется использовать меньшее значение параметра -w.</p></li><li><p><code>-O</code> — Включить оптимизированные ядра.</p></li><li><p><code>-m 1000</code> — Выбор алгоритма хаширования, в данном случае 1000 — NTLM.</p></li><li><p><code>-benchmark</code> — Запустить тестирование производительности для выбранного алгоритма.</p></li></ul><p>Более подробно об аргументах можно прочитать на странице помощи утилиты:</p><pre><code class="powershell"> hashcat.exe --help 
 или 
 hashcat.exe -h</code></pre></li></ol><figure class="full-width "><img src="/img/image-loader.svg" alt="Пример успешного запуска утилиты hashcat в режиме benchmark " title="Пример успешного запуска утилиты hashcat в режиме benchmark " height="509" data-src="https://habrastorage.org/getpro/habr/upload_files/77c/576/d4f/77c576d4fa0f2fc8b084168dd5726efb.png" data-width="853"/><figcaption>Пример успешного запуска утилиты hashcat в режиме benchmark </figcaption></figure><p>Если используется GPU Nvidia, то можно увидеть предупреждение, как на рисунке выше. По умолчанию hashcat использует открытый фреймворк OpenCL для работы с GPU, однако Nvidia разработала свой собственный — <a href="https://developer.nvidia.com/cuda-toolkit">CUDA</a>. Рекомендуется установить его для повышения производительности.</p><p>Запустив еще раз команду выше, видим, что после установки CUDA, производительность выросла на 15%.</p><figure class="full-width "><img src="/img/image-loader.svg" alt="Пример успешного запуска утилиты hashcat в режиме benchmark с установленным CUDA драйвером" title="Пример успешного запуска утилиты hashcat в режиме benchmark с установленным CUDA драйвером" height="487" data-src="https://habrastorage.org/getpro/habr/upload_files/691/9e8/106/6919e8106a88480b82956e2f8be81286.png" data-width="716"/><figcaption>Пример успешного запуска утилиты hashcat в режиме benchmark с установленным CUDA драйвером</figcaption></figure><h2>Перебор паролей</h2><p>90% успеха в переборе паролей — это правильно выбранный метод подбора. В данной статье рассмотрено несколько таких методов, а в конце приведено сравнение таких методов по скорости и эффективности.</p><h3>Перебор по публично доступным словарям</h3><p>Несколько примеров словарей, которые можно найти в открытом доступе:</p><ul><li><p><a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">SecLists</a> — Репозиторий содержит большое количество файлов с паролями, в том числе рейтинги самых популярных паролей, а также словарей, полученных в результате утечек из различных сервисов.</p></li><li><p><a href="https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm">Сrackstation</a> — Сервис, позволяющий производить поиск хэшей в словаре, предоставляет один из самых больших (1,6 миллиарда строк) словарей. По заявлению создателей, словарь содержит все пароли, которые когда-либо были опубликованы в Интернете.</p></li><li><p><a href="https://github.com/berzerk0/Probable-Wordlists">Probable-Wordlists</a> — Репозиторий содержит словари паролей как из утечек, так и из различных публично доступных словарей. Проект содержит аналитику популярности использования паролей, а также маски и правила для утилиты hashcat.  </p></li><li><p><a href="https://weakpass.com/">weakpass.com</a> — На сайте собрано большое количество словарей агрегированных из различных источников и их комбинаций. Есть словари размером как меньше мегабайта, так и больше четырехсот гигабайт.</p></li></ul><h4>Словарь rockyou.txt</h4><p><a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Leaked-Databases/rockyou.txt.tar.gz">rockyou.txt</a> — самый популярный словарь для перебора, состоящий из самых популярных паролей, собранных из публично опубликованных баз данных.</p><p>Для перебора по словарю rockyou.txt, его необходимо загрузить на устройство, а затем выполнить следующую команду в командной строке:</p><pre><code class="powershell">hashcat.exe -m 1000 -a 0 -O -w 4 E:\hashs.txt E:\dicts\rockyou.txt</code></pre><p>где:</p><ul><li><p><code>-m 1000</code> — Выбор алгоритма хэширования, в данном случае 1000 — NTLM.</p></li><li><p><code>-a 0</code> — Выбор режима работы (0 — перебор по словарю, 3 — перебор по маске, 1,6,7 — Гибридные режимы работы).</p></li><li><p><code>-O</code> — Включить оптимизированные ядра.</p></li><li><p><code>-w 4</code> — Выбор режима рабочей нагрузки из заданного набора 1-4, где 1 — самая минимальная нагрузка, а 4 — максимальная.</p></li><li><p><code>E:\hashs.txt</code> — Путь к файлу с хэшами.</p></li><li><p><code>E:\dicts\rockyou.txt</code> — Путь к словарю.</p></li></ul><p>На рисунке ниже, видим пример вывода программы. Красным выделены пары хэш — значение, которые были успешно восстановлены.</p><figure class="full-width "><img src="/img/image-loader.svg" alt="Пример успешно подобранных паролей" title="Пример успешно подобранных паролей" height="623" data-src="https://habrastorage.org/getpro/habr/upload_files/cea/662/26a/cea66226a38ca700c871d4b8d3a44c92.png" data-width="722"/><figcaption>Пример успешно подобранных паролей</figcaption></figure><p>На тестовом стенде программе потребовалось 3 секунды на перебор 20-и хэшей по словарю, содержащему 1,4 миллиона паролей.</p><p>После успешного подбора, пары хэш — значение будут помещены в pot-файл, расположенный в папке с программой — E:\hashcat\hashcat.potfile. При каждом запуске программы, в первую очередь будет проверяться наличие хэшей в pot-файле, чтобы не перебирать известные хэши заново. Если такой хэш был найден, то он не будет выведен на экран. Вместо этого будет выведено информационное сообщение о том, что такой хэш был найден в pot-файле.</p><p><code>INFO: Removed 3 hashes found in potfile. </code></p><p>Содержимое pot-файла:</p><figure class=""><img src="/img/image-loader.svg" alt="Пример содержимого pot-файла" title="Пример содержимого pot-файла" height="140" data-src="https://habrastorage.org/getpro/habr/upload_files/629/5bc/8f7/6295bc8f723402cad292ad6129c75a02.png" data-width="504"/><figcaption>Пример содержимого pot-файла</figcaption></figure><p>Для просмотра таких хэшей, можно воспользоваться командой:</p><pre><code class="powershell">hashcat.exe -m 1000 E:\hashs.txt --show</code></pre><figure class=""><img src="/img/image-loader.svg" alt="Поиск хэшей в pot-файле" title="Поиск хэшей в pot-файле" height="85" data-src="https://habrastorage.org/getpro/habr/upload_files/6ac/34f/2e7/6ac34f2e78a301b033effc9025ff4b62.png" data-width="465"/><figcaption>Поиск хэшей в pot-файле</figcaption></figure><h4>Словарь realunique от Сrackstation</h4><p><a href="https://crackstation.net/crackstation-wordlist-password-cracking-dictionary.htm">realuniq.lst</a> — По заявлению создателей — это самый большой файл с паролями на просторах интернета — содержит 1,6 миллиарда паролей.</p><p>Для перебора по словарю realunique, его необходимо загрузить на устройство, а затем выполнить следующую команду в командной строке:</p><pre><code class="powershell">hashcat.exe -m 1000 -a 0 -O -w 4 E:\hashs.txt E:\dicts\realuniq.lst</code></pre><p>Результат работы на рисунке ниже:</p><figure class="full-width "><img src="/img/image-loader.svg" alt="Перебор по словарю" title="Перебор по словарю" height="387" data-src="https://habrastorage.org/getpro/habr/upload_files/f5e/565/97d/f5e56597d51a83f43d1cb92740e465d6.png" data-width="924"/><figcaption>Перебор по словарю</figcaption></figure><p>На тестовом стенде программе потребовалось 39 секунд на перебор 20-и хэшей по словарю, содержащему 1,2 миллиарда паролей.</p><h3>Перебор по самодельному словарю</h3><p>У каждой организации свои парольные политики и своя культура, связанная с особенностями работы (Bank2020!, Neft2020@, C@rd2019), местоположением (Russia2020!, Astana2010#, Moscow123$), названиями компании (BankRot123, G@zM0sPr0m, Vodorod!@#), филиалов (H3adOff1ce1, $KolymaDep$, Branch*) и отделов (HR123!@#, ITdep!!!, Accountants200). Также словари не учитывают специфику языка пользователей (Mamir2020 (май на казахском языке), Vfq2020! (май на русском языке, набранный другой раскладкой), Maijs2018 (май на латышском языке)). Поэтому рекомендуется создавать свои собственные словари для перебора паролей и использовать их вместе с другими методами перебора.</p><p>Также, публичные словари редко учитывают специфику сетей Windows и ее парольные политики:</p><p>Парольная политика "Passwords must meet complexity requirements", регламентирует, что пароль должен содержать символы как минимум из трех следующих категорий:</p><ol><li><p>Заглавные буквы европейских языков (от A до Z, с диакритическими знаками, греческие и кириллические символы).</p></li><li><p>Строчные буквы европейских языков (от a до z, ß, с диакритическими знаками, греческие и кириллические символы).</p></li><li><p>Цифры (от 0 до 9).</p></li><li><p>Не алфавитно-цифровые символы (специальные символы): (<code>~! @ # $% ^ &amp; * _- + = \| \ () {} [] :;" '&lt;>,.? /</code>) Символы валюты, такие как евро или Британский фунт не считаются специальными символами для этого параметра политики.</p></li><li><p>Любой символ Юникода, относящийся к категории алфавитных символов, но не прописных или строчных. В эту группу входят символы Unicode из азиатских языков.</p></li></ol><p>Также, стоит учитывать, что в Windows по умолчанию стоит минимальная длина пароля 8 символов, а частота смены пароля обычно установлена 90 дней.</p><h3>Словарь — календарные единицы</h3><p>При частой смене паролей пользователям сложно запомнить сложный, стойкий пароль, который при этом будет действовать всего 3 месяца, и будет существенно отличаться от предыдущего. Поэтому, зачастую пользователи используют пароли, состоящие из следующих частей:</p><ul><li><p>Месяц</p></li><li><p>Время года</p></li><li><p>Год</p></li><li><p>Спецсимволы</p></li></ul><p>Например:</p><ul><li><p>May2020!</p></li><li><p>Leto2019</p></li><li><p>Aprel2021@</p></li><li><p>19October.</p></li><li><p>Pbvf2020!! (где “Pbvf” — это слово “Зима” набранное другой раскладкой)</p></li></ul><p>Для генерации такого словаря можно воспользоваться небольшим скриптом на Python:</p><pre><code class="python">import datetime
from itertools import permutations, product #библиотека для комбинирования элементов

#определяем компоненты, из которых будет состоять пароль
specials = ['!','@','#','$','.','*','^','?'] #спецсимволы

#месяца и времена года
words = ["April", "Atdhfkm", "August", "Autumn", "Besna", "Becna", "B.km", "B.ym", "Ctynz,hm", "December", "Dtcyf", "Fduecn", "February", "Fghtkm", "January", "Jctym", "Jrnz,hm", "July", "June", "Ktnj", "Leto", "Ltrf,hm", "March", "May", "November", "October", "Ocen", "Osen" "Pbvf", "September", "Spring", "Summer", "Vesna", "Vecna", "Vfq", "Vfhn", "Winter", "Yjz,hm", "Zima", "Zydfhm", "3ima"]
# года с 2010 по текущий + 2 в форматах YYYY и YY
now = datetime.datetime.now()
years = list(range(2010,now.year+2))+list(range(10,int(str(now.year)[2:])+2))

#открываем файл для сохранения паролей
f_o = open("calendar_passwords.txt", "w") 

#генерируем список специальных символов от 0 до 3 элементов
special_array=[]
for i in range(0,4):
    for subset in product(specials,repeat=i):
        special_array.append(''.join(subset))

#собираем компоненты в пароль
for word in words:
    for year in years:
        for special in special_array:
            for password in permutations([word, str(year), special], 3):
                f_o.write(''.join(password)+"\r\n")

#закрываем файл
f_o.close()</code></pre><p>В результате получаем словарь на 3,2 миллиона паролей.</p><pre><code class="powershell">hashcat.exe -m 1000 -a 0 -O -w 4 E:\hashs.txt E:\dicts\calendar_passwords.txt</code></pre><figure class="full-width "><img src="/img/image-loader.svg" alt="Перебор по словарю" title="Перебор по словарю" height="386" data-src="https://habrastorage.org/getpro/habr/upload_files/c26/e9c/272/c26e9c2728884ea641fc572c1100df7a.png" data-width="722"/><figcaption>Перебор по словарю</figcaption></figure><p>На тестовом стенде программе потребовалось 2 секунды на перебор 20-и хэшей по словарю, содержащему 3,2 миллиона паролей.</p><h3>Пароль-“змейка”</h3><p>“Змейка” это строка, набираемая на клавиатуре, позиции символов в которой, подвержены неким закономерностям, например, набираются друг за другом (qwerty, asdfgh, zxcvb), находятся друг под другом (qaz, wsx, edc), их можно набирать “не отрывая руки” от клавиатуры (qwedcxza, zxcdsaqwe, 4rfvbgt5) или комбинации этих закономерностей (1qaz2wsx3edc).</p><p>Большое число таких паролей содержится в публичных словарях, однако не все удовлетворяют парольным политикам Windows.</p><p>Для генерации таких паролей можно воспользоваться утилитой <a href="https://github.com/hashcat/kwprocessor">kwprocessor</a>, либо набрать “змейку” самостоятельно, учитывая особенности парольных политик (!QAZ2wsx#EDC, 1q2w3e4r5t^Y, !QAZ1qaz!QAZ).</p><h3>Перебор по словарю с правилами мутации</h3><p>Правила мутации (Rule-based Attack) — преобразование слов из словаря, по некоторым, заранее заданным, правилам.</p><p>Для описания правил в hashcat <a href="https://hashcat.net/wiki/doku.php?id=rule_based_attack">существует</a> специальный язык программирования. Написание собственных правил — это нетривиальная задача, поэтому hashcat уже содержит несколько десятков наборов правил, найти которые можно в директории “rules”. Также существует множество наборов правил в открытом доступе, например в <a href="https://github.com/search?q=hashcat+rules">репозиториях</a> на GitHub.</p><h4>dive.rule</h4><p>dive.rule — самый большой набор правил, из тех, что идет в составе hashcat.</p><p>Для запуска hascat cо словарем rockyou.txt и этим набором правил можно воспользоваться следующей командой:</p><pre><code class="powershell">hashcat.exe -m 1000 -a 0 -O -w 4 E:\hashs.txt E:\dicts\rockyou.txt -r rules\dive.rule</code></pre><p>где:</p><ul><li><p><code>-r</code> — Использовать правила.</p></li><li><p><code>rules/dive.rule</code> — Путь к правилам.</p></li></ul><figure class="full-width "><img src="/img/image-loader.svg" alt="Перебор по словарю с правилами мутации" title="Перебор по словарю с правилами мутации" height="405" data-src="https://habrastorage.org/getpro/habr/upload_files/697/c9b/c7a/697c9bc7a0f8c9c9d28a6f262e561f08.png" data-width="973"/><figcaption>Перебор по словарю с правилами мутации</figcaption></figure><p>На тестовом стенде программе потребовалось 415 секунд на перебор 20-и хэшей по словарю, из которого было создано 1,4 триллиона паролей. Также видим, что словарь, который содержал всего 3 пароля из 20, с помощью правил позволил восстановить 13 из 20 значений.</p><div><div class="table"><table><tbody><tr><th><p align="center">Получены с использованием правил</p></th><th><p align="center">Получены без использования правил</p></th></tr><tr><td><p align="center">(пустой пароль)</p></td><td><p align="center">(пустой пароль)</p></td></tr><tr><td><p align="center">liverpool_fc5</p></td><td><p align="center">liverpool_fc5</p></td></tr><tr><td><p align="center">fr!3ndss</p></td><td><p align="center">fr!3ndss</p></td></tr><tr><td><p align="center">!QAZ1qaz!QAZ</p></td><td><p align="center"> </p></td></tr><tr><td><p align="center">118@4</p></td><td><p align="center"> </p></td></tr><tr><td><p align="center">Albert93!</p></td><td><p align="center"> </p></td></tr><tr><td><p align="center">May2020!</p></td><td><p align="center"> </p></td></tr><tr><td><p align="center">!QAZ2wsx#EDC</p></td><td><p align="center"> </p></td></tr><tr><td><p align="center">(!)(!)</p></td><td><p align="center"> </p></td></tr><tr><td><p align="center">Ktnj2020</p></td><td><p align="center"> </p></td></tr><tr><td><p align="center">987654cc–</p></td><td><p align="center"> </p></td></tr><tr><td><p align="center">1q2w3e4r5t^Y</p></td><td><p align="center"> </p></td></tr><tr><td><p align="center">2020jana@@</p></td><td><p align="center"> </p></td></tr></tbody></table></div></div><h4>OneRuleToRuleThemAll.rule</h4><p><a href="https://github.com/NotSoSecure/password_cracking_rules">OneRuleToRuleThemAll.rule</a> — набор правил, который является комбинацией самых популярных правил из других наборов.</p><p>По заверениям создателей, при двукратно меньшем размере позволяет восстановить на 4% больше паролей, чем dive.rule.</p><p>Для использования правила, необходимо сохранить <a href="https://raw.githubusercontent.com/NotSoSecure/password_cracking_rules/master/OneRuleToRuleThemAll.rule">файл</a>, в директорию “rules”.</p><p>Далее правило можно вызвать как предустановленное:</p><pre><code class="powershell">hashcat.exe -m 1000 -a 0 -O -w 4 E:\hashs.txt E:\dicts\rockyou.txt -r rules\OneRuleToRuleThemAll.rule</code></pre><figure class="full-width "><img src="/img/image-loader.svg" alt="Перебор по словарю с правилами мутации" title="Перебор по словарю с правилами мутации" height="406" data-src="https://habrastorage.org/getpro/habr/upload_files/e80/531/f33/e80531f33fbdf9bae5edc1846d8018d7.png" data-width="723"/><figcaption>Перебор по словарю с правилами мутации</figcaption></figure><p>На тестовом стенде программе потребовалось 192 секунды на перебор 20-и хэшей по словарю, содержащему 745 миллиардов паролей. Данное правило позволило восстановить 11 паролей из 20, что на два меньше, чем в dive.rule, однако программа отработала в 2 раза быстрее, чем в случае с dive.rule.</p><h3>Перебор по маске</h3><p>Перебор по маске является разновидностью полного перебора.</p><p>В hashcat существуют предопределенные наборы символов, которые позволяют описывать маску для перебора.</p><figure class=""><img src="/img/image-loader.svg" alt="Предопределенные наборы символов" title="Предопределенные наборы символов" height="216" data-src="https://habrastorage.org/getpro/habr/upload_files/473/383/472/473383472310e56da92c14b838a149ed.png" data-width="370"/><figcaption>Предопределенные наборы символов</figcaption></figure><p>Например, маска <code>?a?a?a</code> означает, что будут перебираться все комбинации символов из набора: <code>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 !"#$%&amp;'()*+,-./:;&lt;=>?@[\]^_\{|}~</code> длиной 3. Однако набор символов ?a является очень большим, что не позволяет в обозримое время перебирать длинные пароли. Например, для перебора 20 хэшей по маске <code>?a?a?a?a?a?a?a?a</code> (длина 8) на тестовом стенде потребуется около 7-и дней.</p><pre><code class="powershell">hashcat.exe -m 1000 -a 3 -O -w 4 E:\hashs.txt ?a?a?a?a?a?a?a?a</code></pre><p>где:</p><ul><li><p><code>a 3</code> — Режим перебора по маске.</p></li><li><p><code>?a?a?a?a?a?a?a?a</code> — Маска, означающая пароль, длиной 8, состоящий из символов <code>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 !"#$%&amp;'(),-./:;&lt;=>?@[\]^_{|}~+*</code>.</p></li></ul><figure class="full-width "><img src="/img/image-loader.svg" alt="Перебор по маске" title="Перебор по маске" height="325" data-src="https://habrastorage.org/getpro/habr/upload_files/849/1bc/e93/8491bce935f38fa5833eebc786772110.png" data-width="745"/><figcaption>Перебор по маске</figcaption></figure><p>Перебором по маске с набором символов ?a можно пользоваться для перебора коротких паролей, например, длиной от 1 до 6. Для того чтобы не вводить команду 6 раз, можно воспользоваться режимом инкрементирования:</p><pre><code class="powershell">hashcat.exe -m 1000 -a 3 -O -w 4 E:\hashs.txt ?a?a?a?a?a?a --increment --increment-min 1</code></pre><p>где:</p><ul><li><p><code>-increment</code> — Запуск в режиме инкрементирования.</p></li><li><p><code>-increment-min 1</code> — Минимальная длина пароля 1.</p></li></ul><figure class="full-width "><img src="/img/image-loader.svg" alt="Перебор по маске с инкрементом" title="Перебор по маске с инкрементом" height="380" data-src="https://habrastorage.org/getpro/habr/upload_files/a71/6d2/61f/a716d261fb81760b8e206c78ed98a58b.png" data-width="725"/><figcaption>Перебор по маске с инкрементом</figcaption></figure><p>Перебор 20 хэшей паролей с длиной от 1 до 6 символов был осуществлен за 71 секунду, а паролей длиной 7, был бы осуществлен уже за 2 часа. Попытка восстановления исходных хэш-значений паролей с длиной меньше 8 символов может быть полезна в сети AD, в том случае, если минимальная длина пароля была когда-либо установлена меньше чем восемь символов.</p><h3>Перебор по маске c самодельными наборами</h3><p>Для ускорения процесса перебора по маске, а также возможности перебора более длинных паролей, можно воспользоваться некоторыми правилами и закономерностями. Если рассмотреть описанные выше методы, то можно заметить, что большое количество полученных паролей начинается с большой буквы, после неё следуют несколько строчных букв, а потом цифры и/или спецсимволы. Это можно представить в виде маски, например:</p><p><code>?u?l?l?l?d?d?d?d</code></p><figure class="full-width "><img src="/img/image-loader.svg" alt="Перебор по маске" title="Перебор по маске" height="386" data-src="https://habrastorage.org/getpro/habr/upload_files/cda/2fc/2f2/cda2fc2f201449a4b13c878a361edafb.png" data-width="727"/><figcaption>Перебор по маске</figcaption></figure><p>Существенно снизив набор символов, пароль длиной 8 символов можно перебрать за 2 секунды.</p><h2>Перебор по наборам масок</h2><p>Если мы хотим перебрать множество вариантов, состоящих из масок вида: большая буква, несколько строчных букв, цифры и/или спецсимволы, то придется запускать hashcat несколько десятков раз. Для упрощения задачи существуют hcmask-файлы — файлы набора масок. Создадим такой файл небольшим скриптом на Python:</p><pre><code class="python">for first in range(1,7):
    for digits in range(0,6):
        for second in range(0,3):
            mask = "?l3@17,!@#$%^&amp;*.,?u"+str("?1"*first)+str("?d"*digits)+str("?2"*second)
            if len(mask)&lt;37 and len(mask)>32:
                print("?l3@17,!@#$%^&amp;*.,?u"+str("?1"*first)+str("?d"*digits)+str("?2"*second))
                print("?l3@17,!@#$%^&amp;*.,"+str("?d"*digits)+"?u"+str("?1"*first)+str("?2"*second))
</code></pre><p>Этот скрипт создаст 62 строки вида:</p><pre><code>?l3@17,!@#$%^&amp;*.,?u?1?1?d?d?d?d?2?2</code></pre><p>Каждая из созданных строк состоит из трех полей, разделенных запятыми:</p><ul><li><p>Самодельный набор символов 1.</p></li><li><p>Самодельный набор символов 2.</p></li><li><p>Маска, состоящая из наборов символов.</p></li></ul><p>Для перебора с использованием файла масок можно воспользоваться следующей командой:</p><pre><code>hashcat.exe -m 1000 -a 3 -O -w 4 E:\hashs.txt E:\hashcat\mask.hcmask</code></pre><p>где:</p><ul><li><p><code>E:\hashcat\mask.hcmask</code> — Путь к файлу масок.</p></li></ul><p>Перебор 20 хэшей паролей по 62 маскам от 8 до 9 символов занял 44 минуты.</p><h3>Как сделать удобный вывод</h3><p>После всех операций выше, pot-файл будет заполнен полученными паролями и соответствующими им хэшами. Чтобы узнать какой пароль соответствует какому пользователю, можно выполнить следующую команду:</p><pre><code>hashcat.exe -m 1000 --show --username --outfile E:\output.txt --outfile-format 2 E:\hashs.txt</code></pre><p>где:</p><ul><li><p><code>-username</code> — Игнорирование имя пользователя в хэш-файле.</p></li><li><p><code>-outfile E:\output.txt</code> — Файл, в который будет сохранен вывод программы.</p></li><li><p><code>-outfile-format 2</code> — Формат вывода программы, где 2 — в открытом виде.</p></li></ul><figure class=""><img src="/img/image-loader.svg" alt="Пример удобного вывода пар пользователь — пароль" title="Пример удобного вывода пар пользователь — пароль" height="351" data-src="https://habrastorage.org/getpro/habr/upload_files/e74/2e9/9bd/e742e99bde0b964858336e2932a44ea7.png" data-width="362"/><figcaption>Пример удобного вывода пар пользователь — пароль</figcaption></figure><h2>Сравнение эффективности</h2><p>Для тестирования скорости перебора и количества получаемых паролей каждым из описанных выше методов, бы произведен перебор хэшей, полученных из существующей организации. С контроллера домена было получено 7168 пользователей с 5267 уникальными хэшами.</p><details class="spoiler"><summary>Методы перебора</summary><div class="spoiler__content"><p>Метод перебора №1</p><p><strong>Словарь</strong>: rockyou.txt<br/><strong>Уникальных хэшей восстановлено:</strong> 0<br/><strong>Процент восстановленных хэшей:</strong> 1.689766<br/><strong>Затраченное время в секундах:</strong> 4<br/><strong>Хэшей восстановлено:</strong> 89<br/><strong>Команда для запуска:</strong> <code>hashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\rockyou.txt</code></p><p>Метод перебора №2</p><p><strong>Словарь:</strong> realunique<br/><strong>Уникальных хэшей восстановлено:</strong> 0<br/><strong>Процент восстановленных хэшей:</strong> 3.721283<br/><strong>Затраченное время в секундах:</strong> 122<br/><strong>Хэшей восстановлено:</strong> 196<br/><strong>Команда для запуска:</strong> <code>hashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\realuniq.lst</code></p><p>Метод перебора №3</p><p><strong>Словарь:</strong> из календарных единиц<br/><strong>Уникальных хэшей восстановлено:</strong> 0<br/><strong>Процент восстановленных хэшей:</strong> 0.645529<br/><strong>Затраченное время в секундах:</strong> 2<br/><strong>Хэшей восстановлено:</strong> 34<br/><strong>Команда для запуска:</strong> <code>hashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\calendar_passwords.txt</code></p><p>Метод перебора №4</p><p><strong>Словарь:</strong> rockyou.txt с правилами мутации dive.rule<br/><strong>Уникальных хэшей восстановлено:</strong> 0<br/><strong>Процент восстановленных хэшей:</strong> 19.66964<br/><strong>Затраченное время в секундах:</strong> 448<br/><strong>Хэшей восстановлено:</strong> 1036<br/><strong>Команда для запуска:</strong> <code>hashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\rockyou.txt -r rules\dive.rule</code></p><p>Метод перебора №5</p><p><strong>Словарь:</strong> realunique с правилами мутации dive.rule<br/><strong>Уникальных хэшей восстановлено:</strong> 137<br/><strong>Процент восстановленных хэшей:</strong> 30.20695<br/><strong>Затраченное время в секундах:</strong> 34784<br/><strong>Хэшей восстановлено:</strong> 1591<br/><strong>Команда для запуска:</strong> <code>hashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\realuniq.lst -r rules\dive.rule</code></p><p>Метод перебора №6</p><p><strong>Словарь:</strong> из календарных единиц с правилами мутации dive.rule<br/><strong>Уникальных хэшей восстановлено:</strong> 9<br/><strong>Процент восстановленных хэшей:</strong> 2.41124<br/><strong>Затраченное время в секундах:</strong> 92<br/><strong>Хэшей восстановлено:</strong> 127<br/><strong>Команда для запуска:</strong> <code>hashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\calendar_passwords.txt -r rules\dive.rule</code></p><p>Метод перебора №7</p><p><strong>Словарь:</strong> rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Уникальных хэшей восстановлено:</strong> 0<br/><strong>Процент восстановленных хэшей:</strong> 18.54946<br/><strong>Затраченное время в секундах:</strong> 198<br/><strong>Хэшей восстановлено:</strong> 977<br/><strong>Команда для запуска:</strong> <code>hashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\rockyou.txt  -r rules\OneRuleToRuleThemAll.rule</code></p><p>Метод перебора №8</p><p><strong>Словарь:</strong> realunique с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Уникальных хэшей восстановлено:</strong> 63<br/><strong>Процент восстановленных хэшей:</strong> 28.0805<br/><strong>Затраченное время в секундах:</strong> 15684<br/><strong>Хэшей восстановлено:</strong> 1479<br/><strong>Команда для запуска:</strong> <code>hashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\realuniq.lst -r rules\OneRuleToRuleThemAll.rule</code></p><p>Метод перебора №9</p><p><strong>Словарь:</strong> из календарных единиц с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Уникальных хэшей восстановлено:</strong> 1<br/><strong>Процент восстановленных хэшей:</strong> 1.898614<br/><strong>Затраченное время в секундах:</strong> 46<br/><strong>Хэшей восстановлено:</strong> 100<br/><strong>Команда для запуска:</strong> <code>hashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\calendar_passwords.txt -r rules\OneRuleToRuleThemAll.rule</code></p><p>Метод перебора №10</p><p><strong>Словарь:</strong> Маска ?a длиной от 1 до 6<br/><strong>Уникальных хэшей восстановлено:</strong> 0<br/><strong>Процент восстановленных хэшей:</strong> 0.322764<br/><strong>Затраченное время в секундах:</strong> 73<br/><strong>Хэшей восстановлено:</strong> 17<br/><strong>Команда для запуска:</strong> <code>hashcat.exe -m 1000 -a 3 -O -w 4 hashs.txt mask1-6.hcmask</code></p><p>Метод перебора №11</p><p><strong>Словарь:</strong> Набор масок длиной от 7 до 9<br/><strong>Уникальных хэшей восстановлено:</strong> 71<br/><strong>Процент восстановленных хэшей:</strong> 7.404595<br/><strong>Затраченное время в секундах:</strong> 2668<br/><strong>Хэшей восстановлено:</strong> 390<br/><strong>Команда для запуска:</strong> <code>hashcat.exe -m 1000 -a 3 -O -w 4 hashs.txt mask7-9.hcmask</code></p></div></details><figure class="full-width "><img src="/img/image-loader.svg" height="403" data-src="https://habrastorage.org/getpro/habr/upload_files/c92/3de/f39/c923def3948f9e28d0ef076fa9e93adf.png" data-width="803"/><figcaption></figcaption></figure><div><div class="table"><table><tbody><tr><th data-colwidth="61" width="61"><p align="center">Метод</p></th><th data-colwidth="134" width="134"><p align="center">Уникальных* хэшей восстановлено</p></th><th data-colwidth="156" width="156"><p align="center">Процент восстановленных хэшей</p></th><th data-colwidth="188" width="188"><p align="center">Затраченное время в секундах</p></th><th><p align="center">Хэшей восстановлено</p></th></tr><tr><td data-colwidth="61" width="61"><p align="center">1</p></td><td data-colwidth="134" width="134"><p align="center">0</p></td><td data-colwidth="156" width="156"><p align="center">1.689766</p></td><td data-colwidth="188" width="188"><p align="center">4</p></td><td><p align="center">89</p></td></tr><tr><td data-colwidth="61" width="61"><p align="center">2</p></td><td data-colwidth="134" width="134"><p align="center">0</p></td><td data-colwidth="156" width="156"><p align="center">3.721283</p></td><td data-colwidth="188" width="188"><p align="center">122</p></td><td><p align="center">196</p></td></tr><tr><td data-colwidth="61" width="61"><p align="center">3</p></td><td data-colwidth="134" width="134"><p align="center">0</p></td><td data-colwidth="156" width="156"><p align="center">0.645529</p></td><td data-colwidth="188" width="188"><p align="center">2</p></td><td><p align="center">34</p></td></tr><tr><td data-colwidth="61" width="61"><p align="center">4</p></td><td data-colwidth="134" width="134"><p align="center">0</p></td><td data-colwidth="156" width="156"><p align="center">19.66964</p></td><td data-colwidth="188" width="188"><p align="center">448</p></td><td><p align="center">1036</p></td></tr><tr><td data-colwidth="61" width="61"><p align="center">5</p></td><td data-colwidth="134" width="134"><p align="center">137</p></td><td data-colwidth="156" width="156"><p align="center">30.20695</p></td><td data-colwidth="188" width="188"><p align="center">34784</p></td><td><p align="center">1591</p></td></tr><tr><td data-colwidth="61" width="61"><p align="center">6</p></td><td data-colwidth="134" width="134"><p align="center">9</p></td><td data-colwidth="156" width="156"><p align="center">2.41124</p></td><td data-colwidth="188" width="188"><p align="center">92</p></td><td><p align="center">127</p></td></tr><tr><td data-colwidth="61" width="61"><p align="center">7</p></td><td data-colwidth="134" width="134"><p align="center">0</p></td><td data-colwidth="156" width="156"><p align="center">18.54946</p></td><td data-colwidth="188" width="188"><p align="center">198</p></td><td><p align="center">977</p></td></tr><tr><td data-colwidth="61" width="61"><p align="center">8</p></td><td data-colwidth="134" width="134"><p align="center">63</p></td><td data-colwidth="156" width="156"><p align="center">28.0805</p></td><td data-colwidth="188" width="188"><p align="center">15684</p></td><td><p align="center">1479</p></td></tr><tr><td data-colwidth="61" width="61"><p align="center">9</p></td><td data-colwidth="134" width="134"><p align="center">1</p></td><td data-colwidth="156" width="156"><p align="center">1.898614</p></td><td data-colwidth="188" width="188"><p align="center">46</p></td><td><p align="center">100</p></td></tr><tr><td data-colwidth="61" width="61"><p align="center">10</p></td><td data-colwidth="134" width="134"><p align="center">0</p></td><td data-colwidth="156" width="156"><p align="center">0.322764</p></td><td data-colwidth="188" width="188"><p align="center">73</p></td><td><p align="center">17</p></td></tr><tr><td data-colwidth="61" width="61"><p align="center">11</p></td><td data-colwidth="134" width="134"><p align="center">71</p></td><td data-colwidth="156" width="156"><p align="center">7.404595</p></td><td data-colwidth="188" width="188"><p align="center">2668</p></td><td><p align="center">390</p></td></tr></tbody></table></div></div><p>*Уникальный хэш — хэш, который не был получен ни в одном из других методов.</p><p>Видим, что наибольшее число паролей восстановилось в методе “<em>5. Словарь realunique с правилами мутации dive.rule</em>”, который для получения конечных результатов требует 10 часов работы на тестовом стенде. В два раза быстрее отрабатывает метод “<em>8. Словарь realunique с правилами мутации OneRuleToRuleThemAll.rule</em>”, уступая предыдущему всего на 2% восстановленных паролей. Если требуется результат "как можно скорее", то можно воспользоваться методами “<em>4. Словарь rockyou.txt с правилами мутации dive.rule</em>” или “<em>7. Словарь rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule</em>”, которые отличаются друг от друга на 1% хэшей и уступают предыдущим методам почти на 10%, но при этом, отрабатывают за 7 и 3,5 минуты соответственно.</p><h3>Комбинации методов</h3><p>Наилучшие результаты достигаются путем использования нескольких из описанных выше методов.</p><p>В файле ниже приведена полная таблица со всеми комбинациями.</p><p><a href="https://www.dropbox.com/s/v4xpi4vr7knve1l/combo_1_2_3_4_5_top.xlsx?dl=0"><u>https://www.dropbox.com/s/v4xpi4vr7knve1l/combo_1_2_3_4_5_top.xlsx?dl=0</u></a></p><p>Ниже переведены лучшие комбинации из наборов методов от 2 до 5.</p><h3>Топ 7 наборов методов по количеству восстановленных хэшей</h3><h4>Набор методов №1</h4><p><strong>Комментарий:</strong> Лучший по количеству восстановленных хэшей<br/><strong>Метод 1:</strong> Словарь из календарных единиц с правилами мутации dive.rule<br/><strong>Метод 2:</strong> Словарь из календарных единиц с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Метод 3:</strong> Набор масок длиной от 7 до 9<br/><strong>Метод 4:</strong> Словарь realunique с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Метод 5:</strong> Словарь realunique с правилами мутации dive.rule</p><p><strong>Количество уникальных хэшей:</strong> 658<br/><strong>Процент восстановленных хэшей:</strong> 34.53579<br/><strong>Затраченное время в секундах:</strong> 53320<br/><strong>Всего восстановлено:</strong> 1819</p><h4>Набор методов №2</h4><p><strong>Комментарий:</strong> Лучший по количеству уникальных хэшей<br/><strong>Метод 1:</strong> Словарь rockyou.txt с правилами мутации dive.rule<br/><strong>Метод 2:</strong> Словарь rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Метод 3:</strong> Набор масок длиной от 7 до 9<br/><strong>Метод 4:</strong> Словарь realunique с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Метод 5:</strong> Словарь realunique с правилами мутации dive.rule</p><p><strong>Количество уникальных хэшей:</strong> 1498<br/><strong>Процент восстановленных хэшей:</strong> 33.60547<br/><strong>Затраченное время в секундах:</strong> 53782<br/><strong>Всего восстановлено:</strong> 1770</p><h4>Набор методов №3</h4><p><strong>Комментарий:</strong> Высокая скорость и большое количество восстановленных хэшей #1<br/><strong>Метод 1:</strong> Словарь из календарных единиц с правилами мутации dive.rule<br/><strong>Метод 2:</strong> Словарь rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Метод 3:</strong> Словарь из календарных единиц с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Метод 4:</strong> Набор масок длиной от 7 до 9<br/><strong>Метод 5:</strong> Словарь realunique с правилами мутации dive.rule</p><p><strong>Количество уникальных хэшей:</strong> 263<br/><strong>Процент восстановленных хэшей:</strong> 33.33966<br/><strong>Затраченное время в секундах:</strong> 37834<br/><strong>Всего восстановлено:</strong> 1756</p><h4>Набор методов №4</h4><p><strong>Комментарий:</strong> Лучший набор из двух методов<br/><strong>Метод 1:</strong> Словарь realunique с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Метод 2:</strong> Словарь realunique с правилами мутации dive.rule</p><p><strong>Количество уникальных хэшей:</strong> 462<br/><strong>Процент восстановленных хэшей:</strong> 32.23847<br/><strong>Затраченное время в секундах:</strong> 50468<br/><strong>Всего восстановлено:</strong> 1698</p><h4>Набор методов №5</h4><p><strong>Комментарий:</strong> Высокая скорость и большое количество хэшей #2<br/><strong>Метод 1:</strong> Словарь из календарных единиц с правилами мутации dive.rule<br/><strong>Метод 2:</strong> Словарь rockyou.txt с правилами мутации dive.rule<br/><strong>Метод 3:</strong> Словарь из календарных единиц с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Метод 4:</strong> Набор масок длиной от 7 до 9<br/><strong>Метод 5:</strong> Словарь realunique с правилами мутации OneRuleToRuleThemAll.rule</p><p><strong>Количество уникальных хэшей:</strong> 188<br/><strong>Процент восстановленных хэшей:</strong> 31.93469<br/><strong>Затраченное время в секундах:</strong> 18984<br/><strong>Всего восстановлено:</strong> 1682</p><h4>Набор методов №6</h4><p><strong>Комментарий:</strong> Высокая скорость и большое количество хэшей #3<br/><strong>Метод 1:</strong> Словарь realunique<br/><strong>Метод 2:</strong> Словарь из календарных единиц с правилами мутации dive.rule<br/><strong>Метод 3:</strong> Словарь rockyou.txt с правилами мутации dive.rule<br/><strong>Метод 4:</strong> Словарь rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule<br/><strong>Метод 5:</strong> Набор масок длиной от 7 до 9</p><p><strong>Количество уникальных хэшей:</strong> 80<br/><strong>Процент восстановленных хэшей:</strong> 25.74521<br/><strong>Затраченное время в секундах:</strong> 3528<br/><strong>Всего восстановлено:</strong> 1356</p><h4>Набор методов №7</h4><p><strong>Комментарий:</strong> Высокая скорость и большое количество хэшей #4<br/><strong>Метод 1:</strong> Словарь realunique<br/><strong>Метод 2:</strong> Словарь из календарных единиц с правилами мутации dive.rule<br/><strong>Метод 3:</strong> Словарь rockyou.txt с правилами мутации dive.rule<br/><strong>Метод 4:</strong> Словарь rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule</p><p><strong>Количество уникальных хэшей:</strong> 9<br/><strong>Процент восстановленных хэшей:</strong> 23.10613<br/><strong>Затраченное время в секундах:</strong> 860<br/><strong>Всего восстановлено:</strong> 1217</p><figure class="full-width "><img src="/img/image-loader.svg" alt="Сравнение наборов методов" title="Сравнение наборов методов" height="336" data-src="https://habrastorage.org/getpro/habr/upload_files/b54/47c/e74/b5447ce74260142866571092da871650.png" data-width="590"/><figcaption>Сравнение наборов методов</figcaption></figure><p>В зависимости от целей и располагаемого времени, рекомендуется выбрать один из наборов, из списка выше. Однако наилучший результат будет достигнут путем применения самостоятельно сгенерированных словарей, масок и правил.</p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bhashcat%5D" class="tm-tags-list__link">hashcat</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bactivedirectory%5D" class="tm-tags-list__link">activedirectory</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bpentest%5D" class="tm-tags-list__link">pentest</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bpasswords%5D" class="tm-tags-list__link">passwords</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bwindows%5D" class="tm-tags-list__link">windows</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/company/deiteriylab/blog/" class="tm-hubs-list__link router-link-active">
    Блог компании Deiteriy Lab
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/infosecurity/" class="tm-hubs-list__link">
    Информационная безопасность
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/sys_admin/" class="tm-hubs-list__link">
    Системное администрирование
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 20: ↑19 и ↓1</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 20: ↑19 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+18</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5.7K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    73
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="/ru/company/deiteriylab/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" height="40" src="//habrastorage.org/getpro/habr/company/655/e13/ab1/655e13ab17c25e01d5a93824fa872af3.png" width="40" class="tm-entity-image__pic"></div></a> <div class="tm-company-snippet__info"><a href="/ru/company/deiteriylab/profile/" class="tm-company-snippet__title">Deiteriy Lab</a> <div class="tm-company-snippet__description">Делаем пентесты</div></div></div> <div class="tm-article-author__buttons"><!----> <!----></div></div> <div class="tm-article-author__company-contacts"><a href="https://lab.deiteriy.com" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a></div> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/kukuxumushi/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/c47/6a5/472/c476a5472f5f93a37fa99db7fd09b0b0.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 5 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    5
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">18</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/kukuxumushi/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @kukuxumushi
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/company/deiteriylab/blog/584160/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 3 
    </span></a> <!----></div></div></div>  <!---->  <!----> <!----></div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section class="tm-block tm-block_spacing-bottom"><header class="tm-block__header"><h2 class="tm-block__title">Информация</h2> <!----></header> <div class="tm-block__body"><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата основания</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2010-01-25T21:00:00.000Z" title="2010-01-26, 00:00">26  января  2010</time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Местоположение</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    Россия
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Сайт</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="https://lab.deiteriy.com" target="_blank" class="tm-company-basic-info__link">
      lab.deiteriy.com
    </a></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Численность</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    11–30 человек
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата регистрации</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2021-10-05T08:44:15.000Z" title="2021-10-05, 11:44">5  октября  </time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Представитель</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="/ru/users/ostrokonskiy/" class="tm-company-basic-info__link">
      Антон
    </a></dd></dl></div></div> <!----></section> <div class="tm-company-widgets"></div> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/company/deiteriylab/blog/584160/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/company/deiteriylab/blog/584160/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"584160":{"id":"584160","timePublished":"2021-10-19T16:34:11+00:00","isCorporative":true,"lang":"ru","titleHtml":"Брутфорс хэшей в Active Directory","leadData":{"textHtml":"\u003Cp\u003EСлабые пароли пользователей — очень распространенная проблема, которая может позволить злоумышленнику повысить свои привилегии в сети компании и закрепиться в ней.\u003C\u002Fp\u003E\u003Cp\u003EЧтобы этого не допустить, необходимо регулярно анализировать стойкость паролей пользователей.\u003C\u002Fp\u003E\u003Cp\u003EУ системных администраторов нет возможности увидеть пароли пользователей в открытом виде, но они могут загрузить хэши паролей и провести их перебор.\u003C\u002Fp\u003E\u003Cp\u003EВ этой статье мы расскажем о том, как можно легко получить хэши паролей пользователей и провести эффективный перебор паролей, используя различные методы.\u003C\u002Fp\u003E\u003Cp\u003EДанный материал также будет полезен пентестерам, которым для развития атаки требуется восстановить пароли пользователей.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb2f\u002Fd15\u002Fde7\u002Fb2fd15de7671326b47166c3275d34f33.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb2f\u002Fd15\u002Fde7\u002Fb2fd15de7671326b47166c3275d34f33.png","fit":"cover","positionY":12.272727272727,"positionX":0.51282051282051}},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"scoreStats":{"score":5,"votesCount":5},"rating":18,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"745327","alias":"kukuxumushi","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fc47\u002F6a5\u002F472\u002Fc476a5472f5f93a37fa99db7fd09b0b0.jpg","speciality":null},"statistics":{"commentsCount":3,"favoritesCount":73,"readingCount":5735,"score":18,"votesCount":20},"hubs":[{"relatedData":null,"id":"22820","alias":"deiteriylab","type":"corporative","title":"Блог компании Deiteriy Lab","titleHtml":"Блог компании Deiteriy Lab","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"221","alias":"sys_admin","type":"collective","title":"Системное администрирование","titleHtml":"Системное администрирование","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"1179\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffb1\u002Fdeb\u002F497\u002Ffb1deb497e4627ef832f5e23779a116f.png\" data-width=\"1490\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EСлабые пароли пользователей — очень распространенная проблема, которая может позволить злоумышленнику повысить свои привилегии и закрепиться в сети компании.\u003C\u002Fp\u003E\u003Cp\u003EЧтобы этого не допустить, необходимо регулярно анализировать стойкость паролей пользователей.\u003C\u002Fp\u003E\u003Cp\u003EУ системных администраторов нет возможности увидеть пароли пользователей в открытом виде, но они могут выгрузить хэши паролей и провести их перебор.\u003C\u002Fp\u003E\u003Cp\u003EВ этой статье мы расскажем о том, как можно легко получить хэши паролей пользователей и провести эффективный перебор паролей, используя различные методы.\u003C\u002Fp\u003E\u003Cp\u003EДанный материал также будет полезен пентестерам, которым для развития атаки требуется восстановить пароли пользователей из их хэш-значений.\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003ETL;DR\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Ch3\u003EЧем перебирать?\u003C\u002Fh3\u003E\u003Cp\u003EСкачать в GitHub \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fhashcat\u002Fhashcat\u002Freleases\u002F\"\u003Eрепозитории\u003C\u002Fa\u003E последнюю сборку приложения в архиве. Разархивировать и запустить hashcat.exe в командной строке.\u003C\u002Fp\u003E\u003Ch3\u003EГде взять хэши?\u003C\u002Fh3\u003E\u003Cp\u003EСкачать с контроллера домена, утилитой \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FSecureAuthCorp\u002Fimpacket\u002Fblob\u002Fmaster\u002Fexamples\u002Fsecretsdump.py\"\u003Esecretsdump.py\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003Epython secretsdump.py deiteriy.local\u002FAdministrator@192.168.88.32 -just-dc-ntlm\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3\u003EКак перебирать?\u003C\u002Fh3\u003E\u003Cp\u003EЕсли нет времени или желания долго ждать перебора, то рекомендуется использовать комбинацию из всех четырех методов из списка ниже:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EСловарь \u003Ca href=\"https:\u002F\u002Fcrackstation.net\u002Fcrackstation-wordlist-password-cracking-dictionary.htm\"\u003Erealuniq.lst\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EЗапускаем hashcat с предварительно загруженным словарем:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003E  hashcat.exe -m 1000 -a 0 -O -w 4 E:\\hashs.txt E:\\dicts\\realuniq.lst\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСловарь из календарных единиц (файл для генерации ниже) с правилами мутации dive.rule (правила из комплекта hashcat).\u003C\u002Fp\u003E\u003Cp\u003EЗапустить скрипт на Python, который создаст словарь calendar_passwords.txt:\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fraw.githubusercontent.com\u002Fkukuxumushi\u002Fcalendar_password_generator\u002Fmain\u002Fwordlist_generator.py\"\u003Ewordlist_generator.py\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp\u003EЗапускаем hashcat со сгенерированным словарем:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003E hashcat.exe -m 1000 -a 0 -O -w 4 E:\\hashs.txt E:\\dicts\\calendar_passwords.txt -r rules\\dive.rule\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСловарь \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fdanielmiessler\u002FSecLists\u002Fblob\u002Fmaster\u002FPasswords\u002FLeaked-Databases\u002Frockyou.txt.tar.gz\"\u003Erockyou.txt\u003C\u002Fa\u003E с правилами мутации dive.rule (стандартное правило).\u003C\u002Fp\u003E\u003Cp\u003EЗапускаем hashcat с предварительно загруженным словарем:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003E  hashcat.exe -m 1000 -a 0 -O -w 4 E:\\hashs.txt E:\\dicts\\rockyou.txt -r rules\\dive.rule\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСловарь \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fdanielmiessler\u002FSecLists\u002Fblob\u002Fmaster\u002FPasswords\u002FLeaked-Databases\u002Frockyou.txt.tar.gz\"\u003Erockyou.txt\u003C\u002Fa\u003E с правилами мутации \u003Ca href=\"https:\u002F\u002Fraw.githubusercontent.com\u002FNotSoSecure\u002Fpassword_cracking_rules\u002Fmaster\u002FOneRuleToRuleThemAll.rule\"\u003EOneRuleToRuleThemAll.rule\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003E  hashcat.exe -m 1000 -a 0 -O -w 4 E:\\hashs.txt E:\\dicts\\rockyou.txt -r rules\\OneRuleToRuleThemAll.rule\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Ch2\u003EКонфигурация тестового стенда\u003C\u002Fh2\u003E\u003Cp\u003EДля демонстрации получения хэшей была создана Active Directory инфраструктура, состоящая из одного контроллера домена и одного компьютера в сети.\u003C\u002Fp\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"380\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa1a\u002F5e2\u002Fd27\u002Fa1a5e2d27ca60c67243de13980121f4c.png\" data-width=\"431\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EКонфигурация компьютера для перебора паролей:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EIntel Core i7-7700.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E32GB RAM.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003ENvidia GeForce GTX 1060 6GB.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Ehashcat 6.1.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EWindows 10 build 19041.572.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EGeForce Game Ready Driver 460.89.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003ECUDA 11.2.0.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch2\u003EПодготовка\u003C\u002Fh2\u003E\u003Ch3\u003EКак получить хэши для перебора?\u003C\u002Fh3\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EЧто такое NTLM-хэш?\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cp\u003EХэш — это результат работы хэш-функции, которая осуществляет преобразование строки произвольной длины в строку фиксированной длины.\u003C\u002Fp\u003E\u003Cp\u003ENT-хэш или NTLM-хэш является результатом работы функции MD4(UTF-16-LE(password)) — функции хэширования MD4 от пароля, закодированного в кодировке UTF-16 little-endian.\u003C\u002Fp\u003E\u003Cp\u003EСлабости алгоритма MD4 были известны еще с 1991 года, а в 2011 году его признали устаревшим, однако он все еще повсеместно используется для хранения паролей в Windows-инфраструктуре. Данный алгоритм также обладает низкой вычислительной сложностью, что позволяет относительно быстро перебирать возможные значения.\u003C\u002Fp\u003E\u003Cp\u003EВ NTLM-хэш не применяется криптографическая соль, следовательно один пароль всегда будет соответствовать одному хэш-значению. Это позволяет находить пользователей, которые используют одинаковые пароли даже если мы не знаем их значения. Также это позволяет проводить поиск хэш-значений в радужных таблицах.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Cp\u003EДля получения хэшей всех пользователей домена можно воспользоваться утилитой \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FSecureAuthCorp\u002Fimpacket\u002Fblob\u002Fmaster\u002Fexamples\u002Fsecretsdump.py\"\u003Esecretsdump.py\u003C\u002Fa\u003E, входящей в состав пакета \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FSecureAuthCorp\u002Fimpacket\"\u003Eimpacket\u003C\u002Fa\u003E. Для использования утилиты необходимо иметь установленный интерпретатор языка программирования \u003Ca href=\"https:\u002F\u002Fwww.python.org\u002Fdownloads\u002F\"\u003EPython\u003C\u002Fa\u003E версии 2.7 или выше. Также существуют сборки утилиты \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fmaaaaz\u002Fimpacket-examples-windows\u002Fblob\u002Fmaster\u002Fsecretsdump.exe\"\u003Esecretsdump\u003C\u002Fa\u003E, специально созданные для работы под OS Windows, и не требующие наличия сторонних интерпретаторов.\u003C\u002Fp\u003E\u003Cp\u003EДанная утилита может быть запущена на любом устройстве, имеющем сетевой доступ к контроллеру домена.\u003C\u002Fp\u003E\u003Cp\u003EДля получения NTLM-хэшей с контроллера домена, можно воспользоваться следующей командой. Данная команда может быть выполнена на любом устройстве, имеющем сетевой доступ к контроллеру домена.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003Esecretsdump.exe deiteriy.local\u002FAdministrator@192.168.88.32 -just-dc-ntlm\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eгде:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003Edeiteriy.local\u003C\u002Fcode\u003E — название домена.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003EAdministrator\u003C\u002Fcode\u003E — имя учетной записи с правами доменного администратора.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E192.168.88.32\u003C\u002Fcode\u003E — IP-адрес или доменное имя контроллера домена.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-just-dc-ntlm\u003C\u002Fcode\u003E — аргумент, позволяющий получить только NTLM-хэши в формате domain\\uid:rid:lmhash:nthash.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Пример успешного получения NTLM-хэшей с тестового контроллера домена\" title=\"Пример успешного получения NTLM-хэшей с тестового контроллера домена\" height=\"623\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F753\u002Fdb2\u002F20f\u002F753db220fc12bfe5e0127268441c6261.png\" data-width=\"864\"\u002F\u003E\u003Cfigcaption\u003EПример успешного получения NTLM-хэшей с тестового контроллера домена\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch3\u003EЧем перебирать?\u003C\u002Fh3\u003E\u003Cp\u003E\u003Cstrong\u003EOffline:\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fhashcat.net\u002Fhashcat\u002F\"\u003Ehashcat\u003C\u002Fa\u003E — Самая популярная и производительная утилита, поддерживающая множество различных алгоритмов хэширования. Данная статья посвящена этой программе.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwww.openwall.com\u002Fjohn\u002F\"\u003EJohn the Ripper\u003C\u002Fa\u003E — Старейший набор программ для перебора хэшей и преобразования различных файлов в их хэш-значения для последующего перебора. Кросплатформенный, поддерживает множество алгоритмов, однако имеет меньшую производительность, чем hashcat.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"http:\u002F\u002Fproject-rainbowcrack.com\u002F\"\u003ERainbowCrack\u003C\u002Fa\u003E — Данное приложение использует другой подход к перебору хешей: не вычисление хэшей от паролей и их последующее сравнение, а поиск хэшей по заранее сгенерированным таблицам, содержащим пары хэш — значение. Отличается очень высокой скоростью подбора (быстрее в ~5000 раз), по сравнению с остальными утилитами, однако требует хранения заранее сгенерированных таблиц для каждого алгоритма хэширования, которые занимают \u003Cstrong\u003Eдесятки\u003C\u002Fstrong\u003E \u003Cstrong\u003Eтерабайт\u003C\u002Fstrong\u003E дискового пространства.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003E\u003Cstrong\u003EOnline:\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fcrackstation.net\u002F\"\u003Ecrackstation\u003C\u002Fa\u003E — Сервис, позволяющий производить поиск хэшей в словаре, содержащем 1,6 миллиарда паролей.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwww.onlinehashcrack.com\u002F\"\u003Eonlinehashcrack\u003C\u002Fa\u003E — Сервис, предоставляющий возможность полного перебора и перебора паролей по словарю в облаке. При успешном восстановлении исходного значения, будет предложено оплатить услуги для получения этого значения. Для проверки сложности паролей, может быть достаточно информации о том, что исходное значение хэша можно восстановить за приемлемое время.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EПоисковые системы (Google, Yandex, …) — Любой хэш можно “загуглить”. Если в поисковой выдаче есть проиндексированная страница с данным хешем, то велик шанс, что на ней находится соответствие хэш — исходное значение.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch3\u003EУстановка hashcat\u003C\u002Fh3\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003EСкачать в GitHub \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fhashcat\u002Fhashcat\u002Freleases\u002F\"\u003Eрепозитории\u003C\u002Fa\u003E последнюю сборку приложения в архиве. Архив содержит программу под операционные системы Windows и Linux.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСкачать и установить последнюю версию драйверов GPU (\u003Ca href=\"https:\u002F\u002Fwww.nvidia.com\u002FDownload\u002Findex.aspx\"\u003ENvidia\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fwww.amd.com\u002Fen\u002Fsupport\"\u003EAMD\u003C\u002Fa\u003E).\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EРазархивировать файл из первого пункта и запустить hashcat.exe из командой строки. Для проверки корректности установки можно использовать следующую команду:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003E hashcat.exe -w 4 -O -m 1000 --benchmark\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eгде:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-w 4\u003C\u002Fcode\u003E — Выбор режима рабочей нагрузки из заданного набора, где 1 — самая минимальная нагрузка, а 4 — максимальная. Если вы заметили существенное ухудшение производительности, которое мешает работе с устройством, рекомендуется использовать меньшее значение параметра -w.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-O\u003C\u002Fcode\u003E — Включить оптимизированные ядра.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-m 1000\u003C\u002Fcode\u003E — Выбор алгоритма хаширования, в данном случае 1000 — NTLM.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-benchmark\u003C\u002Fcode\u003E — Запустить тестирование производительности для выбранного алгоритма.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EБолее подробно об аргументах можно прочитать на странице помощи утилиты:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003E hashcat.exe --help \n или \n hashcat.exe -h\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Пример успешного запуска утилиты hashcat в режиме benchmark \" title=\"Пример успешного запуска утилиты hashcat в режиме benchmark \" height=\"509\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F77c\u002F576\u002Fd4f\u002F77c576d4fa0f2fc8b084168dd5726efb.png\" data-width=\"853\"\u002F\u003E\u003Cfigcaption\u003EПример успешного запуска утилиты hashcat в режиме benchmark \u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EЕсли используется GPU Nvidia, то можно увидеть предупреждение, как на рисунке выше. По умолчанию hashcat использует открытый фреймворк OpenCL для работы с GPU, однако Nvidia разработала свой собственный — \u003Ca href=\"https:\u002F\u002Fdeveloper.nvidia.com\u002Fcuda-toolkit\"\u003ECUDA\u003C\u002Fa\u003E. Рекомендуется установить его для повышения производительности.\u003C\u002Fp\u003E\u003Cp\u003EЗапустив еще раз команду выше, видим, что после установки CUDA, производительность выросла на 15%.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Пример успешного запуска утилиты hashcat в режиме benchmark с установленным CUDA драйвером\" title=\"Пример успешного запуска утилиты hashcat в режиме benchmark с установленным CUDA драйвером\" height=\"487\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F691\u002F9e8\u002F106\u002F6919e8106a88480b82956e2f8be81286.png\" data-width=\"716\"\u002F\u003E\u003Cfigcaption\u003EПример успешного запуска утилиты hashcat в режиме benchmark с установленным CUDA драйвером\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch2\u003EПеребор паролей\u003C\u002Fh2\u003E\u003Cp\u003E90% успеха в переборе паролей — это правильно выбранный метод подбора. В данной статье рассмотрено несколько таких методов, а в конце приведено сравнение таких методов по скорости и эффективности.\u003C\u002Fp\u003E\u003Ch3\u003EПеребор по публично доступным словарям\u003C\u002Fh3\u003E\u003Cp\u003EНесколько примеров словарей, которые можно найти в открытом доступе:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fdanielmiessler\u002FSecLists\u002Ftree\u002Fmaster\u002FPasswords\"\u003ESecLists\u003C\u002Fa\u003E — Репозиторий содержит большое количество файлов с паролями, в том числе рейтинги самых популярных паролей, а также словарей, полученных в результате утечек из различных сервисов.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fcrackstation.net\u002Fcrackstation-wordlist-password-cracking-dictionary.htm\"\u003EСrackstation\u003C\u002Fa\u003E — Сервис, позволяющий производить поиск хэшей в словаре, предоставляет один из самых больших (1,6 миллиарда строк) словарей. По заявлению создателей, словарь содержит все пароли, которые когда-либо были опубликованы в Интернете.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fberzerk0\u002FProbable-Wordlists\"\u003EProbable-Wordlists\u003C\u002Fa\u003E — Репозиторий содержит словари паролей как из утечек, так и из различных публично доступных словарей. Проект содержит аналитику популярности использования паролей, а также маски и правила для утилиты hashcat.  \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fweakpass.com\u002F\"\u003Eweakpass.com\u003C\u002Fa\u003E — На сайте собрано большое количество словарей агрегированных из различных источников и их комбинаций. Есть словари размером как меньше мегабайта, так и больше четырехсот гигабайт.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch4\u003EСловарь rockyou.txt\u003C\u002Fh4\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fdanielmiessler\u002FSecLists\u002Fblob\u002Fmaster\u002FPasswords\u002FLeaked-Databases\u002Frockyou.txt.tar.gz\"\u003Erockyou.txt\u003C\u002Fa\u003E — самый популярный словарь для перебора, состоящий из самых популярных паролей, собранных из публично опубликованных баз данных.\u003C\u002Fp\u003E\u003Cp\u003EДля перебора по словарю rockyou.txt, его необходимо загрузить на устройство, а затем выполнить следующую команду в командной строке:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 E:\\hashs.txt E:\\dicts\\rockyou.txt\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eгде:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-m 1000\u003C\u002Fcode\u003E — Выбор алгоритма хэширования, в данном случае 1000 — NTLM.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-a 0\u003C\u002Fcode\u003E — Выбор режима работы (0 — перебор по словарю, 3 — перебор по маске, 1,6,7 — Гибридные режимы работы).\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-O\u003C\u002Fcode\u003E — Включить оптимизированные ядра.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-w 4\u003C\u002Fcode\u003E — Выбор режима рабочей нагрузки из заданного набора 1-4, где 1 — самая минимальная нагрузка, а 4 — максимальная.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003EE:\\hashs.txt\u003C\u002Fcode\u003E — Путь к файлу с хэшами.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003EE:\\dicts\\rockyou.txt\u003C\u002Fcode\u003E — Путь к словарю.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EНа рисунке ниже, видим пример вывода программы. Красным выделены пары хэш — значение, которые были успешно восстановлены.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Пример успешно подобранных паролей\" title=\"Пример успешно подобранных паролей\" height=\"623\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcea\u002F662\u002F26a\u002Fcea66226a38ca700c871d4b8d3a44c92.png\" data-width=\"722\"\u002F\u003E\u003Cfigcaption\u003EПример успешно подобранных паролей\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EНа тестовом стенде программе потребовалось 3 секунды на перебор 20-и хэшей по словарю, содержащему 1,4 миллиона паролей.\u003C\u002Fp\u003E\u003Cp\u003EПосле успешного подбора, пары хэш — значение будут помещены в pot-файл, расположенный в папке с программой — E:\\hashcat\\hashcat.potfile. При каждом запуске программы, в первую очередь будет проверяться наличие хэшей в pot-файле, чтобы не перебирать известные хэши заново. Если такой хэш был найден, то он не будет выведен на экран. Вместо этого будет выведено информационное сообщение о том, что такой хэш был найден в pot-файле.\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003EINFO: Removed 3 hashes found in potfile. \u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EСодержимое pot-файла:\u003C\u002Fp\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Пример содержимого pot-файла\" title=\"Пример содержимого pot-файла\" height=\"140\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F629\u002F5bc\u002F8f7\u002F6295bc8f723402cad292ad6129c75a02.png\" data-width=\"504\"\u002F\u003E\u003Cfigcaption\u003EПример содержимого pot-файла\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EДля просмотра таких хэшей, можно воспользоваться командой:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003Ehashcat.exe -m 1000 E:\\hashs.txt --show\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Поиск хэшей в pot-файле\" title=\"Поиск хэшей в pot-файле\" height=\"85\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6ac\u002F34f\u002F2e7\u002F6ac34f2e78a301b033effc9025ff4b62.png\" data-width=\"465\"\u002F\u003E\u003Cfigcaption\u003EПоиск хэшей в pot-файле\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch4\u003EСловарь realunique от Сrackstation\u003C\u002Fh4\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fcrackstation.net\u002Fcrackstation-wordlist-password-cracking-dictionary.htm\"\u003Erealuniq.lst\u003C\u002Fa\u003E — По заявлению создателей — это самый большой файл с паролями на просторах интернета — содержит 1,6 миллиарда паролей.\u003C\u002Fp\u003E\u003Cp\u003EДля перебора по словарю realunique, его необходимо загрузить на устройство, а затем выполнить следующую команду в командной строке:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 E:\\hashs.txt E:\\dicts\\realuniq.lst\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EРезультат работы на рисунке ниже:\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Перебор по словарю\" title=\"Перебор по словарю\" height=\"387\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff5e\u002F565\u002F97d\u002Ff5e56597d51a83f43d1cb92740e465d6.png\" data-width=\"924\"\u002F\u003E\u003Cfigcaption\u003EПеребор по словарю\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EНа тестовом стенде программе потребовалось 39 секунд на перебор 20-и хэшей по словарю, содержащему 1,2 миллиарда паролей.\u003C\u002Fp\u003E\u003Ch3\u003EПеребор по самодельному словарю\u003C\u002Fh3\u003E\u003Cp\u003EУ каждой организации свои парольные политики и своя культура, связанная с особенностями работы (Bank2020!, Neft2020@, C@rd2019), местоположением (Russia2020!, Astana2010#, Moscow123$), названиями компании (BankRot123, G@zM0sPr0m, Vodorod!@#), филиалов (H3adOff1ce1, $KolymaDep$, Branch*) и отделов (HR123!@#, ITdep!!!, Accountants200). Также словари не учитывают специфику языка пользователей (Mamir2020 (май на казахском языке), Vfq2020! (май на русском языке, набранный другой раскладкой), Maijs2018 (май на латышском языке)). Поэтому рекомендуется создавать свои собственные словари для перебора паролей и использовать их вместе с другими методами перебора.\u003C\u002Fp\u003E\u003Cp\u003EТакже, публичные словари редко учитывают специфику сетей Windows и ее парольные политики:\u003C\u002Fp\u003E\u003Cp\u003EПарольная политика \"Passwords must meet complexity requirements\", регламентирует, что пароль должен содержать символы как минимум из трех следующих категорий:\u003C\u002Fp\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003EЗаглавные буквы европейских языков (от A до Z, с диакритическими знаками, греческие и кириллические символы).\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСтрочные буквы европейских языков (от a до z, ß, с диакритическими знаками, греческие и кириллические символы).\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EЦифры (от 0 до 9).\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EНе алфавитно-цифровые символы (специальные символы): (\u003Ccode\u003E~! @ # $% ^ &amp; * _- + = \\| \\ () {} [] :;\" '&lt;\u003E,.? \u002F\u003C\u002Fcode\u003E) Символы валюты, такие как евро или Британский фунт не считаются специальными символами для этого параметра политики.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EЛюбой символ Юникода, относящийся к категории алфавитных символов, но не прописных или строчных. В эту группу входят символы Unicode из азиатских языков.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp\u003EТакже, стоит учитывать, что в Windows по умолчанию стоит минимальная длина пароля 8 символов, а частота смены пароля обычно установлена 90 дней.\u003C\u002Fp\u003E\u003Ch3\u003EСловарь — календарные единицы\u003C\u002Fh3\u003E\u003Cp\u003EПри частой смене паролей пользователям сложно запомнить сложный, стойкий пароль, который при этом будет действовать всего 3 месяца, и будет существенно отличаться от предыдущего. Поэтому, зачастую пользователи используют пароли, состоящие из следующих частей:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EМесяц\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EВремя года\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EГод\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСпецсимволы\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EНапример:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EMay2020!\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003ELeto2019\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EAprel2021@\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E19October.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EPbvf2020!! (где “Pbvf” — это слово “Зима” набранное другой раскладкой)\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EДля генерации такого словаря можно воспользоваться небольшим скриптом на Python:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Eimport datetime\nfrom itertools import permutations, product #библиотека для комбинирования элементов\n\n#определяем компоненты, из которых будет состоять пароль\nspecials = ['!','@','#','$','.','*','^','?'] #спецсимволы\n\n#месяца и времена года\nwords = [\"April\", \"Atdhfkm\", \"August\", \"Autumn\", \"Besna\", \"Becna\", \"B.km\", \"B.ym\", \"Ctynz,hm\", \"December\", \"Dtcyf\", \"Fduecn\", \"February\", \"Fghtkm\", \"January\", \"Jctym\", \"Jrnz,hm\", \"July\", \"June\", \"Ktnj\", \"Leto\", \"Ltrf,hm\", \"March\", \"May\", \"November\", \"October\", \"Ocen\", \"Osen\" \"Pbvf\", \"September\", \"Spring\", \"Summer\", \"Vesna\", \"Vecna\", \"Vfq\", \"Vfhn\", \"Winter\", \"Yjz,hm\", \"Zima\", \"Zydfhm\", \"3ima\"]\n# года с 2010 по текущий + 2 в форматах YYYY и YY\nnow = datetime.datetime.now()\nyears = list(range(2010,now.year+2))+list(range(10,int(str(now.year)[2:])+2))\n\n#открываем файл для сохранения паролей\nf_o = open(\"calendar_passwords.txt\", \"w\") \n\n#генерируем список специальных символов от 0 до 3 элементов\nspecial_array=[]\nfor i in range(0,4):\n    for subset in product(specials,repeat=i):\n        special_array.append(''.join(subset))\n\n#собираем компоненты в пароль\nfor word in words:\n    for year in years:\n        for special in special_array:\n            for password in permutations([word, str(year), special], 3):\n                f_o.write(''.join(password)+\"\\r\\n\")\n\n#закрываем файл\nf_o.close()\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ результате получаем словарь на 3,2 миллиона паролей.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 E:\\hashs.txt E:\\dicts\\calendar_passwords.txt\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Перебор по словарю\" title=\"Перебор по словарю\" height=\"386\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc26\u002Fe9c\u002F272\u002Fc26e9c2728884ea641fc572c1100df7a.png\" data-width=\"722\"\u002F\u003E\u003Cfigcaption\u003EПеребор по словарю\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EНа тестовом стенде программе потребовалось 2 секунды на перебор 20-и хэшей по словарю, содержащему 3,2 миллиона паролей.\u003C\u002Fp\u003E\u003Ch3\u003EПароль-“змейка”\u003C\u002Fh3\u003E\u003Cp\u003E“Змейка” это строка, набираемая на клавиатуре, позиции символов в которой, подвержены неким закономерностям, например, набираются друг за другом (qwerty, asdfgh, zxcvb), находятся друг под другом (qaz, wsx, edc), их можно набирать “не отрывая руки” от клавиатуры (qwedcxza, zxcdsaqwe, 4rfvbgt5) или комбинации этих закономерностей (1qaz2wsx3edc).\u003C\u002Fp\u003E\u003Cp\u003EБольшое число таких паролей содержится в публичных словарях, однако не все удовлетворяют парольным политикам Windows.\u003C\u002Fp\u003E\u003Cp\u003EДля генерации таких паролей можно воспользоваться утилитой \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fhashcat\u002Fkwprocessor\"\u003Ekwprocessor\u003C\u002Fa\u003E, либо набрать “змейку” самостоятельно, учитывая особенности парольных политик (!QAZ2wsx#EDC, 1q2w3e4r5t^Y, !QAZ1qaz!QAZ).\u003C\u002Fp\u003E\u003Ch3\u003EПеребор по словарю с правилами мутации\u003C\u002Fh3\u003E\u003Cp\u003EПравила мутации (Rule-based Attack) — преобразование слов из словаря, по некоторым, заранее заданным, правилам.\u003C\u002Fp\u003E\u003Cp\u003EДля описания правил в hashcat \u003Ca href=\"https:\u002F\u002Fhashcat.net\u002Fwiki\u002Fdoku.php?id=rule_based_attack\"\u003Eсуществует\u003C\u002Fa\u003E специальный язык программирования. Написание собственных правил — это нетривиальная задача, поэтому hashcat уже содержит несколько десятков наборов правил, найти которые можно в директории “rules”. Также существует множество наборов правил в открытом доступе, например в \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsearch?q=hashcat+rules\"\u003Eрепозиториях\u003C\u002Fa\u003E на GitHub.\u003C\u002Fp\u003E\u003Ch4\u003Edive.rule\u003C\u002Fh4\u003E\u003Cp\u003Edive.rule — самый большой набор правил, из тех, что идет в составе hashcat.\u003C\u002Fp\u003E\u003Cp\u003EДля запуска hascat cо словарем rockyou.txt и этим набором правил можно воспользоваться следующей командой:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 E:\\hashs.txt E:\\dicts\\rockyou.txt -r rules\\dive.rule\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eгде:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-r\u003C\u002Fcode\u003E — Использовать правила.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003Erules\u002Fdive.rule\u003C\u002Fcode\u003E — Путь к правилам.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Перебор по словарю с правилами мутации\" title=\"Перебор по словарю с правилами мутации\" height=\"405\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F697\u002Fc9b\u002Fc7a\u002F697c9bc7a0f8c9c9d28a6f262e561f08.png\" data-width=\"973\"\u002F\u003E\u003Cfigcaption\u003EПеребор по словарю с правилами мутации\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EНа тестовом стенде программе потребовалось 415 секунд на перебор 20-и хэшей по словарю, из которого было создано 1,4 триллиона паролей. Также видим, что словарь, который содержал всего 3 пароля из 20, с помощью правил позволил восстановить 13 из 20 значений.\u003C\u002Fp\u003E\u003Cdiv\u003E\u003Cdiv class=\"table\"\u003E\u003Ctable\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Cth\u003E\u003Cp align=\"center\"\u003EПолучены с использованием правил\u003C\u002Fp\u003E\u003C\u002Fth\u003E\u003Cth\u003E\u003Cp align=\"center\"\u003EПолучены без использования правил\u003C\u002Fp\u003E\u003C\u002Fth\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E(пустой пароль)\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E(пустой пароль)\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003Eliverpool_fc5\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003Eliverpool_fc5\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003Efr!3ndss\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003Efr!3ndss\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E!QAZ1qaz!QAZ\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E \u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E118@4\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E \u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003EAlbert93!\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E \u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003EMay2020!\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E \u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E!QAZ2wsx#EDC\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E \u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E(!)(!)\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E \u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003EKtnj2020\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E \u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E987654cc–\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E \u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E1q2w3e4r5t^Y\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E \u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E2020jana@@\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E \u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Ch4\u003EOneRuleToRuleThemAll.rule\u003C\u002Fh4\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FNotSoSecure\u002Fpassword_cracking_rules\"\u003EOneRuleToRuleThemAll.rule\u003C\u002Fa\u003E — набор правил, который является комбинацией самых популярных правил из других наборов.\u003C\u002Fp\u003E\u003Cp\u003EПо заверениям создателей, при двукратно меньшем размере позволяет восстановить на 4% больше паролей, чем dive.rule.\u003C\u002Fp\u003E\u003Cp\u003EДля использования правила, необходимо сохранить \u003Ca href=\"https:\u002F\u002Fraw.githubusercontent.com\u002FNotSoSecure\u002Fpassword_cracking_rules\u002Fmaster\u002FOneRuleToRuleThemAll.rule\"\u003Eфайл\u003C\u002Fa\u003E, в директорию “rules”.\u003C\u002Fp\u003E\u003Cp\u003EДалее правило можно вызвать как предустановленное:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 E:\\hashs.txt E:\\dicts\\rockyou.txt -r rules\\OneRuleToRuleThemAll.rule\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Перебор по словарю с правилами мутации\" title=\"Перебор по словарю с правилами мутации\" height=\"406\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe80\u002F531\u002Ff33\u002Fe80531f33fbdf9bae5edc1846d8018d7.png\" data-width=\"723\"\u002F\u003E\u003Cfigcaption\u003EПеребор по словарю с правилами мутации\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EНа тестовом стенде программе потребовалось 192 секунды на перебор 20-и хэшей по словарю, содержащему 745 миллиардов паролей. Данное правило позволило восстановить 11 паролей из 20, что на два меньше, чем в dive.rule, однако программа отработала в 2 раза быстрее, чем в случае с dive.rule.\u003C\u002Fp\u003E\u003Ch3\u003EПеребор по маске\u003C\u002Fh3\u003E\u003Cp\u003EПеребор по маске является разновидностью полного перебора.\u003C\u002Fp\u003E\u003Cp\u003EВ hashcat существуют предопределенные наборы символов, которые позволяют описывать маску для перебора.\u003C\u002Fp\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Предопределенные наборы символов\" title=\"Предопределенные наборы символов\" height=\"216\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F473\u002F383\u002F472\u002F473383472310e56da92c14b838a149ed.png\" data-width=\"370\"\u002F\u003E\u003Cfigcaption\u003EПредопределенные наборы символов\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EНапример, маска \u003Ccode\u003E?a?a?a\u003C\u002Fcode\u003E означает, что будут перебираться все комбинации символов из набора: \u003Ccode\u003EabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 !\"#$%&amp;'()*+,-.\u002F:;&lt;=\u003E?@[\\]^_\\{|}~\u003C\u002Fcode\u003E длиной 3. Однако набор символов ?a является очень большим, что не позволяет в обозримое время перебирать длинные пароли. Например, для перебора 20 хэшей по маске \u003Ccode\u003E?a?a?a?a?a?a?a?a\u003C\u002Fcode\u003E (длина 8) на тестовом стенде потребуется около 7-и дней.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003Ehashcat.exe -m 1000 -a 3 -O -w 4 E:\\hashs.txt ?a?a?a?a?a?a?a?a\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eгде:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003Ea 3\u003C\u002Fcode\u003E — Режим перебора по маске.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E?a?a?a?a?a?a?a?a\u003C\u002Fcode\u003E — Маска, означающая пароль, длиной 8, состоящий из символов \u003Ccode\u003EabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 !\"#$%&amp;'(),-.\u002F:;&lt;=\u003E?@[\\]^_{|}~+*\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Перебор по маске\" title=\"Перебор по маске\" height=\"325\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F849\u002F1bc\u002Fe93\u002F8491bce935f38fa5833eebc786772110.png\" data-width=\"745\"\u002F\u003E\u003Cfigcaption\u003EПеребор по маске\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПеребором по маске с набором символов ?a можно пользоваться для перебора коротких паролей, например, длиной от 1 до 6. Для того чтобы не вводить команду 6 раз, можно воспользоваться режимом инкрементирования:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"powershell\"\u003Ehashcat.exe -m 1000 -a 3 -O -w 4 E:\\hashs.txt ?a?a?a?a?a?a --increment --increment-min 1\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eгде:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-increment\u003C\u002Fcode\u003E — Запуск в режиме инкрементирования.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-increment-min 1\u003C\u002Fcode\u003E — Минимальная длина пароля 1.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Перебор по маске с инкрементом\" title=\"Перебор по маске с инкрементом\" height=\"380\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa71\u002F6d2\u002F61f\u002Fa716d261fb81760b8e206c78ed98a58b.png\" data-width=\"725\"\u002F\u003E\u003Cfigcaption\u003EПеребор по маске с инкрементом\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EПеребор 20 хэшей паролей с длиной от 1 до 6 символов был осуществлен за 71 секунду, а паролей длиной 7, был бы осуществлен уже за 2 часа. Попытка восстановления исходных хэш-значений паролей с длиной меньше 8 символов может быть полезна в сети AD, в том случае, если минимальная длина пароля была когда-либо установлена меньше чем восемь символов.\u003C\u002Fp\u003E\u003Ch3\u003EПеребор по маске c самодельными наборами\u003C\u002Fh3\u003E\u003Cp\u003EДля ускорения процесса перебора по маске, а также возможности перебора более длинных паролей, можно воспользоваться некоторыми правилами и закономерностями. Если рассмотреть описанные выше методы, то можно заметить, что большое количество полученных паролей начинается с большой буквы, после неё следуют несколько строчных букв, а потом цифры и\u002Fили спецсимволы. Это можно представить в виде маски, например:\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003E?u?l?l?l?d?d?d?d\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Перебор по маске\" title=\"Перебор по маске\" height=\"386\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcda\u002F2fc\u002F2f2\u002Fcda2fc2f201449a4b13c878a361edafb.png\" data-width=\"727\"\u002F\u003E\u003Cfigcaption\u003EПеребор по маске\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EСущественно снизив набор символов, пароль длиной 8 символов можно перебрать за 2 секунды.\u003C\u002Fp\u003E\u003Ch2\u003EПеребор по наборам масок\u003C\u002Fh2\u003E\u003Cp\u003EЕсли мы хотим перебрать множество вариантов, состоящих из масок вида: большая буква, несколько строчных букв, цифры и\u002Fили спецсимволы, то придется запускать hashcat несколько десятков раз. Для упрощения задачи существуют hcmask-файлы — файлы набора масок. Создадим такой файл небольшим скриптом на Python:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Efor first in range(1,7):\n    for digits in range(0,6):\n        for second in range(0,3):\n            mask = \"?l3@17,!@#$%^&amp;*.,?u\"+str(\"?1\"*first)+str(\"?d\"*digits)+str(\"?2\"*second)\n            if len(mask)&lt;37 and len(mask)\u003E32:\n                print(\"?l3@17,!@#$%^&amp;*.,?u\"+str(\"?1\"*first)+str(\"?d\"*digits)+str(\"?2\"*second))\n                print(\"?l3@17,!@#$%^&amp;*.,\"+str(\"?d\"*digits)+\"?u\"+str(\"?1\"*first)+str(\"?2\"*second))\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЭтот скрипт создаст 62 строки вида:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E?l3@17,!@#$%^&amp;*.,?u?1?1?d?d?d?d?2?2\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКаждая из созданных строк состоит из трех полей, разделенных запятыми:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EСамодельный набор символов 1.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСамодельный набор символов 2.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EМаска, состоящая из наборов символов.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EДля перебора с использованием файла масок можно воспользоваться следующей командой:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Ehashcat.exe -m 1000 -a 3 -O -w 4 E:\\hashs.txt E:\\hashcat\\mask.hcmask\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eгде:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003EE:\\hashcat\\mask.hcmask\u003C\u002Fcode\u003E — Путь к файлу масок.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EПеребор 20 хэшей паролей по 62 маскам от 8 до 9 символов занял 44 минуты.\u003C\u002Fp\u003E\u003Ch3\u003EКак сделать удобный вывод\u003C\u002Fh3\u003E\u003Cp\u003EПосле всех операций выше, pot-файл будет заполнен полученными паролями и соответствующими им хэшами. Чтобы узнать какой пароль соответствует какому пользователю, можно выполнить следующую команду:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Ehashcat.exe -m 1000 --show --username --outfile E:\\output.txt --outfile-format 2 E:\\hashs.txt\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003Eгде:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-username\u003C\u002Fcode\u003E — Игнорирование имя пользователя в хэш-файле.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-outfile E:\\output.txt\u003C\u002Fcode\u003E — Файл, в который будет сохранен вывод программы.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003E-outfile-format 2\u003C\u002Fcode\u003E — Формат вывода программы, где 2 — в открытом виде.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cfigure class=\"\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Пример удобного вывода пар пользователь — пароль\" title=\"Пример удобного вывода пар пользователь — пароль\" height=\"351\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe74\u002F2e9\u002F9bd\u002Fe742e99bde0b964858336e2932a44ea7.png\" data-width=\"362\"\u002F\u003E\u003Cfigcaption\u003EПример удобного вывода пар пользователь — пароль\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Ch2\u003EСравнение эффективности\u003C\u002Fh2\u003E\u003Cp\u003EДля тестирования скорости перебора и количества получаемых паролей каждым из описанных выше методов, бы произведен перебор хэшей, полученных из существующей организации. С контроллера домена было получено 7168 пользователей с 5267 уникальными хэшами.\u003C\u002Fp\u003E\u003Cdetails class=\"spoiler\"\u003E\u003Csummary\u003EМетоды перебора\u003C\u002Fsummary\u003E\u003Cdiv class=\"spoiler__content\"\u003E\u003Cp\u003EМетод перебора №1\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EСловарь\u003C\u002Fstrong\u003E: rockyou.txt\u003Cbr\u002F\u003E\u003Cstrong\u003EУникальных хэшей восстановлено:\u003C\u002Fstrong\u003E 0\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 1.689766\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 4\u003Cbr\u002F\u003E\u003Cstrong\u003EХэшей восстановлено:\u003C\u002Fstrong\u003E 89\u003Cbr\u002F\u003E\u003Cstrong\u003EКоманда для запуска:\u003C\u002Fstrong\u003E \u003Ccode\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\\rockyou.txt\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EМетод перебора №2\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EСловарь:\u003C\u002Fstrong\u003E realunique\u003Cbr\u002F\u003E\u003Cstrong\u003EУникальных хэшей восстановлено:\u003C\u002Fstrong\u003E 0\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 3.721283\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 122\u003Cbr\u002F\u003E\u003Cstrong\u003EХэшей восстановлено:\u003C\u002Fstrong\u003E 196\u003Cbr\u002F\u003E\u003Cstrong\u003EКоманда для запуска:\u003C\u002Fstrong\u003E \u003Ccode\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\\realuniq.lst\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EМетод перебора №3\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EСловарь:\u003C\u002Fstrong\u003E из календарных единиц\u003Cbr\u002F\u003E\u003Cstrong\u003EУникальных хэшей восстановлено:\u003C\u002Fstrong\u003E 0\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 0.645529\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 2\u003Cbr\u002F\u003E\u003Cstrong\u003EХэшей восстановлено:\u003C\u002Fstrong\u003E 34\u003Cbr\u002F\u003E\u003Cstrong\u003EКоманда для запуска:\u003C\u002Fstrong\u003E \u003Ccode\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\\calendar_passwords.txt\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EМетод перебора №4\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EСловарь:\u003C\u002Fstrong\u003E rockyou.txt с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EУникальных хэшей восстановлено:\u003C\u002Fstrong\u003E 0\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 19.66964\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 448\u003Cbr\u002F\u003E\u003Cstrong\u003EХэшей восстановлено:\u003C\u002Fstrong\u003E 1036\u003Cbr\u002F\u003E\u003Cstrong\u003EКоманда для запуска:\u003C\u002Fstrong\u003E \u003Ccode\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\\rockyou.txt -r rules\\dive.rule\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EМетод перебора №5\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EСловарь:\u003C\u002Fstrong\u003E realunique с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EУникальных хэшей восстановлено:\u003C\u002Fstrong\u003E 137\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 30.20695\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 34784\u003Cbr\u002F\u003E\u003Cstrong\u003EХэшей восстановлено:\u003C\u002Fstrong\u003E 1591\u003Cbr\u002F\u003E\u003Cstrong\u003EКоманда для запуска:\u003C\u002Fstrong\u003E \u003Ccode\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\\realuniq.lst -r rules\\dive.rule\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EМетод перебора №6\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EСловарь:\u003C\u002Fstrong\u003E из календарных единиц с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EУникальных хэшей восстановлено:\u003C\u002Fstrong\u003E 9\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 2.41124\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 92\u003Cbr\u002F\u003E\u003Cstrong\u003EХэшей восстановлено:\u003C\u002Fstrong\u003E 127\u003Cbr\u002F\u003E\u003Cstrong\u003EКоманда для запуска:\u003C\u002Fstrong\u003E \u003Ccode\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\\calendar_passwords.txt -r rules\\dive.rule\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EМетод перебора №7\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EСловарь:\u003C\u002Fstrong\u003E rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EУникальных хэшей восстановлено:\u003C\u002Fstrong\u003E 0\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 18.54946\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 198\u003Cbr\u002F\u003E\u003Cstrong\u003EХэшей восстановлено:\u003C\u002Fstrong\u003E 977\u003Cbr\u002F\u003E\u003Cstrong\u003EКоманда для запуска:\u003C\u002Fstrong\u003E \u003Ccode\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\\rockyou.txt  -r rules\\OneRuleToRuleThemAll.rule\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EМетод перебора №8\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EСловарь:\u003C\u002Fstrong\u003E realunique с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EУникальных хэшей восстановлено:\u003C\u002Fstrong\u003E 63\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 28.0805\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 15684\u003Cbr\u002F\u003E\u003Cstrong\u003EХэшей восстановлено:\u003C\u002Fstrong\u003E 1479\u003Cbr\u002F\u003E\u003Cstrong\u003EКоманда для запуска:\u003C\u002Fstrong\u003E \u003Ccode\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\\realuniq.lst -r rules\\OneRuleToRuleThemAll.rule\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EМетод перебора №9\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EСловарь:\u003C\u002Fstrong\u003E из календарных единиц с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EУникальных хэшей восстановлено:\u003C\u002Fstrong\u003E 1\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 1.898614\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 46\u003Cbr\u002F\u003E\u003Cstrong\u003EХэшей восстановлено:\u003C\u002Fstrong\u003E 100\u003Cbr\u002F\u003E\u003Cstrong\u003EКоманда для запуска:\u003C\u002Fstrong\u003E \u003Ccode\u003Ehashcat.exe -m 1000 -a 0 -O -w 4 hashs.txt dicts\\calendar_passwords.txt -r rules\\OneRuleToRuleThemAll.rule\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EМетод перебора №10\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EСловарь:\u003C\u002Fstrong\u003E Маска ?a длиной от 1 до 6\u003Cbr\u002F\u003E\u003Cstrong\u003EУникальных хэшей восстановлено:\u003C\u002Fstrong\u003E 0\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 0.322764\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 73\u003Cbr\u002F\u003E\u003Cstrong\u003EХэшей восстановлено:\u003C\u002Fstrong\u003E 17\u003Cbr\u002F\u003E\u003Cstrong\u003EКоманда для запуска:\u003C\u002Fstrong\u003E \u003Ccode\u003Ehashcat.exe -m 1000 -a 3 -O -w 4 hashs.txt mask1-6.hcmask\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cp\u003EМетод перебора №11\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EСловарь:\u003C\u002Fstrong\u003E Набор масок длиной от 7 до 9\u003Cbr\u002F\u003E\u003Cstrong\u003EУникальных хэшей восстановлено:\u003C\u002Fstrong\u003E 71\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 7.404595\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 2668\u003Cbr\u002F\u003E\u003Cstrong\u003EХэшей восстановлено:\u003C\u002Fstrong\u003E 390\u003Cbr\u002F\u003E\u003Cstrong\u003EКоманда для запуска:\u003C\u002Fstrong\u003E \u003Ccode\u003Ehashcat.exe -m 1000 -a 3 -O -w 4 hashs.txt mask7-9.hcmask\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdetails\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" height=\"403\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc92\u002F3de\u002Ff39\u002Fc923def3948f9e28d0ef076fa9e93adf.png\" data-width=\"803\"\u002F\u003E\u003Cfigcaption\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cdiv\u003E\u003Cdiv class=\"table\"\u003E\u003Ctable\u003E\u003Ctbody\u003E\u003Ctr\u003E\u003Cth data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003EМетод\u003C\u002Fp\u003E\u003C\u002Fth\u003E\u003Cth data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003EУникальных* хэшей восстановлено\u003C\u002Fp\u003E\u003C\u002Fth\u003E\u003Cth data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003EПроцент восстановленных хэшей\u003C\u002Fp\u003E\u003C\u002Fth\u003E\u003Cth data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003EЗатраченное время в секундах\u003C\u002Fp\u003E\u003C\u002Fth\u003E\u003Cth\u003E\u003Cp align=\"center\"\u003EХэшей восстановлено\u003C\u002Fp\u003E\u003C\u002Fth\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003E1\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003E0\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003E1.689766\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003E4\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E89\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003E2\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003E0\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003E3.721283\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003E122\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E196\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003E3\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003E0\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003E0.645529\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003E2\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E34\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003E4\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003E0\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003E19.66964\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003E448\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E1036\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003E5\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003E137\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003E30.20695\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003E34784\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E1591\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003E6\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003E9\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003E2.41124\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003E92\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E127\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003E7\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003E0\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003E18.54946\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003E198\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E977\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003E8\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003E63\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003E28.0805\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003E15684\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E1479\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003E9\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003E1\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003E1.898614\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003E46\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E100\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003E10\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003E0\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003E0.322764\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003E73\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E17\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003Ctr\u003E\u003Ctd data-colwidth=\"61\" width=\"61\"\u003E\u003Cp align=\"center\"\u003E11\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"134\" width=\"134\"\u003E\u003Cp align=\"center\"\u003E71\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"156\" width=\"156\"\u003E\u003Cp align=\"center\"\u003E7.404595\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd data-colwidth=\"188\" width=\"188\"\u003E\u003Cp align=\"center\"\u003E2668\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003Ctd\u003E\u003Cp align=\"center\"\u003E390\u003C\u002Fp\u003E\u003C\u002Ftd\u003E\u003C\u002Ftr\u003E\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cp\u003E*Уникальный хэш — хэш, который не был получен ни в одном из других методов.\u003C\u002Fp\u003E\u003Cp\u003EВидим, что наибольшее число паролей восстановилось в методе “\u003Cem\u003E5. Словарь realunique с правилами мутации dive.rule\u003C\u002Fem\u003E”, который для получения конечных результатов требует 10 часов работы на тестовом стенде. В два раза быстрее отрабатывает метод “\u003Cem\u003E8. Словарь realunique с правилами мутации OneRuleToRuleThemAll.rule\u003C\u002Fem\u003E”, уступая предыдущему всего на 2% восстановленных паролей. Если требуется результат \"как можно скорее\", то можно воспользоваться методами “\u003Cem\u003E4. Словарь rockyou.txt с правилами мутации dive.rule\u003C\u002Fem\u003E” или “\u003Cem\u003E7. Словарь rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule\u003C\u002Fem\u003E”, которые отличаются друг от друга на 1% хэшей и уступают предыдущим методам почти на 10%, но при этом, отрабатывают за 7 и 3,5 минуты соответственно.\u003C\u002Fp\u003E\u003Ch3\u003EКомбинации методов\u003C\u002Fh3\u003E\u003Cp\u003EНаилучшие результаты достигаются путем использования нескольких из описанных выше методов.\u003C\u002Fp\u003E\u003Cp\u003EВ файле ниже приведена полная таблица со всеми комбинациями.\u003C\u002Fp\u003E\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwww.dropbox.com\u002Fs\u002Fv4xpi4vr7knve1l\u002Fcombo_1_2_3_4_5_top.xlsx?dl=0\"\u003E\u003Cu\u003Ehttps:\u002F\u002Fwww.dropbox.com\u002Fs\u002Fv4xpi4vr7knve1l\u002Fcombo_1_2_3_4_5_top.xlsx?dl=0\u003C\u002Fu\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cp\u003EНиже переведены лучшие комбинации из наборов методов от 2 до 5.\u003C\u002Fp\u003E\u003Ch3\u003EТоп 7 наборов методов по количеству восстановленных хэшей\u003C\u002Fh3\u003E\u003Ch4\u003EНабор методов №1\u003C\u002Fh4\u003E\u003Cp\u003E\u003Cstrong\u003EКомментарий:\u003C\u002Fstrong\u003E Лучший по количеству восстановленных хэшей\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 1:\u003C\u002Fstrong\u003E Словарь из календарных единиц с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 2:\u003C\u002Fstrong\u003E Словарь из календарных единиц с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 3:\u003C\u002Fstrong\u003E Набор масок длиной от 7 до 9\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 4:\u003C\u002Fstrong\u003E Словарь realunique с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 5:\u003C\u002Fstrong\u003E Словарь realunique с правилами мутации dive.rule\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоличество уникальных хэшей:\u003C\u002Fstrong\u003E 658\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 34.53579\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 53320\u003Cbr\u002F\u003E\u003Cstrong\u003EВсего восстановлено:\u003C\u002Fstrong\u003E 1819\u003C\u002Fp\u003E\u003Ch4\u003EНабор методов №2\u003C\u002Fh4\u003E\u003Cp\u003E\u003Cstrong\u003EКомментарий:\u003C\u002Fstrong\u003E Лучший по количеству уникальных хэшей\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 1:\u003C\u002Fstrong\u003E Словарь rockyou.txt с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 2:\u003C\u002Fstrong\u003E Словарь rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 3:\u003C\u002Fstrong\u003E Набор масок длиной от 7 до 9\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 4:\u003C\u002Fstrong\u003E Словарь realunique с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 5:\u003C\u002Fstrong\u003E Словарь realunique с правилами мутации dive.rule\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоличество уникальных хэшей:\u003C\u002Fstrong\u003E 1498\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 33.60547\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 53782\u003Cbr\u002F\u003E\u003Cstrong\u003EВсего восстановлено:\u003C\u002Fstrong\u003E 1770\u003C\u002Fp\u003E\u003Ch4\u003EНабор методов №3\u003C\u002Fh4\u003E\u003Cp\u003E\u003Cstrong\u003EКомментарий:\u003C\u002Fstrong\u003E Высокая скорость и большое количество восстановленных хэшей #1\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 1:\u003C\u002Fstrong\u003E Словарь из календарных единиц с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 2:\u003C\u002Fstrong\u003E Словарь rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 3:\u003C\u002Fstrong\u003E Словарь из календарных единиц с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 4:\u003C\u002Fstrong\u003E Набор масок длиной от 7 до 9\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 5:\u003C\u002Fstrong\u003E Словарь realunique с правилами мутации dive.rule\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоличество уникальных хэшей:\u003C\u002Fstrong\u003E 263\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 33.33966\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 37834\u003Cbr\u002F\u003E\u003Cstrong\u003EВсего восстановлено:\u003C\u002Fstrong\u003E 1756\u003C\u002Fp\u003E\u003Ch4\u003EНабор методов №4\u003C\u002Fh4\u003E\u003Cp\u003E\u003Cstrong\u003EКомментарий:\u003C\u002Fstrong\u003E Лучший набор из двух методов\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 1:\u003C\u002Fstrong\u003E Словарь realunique с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 2:\u003C\u002Fstrong\u003E Словарь realunique с правилами мутации dive.rule\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоличество уникальных хэшей:\u003C\u002Fstrong\u003E 462\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 32.23847\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 50468\u003Cbr\u002F\u003E\u003Cstrong\u003EВсего восстановлено:\u003C\u002Fstrong\u003E 1698\u003C\u002Fp\u003E\u003Ch4\u003EНабор методов №5\u003C\u002Fh4\u003E\u003Cp\u003E\u003Cstrong\u003EКомментарий:\u003C\u002Fstrong\u003E Высокая скорость и большое количество хэшей #2\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 1:\u003C\u002Fstrong\u003E Словарь из календарных единиц с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 2:\u003C\u002Fstrong\u003E Словарь rockyou.txt с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 3:\u003C\u002Fstrong\u003E Словарь из календарных единиц с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 4:\u003C\u002Fstrong\u003E Набор масок длиной от 7 до 9\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 5:\u003C\u002Fstrong\u003E Словарь realunique с правилами мутации OneRuleToRuleThemAll.rule\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоличество уникальных хэшей:\u003C\u002Fstrong\u003E 188\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 31.93469\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 18984\u003Cbr\u002F\u003E\u003Cstrong\u003EВсего восстановлено:\u003C\u002Fstrong\u003E 1682\u003C\u002Fp\u003E\u003Ch4\u003EНабор методов №6\u003C\u002Fh4\u003E\u003Cp\u003E\u003Cstrong\u003EКомментарий:\u003C\u002Fstrong\u003E Высокая скорость и большое количество хэшей #3\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 1:\u003C\u002Fstrong\u003E Словарь realunique\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 2:\u003C\u002Fstrong\u003E Словарь из календарных единиц с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 3:\u003C\u002Fstrong\u003E Словарь rockyou.txt с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 4:\u003C\u002Fstrong\u003E Словарь rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 5:\u003C\u002Fstrong\u003E Набор масок длиной от 7 до 9\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоличество уникальных хэшей:\u003C\u002Fstrong\u003E 80\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 25.74521\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 3528\u003Cbr\u002F\u003E\u003Cstrong\u003EВсего восстановлено:\u003C\u002Fstrong\u003E 1356\u003C\u002Fp\u003E\u003Ch4\u003EНабор методов №7\u003C\u002Fh4\u003E\u003Cp\u003E\u003Cstrong\u003EКомментарий:\u003C\u002Fstrong\u003E Высокая скорость и большое количество хэшей #4\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 1:\u003C\u002Fstrong\u003E Словарь realunique\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 2:\u003C\u002Fstrong\u003E Словарь из календарных единиц с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 3:\u003C\u002Fstrong\u003E Словарь rockyou.txt с правилами мутации dive.rule\u003Cbr\u002F\u003E\u003Cstrong\u003EМетод 4:\u003C\u002Fstrong\u003E Словарь rockyou.txt с правилами мутации OneRuleToRuleThemAll.rule\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EКоличество уникальных хэшей:\u003C\u002Fstrong\u003E 9\u003Cbr\u002F\u003E\u003Cstrong\u003EПроцент восстановленных хэшей:\u003C\u002Fstrong\u003E 23.10613\u003Cbr\u002F\u003E\u003Cstrong\u003EЗатраченное время в секундах:\u003C\u002Fstrong\u003E 860\u003Cbr\u002F\u003E\u003Cstrong\u003EВсего восстановлено:\u003C\u002Fstrong\u003E 1217\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Сравнение наборов методов\" title=\"Сравнение наборов методов\" height=\"336\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb54\u002F47c\u002Fe74\u002Fb5447ce74260142866571092da871650.png\" data-width=\"590\"\u002F\u003E\u003Cfigcaption\u003EСравнение наборов методов\u003C\u002Ffigcaption\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВ зависимости от целей и располагаемого времени, рекомендуется выбрать один из наборов, из списка выше. Однако наилучший результат будет достигнут путем применения самостоятельно сгенерированных словарей, масок и правил.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"hashcat"},{"titleHtml":"activedirectory"},{"titleHtml":"pentest"},{"titleHtml":"passwords"},{"titleHtml":"windows"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb2f\u002Fd15\u002Fde7\u002Fb2fd15de7671326b47166c3275d34f33.png","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb2f\u002Fd15\u002Fde7\u002Fb2fd15de7671326b47166c3275d34f33.png","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fdeiteriylab\\\u002Fblog\\\u002F584160\\\u002F\"},\"headline\":\"Брутфорс хэшей в Active Directory\",\"datePublished\":\"2021-10-19T19:34:11+03:00\",\"dateModified\":\"2021-10-20T10:35:49+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"kukuxumushi\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Слабые пароли пользователей &mdash; очень распространенная проблема, которая может позволить злоумышленнику повысить свои привилегии и закрепиться в сети компании.Чтоб...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fdeiteriylab\\\u002Fblog\\\u002F584160\\\u002F#post-content-body\",\"about\":[\"c_deiteriylab\",\"h_infosecurity\",\"h_sys_admin\",\"f_develop\",\"f_admin\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F584160\\\u002F56235dc30cf80706fafa3b41cb6696c7\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Ffb1\\\u002Fdeb\\\u002F497\\\u002Ffb1deb497e4627ef832f5e23779a116f.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fa1a\\\u002F5e2\\\u002Fd27\\\u002Fa1a5e2d27ca60c67243de13980121f4c.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F753\\\u002Fdb2\\\u002F20f\\\u002F753db220fc12bfe5e0127268441c6261.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F77c\\\u002F576\\\u002Fd4f\\\u002F77c576d4fa0f2fc8b084168dd5726efb.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F691\\\u002F9e8\\\u002F106\\\u002F6919e8106a88480b82956e2f8be81286.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fcea\\\u002F662\\\u002F26a\\\u002Fcea66226a38ca700c871d4b8d3a44c92.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F629\\\u002F5bc\\\u002F8f7\\\u002F6295bc8f723402cad292ad6129c75a02.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F6ac\\\u002F34f\\\u002F2e7\\\u002F6ac34f2e78a301b033effc9025ff4b62.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Ff5e\\\u002F565\\\u002F97d\\\u002Ff5e56597d51a83f43d1cb92740e465d6.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fc26\\\u002Fe9c\\\u002F272\\\u002Fc26e9c2728884ea641fc572c1100df7a.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F697\\\u002Fc9b\\\u002Fc7a\\\u002F697c9bc7a0f8c9c9d28a6f262e561f08.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fe80\\\u002F531\\\u002Ff33\\\u002Fe80531f33fbdf9bae5edc1846d8018d7.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F473\\\u002F383\\\u002F472\\\u002F473383472310e56da92c14b838a149ed.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F849\\\u002F1bc\\\u002Fe93\\\u002F8491bce935f38fa5833eebc786772110.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fa71\\\u002F6d2\\\u002F61f\\\u002Fa716d261fb81760b8e206c78ed98a58b.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fcda\\\u002F2fc\\\u002F2f2\\\u002Fcda2fc2f201449a4b13c878a361edafb.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fe74\\\u002F2e9\\\u002F9bd\\\u002Fe742e99bde0b964858336e2932a44ea7.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fc92\\\u002F3de\\\u002Ff39\\\u002Fc923def3948f9e28d0ef076fa9e93adf.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fb54\\\u002F47c\\\u002Fe74\\\u002Fb5447ce74260142866571092da871650.png\"]}","metaDescription":"Слабые пароли пользователей — очень распространенная проблема, которая может позволить злоумышленнику повысить свои привилегии и закрепиться в сети компании.Чтобы этого не допустить, необходимо...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{"deiteriylab":{"alias":"deiteriylab","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F655\u002Fe13\u002Fab1\u002F655e13ab17c25e01d5a93824fa872af3.png","titleHtml":"Deiteriy Lab","descriptionHtml":"Делаем пентесты","relatedData":null,"statistics":{"postsCount":2,"newsCount":0,"vacanciesCount":0,"employeesCount":3,"careerRating":null,"subscribersCount":21,"rating":146.15,"invest":null},"foundationDate":{"year":"2010","month":"01","day":"26"},"location":{"city":{"id":"447733","title":"Санкт-Петербург"},"region":{"id":"1948","title":"Санкт-Петербург и область"},"country":{"id":"168","title":"Россия"}},"siteUrl":"https:\u002F\u002Flab.deiteriy.com","staffNumber":"11–30 человек","registrationDate":"2021-10-05T08:44:15+00:00","representativeUser":{"alias":"ostrokonskiy","fullname":"Антон"},"contacts":[{"title":"Сайт","url":"https:\u002F\u002Flab.deiteriy.com"}],"settings":{"analyticsSettings":[],"branding":null,"status":"active"},"metadata":{"titleHtml":"Deiteriy Lab, Санкт-Петербург - Делаем пентесты с 26 января 2010 г.","title":"Deiteriy Lab, Санкт-Петербург - Делаем пентесты с 26 января 2010 г.","keywords":["Информационная безопасность","Системное администрирование"],"descriptionHtml":"2 статьи от авторов компании Deiteriy Lab","description":"2 статьи от авторов компании Deiteriy Lab"},"aDeskSettings":null,"careerAlias":null,"maxCustomTrackerLinks":0}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
